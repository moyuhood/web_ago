webpackJsonp([1],{"+28K":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i("v2ns");var n=i("7QTg");e.default={props:{},name:"pc-scene-panel",components:{swiper:n.swiper,swiperSlide:n.swiperSlide},data:function(){return{swiperOption:{slidesPerView:4,spaceBetween:15,grabCursor:!0,scrollbar:{el:".swiper-scrollbar",draggable:!0,dragSize:"auto"},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}}}},created:function(){},computed:{sceneIsActive:function(){return this.$store.state.sceneIsActive},sceneList:function(){return this.$store.state.sceneList},currentSceneIndex:function(){return this.$store.state.currentSceneIndex}},watch:{currentSceneIndex:function(t,e){this.sceneIsActive&&t!==e&&this.updateSceneItem(this.currentSceneIndex)},currentSceneIsActive:function(t,e){}},mounted:function(){var t=this;1===this.sceneList[0].index&&this.$store.dispatch("changeCurrentSceneIndex",1),this.$nextTick(function(){t.updateSceneItem(t.currentSceneIndex)})},methods:{showScenePanelList:function(){this.$store.dispatch("changeSceneStatus",!this.sceneIsActive)},closeScenePanelList:function(){this.$store.dispatch("changeSceneStatus",!1)},selectSceneItem:function(t){if("scene-item"===t.target.className&&t.target.dataset.index&&t.target.dataset.index!==this.currentSceneIndex){var e=parseInt(t.target.dataset.index);this.$store.dispatch("changeCurrentSceneIndex",e)}},selectSceneItem1:function(t){var e=this;t=parseInt(t),this.$nextTick(function(){e.$refs.swiper&&e.$refs.swiper.swiper.slideTo(t),e.$store.dispatch("changeCurrentSceneIndex",t)})},updateSceneItem:function(t){var e=this,i="sceneItem"+t;this.$nextTick(function(){e.$refs[i]&&[0].scrollIntoView&&e.$refs[i]&&e.$refs[i][0].scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),e.$refs[i]&&e.$refs[i][0].scrollIntoViewIfNeeded&&e.$refs[i]&&e.$refs[i][0].scrollIntoViewIfNeeded(!0)})}}}},"+3NN":function(t,e){},"+GI9":function(t,e){},"+NqR":function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{on:{click:this.emitFun}},[this._t("feature-icon"),this._v(" "),this._t("feature-text")],2)},staticRenderFns:[]};e.a=n},"+Th0":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("WLav"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("5GbH");var s=function(t){i("5GhF")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-1f690d44",null);e.default=l.exports},"+Wo4":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("gj31"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("fBLG");var s=function(t){i("bWA0")},l=i("VU/8")(o.a,a.a,!1,s,null,null);e.default=l.exports},"+bgK":function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"panorama-btn-container",on:{click:this.changeMode}},[e("i",{staticClass:"panorama-btn-icon"}),this._v(" "),e("span",{staticClass:"panorama-btn-text"},[this._v("\n         "+this._s(this.$t("panoramaText"))+"\n    ")])])},staticRenderFns:[]};e.a=n},"+ej7":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i("v2ns");var n=i("7QTg");e.default={props:{},name:"mobile-lecture-panel",components:{swiper:n.swiper,swiperSlide:n.swiperSlide},data:function(){return{swiperOption:{slidesPerView:4,spaceBetween:15,freeMode:!0,slideToClickedSlide:!0,scrollbar:{el:".swiper-scrollbar",draggable:!0,dragSize:50},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},loop:!1,loopAdditionalSlides:0}}},computed:{lectureIsActive:function(){return this.$store.state.lectureIsActive},lectureList:function(){return this.$store.state.lectureList},currentLectureIndex:function(){return this.$store.state.currentLectureIndex},currentLecturePercent:function(){return this.$store.state.currentLecturePercent}},watch:{currentLectureIndex:function(t,e){var i=this,n="lectureItem"+t;this.$nextTick(function(){i.$refs[n][0].scrollIntoView&&i.$refs[n][0].scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),i.$refs[n][0].scrollIntoViewIfNeeded&&i.$refs[n][0].scrollIntoViewIfNeeded(!0)})}},created:function(){},mounted:function(){},methods:{showLecturePanelList:function(){this.statistic_utils.trackEvent(23),this.$store.dispatch("changeLectureStatus",!0)},closeLecturePanelList:function(){this.statistic_utils.trackEvent(24),this.$store.dispatch("changeLectureStatus",!1)},selectLectureItem:function(t){t=parseInt(t),this.$store.dispatch("changeCurrentLectureIndex",t)}}}},"+wHh":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"lecture-panel-container",class:{active:t.lectureIsActive}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.lectureIsActive,expression:"lectureIsActive"}],staticClass:"lecture-list-container"},[t.lectureList.length<=4?i("div",{ref:"lectureList",staticClass:"lecture-list"},t._l(t.lectureList,function(e,n){return i("div",{key:n,ref:"lectureItem"+n,refInFor:!0,staticClass:"lecture-item",class:{active:t.currentLectureIndex===n},attrs:{"data-index":n},on:{click:function(e){return t.selectLectureItem(n)}}},[i("div",{staticClass:"lecture-item-text"},[t._v(t._s(e.name)+"asdf")]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.currentLectureIndex===n,expression:"currentLectureIndex === index"}],staticClass:"lecture-item-status-container"},[i("div",{staticClass:"lecture-item-status",style:{width:t.currentLecturePercent+"%"}})])])}),0):t.lectureList.length>4?i("div",{ref:"lectureList",staticClass:"lecture-list"},[i("swiper",{attrs:{options:t.swiperOption}},[i("div",{staticClass:"swiper-scrollbar",attrs:{slot:"scrollbar"},slot:"scrollbar"}),t._v(" "),t._l(t.lectureList,function(e,n){return i("swiper-slide",{key:n},[i("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"}),t._v(" "),i("div",{ref:"lectureItem"+n,refInFor:!0,staticClass:"lecture-item",class:{active:t.currentLectureIndex===n},attrs:{"data-index":n},on:{click:function(e){return t.selectLectureItem(n)}}},[i("div",{staticClass:"lecture-item-text2"},[t._v(t._s(e.name))]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.currentLectureIndex===n,expression:"currentLectureIndex === index"}],staticClass:"lecture-item-status-container"},[i("div",{staticClass:"lecture-item-status",style:{width:t.currentLecturePercent+"%"}})])])])})],2)],1):t._e()]),t._v(" "),i("div",{staticClass:"lecture-btn-content",class:{active:t.lectureIsActive},on:{click:function(e){return e.preventDefault(),t.toggleLectureList(e)}}},[i("i",{staticClass:"lecture-btn-icon"}),t._v(" "),i("span",{staticClass:"lecture-btn-text"},[t._v(t._s(t.$t("lectureText")))])])])},staticRenderFns:[]};e.a=n},"+zAU":function(t,e){},"/8EQ":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("F2xk"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("Zcgf");var s=function(t){i("S0Ex")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-10402158",null);e.default=l.exports},"/9mg":function(t,e,i){"use strict";t.exports={title:"subtitle",share:{enable:!0,share_link:"ShareLink",share_context:"ShareContext",share_img:"ShareImageUrl",share_title:"ShareTitle"},houseInfo:{enable:!0,version:0,list:[],map:{lon:"address_x",lat:"address_y"},map_type:"map_type",houseDetail:"jump_url"},brokerInfo:{enable:!0,brokerImage:"StaffImage",brokerPhone:"UserExt",PcPhoneTip:"",brokerName:"***"},homeLink:{enable:!1,link:"indexUrl"},panoramaLink:{enable:!1,link:"hangpaiUrl"}}},"/Hj1":function(t,e){},"/Nm6":function(t,e){},"/R/P":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("XulS"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("RNrm");var s=function(t){i("wbWE")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-012fa2da",null);e.default=l.exports},"/f0r":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"iframe-tag-container",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeTagContainer(e)},touchmove:function(t){t.preventDefault()},scroll:function(t){t.preventDefault()},mousewheel:function(t){t.preventDefault()}}},[i("div",{staticClass:"iframe-tag-content"},[i("div",{staticClass:"iframe-close-btn",on:{click:t.closeTagContainer}}),t._v(" "),i("iframe",{staticClass:"iframe-ele scroll_content",attrs:{src:t.currentTagData.url,frameborder:"0",scrolling:"auto"}})])])},staticRenderFns:[]};e.a=n},"/fLj":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"house-img-container",data:function(){return{}},computed:{houseInfoData:function(){return this.$store.state.houseInfo}},created:function(){},mounted:function(){},methods:{toggleHouseInfoImgSwiper:function(){this.$store.dispatch("toggleHouseInfoImgSwiper",!0),this.$store.dispatch("toggleHouseInfoPanel",!1)},goHangPai:function(){this.statistic_utils.trackEvent(29),this.houseInfoData&&this.houseInfoData.panoramaLink&&this.houseInfoData.panoramaLink.enable&&this.houseInfoData.panoramaLink.link&&(window.location.href=this.houseInfoData.panoramaLink.link)}}}},"/g3c":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={components:{},props:{},name:"mobile-company-logo",data:function(){return{}},computed:{companyLogoUrl:function(){return this.$store.state.companyLogoUrl}},created:function(){},mounted:function(){},methods:{}}},0:function(t,e,i){i("EKrm"),i("j1ja"),t.exports=i("NHnr")},"0B5h":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("N1bY"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("0tTq");var s=function(t){i("WdZV")},l=i("VU/8")(o.a,a.a,!1,s,null,null);e.default=l.exports},"0F+u":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i("v2ns");var n=i("7QTg");e.default={props:{},name:"mobile-scene-panel",components:{swiper:n.swiper,swiperSlide:n.swiperSlide},data:function(){return{swiperOption:{slidesPerView:4,spaceBetween:15,slideToClickedSlide:!0,scrollbar:{el:".swiper-scrollbar",draggable:!0,dragSize:100},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},loop:!1,loopAdditionalSlides:0}}},computed:{sceneIsActive:function(){return this.$store.state.sceneIsActive},sceneList:function(){return this.$store.state.sceneList},currentSceneIndex:function(){return this.$store.state.currentSceneIndex}},watch:{currentSceneIndex:function(t,e){var i=this,n="sceneItem"+t;this.$nextTick(function(){i.$refs[n][0].scrollIntoView&&i.$refs[n][0].scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),i.$refs[n][0].scrollIntoViewIfNeeded&&i.$refs[n][0].scrollIntoViewIfNeeded(!0)})}},created:function(){},mounted:function(){},methods:{showScenePanelList:function(){this.statistic_utils.trackEvent(14),this.$store.dispatch("changeSceneStatus",!0)},closeScenePanelList:function(){this.statistic_utils.trackEvent(15),this.$store.dispatch("changeSceneStatus",!1)},selectSceneItem:function(t){if("scene-item"===t.target.className&&t.target.dataset.index&&t.target.dataset.index!==this.currentSceneIndex){var e=parseInt(t.target.dataset.index);this.$store.dispatch("changeCurrentSceneIndex",e)}},selectSceneItem1:function(t){this.statistic_utils.trackEvent(0),t=parseInt(t),this.$store.dispatch("changeCurrentSceneIndex",t)}}}},"0MTW":function(t,e){},"0PvF":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i("v2ns");var n=i("7QTg");e.default={props:{},name:"pc-img-swiper",data:function(){return{swiperOptionTop:{spaceBetween:10,loop:!0,loopedSlides:1,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}},swiperOptionThumbs:{spaceBetween:11,slidesPerView:4,touchRatio:.2,loop:!0,loopedSlides:1,slideToClickedSlide:!0}}},computed:{houseInfoData:function(){return this.$store.state.houseInfo}},components:{swiper:n.swiper,swiperSlide:n.swiperSlide},created:function(){},mounted:function(){var t=this;this.$nextTick(function(){var e=t.$refs.swiperTop.swiper,i=t.$refs.swiperThumbs.swiper;e.controller.control=i,i.controller.control=e})},methods:{closeImgSwiper:function(){this.statistic_utils.trackEvent(78),this.$store.dispatch("toggleHouseInfoImgSwiper",!1)}}}},"0aIv":function(t,e){},"0axG":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("t27W"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("pdV6");var s=function(t){i("KOLw")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-0f8914bf",null);e.default=l.exports},"0fFI":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i("v2ns");var n=i("7QTg");e.default={props:{},name:"picture-tag-container",components:{swiper:n.swiper,swiperSlide:n.swiperSlide},data:function(){return{swiperOption:{pagination:{el:".swiper-pagination",type:"fraction"},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},loop:!0,loopAdditionalSlides:0}}},computed:{currentTagData:function(){return this.$store.state.currentTagData}},created:function(){},mounted:function(){},methods:{closeTagContainer:function(){this.statistic_utils.trackEvent(79),this.$store.dispatch("changeTagStatus",!1)},lookDetails:function(){this.currentTagData.url&&(window.location.href=this.currentTagData.url)}}}},"0iLD":function(t,e,i){"use strict";t.exports={brokerInfo:{enable:!0,brokerImage:"HeadPortraitUrl",brokerPhone:"Mobile",brokerName:"",PcPhoneTip:""},commonJsonData:{area_text:"",district_text:"",purpose_text:"",house_type:"户型",acreage_value:"建筑面积",orientation_text:"朝向",decoration_type:"装修",floor_text:"楼层",complation_date:"建筑年代",total_price:"售价",address_details:"",house_status:"",longitude_value:"address_x",latitude_value:"address_y",more_details_address:"jump_url",community_name:"小区",unit_price:"",sell_type:"",city_text:"",developer_name:"",elevator_issupport:"",listing_time:"",rent_price:"",hangpaiurl:""}}},"0k8j":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"slide-verify-container",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeSlideVerify(e)},touchmove:function(t){if(t.target!==t.currentTarget)return null;t.preventDefault()},scroll:function(t){if(t.target!==t.currentTarget)return null;t.preventDefault()},mousewheel:function(t){if(t.target!==t.currentTarget)return null;t.preventDefault()}}},[i("div",{staticClass:"slide-verify-content"},[i("div",{staticClass:"slide-verify-img-part re"},[i("img",{staticClass:"slide-verify-img-part-parent",attrs:{src:t.imgUrl+t.slideVerifyPicArray[0],alt:"",id:"slide-img-parent"}}),t._v(" "),i("img",{ref:"slideimg",staticClass:"slide-verify-img-part-small",style:{left:t.currentPosition+"px"},attrs:{src:t.imgUrl+t.slideVerifyPicArray[1],alt:""}}),t._v(" "),i("div",{staticClass:"slide-verify-img-part-refresh css-sprites",on:{click:t.refreshImg}})]),t._v(" "),i("div",{staticClass:"slide-verify-btn-part"},[i("div",{ref:"slidebg",staticClass:"slide-verify-btn-part-footer-container"},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.status,expression:"!status"}],staticClass:"slide-verify-btn-part-footer-btn",style:{left:t.currentPosition+"px"},attrs:{id:"slide-btn"},on:{mousedown:t.slideStart,touchstart:function(e){return t.slideStart(e,"mobile")},mousemove:t.slideMove,touchmove:function(e){return t.slideMove(e,"mobile")},mouseout:t.slideEnd,touchend:function(e){return t.slideEnd(e,"mobile")}}},[t._v(">>")]),t._v(" "),0==t.currentPosition?i("div",{staticClass:"slide-verify-btn-part-footer-status",style:{width:t.currentPosition+"px"},attrs:{id:"slide-status"}}):t._e(),t._v(" "),i("div",{staticClass:"slide-verify-btn-part-footer-desc",class:{success:!0===t.status},attrs:{id:"slide-desc"}},[t._v("\n\t\t\t  "+t._s(!1===t.status?t.$t("slide_verify_desc"):t.$t("slide_verify_success"))+"\n\t\t  ")])])])])])},staticRenderFns:[]};e.a=n},"0pt3":function(t,e){},"0tTq":function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"player-container",attrs:{id:"player"}})},staticRenderFns:[]};e.a=n},"0zIx":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"house-img-container"},[t.houseInfoData.communityImages&&t.houseInfoData.communityImages.enable&&t.houseInfoData.communityImages.images&&t.houseInfoData.communityImages.images.length>0&&t.houseInfoData.panoramaLink&&t.houseInfoData.panoramaLink.enable&&t.houseInfoData.panoramaLink.link?i("div",{staticClass:"house-img-box style2"},[i("div",{staticClass:"house-img-item",style:{backgroundImage:"url("+t.houseInfoData.communityImages.images[0]+")"},on:{click:t.toggleHouseInfoImgSwiper}},[i("div",{staticClass:"house-img-status isCommunity"},[i("i",{staticClass:"community-icon"}),t._v(" "),i("span",{staticClass:"community-text"},[t._v(t._s(t.houseInfoData.communityImages.images.length))])])]),t._v(" "),i("div",{staticClass:"house-img-item isAerial"},[i("div",{staticClass:"house-img-status isAerial",on:{click:t.goHangPai}},[i("span",{staticClass:"aerial-text"},[t._v(t._s(t.$t("goAerialUrl")))]),t._v(" "),i("i",{staticClass:"aerial-icon"})])])]):t.houseInfoData&&t.houseInfoData.communityImages&&t.houseInfoData.communityImages&&t.houseInfoData.communityImages.enable&&t.houseInfoData.communityImages.images&&t.houseInfoData.communityImages.images.length>0||t.houseInfoData&&t.houseInfoData.panoramaLink&&t.houseInfoData.panoramaLink.enable&&t.houseInfoData.panoramaLink.link?i("div",{staticClass:"house-img-box style1"},[t.houseInfoData&&t.houseInfoData.communityImages&&t.houseInfoData.communityImages.enable&&t.houseInfoData.communityImages.images&&t.houseInfoData.communityImages.images.length>0?i("div",{staticClass:"house-img-item isCommunity",style:{backgroundImage:"url("+t.houseInfoData.communityImages.images[0]+")"},on:{click:t.toggleHouseInfoImgSwiper}},[t._m(0)]):t.houseInfoData&&t.houseInfoData.panoramaLink&&t.houseInfoData.panoramaLink.enable&&t.houseInfoData.panoramaLink.link?i("div",{staticClass:"house-img-item isAerial"},[i("div",{staticClass:"house-img-status isAerial",on:{click:t.goHangPai}},[i("span",{staticClass:"aerial-text"},[t._v(t._s(t.$t("goAerialUrl")))]),t._v(" "),i("i",{staticClass:"aerial-icon"})])]):t._e()]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"house-img-status isCommunity"},[e("i",{staticClass:"community-icon"}),this._v(" "),e("span",{staticClass:"community-text"})])}]};e.a=n},"17tp":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(i("mvHQ")),o=r(i("3pLw"));function r(t){return t&&t.__esModule?t:{default:t}}var a=i("2Uyi"),s=i("rnzN"),l=i("w1BD");e.default={load:function(t,e){var i=a.getQueryString("houseDelId"),r=a.getQueryString("middlemanId")||"",c=a.getQueryString("type")||"",u=a.getQueryString("site")||"",h=a.getQueryString("os"),d=a.getQueryString("formId"),p=void 0;if(!i){var f=l.replenishData(null,t);return e(f),!1}var m={housedelId:i,middlemanId:r,response_mode:1,type:c,site:u};o.default.get({url:"https://www.lizihang.com/landz-cloud-vr/vr/getHouseInfo",data:m}).then(function(o){var a=null;if(200===o.status&&1===o.data.code){if(a=l.replenishData(function(t,e){var i={};for(var n in e)switch(n){case"title":i.title=t.title;break;case"share":i.share=l.getTotalData(t,e.share);break;case"houseInfo":i.houseInfo=l.getTotalData(t,e.houseInfo);break;case"brokerInfo":i.brokerInfo=l.getTotalData(t,e.brokerInfo);break;case"homeLink":i.homeLink=l.getTotalData(t,e.homeLink);break;case"panoramaLink":i.panoramaLink=l.getTotalData(t,e.panoramaLink);break;case"communityImages":i.communityImages=l.getTotalData(t,e.communityImages)}return i}(o.data.data,s),t),h&&("h5"===h||"wap"===h)&&i&&r&&c)p=(p="https://m.lizihang.com/landz-im/")+r+"?pageName=VrDetailPage&os="+h+"&houseDelId="+i+"&type="+c,a.miniChat={enable:!0,params:p,style:"web"};else if(h&&"miniapp"===h&&i&&r&&c)p="/pages/im/imDetail/main?",p=d?p+"pageName=VrDetailPage&os="+h+"&houseDelId="+i+"&type="+c+"&middlemanId="+r+"&formId="+d:p+"pageName=VrDetailPage&os="+h+"&houseDelId="+i+"&type="+c+"&middlemanId="+r,a.miniChat={enable:!0,params:p,style:"miniapp"};else if(h&&"clientapp"===h){var u=(0,n.default)({interfaceName:"chatIM",options:{pageName:"VrDetailPage"}});a.miniChat={enable:!0,params:u,style:"app"}}else a.miniChat={enable:!1,params:""};e(a)}else a=l.replenishData(null,t),e(a)})}}},"1CD3":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{funName:{type:String}},name:"single-feature",data:function(){return{}},created:function(){},mounted:function(){},methods:{emitFun:function(){this.$emit("emitFun",this.funName)}}}},"1Caf":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"take-look-container"},[i("div",{staticClass:"take-look-left"},[1===t.takeLookProgress?i("div",{staticClass:"time-count-container"},[i("span",{staticClass:"time-text"},[t._v(t._s(t.currentTime))]),t._v(" "),i("span",{staticClass:"time-desc"},[t._v("等待顾问")])]):2===t.takeLookProgress?i("div",{staticClass:"link-again",on:{click:t.callAgain}},[i("span",{staticClass:"icon"}),t._v(" "),i("span",{staticClass:"desc"},[t._v("再次呼叫")])]):3===t.takeLookProgress?i("div",{staticClass:"broker-container"},[i("i",{staticClass:"broker-icon",style:{backgroundImage:"url("+t.brokerBg+")"}}),t._v(" "),i("div",{staticClass:"broker-desc"},[i("span",{staticClass:"broker-name only-line1"},[t._v(t._s(t.brokerName))]),t._v(" "),i("span",{staticClass:"broker-title"},[t._v(t._s(t.brokerTitle))])])]):t._e()]),t._v(" "),i("div",{staticClass:"take-look-end",class:{spec:"panorama"!==t.currentMode},on:{click:t.closeTakeLook}},[i("i",{staticClass:"take-look-end-icon"}),t._v(" "),i("span",{staticClass:"take-look-end-text"},[t._v(t._s(t.$t("take_look_end_text")))])]),t._v(" "),i("div",{staticClass:"take-look-right"},[i("i",{staticClass:"take-look-right-icon",style:{backgroundImage:"url("+t.userBg+")"}}),t._v(" "),i("div",{staticClass:"take-look-right-desc"},[i("span",{staticClass:"take-look-right-name only-line1"},[t._v(t._s(t.userName))]),t._v(" "),i("span",{staticClass:"take-look-right-title"},[t._v(t._s(t.userTitle))])])])])},staticRenderFns:[]};e.a=n},"1Lh/":function(t,e){},"1O0X":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("U/sn"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("tHSw");var s=function(t){i("oCf1")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-26aa6326",null);e.default=l.exports},"1YG9":function(t,e){},"1bJ3":function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement;return(this._self._c||t)("div",[this._t("default")],2)},staticRenderFns:[]};e.a=n},"1ccB":function(t,e){t.exports={defaultTitle:"3D物件内見",panoramaText:"室内",dollhouseText:"3D",floorplanText:"間取図",sceneText:"案内",lectureText:"音声案内",playText:"再生",pauseText:"停止",middleManTitle:"担当者",takeLookText:"遠隔案内",miniChatText:"微话",toolsText:"ツール",measureText:"寸法",tagText:"タグ",vrText:"VR",helpText:"ヘルプ",wechatTipTitle:"スマホで体験",wechatTipDesc:"",disclaimerBtnText:"利用規約",houseInfoTitle:"物件情報",houseInfoMoreBtnText:"もっと見る",goAerialUrl:"空撮画像",lookMapMore:"周辺環境",vrTipTitle:"VRモード",vrTipDesc1:"スマートフォンの画面縦向きのロックを解除し、VRゴーグルに入れてください",vrTipDesc2:"前向き進むには、視野の中の白い点を青い枠に合わせてください",helpTipTitle:"ヘルプ",helpTipWalk:"クリックして移動する",helpTipSlide:"ドラックして見回す",helpTipMagnify:"2本の指を広げる",helpTipShrink:"2本指の縮小",telText:"Tel",wifiTipText:"WIFI環境での観覧をおすすめ",look3DDesc:"３Dビュー",direction_s_text:"南",direction_n_text:"北",direction_w_text:"西",direction_e_text:"東",direction_e_n_text:"東北",direction_e_s_text:"東南",direction_w_n_text:"西北",direction_w_s_text:"西南",approximate_text:"約",unit_text:"m",double_unit_text:"m²",entry_text:"入口",floorLevel:"階",floorAll:"全体",mobile_num_not_empty:"必ず電話番号を入力して下さい。",middle_verify_input_incorrect_format:"電話番号が間違っています",mobile_num_not_match:"有効な電話番号を入力して下さい。",middle_verify_input_title:"番号を入力する",middle_verify_input_lable:"電話:",middle_verify_input_placeholder:"電話番号を入力する",middle_verify_confirm_text:"確認",middle_verify_cancel_text:"キャンセル",middle_verify_open_text:"開く",middle_verify_generate_link_title:"リンクを生成",middle_verify_tip_title:"メッセージ",middle_verify_tip_modify_text:"書き直し",middle_verify_copy_success_tip:"リンクはクリップボードにコピーされました。",middle_verify_copy_text:"コピー",middle_verify_tip_content:"電話番号'number'は登録していないです。管理者に連絡してください。",middle_verify_correct_tip:"正しい携帯番号を入力してください",tagLookDetails:"詳細を確認",mobile_contact_desc_text:"(内線番号は手動で入力してください)",mobile_contact_cancel_text:"キャンセル",mobile_contact_call_text:"通話",has_not_phone_tip:"電話番号未登録",slide_verify_desc:" スライダーを右にドラッグ",slide_verify_success:"検証に合格しました",take_look_end_text:"終了",red_packet:"秒后可拆"}},"1hEm":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("+ej7"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("hA7x");var s=function(t){i("aNZS")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-22f6c64b",null);e.default=l.exports},"1hlY":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mini-floor-plan-container"},[i("div",{staticClass:"floor-plan-content",on:{click:function(e){return t.changeMode("floorplan")}}},[i("div",{staticClass:"floor-plan-area",domProps:{innerHTML:t._s(t.currentArea)}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.floorPlanImageUrl,expression:"floorPlanImageUrl"}],staticClass:"floor-plan-compass"},[i("span",{staticClass:"floor-plan-compass-text"},[t._v("\n                "+t._s(this.currentCompass.up)+"\n            ")]),t._v(" "),i("i",{staticClass:"floor-plan-compass-arrow"})]),t._v(" "),i("div",{staticClass:"floor-plan-img-container-box"},[i("div",{staticClass:"floor-plan-img-container"},[i("img",{staticClass:"floor-plan-img",style:{width:t.miniFloorPlanWidth,height:t.miniFloorPlanHeight},attrs:{src:t.floorPlanImageUrl,alt:""}}),t._v(" "),i("img",{directives:[{name:"show",rawName:"v-show",value:t.floorPlanImageUrl,expression:"floorPlanImageUrl"}],staticClass:"locating-point",style:{left:"calc("+t.currentPosition.x+" - 1.1rem)",top:"calc("+t.currentPosition.y+" - 1.1rem)",transform:"rotate("+t.currentAngle+"deg)",transition:"left "+t.currentPosition.time/1e3+"s,top "+t.currentPosition.time/1e3+"s"},attrs:{src:t.locationgPointIcon,alt:""}})])])]),t._v(" "),i("div",{staticClass:"doll-house-container",on:{click:function(e){return t.changeMode("dollhouse")}}},[i("i",{staticClass:"doll-house-icon"}),t._v(" "),i("span",{staticClass:"doll-house-text"},[t._v("\n            "+t._s(t.$t("look3DDesc"))+"\n        ")])])])},staticRenderFns:[]};e.a=n},"1m9V":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"vr-tip-container",on:{click:t.closeVrTip}},[i("div",{staticClass:"vr-tip-title"},[i("i",{staticClass:"vr-tip-title-icon"}),t._v(" "),i("span",{staticClass:"vr-tip-title-text"},[t._v(t._s(t.$t("vrTipTitle")))])]),t._v(" "),t._m(0),t._v(" "),i("div",{staticClass:"vr-tip-desc"},[i("i",{staticClass:"vr-tip-desc-item"},[t._v("\n             "+t._s(t.$t("vrTipDesc1"))+"\n        ")]),t._v(" "),i("i",{staticClass:"vr-tip-desc-item"},[t._v("\n             "+t._s(t.$t("vrTipDesc2"))+" \n        ")])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"vr-tip-enter"},[e("i",{staticClass:"vr-tip-enter-icon"})])}]};e.a=n},"1mZ1":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("UjGr"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("Cy/D");var s=function(t){i("P36U")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-63d138ce",null);e.default=l.exports},"1oy7":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o(i("3pLw"));function o(t){return t&&t.__esModule?t:{default:t}}var r=o(i("ynQN")).default.getStyle();e.default={props:{},name:"mobile-middleman-transpond",data:function(){return{inputNumber:"",tipContent:"",shareUrl:""}},created:function(){},mounted:function(){},computed:{middlemanTranspondStep:function(){return this.$store.state.middlemanTranspondStep}},methods:{cancelInput:function(){this.$store.dispatch("changeMiddlemanTranspondStatus",!1),this.$store.dispatch("changeMiddlemanTranspondStep","input"),this.inputNumber=""},confirmInput:function(){this.checkNumber(this.inputNumber)?this.verifyNumber(this.inputNumber):this.$store.dispatch("changeMiddlemanTranspondStep","checkFail")},cancelCopy:function(){this.$store.dispatch("changeMiddlemanTranspondStatus",!1),this.$store.dispatch("changeMiddlemanTranspondStep","input"),this.inputNumber=""},goCopy:function(){},goBackModify:function(){this.$store.dispatch("changeMiddlemanTranspondStep","input")},checkNumber:function(t){return!!t},verifyNumber:function(t){var e,i={phone:t,nest_id:this.CommonUtil.getQueryString("m")},o=window.location.href;e="online"===r?"https://user.3dnest.cn/nest_house/verify_broker/":"https://allfun.3dnest.cn/nest_house/verify_broker/",this.tipContent=this.$t("middle_verify_tip_content").replace("number",t);var a=this;n.default.post({url:e,data:i}).then(function(t){if(1===t.code){var e=t.pa;a.shareUrl=a.CommonUtil.changeURLArg(o,"middlemanShare",e),a.$store.dispatch("changeMiddlemanTranspondStep","success")}else a.$store.dispatch("changeMiddlemanTranspondStep","fail")})},jumpUrl:function(){window.location.href=this.shareUrl},onCopy:function(t){this.cancelInput(),this.$store.dispatch("changeCopyStatus",!0);var e=this;setTimeout(function(){e.$store.dispatch("changeCopyStatus",!1),null},1500)},onError:function(t){}}}},"2HrB":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"full-screen",data:function(){return{}},computed:{isFull:function(){return this.$store.state.isFullScreen},ShareFullState:function(){return this.$store.state.ShareFullState}},created:function(){},mounted:function(){var t=this;window.onresize=function(){t.isFullScreen()?t.$store.dispatch("toggleFullScreenStatus",!0):t.$store.dispatch("toggleFullScreenStatus",!1)}},methods:{toggleFull:function(){if(this.isFull)this.exitFullscreen();else{this.statistic_utils.trackEvent(74);this.fullScreen()}},fullScreen:function(){var t=document.documentElement,e=!0;return t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():e=!1,e},exitFullscreen:function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},isFullScreen:function(){return window.innerHeight==window.screen.height}}}},"2NXV":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={components:{},props:{},name:"mobile-floor-bar",data:function(){return{currentFloorIndex:"all"}},computed:{floorList:function(){return this.$store.state.floorList},currentMode:function(){return this.$store.state.currentMode}},watch:{currentMode:function(t,e){switch(t){case"floorplan":this.currentFloorIndex=this.$store.state.currentFloorIndex;break;case"dollhouse":this.currentFloorIndex="all"}}},created:function(){},mounted:function(){},methods:{selectFloor:function(t){if(this.statistic_utils.trackEvent(75),t.target.dataset.index==this.currentFloorIndex)return!1;this.currentFloorIndex=t.target.dataset.index,this.$store.dispatch("changeCurrentFloorIndex",t.target.dataset.index)}}}},"2OPp":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("y8eZ"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("EO5w");var s=function(t){i("F6KQ")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-16e83767",null);e.default=l.exports},"2Uyi":function(t,e,i){"use strict";t.exports={getQueryString:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),i=window.location.search.substr(1).match(e);return null!=i?decodeURI(i[2]):null},isContain:function(t,e,i){return 0===window.location.host.indexOf(t)},isMobile:function(){var t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|android|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))},changeURLArg:function(t,e,i){var n=e+"=([^&]*)",o=e+"="+i;if(t.match(n)){var r="("+e+"=)([^&]*)",a=new RegExp(r,"gi");return r=t.replace(a,o)}return t.match("[?]")?t+"&"+o:t+"?"+o},getUuid:function(){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},detectDevice:function(){var t=navigator.userAgent,e=t.indexOf("Android")>-1||t.indexOf("Adr")>-1;return!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?"ios":e?"android":""},getAllValueFromSearch:function(){var t=window.location.search,e={};if(-1!==t.indexOf("?"))for(var i=t.substr(1).split("&"),n="",o=0;o<i.length;o++)e[(n=i[o].split("="))[0]]=unescape(n[1]);return e},detectIOS:function(){var t=window.navigator.userAgent;return/iPad|iPhone|iPod/.test(t)},detectAndroid:function(){return-1!==window.navigator.userAgent.indexOf("Android")}}},"2jBA":function(t,e){},"2p3U":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"help-tip-component",data:function(){return{}},created:function(){},mounted:function(){},methods:{closeHelpTip:function(){this.statistic_utils.trackEvent(76),this.$store.dispatch("changeHelpTipStatus",!1)}}}},"2sFm":function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"panorama-btn-container",on:{click:this.changeMode}},[e("i",{staticClass:"panorama-btn-icon"}),this._v(" "),e("span",{staticClass:"panorama-btn-text"},[this._v("\n         "+this._s(this.$t("panoramaText"))+"\n    ")])])},staticRenderFns:[]};e.a=n},"31q2":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("3pLw"),r=(n=o)&&n.__esModule?n:{default:n};var a=i("2Uyi"),s=i("AuHd"),l=i("w1BD");i("ynQN").getStyle();e.default={load:function(t,e){var i=a.getQueryString("houseNo"),n=a.getQueryString("emplid"),o=a.getQueryString("type");if(i){var c={houseNo:i,emplid:n||0,type:o};r.default.get({url:"https://miniprograms.leet.com.cn/VRHouseInfo/HouseInfo",data:c}).then(function(i){var n=null;200===i.status&&i.data&&1==i.data.code?(n=l.replenishData(function(t,e){var i={};for(var n in e)switch(n){case"title":i.title=t.title;break;case"share":i.share=l.getTotalData(t,e.share);break;case"houseInfo":i.houseInfo=l.getTotalData(t,e.houseInfo);break;case"brokerInfo":i.brokerInfo=l.getTotalData(t,e.brokerInfo);break;case"homeLink":i.homeLink=l.getTotalData(t,e.homeLink);break;case"panoramaLink":i.panoramaLink=l.getTotalData(t,e.panoramaLink)}return i}(i.data.HouseInfo,s),t),e(n)):(n=l.replenishData(null,t),e(n))})}else{var u=l.replenishData(null,t);e(u)}}}},"322j":function(t,e,i){"use strict";t.exports={title:"Title",share:{enable:!0,share_link:"ShareLink",share_context:"ShareContext",share_img:"ShareImageUrl",share_title:"ShareTitle"},offline:{text:"该房源已下架，您可以联系下方经纪人为您推荐其他优质房源！",houseDetail:""},houseInfo:{enable:!0,version:0,list:[{value:"EstateName",name:"楼盘名称",widthStyle:"2"},{value:"(Price)(PriceName)",name:"售价",widthStyle:"1"},{value:"(PriceUnit)(PriceUnitName)",name:"单价",widthStyle:"1"},{value:"(CountF)室(CountT)厅(CountW)卫",name:"户型",widthStyle:"1"},{value:"(Square)(SquareName)",name:"面积",widthStyle:"1"},{value:"HasElevator",name:"电梯",widthStyle:"1"},{value:"PropertyDirectionName",name:"朝向",widthStyle:"1"},{value:"(Floor)/(FloorAll)",name:"楼层",widthStyle:"1"},{value:"PropertyUsageName",name:"用途",widthStyle:"1"},{value:"TrustDate",name:"挂牌时间",widthStyle:"1"},{value:"CompleteYear",name:"建筑年代",widthStyle:"1"}],map:{lon:"CoX",lat:"CoY"},houseDetail:"ID",downUrl:""},brokerInfo:{enable:!0,brokerImage:"StaffImage",brokerPhone:"UserExt",PcPhoneTip:""},homeLink:{enable:!1,link:"indexUrl"},panoramaLink:{enable:!1,link:"hangpaiUrl"},commonJsonData:{area_text:"",district_text:"",purpose_text:"PropertyUsageName",house_type:"(CountF)室(CountT)厅(CountW)卫",acreage_value:"(Square)(SquareName)",orientation_text:"PropertyDirectionName",decoration_type:"",floor_text:"(Floor)/(FloorAll)",complation_date:"CompleteYear",total_price:"(Price)(PriceName)",address_details:"EstateName",house_status:"",longitude_value:"",latitude_value:"",more_details_address:"",community_name:"",unit_price:"(PriceUnit)(PriceUnitName)",sell_type:"",city_text:"",developer_name:"",elevator_issupport:"HasElevator",listing_time:"TrustDate",rent_price:"",hangpaiurl:""}}},3535:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i("v2ns");var n=i("7QTg");e.default={props:{},name:"house-info",data:function(){return{swiperOption:{loop:!0,loopAdditionalSlides:0,effect:"coverflow",grabCursor:!0,centeredSlides:!0,slidesPerView:"auto",spaceBetween:61,coverflowEffect:{rotate:0,stretch:.2,depth:100,modifier:1,slideShadows:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}},houseInfoData:this.$store.state.houseInfo}},computed:{},components:{swiper:n.swiper,swiperSlide:n.swiperSlide},created:function(){},mounted:function(){},methods:{closeImgSwiper:function(){this.statistic_utils.trackEvent(78),this.$store.dispatch("toggleHouseInfoImgSwiper",!1)}}}},"355H":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i("v2ns");var n=i("7QTg");e.default={props:{componentParams:{type:String}},name:"pc-switch",components:{swiper:n.swiper,swiperSlide:n.swiperSlide},data:function(){return{swiperOption:{slidesPerView:4,spaceBetween:15,slideToClickedSlide:!0,scrollbar:{el:".swiper-scrollbar",draggable:!0,dragSize:80}}}},computed:{lectureIsActive:function(){return this.$store.state.lectureIsActive},lectureList:function(){return this.$store.state.lectureList},currentLectureIndex:function(){return this.$store.state.currentLectureIndex},currentLecturePercent:function(){return this.$store.state.currentLecturePercent}},watch:{currentLectureIndex:function(t,e){var i=this,n="lectureItem"+t;this.$nextTick(function(){i.$refs[n][0].scrollIntoView&&i.$refs[n][0].scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),i.$refs[n][0].scrollIntoViewIfNeeded&&i.$refs[n][0].scrollIntoViewIfNeeded(!0)})}},created:function(){},mounted:function(){},methods:{toggleLectureList:function(){this.$store.dispatch("changeLectureStatus",!this.$store.state.lectureIsActive),this.$store.state.lectureIsActive?this.statistic_utils.trackEvent(23):this.statistic_utils.trackEvent(24)},selectLectureItem:function(t){t=parseInt(t),this.$store.dispatch("changeCurrentLectureIndex",t)}}}},"38pd":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});o(i("EybN"));var n=o(i("Gl8h"));function o(t){return t&&t.__esModule?t:{default:t}}e.default={components:{},props:{modelSettings:Object},name:"mobile-mini-floor-plan",data:function(){return{miniFloorPlanWidth:"",miniFloorPlanHeight:"",locationgPointIcon:n.default,currentTop:0,currentLeft:0}},computed:{floorPlanImageUrl:function(){return this.$store.state.floorPlanImageUrl},currentAngle:function(){return this.$store.state.currentAngle},currentPosition:function(){return this.$store.state.currentPosition},currentArea:function(){return this.$store.state.currentArea},currentCompass:function(){var t=void 0,e={up:"",down:""};return t=this.modelSettings&&this.modelSettings.basic&&this.modelSettings.basic.menu&&this.modelSettings.basic.menu.orientation_correct?this.modelSettings.basic.menu.orientation_correct:0,(t%=360)>=337.5||t<22.5?(e.up=this.$t("direction_n_text"),e.down=this.$t("direction_s_text")):t>=22.5&&t<67.5?(e.up=this.$t("direction_w_n_text"),e.down=this.$t("direction_e_s_text")):t>=67.5&&t<112.5?(e.up=this.$t("direction_w_text"),e.down=this.$t("direction_e_text")):t>=112.5&&t<157.5?(e.up=this.$t("direction_w_s_text"),e.down=this.$t("direction_e_n_text")):t>=157.5&&t<202.5?(e.up=this.$t("direction_s_text"),e.down=this.$t("direction_n_text")):t>=202.5&&t<247.5?(e.up=this.$t("direction_e_s_text"),e.down=this.$t("direction_w_n_text")):t>=247.5&&t<292.5?(e.up=this.$t("direction_e_text"),e.down=this.$t("direction_w_text")):t>=292.5&&t<337.5&&(e.up=this.$t("direction_e_n_text"),e.down=this.$t("direction_w_s_text")),e}},watch:{floorPlanImageUrl:function(t,e){this.updateFloorPlan(t)}},created:function(){this.updateFloorPlan(this.floorPlanImageUrl)},mounted:function(){},methods:{changeMode:function(t){this.statistic_utils.trackEvent(43),this.$store.dispatch("goMode",t)},updateFloorPlan:function(t){if(!t)return!1;var e=t.split("_"),i=9,n=9;if(e&&e.length>0){var o=parseInt(e[e.length-2]),r=parseInt(e[e.length-1]);o>r?(n=r/o*9,i=9):(i=o/r*9,n=9)}this.miniFloorPlanWidth=i+"rem",this.miniFloorPlanHeight=n+"rem"}}}},"3De2":function(t,e,i){"use strict";t.exports.load=function(t,e){e({title:"",share:{enable:!1},houseInfo:{enable:!1},brokerInfo:{enable:!1},homeLink:{enable:!1},panoramaLink:{enable:!1}})}},"3llQ":function(t,e){},"3lr+":function(t,e){},"3pLw":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(i("//Fk")),o=a(i("mtWM")),r=a(i("mw3O"));function a(t){return t&&t.__esModule?t:{default:t}}function s(t){return t&&t.data?t.data:{status:-404,msg:"网络异常"}}o.default.interceptors.request.use(function(t){return t},function(t){return n.default.reject(t)}),o.default.interceptors.response.use(function(t){return t},function(t){return n.default.resolve(t.response)}),e.default={post:function(t){return(0,o.default)({method:"post",baseURL:t.baseURL,url:t.url,data:r.default.stringify(t.data),timeout:1e4,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(t){return s(t)})},get:function(t){return(0,o.default)({method:"get",baseURL:t.baseURL,url:t.url,params:t.data,timeout:1e4}).then(function(t){return t})},getResource:function(t){return(0,o.default)({method:"get",url:t.url,timeout:1e4}).then(function(t){return s(t)})}}},"3sn9":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(i("YFyo")),o=r(i("HcVH"));function r(t){return t&&t.__esModule?t:{default:t}}e.default={props:{},components:{BaiduMap:n.default,BmMarker:o.default},name:"small-baidu-map",data:function(){return{map:{width:"87%",height:"82.15%"}}},computed:{houseInfoData:function(){return this.$store.state.houseInfo}},created:function(){},mounted:function(){},methods:{showBigMap:function(t){this.statistic_utils.trackEvent(8),this.$store.dispatch("toggleHouseInfoPanel",!1),this.$store.dispatch("toggleBigMapStatus",!0)},syncCenterAndZoom:function(t){},lookDetail:function(t,e){var i=this;if(this.infoWindow.show=!0,this.infoWindow.info=t,this.activeName=t.name,this.$nextTick(function(){document.querySelector(".BMap_bubble_title").title=i.activeName}),"left"==e)return this.map.center={lng:t.lng,lat:t.lat},void(this.map.zoom=15);this.$nextTick(function(){var t=document.querySelector(".active").offsetTop;i.$refs.box.scrollTop=t-180})}}}},"3yjQ":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"midddle-man",data:function(){return{}},computed:{houseInfoData:function(){return this.$store.state.houseInfo}},created:function(){},mounted:function(){},methods:{goChat:function(){"web"===this.houseInfoData.miniChat.style?window.location.href=this.houseInfoData.miniChat.params:"miniapp"===this.houseInfoData.miniChat.style?wx&&wx.miniProgram&&wx.miniProgram.redirectTo({url:this.houseInfoData.miniChat.params}):"app"===this.houseInfoData.miniChat.style&&("ios"===this.CommonUtil.detectDevice()?window.webkit.messageHandlers.nativeInterfaceRunner.postMessage(this.houseInfoData.miniChat.params):window.WebBridge.nativeInterfaceRunner(this.houseInfoData.miniChat.params))}}}},"4a9W":function(t,e){},"4iO0":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("+28K"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("5Q3M");var s=function(t){i("/Nm6")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-54a1a6cd",null);e.default=l.exports},"4wcH":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("3pLw"),r=(n=o)&&n.__esModule?n:{default:n};var a=i("xiRS");e.default={props:{},name:"midddle-man",data:function(){return{defaultImg:'this.src="'+i("xiRS")+'"',virtualNumber:""}},computed:{houseInfoData:function(){return this.$store.state.houseInfo},brokerImage:function(){var t=this.$store.state.houseInfo;return t&&t.brokerInfo&&t.brokerInfo.brokerImage?t.brokerInfo.brokerImage:a}},created:function(){},mounted:function(){this.houseInfoData&&this.houseInfoData.slideVerify&&this.houseInfoData.slideVerify.enable&&this.houseInfoData.slideVerify.uid&&this.getVirtualNumber(this.houseInfoData.slideVerify.uid)},methods:{getVirtualNumber:function(t){var e=this.CommonUtil.getQueryString("city"),i={command:"Global",action:"VirtualCheckType",city_id:e,uid:t},n="https://api.917.com/index.php",o=this;r.default.post({url:n,data:i}).then(function(i){var a;if((a=i.feedback)&&a.msg9006&&1==a.msg9006.type){var s={command:"Global",action:"VirtualCheckType",city_id:e,uid:t,act:"check",ts:a.msg9006.msg.ts,sec:a.msg9006.msg.secret};r.default.post({url:n,data:s}).then(function(t){var e;if((e=t.feedback)&&e.msg9006&&200==e.msg9006.status){var i=e.msg9006.msg._virtual_number;e.msg9006.msg.unbind_time;o.virtualNumber=i.replace(/\s*/g,"")}})}})}}}},"5/zl":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i("v2ns");var n=i("7QTg");e.default={props:{},name:"mobile-lecture-panel",components:{swiper:n.swiper,swiperSlide:n.swiperSlide},data:function(){return{swiperOption:{slidesPerView:4,spaceBetween:15,freeMode:!0,slideToClickedSlide:!0,scrollbar:{el:".swiper-scrollbar",draggable:!0,dragSize:50},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},loop:!1,loopAdditionalSlides:0}}},computed:{lectureIsActive:function(){return this.$store.state.lectureIsActive},lectureList:function(){return this.$store.state.lectureList},currentLectureIndex:function(){return this.$store.state.currentLectureIndex},currentLecturePercent:function(){return this.$store.state.currentLecturePercent}},watch:{currentLectureIndex:function(t,e){var i=this,n="lectureItem"+t;this.$nextTick(function(){i.$refs[n][0].scrollIntoView&&i.$refs[n][0].scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),i.$refs[n][0].scrollIntoViewIfNeeded&&i.$refs[n][0].scrollIntoViewIfNeeded(!0)})}},created:function(){},mounted:function(){},methods:{showLecturePanelList:function(){this.statistic_utils.trackEvent(23),this.$store.dispatch("changeLectureStatus",!0)},closeLecturePanelList:function(){this.statistic_utils.trackEvent(24),this.$store.dispatch("changeLectureStatus",!1)},selectLectureItem:function(t){t=parseInt(t),this.$store.dispatch("changeCurrentLectureIndex",t)}}}},"53lP":function(t,e,i){"use strict";t.exports={brokerInfo:{enable:!0,brokerImage:"photo",brokerPhone:"mobile",brokerName:"username",PcPhoneTip:""}}},"54WP":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"middleman-transpond-container"},[i("div",{directives:[{name:"show",rawName:"v-show",value:"input"===t.middlemanTranspondStep||"checkFail"===t.middlemanTranspondStep,expression:"middlemanTranspondStep==='input'|| middlemanTranspondStep==='checkFail'"}],staticClass:" middleman-transpond-content input-container"},[i("div",{staticClass:"middleman-transpond-title"},[t._v("\n            "+t._s(t.$t("middle_verify_input_title"))+"\n        ")]),t._v(" "),i("div",{staticClass:"middleman-transpond-body"},[i("div",{staticClass:"input-container"},[i("span",{staticClass:"input-label"},[t._v("\n                     "+t._s(t.$t("middle_verify_input_lable"))+"\n                 ")]),t._v(" "),i("div",{staticClass:"input-content"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.inputNumber,expression:"inputNumber"}],staticClass:"tel-input",attrs:{type:"text",placeholder:t.$t("middle_verify_input_placeholder"),autofocus:""},domProps:{value:t.inputNumber},on:{input:function(e){e.target.composing||(t.inputNumber=e.target.value)}}}),t._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:"checkFail"===t.middlemanTranspondStep,expression:"middlemanTranspondStep==='checkFail'"}],staticClass:"input-tip"},[t._v("\n                         "+t._s(t.$t("middle_verify_correct_tip"))+"\n                     ")])])])]),t._v(" "),i("div",{staticClass:"middleman-transpond-footer"},[i("div",{staticClass:"footer-cancel footer-item",on:{click:t.cancelInput}},[t._v("\n                "+t._s(t.$t("middle_verify_cancel_text"))+"\n            ")]),t._v(" "),i("div",{staticClass:"footer-confirm footer-item",on:{click:t.confirmInput}},[t._v("\n                "+t._s(t.$t("middle_verify_confirm_text"))+"\n            ")])])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"success"===t.middlemanTranspondStep,expression:"middlemanTranspondStep==='success'"}],staticClass:" middleman-transpond-content success"},[i("div",{staticClass:"middleman-transpond-title"},[t._v("\n            "+t._s(t.$t("middle_verify_generate_link_title"))+"\n         ")]),t._v(" "),i("div",{staticClass:"middleman-transpond-body"},[i("div",{staticClass:"share-url-container",on:{click:t.jumpUrl}},[t._v("\n                "+t._s(t.shareUrl)+"\n            ")])]),t._v(" "),i("div",{staticClass:"middleman-transpond-footer"},[i("div",{staticClass:"footer-cancel footer-item",on:{click:t.cancelCopy}},[t._v("\n                "+t._s(t.$t("middle_verify_cancel_text"))+"\n             ")]),t._v(" "),i("div",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.shareUrl,expression:"shareUrl",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"footer-copy footer-item",on:{click:t.goCopy}},[t._v("\n                "+t._s(t.$t("middle_verify_copy_text"))+"\n             ")])])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"fail"===t.middlemanTranspondStep,expression:"middlemanTranspondStep==='fail'"}],staticClass:" middleman-transpond-content"},[i("div",{staticClass:"middleman-transpond-title"},[t._v("\n            "+t._s(t.$t("middle_verify_tip_title"))+"\n         ")]),t._v(" "),i("div",{staticClass:"middleman-transpond-body"},[i("div",{staticClass:"fail-tip-container"},[t._v("\n                "+t._s(t.tipContent)+"\n            ")])]),t._v(" "),i("div",{staticClass:"middleman-transpond-footer"},[i("div",{staticClass:"footer-cancel footer-item",on:{click:t.cancelInput}},[t._v("\n                "+t._s(t.$t("middle_verify_cancel_text"))+"\n             ")]),t._v(" "),i("div",{staticClass:"footer-copy footer-item",on:{click:t.goBackModify}},[t._v("      \n                  "+t._s(t.$t("middle_verify_tip_modify_text"))+"\n             ")])])])])},staticRenderFns:[]};e.a=n},"59XI":function(t,e){},"5GbH":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"house-info-container"},[i("div",{staticClass:"house-info-title"},[t._v("\n        "+t._s(t.$t("houseInfoTitle"))+"\n    ")]),t._v(" "),i("div",{staticClass:"house-info-main-container"},[i("div",{staticClass:"house-info-main scroll_content"},t._l(t.houseInfoData.houseInfo.list,function(e,n){return i("div",{key:n,staticClass:"house-info-item",class:{style1:1==e.widthStyle,style2:1!=e.widthStyle},style:{display:e.is_show&&"1"==e.is_show||!e.name&&!e.value?"none":"flex"}},[i("div",{staticClass:"house-info-item-name only-line1"},[t._v(t._s(e.name))]),t._v(" "),i("div",{staticClass:"house-info-item-content only-line1"},[t._v(t._s(e.value))])])}),0)]),t._v(" "),i("div",{staticClass:"house-info-more-container"},[t.houseInfoData.houseInfo.houseDetail?i("div",{staticClass:"house-info-more-btn",on:{click:t.goHouseInfoDetails}},[i("span",{staticClass:"house-info-more-text"},[t._v(t._s(t.$t("houseInfoMoreBtnText")))]),t._v(" "),i("i",{staticClass:"house-info-more-icon"})]):t._e()])])},staticRenderFns:[]};e.a=n},"5GhF":function(t,e){},"5NOO":function(t,e){},"5Q3M":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"scene-panel-container",class:{active:t.sceneIsActive}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.sceneIsActive,expression:"sceneIsActive"}],staticClass:"scene-list-container"},[t.sceneList&&t.sceneList.length<=4?i("div",{ref:"sceneList",staticClass:"scene-list",on:{click:t.selectSceneItem}},t._l(t.sceneList,function(e,n){return i("div",{key:n,ref:"sceneItem"+e.index,refInFor:!0,staticClass:"scene-item",class:{active:t.currentSceneIndex===e.index},attrs:{"data-index":e.index}},[t._v("\n        "+t._s(e.name)+"\n        ")])}),0):t.sceneList&&t.sceneList.length>4?i("div",{ref:"sceneList",staticClass:"scene-list"},[i("swiper",{ref:"swiper",attrs:{options:t.swiperOption}},[i("div",{staticClass:"swiper-scrollbar",attrs:{slot:"scrollbar"},slot:"scrollbar"}),t._v(" "),t._l(t.sceneList,function(e,n){return i("swiper-slide",{key:n},[i("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"}),t._v(" "),i("div",{staticClass:"swiper-button-prev",attrs:{slot:"button-prev"},slot:"button-prev"}),t._v(" "),i("div",{staticClass:"swiper-button-next",attrs:{slot:"button-next"},slot:"button-next"}),t._v(" "),i("div",{key:n,ref:"sceneItem"+e.index,refInFor:!0,staticClass:"scene-item",class:{active:t.currentSceneIndex===e.index},attrs:{"data-index":e.index},on:{click:function(i){return t.selectSceneItem1(e.index)}}},[i("div",{staticClass:"scene-text"},[t._v(t._s(e.name))])])])})],2)],1):t._e()]),t._v(" "),i("div",{staticClass:"scene-btn-content",class:{active:t.sceneIsActive},on:{click:function(e){return e.preventDefault(),t.showScenePanelList(e)}}},[i("i",{staticClass:"scene-btn-icon"}),t._v(" "),i("span",{staticClass:"scene-btn-text"},[t._v(t._s(t.$t("sceneText")))])])])},staticRenderFns:[]};e.a=n},"5T7T":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("mA03"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("r6fd");var s=function(t){i("1YG9")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-789ad90e",null);e.default=l.exports},"5e1Z":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"help-tip-container"},[i("div",{staticClass:"help-tip-content"},[i("i",{staticClass:"help-tip-close",on:{click:t.closeHelpTip}}),t._v(" "),i("div",{staticClass:"help-tip-title"},[t._v("\n           "+t._s(t.$t("helpTipTitle"))+"\n       ")]),t._v(" "),i("div",{staticClass:"help-tip-main"},[i("div",{staticClass:"help-tip-item"},[i("i",{staticClass:"help-tip-item-icon walk"}),t._v(" "),i("span",{staticClass:"help-tip-item-text"},[t._v("\n                    "+t._s(t.$t("helpTipWalk"))+"\n                ")])]),t._v(" "),i("div",{staticClass:"help-tip-item"},[i("i",{staticClass:"help-tip-item-icon slide"}),t._v(" "),i("span",{staticClass:"help-tip-item-text"},[t._v("\n                    "+t._s(t.$t("helpTipSlide"))+"\n                ")])])])])])},staticRenderFns:[]};e.a=n},"5fTZ":function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"audio-tag-container"},["TextAudio"===this.currentTagType?e("audio",{ref:"audioTag",staticClass:"audio-tag",attrs:{src:this.currentTagData.audiourl,autoplay:"autoplay"},on:{onended:this.endPlay}}):this._e()])},staticRenderFns:[]};e.a=n},"5ruX":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"small-map-container"},[i("baidu-map",{staticClass:"map",style:{width:t.map.width,height:t.map.height},attrs:{ak:"UYtXGSLnxZGtjQ0rj58LWvTFivB4aHIF",zoom:t.mapData.zoom,center:{lng:t.houseInfoData.houseInfo.map.lon,lat:t.houseInfoData.houseInfo.map.lat},"scroll-wheel-zoom":!0,"inertial-dragging":!1,dragging:!0},on:{dragend:t.cleanEvent,dragstart:t.goDrag}},[i("bm-marker",{attrs:{position:{lng:t.houseInfoData.houseInfo.map.lon,lat:t.houseInfoData.houseInfo.map.lat},animation:"BMAP_ANIMATION_BOUNCE"}})],1),t._v(" "),i("div",{staticClass:"small-baidu-map-footer",on:{click:t.showBigMap}},[i("span",{staticClass:"small-baidu-map-footer-text"},[t._v(t._s(t.$t("lookMapMore")))]),t._v(" "),i("i",{staticClass:"small-baidu-map-footer-icon"})])],1)},staticRenderFns:[]};e.a=n},"6aHO":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={components:{},props:{},name:"mobile-panorama-btn",data:function(){return{}},computed:{},created:function(){},mounted:function(){},methods:{changeMode:function(t){this.statistic_utils.trackEvent(3),this.$store.dispatch("goMode","panorama")}}}},"6cOn":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"img-swiper-container"},[i("div",{staticClass:"img-swiper-content"},[i("i",{staticClass:"img-swiper-close",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeImgSwiper(e)}}}),t._v(" "),i("swiper",{attrs:{options:t.swiperOption}},[t._l(t.houseInfoData.communityImages.images,function(t,e){return i("swiper-slide",{key:e,style:{backgroundImage:"url("+t+")"}})}),t._v(" "),i("div",{staticClass:"swiper-button-next swiper-button-white",attrs:{slot:"button-next"},slot:"button-next"}),t._v(" "),i("div",{staticClass:"swiper-button-prev swiper-button-white",attrs:{slot:"button-prev"},slot:"button-prev"})],2)],1)])},staticRenderFns:[]};e.a=n},"6dQP":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"pc-bottom-container"},[t.houseInfoData.brokerInfo&&t.houseInfoData.brokerInfo.enable&&t.MiddleManState?i("middle-man"):t._e(),t._v(" "),t.MultipleMeasureState||t.MultipleTagState||t.MultipleHelpState?i("multiple-fun"):t._e(),t._v(" "),!t.isTooLang&&t.ShareFullState?i("share-full"):t._e(),t._v(" "),t.FullScreenState?i("full-screen"):t._e()],1)},staticRenderFns:[]};e.a=n},"72YK":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("l4+t"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("Xkrt");var s=function(t){i("EYfY")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-0190dd26",null);e.default=l.exports},"7PBQ":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("DQZL"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("0zIx");var s=function(t){i("LvHn")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-1c1aee48",null);e.default=l.exports},"7YRv":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"big-map-container",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeBigMapContent(e)},touchmove:function(t){t.preventDefault()},scroll:function(t){t.preventDefault()},mousewheel:function(t){t.preventDefault()}}},[i("div",{staticClass:"big-map-content"},[i("div",{staticClass:"big-mobile-landscape-google-map",attrs:{id:"big-mobile-landscape-google-map"}}),t._v(" "),i("div",{staticClass:"big-map-close",on:{click:t.closeBigMapContent}})])])},staticRenderFns:[]};e.a=n},"7by9":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"disclaimer-btn",data:function(){return{}},created:function(){},mounted:function(){},methods:{toggleDisclaimerContent:function(){this.statistic_utils.trackEvent(48),this.$store.dispatch("toggleDisclaimerContent",!this.$store.state.disclaimerContentIsShow),!this.$store.state.takeLookInfoStateIsUpdate||"1"!==this.$store.state.takeLookRole&&"2"!==this.$store.state.takeLookRole&&"3"!==this.$store.state.takeLookRole||this.$store.dispatch("changeTakeLookOperation",{type:"UI",target:"disclaimer",action:!this.$store.state.disclaimerContentIsShow})}}}},"7gkt":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("LRwE"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("siXs");var s=function(t){i("PsWa")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-392a7053",null);e.default=l.exports},"7kBY":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("U39E"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("wwmi");var s=function(t){i("QcG6")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-26ee1336",null);e.default=l.exports},"7qWM":function(t,e){},"8+mH":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"disclaimer-btn",data:function(){return{}},created:function(){},mounted:function(){},methods:{toggleDisclaimerContent:function(){this.statistic_utils.trackEvent(48),this.$store.dispatch("toggleDisclaimerContent",!this.$store.state.disclaimerContentIsShow)}}}},"81jq":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"iframe-tag-container",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeTagContainer(e)},touchmove:function(t){t.preventDefault()},scroll:function(t){t.preventDefault()},mousewheel:function(t){t.preventDefault()}}},[i("div",{staticClass:"iframe-tag-content"},[i("div",{staticClass:"iframe-close-btn",on:{click:t.closeTagContainer}}),t._v(" "),i("iframe",{staticClass:"iframe-ele",attrs:{src:t.currentTagData.url,frameborder:"0"}})])])},staticRenderFns:[]};e.a=n},"8Awl":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("J45D"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("UPpq");var s=function(t){i("ITjM")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-4935a8da",null);e.default=l.exports},"8ErW":function(t,e){},"8R19":function(t,e){t.exports={frontEndUrl:["beyond.3dnest","vr.917.com","3dnest.n.weimob.com","space.3dnest","cloud.3dnest","house.3dnest","cloudone.3dnest","3d.2500fang.com","cloudone.3dnest.cn","vr.zuobiaowang.com","cloud2.3dnest","cloud3.3dnest","cloud5.3dnest","cloud6.3dnest","cloud7.3dnest","cloud8.3dnest","cloud9.3dnest","cloud10.3dnest","yun.3dnest","vr.sh.centanet.com","vr.jy510.com","3dv.sdnews.com.cn","oldbeyond.3dnest.cn","t.3dnest.cn","pre.3dnest.cn","3dnest.n.weimob.com","testweb.3dnest.cn","vr.517.cn","vr.51fang.com","127.0.0.1","vr.anyouyou365.com","house3651.3dnest.cn","house3652.3dnest.cn","house3653.3dnest.cn","house3654.3dnest.cn","house3655.3dnest.cn","house3656.3dnest.cn","house3657.3dnest.cn","house3658.3dnest.cn","house3659.3dnest.cn","house36510.3dnest.cn","house36511.3dnest.cn","house36512.3dnest.cn","house36513.3dnest.cn","house36514.3dnest.cn","house36515.3dnest.cn","house36516.3dnest.cn","house36517.3dnest.cn","house36518.3dnest.cn","house36519.3dnest.cn","house36520.3dnest.cn","house36521.3dnest.cn","house36522.3dnest.cn","house36523.3dnest.cn","house36524.3dnest.cn","house36525.3dnest.cn"],backEndUrl:["user.3dnest.cn","allfun.3dnest.cn","user.3dnest.biz","allfun.3dnest.biz","test.3dnest.cn"],demoUrl:["192.168.0.232"],gjf:["192.168.0.239"]}},"8XKv":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=i("2Uyi");i("53lP"),i("w1BD");e.default={load:function(e,i,o){e=e||{};var r=n.getQueryString("name"),a=n.getQueryString("tel"),s=n.getQueryString("signature"),l={format:"json",name:r,sign:s,tel:a};r&&a&&s?t.post("https://user.3dnest.cn/nest_house/sign_check/",l).done(function(t){e.brokerInfo=e.brokerInfo?e.brokerInfo:{enable:!1},1===t.code&&(e.brokerInfo.enable=!0,e.brokerInfo.brokerImage=i.basic.model.headicon,e.brokerInfo.brokerPhone=a,e.brokerInfo.brokerName=r,e.brokerInfo.PcPhoneTip=""),o(e)}).fail(function(){o(e)}):o(e)}}}).call(e,i("awxD"))},"8cTK":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={components:{},props:{},name:"mobile-floor-bar",data:function(){return{currentFloorIndex:""}},computed:{floorList:function(){return this.$store.state.floorList},currentMode:function(){return this.$store.state.currentMode}},watch:{currentMode:function(t,e){switch(t){case"floorplan":this.currentFloorIndex=this.$store.state.currentFloorIndex;break;case"dollhouse":this.currentFloorIndex="all"}}},created:function(){},mounted:function(){},methods:{selectFloor:function(t){if(this.statistic_utils.trackEvent(75),t.target.dataset.index==this.currentFloorIndex)return!1;this.currentFloorIndex=t.target.dataset.index,this.$store.dispatch("changeCurrentFloorIndex",t.target.dataset.index),!this.$store.state.takeLookInfoStateIsUpdate||"1"!==this.$store.state.takeLookRole&&"2"!==this.$store.state.takeLookRole&&"3"!==this.$store.state.takeLookRole||this.$store.dispatch("changeTakeLookOperation",{type:"UI",target:"floorBar",action:t.target.dataset.index})}}}},"8eyn":function(t,e,i){"use strict";t.exports={title:"title",share:{enable:!0,share_link:"ShareLink",share_context:"ShareContext",share_img:"ShareImageUrl",share_title:"ShareTitle"},houseInfo:{enable:!0,version:0,list:{sale:[{value:"CommunityIndexName",name:"片区",widthStyle:"1"},{value:"DistrictName",name:"行政区",widthStyle:"1"},{value:"RealtyTypeName",name:"类型",widthStyle:"1"},{value:"(RoomNum)室(LivingRoomNum)厅",name:"户型",widthStyle:"1"},{value:"ConstructionArea",name:"面积",widthStyle:"1"},{value:"FaceOrientationName",name:"朝向",widthStyle:"1"},{value:"DecorationLevelName",name:"装修",widthStyle:"1"},{value:"(FloorTagName)/共(FloorsTotal)层",name:"楼层",widthStyle:"1"},{value:"BuildingYear",name:"年代",widthStyle:"1"},{value:"(SalePrice)万元",name:"售价",widthStyle:"1"},{value:"(DistrictName)(CommunityIndexName)(CommunityName)",name:"楼盘地址",widthStyle:"2"}],rent:[{value:"CommunityIndexName",name:"片区",widthStyle:"1"},{value:"DistrictName",name:"行政区",widthStyle:"1"},{value:"RealtyTypeName",name:"类型",widthStyle:"1"},{value:"(RoomNum)室(LivingRoomNum)厅",name:"户型",widthStyle:"1"},{value:"ConstructionArea",name:"面积",widthStyle:"1"},{value:"FaceOrientationName",name:"朝向",widthStyle:"1"},{value:"DecorationLevelName",name:"装修",widthStyle:"1"},{value:"(FloorTagName)/共(FloorsTotal)层",name:"楼层",widthStyle:"1"},{value:"BuildingYear",name:"年代",widthStyle:"1"},{value:"(RentPrice)元",name:"租金",widthStyle:"1"},{value:"(DistrictName)(CommunityIndexName)(CommunityName)",name:"楼盘地址",widthStyle:"2"}]},map:{lon:"Longitude",lat:"Latitude"}},brokerInfo:{enable:!0,brokerImage:"HeadImgUrl",brokerPhone:"CallTel"},homeLink:{enable:!0,link:"indexUrl"},panoramaLink:{enable:!1,link:"panoLink"},commonJsonData:{area_text:"CommunityIndexName",district_text:"DistrictName",purpose_text:"RealtyTypeName",house_type:"(RoomNum)室(LivingRoomNum)厅",acreage_value:"ConstructionArea",orientation_text:"FaceOrientationName",decoration_type:"DecorationLevelName",floor_text:"(FloorTagName)/共(FloorsTotal)层",complation_date:"BuildingYear",total_price:"(SalePrice)万元",address_details:"(DistrictName)(CommunityIndexName)(CommunityName)",house_status:"",longitude_value:"Longitude",latitude_value:"Latitude",more_details_address:"",community_name:"",unit_price:"",sell_type:"",city_text:"",developer_name:"",elevator_issupport:"",listing_time:"",rent_price:"",hangpaiurl:""}}},"8gmc":function(t,e,i){"use strict";t.exports={title:"VR看房|(EstateName)(RoomAndHall)",share:{enable:!0,share_link:"href",share_context:"shareDesc",share_img:"DefaultImage",share_title:"shareTitle"},offline:{text:"该房源已下架，您可以联系下方经纪人为您推荐其他优质房源！",houseDetail:""},uniId:"",houseInfo:{enable:!0,version:0,list:{xinfang:[{value:"UnitPrice",name:"均价",widthStyle:"1"},{value:"PropertyType",name:"物业类型",widthStyle:"1"},{value:"NewPropStatus",name:"销售状态",widthStyle:"1"},{value:"FloorDisplay",name:"建筑类型",widthStyle:"1"},{value:"Park",name:"停车位",widthStyle:"1"},{value:"MgtPrice",name:"物业费",widthStyle:"1"},{value:"OpDate",name:"开盘时间",widthStyle:"1"},{value:"LiveDate",name:"交房时间",widthStyle:"1"}],sell:[{value:"SalePrice",name:"总价",widthStyle:"1"},{value:"RoomAndHall",name:"户型",widthStyle:"1"},{value:"Area",name:"面积",widthStyle:"1"},{value:"AvgPrice",name:"均价",widthStyle:"1"},{value:"FloorDisplay",name:"楼层",widthStyle:"1"},{value:"Direction",name:"朝向",widthStyle:"1"},{value:"PropertyType",name:"类型",widthStyle:"1"},{value:"OpDate",name:"年代",widthStyle:"1"},{value:"(Region)   (Gscope)",name:"区域",widthStyle:"1"}],rent:[{value:"RentPrice",name:"租金",widthStyle:"1"},{value:"RoomAndHall",name:"户型",widthStyle:"1"},{value:"Area",name:"面积",widthStyle:"1"},{value:"FloorDisplay",name:"楼层",widthStyle:"1"},{value:"Direction",name:"朝向",widthStyle:"1"},{value:"Fitmen",name:"装修",widthStyle:"1"},{value:"PropertyType",name:"类型",widthStyle:"1"},{value:"OpDate",name:"年代",widthStyle:"1"},{value:"(Region)   (Gscope)",name:"区域",widthStyle:"1"}]},map:{lon:"Lng",lat:"Lat"},houseDetail:"PostUrl"},brokerInfo:{enable:!0,brokerImage:"AgencyAvatar",brokerPhone:"Staff400",brokerName:"StaffName",PcPhoneTip:{sale:"请拨打(StaffName)电话咨询",rent:"(StaffName):请拨打以下电话咨询"},hasVirtualNumber:!1,brokerStyle:1},homeLink:{enable:!1,link:"indexUrl"},panoramaLink:{enable:!1,link:"xqAerialUrl"},slideVerify:{enable:!1,uid:""},commonJsonData:{area_text:"",district_text:"quyu",purpose_text:"houseType",house_type:"huxing",acreage_value:"jzmj",orientation_text:"chaoxiang",decoration_type:"zhuangxiu",floor_text:"louceng",complation_date:"niandai",total_price:"zongjia",address_details:"dizhi",house_status:"",longitude_value:"longitude",latitude_value:"latitude",more_details_address:"",community_name:"",unit_price:"junjia",sell_type:"",city_text:"",developer_name:"kaifashang",elevator_issupport:"",listing_time:"",rent_price:"",hangpaiurl:""}}},"9+Zl":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("UciY"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("aDho");var s=function(t){i("iA8k")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-eb82123e",null);e.default=l.exports},"9QJq":function(t,e){},"9X3O":function(t,e,i){t.exports=i.p+"static/img/loading-icon.2c546c7.png"},"9icC":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("ZbBr"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("NSWm");var s=function(t){i("K7Pl")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-32781002",null);e.default=l.exports},"9lYI":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"floor-bar-container",on:{click:function(e){return e.stopPropagation(),t.selectFloor(e)}}},[i("span",{directives:[{name:"show",rawName:"v-show",value:"dollhouse"===t.currentMode,expression:"currentMode === 'dollhouse'"}],staticClass:"floor-bar-item",class:{active:"all"===t.currentFloorIndex},attrs:{"data-index":"all"}},[t._v(t._s(t.$t("floorAll")))]),t._v(" "),t._l(t.floorList,function(e,n){return i("span",{key:n,staticClass:"floor-bar-item",class:{active:e.floorIndex==t.currentFloorIndex},attrs:{"data-index":e.floorIndex}},[t._v("\n         "+t._s(e.floorName)+"\n     ")])})],2)},staticRenderFns:[]};e.a=n},ACJL:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("J6K5"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("tDiQ");var s=function(t){i("j5L1")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-45fbb070",null);e.default=l.exports},AMeh:function(t,e){},AS8M:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("j1M8"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("W/qc");var s=function(t){i("i6sq")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-2382b0df",null);e.default=l.exports},ASf4:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mode-btn-container"},[i("div",{staticClass:"mode-btn-item floorplan",class:{active:"floorplan"===t.currentMode},on:{click:function(e){return t.changeMode("floorplan")}}},[i("i",{staticClass:"mode-btn-icon"}),t._v(" "),i("span",{staticClass:"mode-btn-text"},[t._v("\n            "+t._s(t.$t("floorplanText"))+"\n        ")])]),t._v(" "),i("div",{staticClass:"mode-btn-item dollhouse",class:{active:"dollhouse"===t.currentMode},on:{click:function(e){return t.changeMode("dollhouse")}}},[i("i",{staticClass:"mode-btn-icon"}),t._v(" "),i("span",{staticClass:"mode-btn-text"},[t._v("\n            "+t._s(t.$t("dollhouseText"))+"\n        ")])])])},staticRenderFns:[]};e.a=n},AWye:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},components:{},name:"small-mobile-landscape-google-map",data:function(){return{}},computed:{houseInfoData:function(){return this.$store.state.houseInfo},getGoogleMapLoadStatus:function(){return this.$store.state.googleMapLoadStatus}},created:function(){},mounted:function(){google&&this.mapInit()},watch:{getGoogleMapLoadStatus:function(t,e){t&&this.mapInit()}},methods:{mapInit:function(){var t={zoom:15,center:{lat:Number(this.houseInfoData.houseInfo.map.lat),lng:Number(this.houseInfoData.houseInfo.map.lon)},mapTypeId:"roadmap"},e=new google.maps.Map(document.getElementById("small-mobile-landscape-google-map"),t);new google.maps.Marker({position:t.center,map:e,animation:google.maps.Animation.BOUNCE})},showBigMap:function(t){this.statistic_utils.trackEvent(8),this.$store.dispatch("toggleHouseInfoPanel",!1),this.$store.dispatch("toggleBigMapStatus",!0)}}}},Acam:function(t,e){},AuHd:function(t,e,i){"use strict";t.exports={title:"title",share:{enable:!0,share_link:"share_link",share_context:"share_desc",share_img:"share_img",share_title:"share_title"},offline:{text:"该房源已下架，您可以联系下方经纪人为您推荐其他优质房源！",houseDetail:""},houseInfo:{enable:!0,version:0,list:"menu_info",map:{lon:"address_x",lat:"address_y"},houseDetail:"jump_url"},brokerInfo:{enable:!0,brokerImage:"middleman_img",brokerPhone:"middleman_tel",brokerName:"middleman",PcPhoneTip:""},homeLink:{enable:!1,link:""},panoramaLink:{enable:!1,link:""},commonJsonData:{area_text:"地理位置",district_text:"",purpose_text:"PropertyUsageName",house_type:"户型",acreage_value:"建面",orientation_text:"朝向",decoration_type:"装修",floor_text:"楼层",complation_date:"年代",total_price:"总价",address_details:"百度地址",house_status:"",longitude_value:"address_x",latitude_value:"address_y",more_details_address:"jump_url",community_name:"",unit_price:"单价",sell_type:"2",city_text:"",developer_name:"",elevator_issupport:"电梯",listing_time:"",rent_price:"",hangpaiurl:""}}},Aw0X:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"disclaimer-btn-container",on:{click:this.toggleDisclaimerContent}},[e("span",{staticClass:"disclaimer-btn-text"},[this._v(this._s(this.$t("disclaimerBtnText")))]),this._v(" "),e("i",{staticClass:"disclaimer-btn-icon"})])},staticRenderFns:[]};e.a=n},AwAS:function(t,e){},AxMW:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("ruqs"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("TPSR");var s=function(t){i("1Lh/")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-6a4cff87",null);e.default=l.exports},B2kn:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("3pLw"),r=(n=o)&&n.__esModule?n:{default:n};var a=i("2Uyi"),s=i("hFDk"),l=(i("hFDk"),i("w1BD"));i("ynQN").getStyle();e.default={load:function(t,e){var i={},n=a.getQueryString("hid"),o=a.getQueryString("source"),c=a.getQueryString("city"),u=a.getQueryString("house_type")||1;o&&c||(i=l.replenishData({},t),e(i));var h={hid:n,city:c,source:o,type:u};r.default.get({url:"http://vr.mfang360.com/vrapi/getHouseInfo",data:h}).then(function(i){var n=null;200===i.status&&i.data&&1==i.data.code?(n=l.replenishData(function(t,e){var i={};for(var n in e)switch(n){case"title":i.title=t.title;break;case"share":i.share=l.getTotalData(t,e.share);break;case"houseInfo":i.houseInfo=l.getTotalData(t,e.houseInfo);break;case"brokerInfo":i.brokerInfo=l.getTotalData(t,e.brokerInfo);break;case"homeLink":i.homeLink=l.getTotalData(t,e.homeLink);break;case"panoramaLink":i.panoramaLink=l.getTotalData(t,e.panoramaLink)}return i}(i.data.house_info,s),t),e(n)):(n=l.replenishData(null,t),e(n))})}}},BMMx:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("/g3c"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("YhjZ");var s=function(t){i("Pl6d")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-117b1ef0",null);e.default=l.exports},BWAX:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"house-info-container"},[i("div",{staticClass:"house-info-title"},[t._v("\n        "+t._s(t.$t("houseInfoTitle"))+"\n    ")]),t._v(" "),i("div",{staticClass:"house-info-main-container"},[i("div",{staticClass:"house-info-main scroll_content"},t._l(t.houseInfoData.houseInfo.list,function(e,n){return i("div",{key:n,staticClass:"house-info-item",class:{style1:1==e.widthStyle,style2:1!=e.widthStyle},style:{display:e.is_show&&"1"===e.is_show||!e.name&&!e.value?"none":"flex"}},[i("div",{staticClass:"house-info-item-name only-line1"},[t._v(t._s(e.name))]),t._v(" "),i("div",{staticClass:"house-info-item-content only-line1"},[t._v(t._s(e.value))])])}),0)]),t._v(" "),i("div",{staticClass:"house-info-more-container"},[t.houseInfoData.houseInfo.houseDetail?i("div",{staticClass:"house-info-more-btn",on:{click:t.goHouseInfoDetails}},[i("span",{staticClass:"house-info-more-text"},[t._v(t._s(t.$t("houseInfoMoreBtnText")))]),t._v(" "),i("i",{staticClass:"house-info-more-icon"})]):t._e()])])},staticRenderFns:[]};e.a=n},BaDW:function(t,e){},"BfP+":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("foAD"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("FO8G");var s=function(t){i("lAej")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-e359b7c8",null);e.default=l.exports},BfPX:function(t,e){},BrAk:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"call-tel-dialog",data:function(){return{}},created:function(){},mounted:function(){},computed:{telNumber:function(){return this.$store.state.houseInfo.slideVerify&&this.$store.state.houseInfo.slideVerify.enable&&this.$store.state.houseInfo.slideVerify.uid?this.$store.state.virtualNumber:this.$store.state.houseInfo&&this.$store.state.houseInfo.brokerInfo&&this.$store.state.houseInfo.brokerInfo.brokerPhone?this.$store.state.houseInfo.brokerInfo.brokerPhone:void 0},houseInfoData:function(){return this.$store.state.houseInfo},companyId:function(){return this.$store.state.companyId},virtualNumber:function(){return this.$store.state.virtualNumber}},methods:{cancelCall:function(){this.$store.dispatch("changeTelDialogStatus",!1)},goCall:function(){var t,e=this.companyId;this.houseInfoData&&this.houseInfoData.slideVerify&&this.houseInfoData.slideVerify.enable&&this.houseInfoData.slideVerify.uid?t=this.$store.state.virtualNumber:this.houseInfoData&&this.houseInfoData.brokerInfo&&this.houseInfoData.brokerInfo.brokerPhone&&(t=this.houseInfoData.brokerInfo.brokerPhone),swan&&swan.webView&&swan.webView.getEnv?swan.webView.getEnv(function(i){i.smartprogram?swan.makePhoneCall({phoneNumber:t}):(window.location.href="tel:"+t,e&&"14"===e.toString()&&window.webkit.messageHandlers.mobile.postMessage({Mobile:t}))}):(window.location.href="tel:"+t,e&&"14"===e.toString()&&window.webkit.messageHandlers.mobile.postMessage({Mobile:t})),this.$store.dispatch("changeTelDialogStatus",!1)}}}},C3Qg:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={components:{},props:{},name:"mobile-panorama-btn",data:function(){return{}},computed:{currentMode:function(){return this.$store.state.currentMode}},created:function(){},mounted:function(){},methods:{changeMode:function(t){this.statistic_utils.trackEvent(2),t!==this.currentMode&&"transitioning"!==this.currentMode&&this.$store.dispatch("goMode",t)}}}},C8U4:function(t,e){},CERm:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[this.hasBmView?this._e():e("div",{ref:"view",staticStyle:{width:"100%",height:"100%"}}),this._v(" "),this._t("default")],2)},staticRenderFns:[]};e.a=n},"CFZ+":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("h8mS"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("Z/uV");var s=function(t){i("JO2z")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-5462e61d",null);e.default=l.exports},CcYH:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("ORrC"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("+wHh");var s=function(t){i("nBmZ")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-64ac5c2c",null);e.default=l.exports},Cg2r:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("9X3O");e.default={components:{},props:{},name:"loading-component",data:function(){return{defaultLoadingUrl:n}},computed:{companyId:function(){return this.$store.state.companyId},companyLogoUrl:function(){return this.$store.state.companyLogoUrl},companyLoadingUrl:function(){return this.$store.state.companyLoadingUrl},loadingBgUrl:function(){return this.$store.state.loadingBgUrl},loadingProgress:function(){return this.$store.state.loadingProgress},companySettingsIsLoaded:function(){return this.$store.state.companySettingsIsLoaded}},created:function(){},mounted:function(){},methods:{}}},CiEp:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"lecture-panel-container",class:{active:t.lectureIsActive}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.lectureIsActive,expression:"lectureIsActive"}],staticClass:"lecture-list-container"},[t.lectureList.length<=4?i("div",{ref:"lectureList",staticClass:"lecture-list"},t._l(t.lectureList,function(e,n){return i("div",{key:n,ref:"lectureItem"+n,refInFor:!0,staticClass:"lecture-item",class:{active:t.currentLectureIndex===n},attrs:{"data-index":n},on:{"!click":function(e){return t.selectLectureItem(n)}}},[i("div",{staticClass:"lecture-item-text"},[t._v(t._s(e.name))]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.currentLectureIndex===n,expression:"currentLectureIndex === index"}],staticClass:"lecture-item-status-container"},[i("div",{staticClass:"lecture-item-status",style:{width:t.currentLecturePercent+"%"}})])])}),0):t.lectureList.length>4?i("div",{ref:"lectureList",staticClass:"lecture-list"},[i("swiper",{attrs:{options:t.swiperOption}},[i("div",{staticClass:"swiper-scrollbar",attrs:{slot:"scrollbar"},slot:"scrollbar"}),t._v(" "),t._l(t.lectureList,function(e,n){return i("swiper-slide",{key:n},[i("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"}),t._v(" "),i("div",{ref:"lectureItem"+n,refInFor:!0,staticClass:"lecture-item",class:{active:t.currentLectureIndex===n},attrs:{"data-index":n},on:{"!click":function(e){return t.selectLectureItem(n)}}},[i("div",{staticClass:"lecture-item-text2"},[t._v(t._s(e.name))]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.currentLectureIndex===n,expression:"currentLectureIndex === index"}],staticClass:"lecture-item-status-container"},[i("div",{staticClass:"lecture-item-status",style:{width:t.currentLecturePercent+"%"}})])])])})],2)],1):t._e()]),t._v(" "),i("div",{staticClass:"lecture-btn-content",class:{active:t.lectureIsActive},on:{click:function(e){return e.preventDefault(),t.toggleLectureList(e)}}},[i("i",{staticClass:"lecture-btn-icon"}),t._v(" "),i("span",{staticClass:"lecture-btn-text"},[t._v(t._s(t.$t("lectureText")))])])])},staticRenderFns:[]};e.a=n},CiM1:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("e6sy"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("TAmv");var s=function(t){i("zs9v")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-38eb8721",null);e.default=l.exports},ClAq:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"big-map-container",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeBigMapContent(e)},touchmove:function(t){t.preventDefault()},scroll:function(t){t.preventDefault()},mousewheel:function(t){t.preventDefault()}}},[i("div",{staticClass:"big-map-content"},[i("div",{staticClass:"big-map-close",on:{click:t.closeBigMapContent}}),t._v(" "),i("baidu-map",{staticClass:"map",style:{width:t.map.width,height:t.map.height},attrs:{ak:"UYtXGSLnxZGtjQ0rj58LWvTFivB4aHIF",zoom:15,center:{lng:t.houseInfoData.houseInfo.map.lon,lat:t.houseInfoData.houseInfo.map.lat},"scroll-wheel-zoom":!0},on:{dragend:t.cleanEvent,dragstart:t.goDrag}},[i("bm-marker",{attrs:{position:{lng:t.houseInfoData.houseInfo.map.lon,lat:t.houseInfoData.houseInfo.map.lat},animation:"BMAP_ANIMATION_BOUNCE"}})],1)],1)])},staticRenderFns:[]};e.a=n},CnPV:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(i("ktka")),o=r(i("ACJL"));function r(t){return t&&t.__esModule?t:{default:t}}e.default={props:{componentParmas:{type:Object}},components:{singleFeature:n.default,toolComponent:o.default},name:"multiple-fun",data:function(){return{}},computed:{MiddleManState:function(){return this.$store.state.MiddleManState}},created:function(){},mounted:function(){},methods:{callPhone:function(){this.$emit("callPhone")}}}},CnUl:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},components:{},name:"small-baidu-map",data:function(){return{}},computed:{houseInfoData:function(){return this.$store.state.houseInfo},getGoogleMapLoadStatus:function(){return this.$store.state.googleMapLoadStatus}},created:function(){},mounted:function(){google&&this.mapInit()},watch:{getGoogleMapLoadStatus:function(t,e){t&&this.mapInit()}},methods:{mapInit:function(){var t={zoom:15,center:{lat:Number(this.houseInfoData.houseInfo.map.lat),lng:Number(this.houseInfoData.houseInfo.map.lon)},mapTypeId:"roadmap"},e=new google.maps.Map(document.getElementById("small-mobile-google-map"),t);new google.maps.Marker({position:t.center,map:e,animation:google.maps.Animation.BOUNCE})},showBigMap:function(t){this.statistic_utils.trackEvent(8),this.$store.dispatch("toggleHouseInfoPanel",!1),this.$store.dispatch("toggleBigMapStatus",!0)}}}},"Co/y":function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"disclaimer-btn-container",on:{click:this.toggleDisclaimerContent}},[e("span",{staticClass:"disclaimer-btn-text"},[this._v(this._s(this.$t("disclaimerBtnText")))]),this._v(" "),e("i",{staticClass:"disclaimer-btn-icon"})])},staticRenderFns:[]};e.a=n},CqPc:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"house-component-mask",on:{click:function(e){return e.target!==e.currentTarget?null:t.closePanel(e)},blur:t.blurEvent}},[i("transition",{attrs:{name:"page-turnning"}},[t.isOpen?i("div",{staticClass:"house-component-container"},[i("swiper",{attrs:{options:t.swiperOption}},t._l(t.houseInfoArr,function(t,e){return i("swiper-slide",{key:e},[i(t.template,{tag:"component"})],1)}),1)],1):t._e()])],1)},staticRenderFns:[]};e.a=n},CvAU:function(t,e){},"Cy/D":function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title-component-container",class:{"is-open":this.isOpen},on:{click:this.toggleHouseInfo}},[e("span",{staticClass:"title-component-content  only-line1"},[this._v(this._s(this.houseInfo.title))]),this._v(" "),e("i",{staticClass:"title-component-icon"})])},staticRenderFns:[]};e.a=n},CzbH:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"video-tag-container",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeTagContainer(e)},touchmove:function(t){t.preventDefault()},scroll:function(t){t.preventDefault()},mousewheel:function(t){t.preventDefault()}}},[i("div",{staticClass:"video-tag-content"},[i("div",{staticClass:"video-close-btn",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeTagContainer(e)}}}),t._v(" "),t.currentTagData&&t.currentTagData.videourl&&"string"==typeof t.currentTagData.videourl?i("div",{staticClass:"video-content"},[i("video",{staticClass:"video-ele",attrs:{src:t.currentTagData.videourl,controls:""}})]):t._e(),t._v(" "),i("div",{staticClass:"video-desc-container"},[i("div",{staticClass:"video-desc-title"},[t._v("\n               "+t._s(t.currentTagData.title)+"\n             ")]),t._v(" "),i("div",{staticClass:"video-desc-content scroll_content",domProps:{innerHTML:t._s(t.currentTagData.description)}})])])])},staticRenderFns:[]};e.a=n},D2Pc:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("unS/"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("WoLW");var s=function(t){i("cslE")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-68777714",null);e.default=l.exports},D7O0:function(t,e,i){"use strict";t.exports={title:"title",share:{enable:!0,share_link:"share_link",share_context:"share_desc",share_img:"share_img",share_title:"share_title"},offline:{text:"该房源已下架，您可以联系下方经纪人为您推荐其他优质房源！",houseDetail:""},houseInfo:{enable:!0,version:0,list:"menu_info",map:{lon:"address_x",lat:"address_y"},houseDetail:"jump_url"},brokerInfo:{enable:!0,brokerImage:"middleman_img",brokerPhone:"middleman_tel",brokerName:"middleman",PcPhoneTip:""},homeLink:{enable:!1,link:""},panoramaLink:{enable:!1,link:""},commonJsonData:{area_text:"",district_text:"",purpose_text:"",house_type:"户型",acreage_value:"建筑面积",orientation_text:"朝向",decoration_type:"装修",floor_text:"楼层",complation_date:"建筑年代",total_price:"售价",address_details:"",house_status:"",longitude_value:"address_x",latitude_value:"address_y",more_details_address:"jump_url",community_name:"小区",unit_price:"",sell_type:"",city_text:"",developer_name:"",elevator_issupport:"",listing_time:"",rent_price:"",hangpaiurl:""}}},DJny:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("3yjQ"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("cFjv");var s=function(t){i("nWSc")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-18ef9146",null);e.default=l.exports},DQZL:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"house-info",data:function(){return{}},computed:{houseInfoData:function(){return this.$store.state.houseInfo}},created:function(){},mounted:function(){},methods:{toggleHouseInfoImgSwiper:function(){this.$store.dispatch("toggleHouseInfoImgSwiper",!0),this.$store.dispatch("toggleHouseInfoPanel",!1)},goHangPai:function(){this.statistic_utils.trackEvent(29),this.houseInfoData.panoramaLink.enable&&this.houseInfoData.panoramaLink.link&&(window.location.href=this.houseInfoData.panoramaLink.link)}}}},DXAO:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"audio-tag-container",data:function(){return{}},computed:{currentTagData:function(){return this.$store.state.currentTagData},currentTagType:function(){return this.$store.state.currentTagType},tagIsShow:function(){return this.$store.state.tagIsShow},getAudioTagIsPlay:function(){return this.$store.state.audioStatus}},watch:{getAudioTagIsPlay:function(t,e){!0===t?this.$nextTick(function(){this.$refs.audioTag.play()}):!1===t&&this.$nextTick(function(){this.$refs.audioTag.pause()})}},created:function(){},mounted:function(){},methods:{endPlay:function(){this.$store.dispatch("changeAudioStatus",!1)}}}},E82V:function(t,e){},EO5w:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"floor-plan-container not-event"},[i("img",{directives:[{name:"show",rawName:"v-show",value:t.currentFloorPlanData,expression:"currentFloorPlanData"}],staticClass:"floor-plan-img not-event",style:{top:t.currentFloorPlanData.top+"px",left:t.currentFloorPlanData.left+"px",width:t.currentFloorPlanData.width+"px",height:t.currentFloorPlanData.height+"px"},attrs:{src:t.currentFloorPlanData.imageUrl,alt:""}}),t._v(" "),t._l(t.currentRoomList,function(e,n){return i("span",{key:n,staticClass:"floor-plan-room",style:{top:e.top+"px",left:e.left+"px",transform:"translate(-50%,-50%)"}},[t._v("\n        "+t._s(e.roomname)+"\n    ")])}),t._v(" "),t.whData&&t.whData.wData&&t.modelSettings.basic&&t.modelSettings.basic.menu&&t.modelSettings.basic.menu.floorplan_enable?i("div",{staticClass:"floor-plan-width",style:{top:t.whData.wData.wDataTop+"px",left:t.whData.wData.wDataLeft+"px",width:t.whData.wData.width+"px"}},[i("span",{staticClass:"floor-plan-width-text"},[t._v("\n            "+t._s(t.whData.wData.wDataText)+"\n        ")])]):t._e(),t._v(" "),t.whData&&t.whData.hData&&t.modelSettings.basic&&t.modelSettings.basic.menu&&t.modelSettings.basic.menu.floorplan_enable?i("div",{staticClass:"floor-plan-height",style:{top:t.whData.hData.hDataTop+"px",left:t.whData.hData.hDataLeft+"px",height:t.whData.hData.height+"px"}},[i("span",{staticClass:"floor-plan-height-text"},[t._v("\n            "+t._s(t.whData.hData.hDataText)+"\n        ")])]):t._e(),t._v(" "),t.entranceData&&t.entranceData.isShow?i("div",{staticClass:"entry-point",style:{top:t.entranceData.top+"px",left:t.entranceData.left+"px",transform:"rotate("+t.entranceData.angle+"deg)"}},[i("p",{staticClass:"entry-img",class:{left:"left"===t.entranceData.state}})]):t._e(),t._v(" "),t.radarData&&t.radarData.isShow?i("img",{staticClass:"locating-point",style:{top:t.radarData.top+"px",left:t.radarData.left+"px",transform:"translate(-50%,-50%) rotate("+t.radarData.angle+"deg)"},attrs:{src:t.locationgPointIcon,alt:""}}):t._e(),t._v(" "),t.whData&&t.whData.hData?i("div",{staticClass:"compass-north-container",style:{top:t.whData.hData.hDataTop-80+"px"}},[i("span",{staticClass:"compass-north-text"},[t._v("\n             "+t._s(this.currentCompass.up)+"\n         ")]),t._v(" "),i("i",{staticClass:"compass-north-icon"})]):t._e(),t._v(" "),t.whData&&t.whData.wData?i("div",{staticClass:"compass-south-container",style:{top:t.whData.wData.wDataTop+10+"px"}},[i("i",{staticClass:"compass-south-icon"}),t._v(" "),i("span",{staticClass:"compass-south-text"},[t._v("\n             "+t._s(this.currentCompass.down)+"\n         ")])]):t._e()],2)},staticRenderFns:[]};e.a=n},EX0w:function(t,e){},EYfY:function(t,e){},EaIs:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"loading-component-container",style:{backgroundImage:"url("+t.loadingBgUrl+")"}},[t._m(0),t._v(" "),i("img",{staticClass:"loading-logo",style:{visibility:t.companySettingsIsLoaded&&49!==t.companyId?"visible":"hidden"},attrs:{src:t.companyLogoUrl,alt:""}}),t._v(" "),t.companySettingsIsLoaded?i("img",{staticClass:"loading-img",class:{lizihang:49===t.companyId},attrs:{src:t.companyLoadingUrl||t.defaultLoadingUrl,alt:""}}):t._e(),t._v(" "),t.companySettingsIsLoaded?i("div",{staticClass:"loading-wifi-tip-container",class:{lizihang:49===t.companyId}},[i("i",{staticClass:"loading-wifi-tip-icon"}),t._v(" "),i("span",{staticClass:"loading-wifi-tip-text"},[t._v("\n            "+t._s(t.$t("wifiTipText"))+"\n        ")])]):t._e(),t._v(" "),t.companySettingsIsLoaded?i("div",{staticClass:"loading-progress-container"},[i("div",{staticClass:"loading-progress",style:{width:t.loadingProgress+"%"}}),t._v(" "),i("span",{staticClass:"loading-progress-number",style:{left:"50%"}},[t._v("\n            "+t._s(t.loadingProgress+"%")+"\n        ")])]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"loading-back-container"},[e("i",{staticClass:"loading-back-icon"})])}]};e.a=n},EybN:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAQCAYAAADJViUEAAAB90lEQVQ4T32SPWtUQRSGnzP7EUMIgviVtYmCjbWgySqmEESwjKVgY6egf0CsgpWNdSqximilQipNsbG0shMLcS9JdNfN7t67d3fufWXWZE1ikgMzw8y8z3nnDMfYimpdVzEWBBfNaJh4Uezx5MNZ621r9q4WDmYiXTNYBsq7BOJtrWK3DoWrkT4JLu0nEsytTtnH/e6GzrOR0v9cQYSR87B2xp4fBn8DpncI/oJhEvOrFXtzIFyt65GMZ3vgHBgAd2pT9upA+LZUqNd5Ksd9oAh4QeogFfQlVqzA49op+7ozybDm7Zj9oQc4FgwSIAZ6gtiMWDkdwetJx8vl09YNzG440qIZNyTawCaiBbQw2oKuifCxzaJ4t1Lh8y64Gmk1PFuigdGUaDr4HRJJdGTDUrq50QfWR/CVNZ1TxqLgJ2LdjF8KoNFAW84Q547UibzsaY7gy5FuOph3sAFs5GIttGmW0ypDnDn6JU86KNDH40tH2BzBs5HumqgEVzki5TRLBdreiC0lcSUG3pNNTJAlGXnlOPE/uK57ZrQyWC95GirTKRpxmtIfG6Pf9uTlDI15NO7R+/OWDuHrDR2NE+a2am2Q0TaRFMcZ0MW3p8mSL9jJC4TG4QRoySwbOc981zErMDleoNcpkriYQWuTLABBvLMflsLeLP8DIyv8P2aUcMkAAAAASUVORK5CYII="},F2xk:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("3pLw"),r=(n=o)&&n.__esModule?n:{default:n};var a=i("xiRS");e.default={props:{},name:"midddle-man",data:function(){return{defaultImg:'this.src="'+i("xiRS")+'"',defaultBg:a}},computed:{houseInfoData:function(){return this.$store.state.houseInfo},brokerImage:function(){var t=this.$store.state.houseInfo;return t&&t.brokerInfo&&t.brokerInfo.brokerImage?t.brokerInfo.brokerImage:a},MiddleManState:function(){return this.$store.state.MiddleManState}},created:function(){},mounted:function(){},methods:{openMiddlemanTranspond:function(){this.$store.dispatch("changeMiddlemanTranspondStatus",!0)},showTelDialog:function(){this.statistic_utils.trackEvent(22),this.houseInfoData&&this.houseInfoData.slideVerify&&this.houseInfoData.slideVerify.enable&&this.houseInfoData.slideVerify.uid?this.getVirtualNumber(this.houseInfoData.slideVerify.uid):!(this.houseInfoData&&this.houseInfoData.brokerInfo&&this.houseInfoData.brokerInfo.brokerPhone)||this.houseInfoData.slideVerify&&this.houseInfoData.slideVerify.enable?this.$store.dispatch("changeTelTipStatus",!0):this.$store.dispatch("changeTelDialogStatus",!0)},getVirtualNumber:function(t){var e=this.CommonUtil.getQueryString("city"),i={command:"Global",action:"VirtualCheckType",city_id:e,uid:t},n="https://api.917.com/index.php",o=this;r.default.post({url:n,data:i}).then(function(i){var a;if((a=i.feedback)&&a.msg9006&&1==a.msg9006.type){var s={command:"Global",action:"VirtualCheckType",city_id:e,uid:t,act:"check",ts:a.msg9006.msg.ts,sec:a.msg9006.msg.secret};r.default.post({url:n,data:s}).then(function(t){var e;if((e=t.feedback)&&e.msg9006&&200==e.msg9006.status){var i=e.msg9006.msg._virtual_number,n=e.msg9006.msg.unbind_time;o.$store.dispatch("changeVirtualNumber",{virtualNumber:i,unbindTime:1e3*n}),o.$store.dispatch("changeTelDialogStatus",!0)}else o.$store.dispatch("changeTelTipStatus",!0)})}else a&&a.msg9006&&2==a.msg9006.type&&a.msg9006[0]&&a.msg9006[1]?(o.$store.dispatch("changeSlideVerifyPicArray",[a.msg9006[0],a.msg9006[1]]),o.$store.dispatch("changeSlideVerifyStatus",!0)):a&&a.msg9006})}}}},F6KQ:function(t,e){},F7mN:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("n32a"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("rcGq");var s=function(t){i("dA04")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-740682da",null);e.default=l.exports},FBD6:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"house-img-container"},[t.houseInfoData&&t.houseInfoData.communityImages&&t.houseInfoData.communityImages.enable&&t.houseInfoData.communityImages.images&&t.houseInfoData.communityImages.images.length>0&&t.houseInfoData.panoramaLink&&t.houseInfoData.panoramaLink.enable&&t.houseInfoData.panoramaLink.link?i("div",{staticClass:"house-img-box style2"},[i("div",{staticClass:"house-img-item",style:{backgroundImage:"url("+t.houseInfoData.communityImages.images[0]+")"},on:{click:t.toggleHouseInfoImgSwiper}},[i("div",{staticClass:"house-img-status isCommunity"},[i("i",{staticClass:"community-icon"}),t._v(" "),i("span",{staticClass:"community-text"},[t._v(t._s(t.houseInfoData.communityImages.images.length))])])]),t._v(" "),i("div",{staticClass:"house-img-item  isAerial"},[i("div",{staticClass:"house-img-status isAerial",on:{click:t.goHangPai}},[i("span",{staticClass:"aerial-text"},[t._v(t._s(t.$t("goAerialUrl")))]),t._v(" "),i("i",{staticClass:"aerial-icon"})])])]):t.houseInfoData&&t.houseInfoData.communityImages&&t.houseInfoData.communityImages.enable&&t.houseInfoData.communityImages.images&&t.houseInfoData.communityImages.images.length>0||t.houseInfoData&&t.houseInfoData.panoramaLink&&t.houseInfoData.panoramaLink.enable&&t.houseInfoData.panoramaLink.link?i("div",{staticClass:"house-img-box style1"},[t.houseInfoData&&t.houseInfoData.communityImages&&t.houseInfoData.communityImages.enable&&t.houseInfoData.communityImages.images&&t.houseInfoData.communityImages.images.length>0?i("div",{staticClass:"house-img-item",style:{backgroundImage:"url("+t.houseInfoData.communityImages.images[0]+")"},on:{click:t.toggleHouseInfoImgSwiper}},[t._m(0)]):t.houseInfoData&&t.houseInfoData.panoramaLink&&t.houseInfoData.panoramaLink.enable&&t.houseInfoData.panoramaLink.link?i("div",{staticClass:"house-img-item isAerial"},[i("div",{staticClass:"house-img-status isAerial",on:{click:t.goHangPai}},[i("span",{staticClass:"aerial-text"},[t._v(t._s(t.$t("goAerialUrl")))]),t._v(" "),i("i",{staticClass:"aerial-icon"})])]):t._e()]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"house-img-status isCommunity"},[e("i",{staticClass:"community-icon"}),this._v(" "),e("span",{staticClass:"community-text"})])}]};e.a=n},FO8G:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mobile-bottom-component"},[t.houseInfoData.brokerInfo&&t.houseInfoData.brokerInfo.enable&&t.MiddleManState?i("middle-man"):t._e(),t._v(" "),t.MultipleMeasureState||t.MultipleTagState||t.MultipleHelpState||t.MultipleVrState?i("tool-component"):t._e(),t._v(" "),i("take-look"),t._v(" "),49==t.companyId&&t.houseInfoData.miniChat&&t.houseInfoData.miniChat.enable?i("mini-chat"):t._e()],1)},staticRenderFns:[]};e.a=n},Fhs5:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"middleman-share-verify-copy-success-tip"},[this._v("\n    "+this._s(this.$t("middle_verify_copy_success_tip"))+"\n")])},staticRenderFns:[]};e.a=n},Fjm0:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("3535"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("6cOn");var s=function(t){i("2jBA")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-3cff46e2",null);e.default=l.exports},Fm9k:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("bf3z"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("EaIs");var s=function(t){i("vxJs")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-0cd7528b",null);e.default=l.exports},FtqT:function(t,e){},G5w5:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"vr-tip-component",data:function(){return{}},created:function(){},mounted:function(){},methods:{closeVrTip:function(){this.statistic_utils.trackEvent(80),this.$store.dispatch("changeVrTipStatus",!1),this.$store.dispatch("changeVrStatus",!1)}}}},G97a:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=w(i("I7wt")),o=w(i("uNpj")),r=w(i("trOA")),a=w(i("oXFx")),s=w(i("8XKv")),l=w(i("dUJX")),c=w(i("31q2")),u=w(i("B2kn")),h=w(i("wJrY")),d=w(i("RQJ0")),p=w(i("17tp")),f=w(i("3De2")),m=w(i("OrYe")),g=w(i("RuwO")),v=w(i("LT4C")),y=w(i("kjdN")),b=w(i("K26X"));function w(t){return t&&t.__esModule?t:{default:t}}function x(){this.policyList={},this.registryPolicy("9",b.default,"house365"),this.registryPolicy("10",f.default,"中原地产"),this.registryPolicy("11",n.default,"21世纪"),this.registryPolicy("12",l.default,"e选房",s.default),this.registryPolicy("13",o.default,"乐有家"),this.registryPolicy("14",r.default,"吉家"),this.registryPolicy("15",a.default,"917"),this.registryPolicy("16",f.default,"云丁"),this.registryPolicy("32",c.default,"骊特"),this.registryPolicy("21",u.default,"觅房"),this.registryPolicy("34",h.default,"嘚房"),this.registryPolicy("31",d.default,"房伯虎"),this.registryPolicy("49",p.default,"丽兹行"),this.registryPolicy("59",m.default,"上海中原"),this.registryPolicy("74",g.default,"可观地产"),this.registryPolicy("75",v.default,"Q房网"),this.registryPolicy("84",y.default,"爱心房产")}x.prototype.getHouseInfo=function(t,e){var i=t.basic.user&&t.basic.user.group;i=i&&i.toString();var n=this.policyList[i];n?n.mCallBack?n.load(t,n.mCallBack.load,e):n.load(t,e):l.default.load(t,e)},x.prototype.registryPolicy=function(t,e,i,n){e&&(this.policyList[t]={load:e.load,note:i,mCallBack:n})},e.default=x},GDEm:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("0PvF"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("l96b");var s=function(t){i("m/7e")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-42e981aa",null);e.default=l.exports},Gl8h:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAApVBMVEUAAAAB//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//8B//+T553qAAAANnRSTlMACgYSDxoWuaYnHb5RKyHEa4EMeD4vs1lEMyOdj3A5sGFNwXSrmmZdSUGINceL+fGXfOSTztfIBIpYAAACpElEQVRYw+2T23qqMBCFQZRDROR88EBVFLUqiFre/9H2CkGwFb6NveiVPzOTycRZkgBcr4Tn64QvZlxV4NnIYAu8abI6h3oNii2Y/WKNRsj3ASswAbOgf4dlAnWBRSAKDFoXRLFITfRzkBMYKJdhIIIBDNCsgmBap0K/FKA1Qgh1JEDTNATYpEi0CUAAWGEDXOyb6IcCBPBTRVHgJSMYdcQidRwkGHDdc0UTTRwhhd6CMnIChxIEzA5heAjA4XAIDgFCSCvwEkch+P8SXhgoTmjX7O29D/b7vY1AR1RsVHYFSOxAEXnuTs8UtcDG6rJC/Q7mRc1jqDvbIX101gqDUbjD+nbr4YItFovtFhYv7mypxRQ99vxAE6oNsIMkjq9uY/0BOplHc0o5goiie7Yilv31MUzC5UKPrMwqieBZlhkgY16SWfrSqQ6gVhCVvadnxifjdKIBzABCxelkRF5I0P+sMPIX1ul6Pm82MDiN080U9sB5ZsS+9tTPdqH4sXGdyk+s1zCAUd58ztWRyTXSg4L+uZHXHwwXVoYK+RqpgcC10BOd5Xw2Xbuu1IIrG16IB9CuEHjRde1Kw2Zc+RTbA/S3KwwOqrVZS8PVeLUag1UFcmk9i21S9rfvQo3OH8PxcVxazfBjptvt91+f5I4pHI+3S5rkSZJebpig/zz3NfT/D1PZzaFwvKV5RXo7rtyptcQD7ACv7fSr+5Xkj3xJ00yd4AvspuDr4/wHN8Nz0N+NnmbkT1wDfMFdUdJngXSE/q7IeQNy936SN0I6C1jNAlZnAalZQOoscGkWuHQWSJoFkj8S6L6F1w/x7x6j1iyg/dWrDEjTx0S4F/CeBTzuJeY/+yPuRZbfdpF63MsQ+eH8CPcbiCVdkuQiWRr35s2bN2+68A964qtvD3YNuAAAAABJRU5ErkJggg=="},Gtpr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("BrAk"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("M5RC");var s=function(t){i("T0Bi")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-989437d4",null);e.default=l.exports},GxPr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("Pqhg"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("oBCU"),s=i("VU/8")(o.a,a.a,!1,null,null,null);e.default=s.exports},H5gG:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("355H"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("CiEp");var s=function(t){i("4a9W")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-93305334",null);e.default=l.exports},H8wj:function(t,e){},HDlG:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"mobile-copy-success",data:function(){return{}},computed:{copyStatus:function(){return this.$store.state.copyStatus}},created:function(){},mounted:function(){},methods:{closeHelpTip:function(){this.$store.dispatch("changeHelpTipStatus",!1)}}}},HLxu:function(t,e,o){(function(t,o,a,c,u){(function(e){"use strict";var h="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};function d(t,e){return t(e={exports:{}},e.exports),e.exports}var p=function(t){this.message=t},f=d(function(t){function e(t){p.call(this,t)}e.prototype=Object.create(p.prototype),t.exports=e});function m(t,e){var i=window.navigator.userAgent.match(t);return i=i?i[1].split(e):[],{major:parseInt(i[0])||0,minor:parseInt(i[1])||0,patch:parseInt(i[2])||0}}var g={isFullscreen:function(){return document.fullscreenElement||document.mozFullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement},supportsFullscreen:function(){return document.fullscreenEnabled||document.mozFullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled},isPointerLocked:function(){return document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement},requestFullscreen:function(t,e){t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):t.msRequestFullscreen&&t.msRequestFullscreen(),e&&o(document).on("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange",browser.requestPointerLock)},requestPointerLock:function(){var t;if(document.fullscreenElement)t=document.fullscreenElement();else if(document.mozFullscreenElement)t=document.mozFullscreenElement();else if(document.mozFullScreenElement)t=document.mozFullScreenElement();else{if(!document.webkitFullscreenElement)return;t=document.webkitFullscreenElement()}t.requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock||t.webkitRequestPointerLock,t.requestPointerLock(),o(document).off("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange",this)},exitPointerLock:function(){document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock()},exitFullscreen:function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},details:function(){var t=navigator.userAgent.match("(Firefox|Chrome|Safari)/([\\d]+)");return t?{name:t[1],version:parseInt(t[2]),platform:navigator.platform}:{}},is:function(t){return this.details()&&this.details().name===t},inIframe:function(){return window.parent!==window},aspectRatio:function(t){var e=t.clientWidth/t.clientHeight;return isFinite(e)?e:0},userAgent:function(){return window.navigator.userAgent},isMobile:function(){var t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|android|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))},isSmallScreen:function(){return screen.width/window.devicePixelRatio<240},detectIE:function(){return-1!==window.navigator.userAgent.indexOf("MSIE ")||!!navigator.userAgent.match(/Trident.*rv\:11\./)},detectSafari:function(){return-1!==window.navigator.userAgent.indexOf("Safari")&&!this.detectChrome()},detectFirefox:function(){return-1!==window.navigator.userAgent.indexOf("Firefox")},detectChrome:function(){return-1!==window.navigator.userAgent.indexOf("Chrome")&&!this.detectOpera()},detectOpera:function(){return-1!==window.navigator.userAgent.indexOf("OPR")},detectIOS:function(){var t=window.navigator.userAgent;return/iPad|iPhone|iPod/.test(t)},detectAndroid:function(){return-1!==window.navigator.userAgent.indexOf("Android")},detectAndroidMobile:function(){var t=window.navigator.userAgent;return this.detectAndroid()&&-1!==t.indexOf("Mobile")},detectSamsungNative:function(){var t=window.navigator.userAgent;return-1!==t.indexOf("SM-G900H")||-1!==t.indexOf("GT-I9500")||-1!==t.indexOf("SM-N900")},detectSamsungS6:function(){return-1!==window.navigator.userAgent.indexOf("SM-G92")},detectHUAWEI5X:function(){return-1!==window.navigator.userAgent.indexOf("KIW-TL00H")},iosVersion:function(){if(!this.detectIOS())throw new f("Did not detect an iDevice");return m(/((?:\d+\_?){1,3}) like Mac OS/,"_")},androidVersion:function(){if(!this.detectAndroid())throw new f("Did not detect an Android based device");return m(/Android ((?:\d+\.?){1,3})/,".")},valueFromCookie:function(t,e){var i=new RegExp(t+"=([0-9a-f]+)(; ?|$)").exec(document.cookie);if(!i)return e;var n=i[1];return"boolean"==typeof e?"true"===n||"1"===n:"number"==typeof e?parseFloat(n):n},valueFromHash:function(t,e){var i=new RegExp("[#&?]"+t+"=([^#&?]*)").exec(window.location.href);if(!i)return e;var n=i[1];return"boolean"==typeof e?"true"===n||"1"===n:"number"==typeof e?parseFloat(n):window.decodeURIComponent(n)},getAllValueFromSearch:function(){var t=window.location.search,e={};if(-1!==t.indexOf("?"))for(var i=t.substr(1).split("&"),n="",o=0;o<i.length;o++)e[(n=i[o].split("="))[0]]=unescape(n[1]);return e},getQueryString:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),i=window.location.search.substr(1).match(e);return null!=i?decodeURI(i[2]):null},is_weixin:function(){return!(-1==navigator.userAgent.toLowerCase().indexOf("micromessenger"))},getUuid:function(){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},changeURLArg:function(t,e,i){var n=e+"=([^&]*)",o=e+"="+i;if(t.match(n)){var r="("+e+"=)([^&]*)",a=new RegExp(r,"gi");return t.replace(a,o)}return t.match("[?]")?t+"&"+o:t+"?"+o}};a.getUrlParam=function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),i=window.location.search.substr(1).match(e);return null!=i?unescape(i[2]):null};var v=d(function(t,e){var i,n,o,r,a,s,l,c,u,h,d,p,f,m,g,v,y,b,w,x,_,S,T,M,I,P,C,A,E,L,D,k,R,O,F,N,U,B,z,V,G,j,H,W,q,$,Y,X,Q,Z,K,J,tt,et,it,nt,ot,rt,at,st,lt,ct,ut,ht,dt,pt,ft,mt,gt,vt,yt,bt,wt,xt,_t,St,Tt,Mt,It,Pt,Ct,At,Et,Lt,Dt,kt,Rt,Ot,Ft,Nt,Ut,Bt,zt,Vt,Gt,jt,Ht,Wt,qt,$t,Yt,Xt,Qt,Zt,Kt,Jt,te,ee,ie,ne,oe,re,ae,se,le,ce,ue,he,de,pe,fe,me,ge,ve,ye,be,we,xe,_e,Se,Te,Me,Ie,Pe,Ce,Ae,Ee,Le,De,ke,Re,Oe,Fe,Ne,Ue,Be,ze,Ve,Ge,je,He,We={REVISION:"75"};t.exports=We,void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:0<t?1:+t}),void 0===Function.prototype.name&&void 0!==Object.defineProperty&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}}),void 0===Object.assign&&Object.defineProperty(Object,"assign",{writable:!0,configurable:!0,value:function(t){if(null==t)throw new TypeError("Cannot convert first argument to object");for(var e=Object(t),i=1,n=arguments.length;i!==n;++i){var o=arguments[i];if(null!=o){o=Object(o);for(var r=Object.keys(o),a=0,s=r.length;a!==s;++a){var l=r[a],c=Object.getOwnPropertyDescriptor(o,l);void 0!==c&&c.enumerable&&(e[l]=o[l])}}}return e}}),We.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},We.CullFaceNone=0,We.CullFaceBack=1,We.CullFaceFront=2,We.CullFaceFrontBack=3,We.FrontFaceDirectionCW=0,We.FrontFaceDirectionCCW=1,We.BasicShadowMap=0,We.PCFShadowMap=1,We.PCFSoftShadowMap=2,We.FrontSide=0,We.BackSide=1,We.DoubleSide=2,We.FlatShading=1,We.SmoothShading=2,We.NoColors=0,We.FaceColors=1,We.VertexColors=2,We.NoBlending=0,We.NormalBlending=1,We.AdditiveBlending=2,We.SubtractiveBlending=3,We.MultiplyBlending=4,We.CustomBlending=5,We.AddEquation=100,We.SubtractEquation=101,We.ReverseSubtractEquation=102,We.MinEquation=103,We.MaxEquation=104,We.ZeroFactor=200,We.OneFactor=201,We.SrcColorFactor=202,We.OneMinusSrcColorFactor=203,We.SrcAlphaFactor=204,We.OneMinusSrcAlphaFactor=205,We.DstAlphaFactor=206,We.OneMinusDstAlphaFactor=207,We.DstColorFactor=208,We.OneMinusDstColorFactor=209,We.SrcAlphaSaturateFactor=210,We.NeverDepth=0,We.AlwaysDepth=1,We.LessDepth=2,We.LessEqualDepth=3,We.EqualDepth=4,We.GreaterEqualDepth=5,We.GreaterDepth=6,We.NotEqualDepth=7,We.MultiplyOperation=0,We.MixOperation=1,We.AddOperation=2,We.NoToneMapping=0,We.LinearToneMapping=1,We.ReinhardToneMapping=2,We.Uncharted2ToneMapping=3,We.CineonToneMapping=4,We.UVMapping=300,We.CubeReflectionMapping=301,We.CubeRefractionMapping=302,We.EquirectangularReflectionMapping=303,We.EquirectangularRefractionMapping=304,We.SphericalReflectionMapping=305,We.CubeUVReflectionMapping=306,We.CubeUVRefractionMapping=307,We.RepeatWrapping=1e3,We.ClampToEdgeWrapping=1001,We.MirroredRepeatWrapping=1002,We.NearestFilter=1003,We.NearestMipMapNearestFilter=1004,We.NearestMipMapLinearFilter=1005,We.LinearFilter=1006,We.LinearMipMapNearestFilter=1007,We.LinearMipMapLinearFilter=1008,We.UnsignedByteType=1009,We.ByteType=1010,We.ShortType=1011,We.UnsignedShortType=1012,We.IntType=1013,We.UnsignedIntType=1014,We.FloatType=1015,We.HalfFloatType=1025,We.UnsignedShort4444Type=1016,We.UnsignedShort5551Type=1017,We.UnsignedShort565Type=1018,We.AlphaFormat=1019,We.RGBFormat=1020,We.RGBAFormat=1021,We.LuminanceFormat=1022,We.LuminanceAlphaFormat=1023,We.RGBEFormat=We.RGBAFormat,We.RGB_S3TC_DXT1_Format=2001,We.RGBA_S3TC_DXT1_Format=2002,We.RGBA_S3TC_DXT3_Format=2003,We.RGBA_S3TC_DXT5_Format=2004,We.RGB_PVRTC_4BPPV1_Format=2100,We.RGB_PVRTC_2BPPV1_Format=2101,We.RGBA_PVRTC_4BPPV1_Format=2102,We.RGBA_PVRTC_2BPPV1_Format=2103,We.RGB_ETC1_Format=2151,We.LoopOnce=2200,We.LoopRepeat=2201,We.LoopPingPong=2202,We.InterpolateDiscrete=2300,We.InterpolateLinear=2301,We.InterpolateSmooth=2302,We.ZeroCurvatureEnding=2400,We.ZeroSlopeEnding=2401,We.WrapAroundEnding=2402,We.TrianglesDrawMode=0,We.TriangleStripDrawMode=1,We.TriangleFanDrawMode=2,We.LinearEncoding=3e3,We.sRGBEncoding=3001,We.GammaEncoding=3007,We.RGBEEncoding=3002,We.LogLuvEncoding=3003,We.RGBM7Encoding=3004,We.RGBM16Encoding=3005,We.RGBDEncoding=3006,We.Color=function(t){return 3===arguments.length?this.fromArray(arguments):this.set(t)},We.Color.prototype={constructor:We.Color,r:1,g:1,b:1,set:function(t){return t instanceof We.Color?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){this.r=t,this.g=t,this.b=t},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,i){return this.r=t,this.g=e,this.b=i,this},setHSL:function(){function t(t,e,i){return i<0&&(i+=1),1<i&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+6*(e-t)*(2/3-i):t}return function(e,i,n){if(e=We.Math.euclideanModulo(e,1),i=We.Math.clamp(i,0,1),n=We.Math.clamp(n,0,1),0===i)this.r=this.g=this.b=n;else{var o=n<=.5?n*(1+i):n+i-n*i,r=2*n-o;this.r=t(r,o,e+1/3),this.g=t(r,o,e),this.b=t(r,o,e-1/3)}return this}}(),setStyle:function(t){function e(t){void 0!==t&&parseFloat(t)}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var n,o=i[1],r=i[2];switch(o){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,e(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,e(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(r)){var a=parseFloat(n[1])/360,s=parseInt(n[2],10)/100,l=parseInt(n[3],10)/100;return e(n[5]),this.setHSL(a,s,l)}}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(t)){var c,u=(c=i[1]).length;if(3===u)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===u)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}return t&&0<t.length&&void 0!==(c=We.ColorKeywords[t])&&this.setHex(c),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var i=0<e?1/e:1;return this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this},convertGammaToLinear:function(){var t=this.r,e=this.g,i=this.b;return this.r=t*t,this.g=e*e,this.b=i*i,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){var e,i,n=t||{h:0,s:0,l:0},o=this.r,r=this.g,a=this.b,s=Math.max(o,r,a),l=Math.min(o,r,a),c=(l+s)/2;if(l===s)i=e=0;else{var u=s-l;switch(i=c<=.5?u/(s+l):u/(2-s-l),s){case o:e=(r-a)/u+(r<a?6:0);break;case r:e=(a-o)/u+2;break;case a:e=(o-r)/u+4}e/=6}return n.h=e,n.s=i,n.l=c,n},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,i){var n=this.getHSL();return n.h+=t,n.s+=e,n.l+=i,this.setHSL(n.h,n.s,n.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}},We.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},We.Quaternion=function(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._w=void 0!==n?n:1},We.Quaternion.prototype={constructor:We.Quaternion,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get w(){return this._w},set w(t){this._w=t,this.onChangeCallback()},set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(t instanceof We.Euler==0)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var i=Math.cos(t._x/2),n=Math.cos(t._y/2),o=Math.cos(t._z/2),r=Math.sin(t._x/2),a=Math.sin(t._y/2),s=Math.sin(t._z/2),l=t.order;return"XYZ"===l?(this._x=r*n*o+i*a*s,this._y=i*a*o-r*n*s,this._z=i*n*s+r*a*o,this._w=i*n*o-r*a*s):"YXZ"===l?(this._x=r*n*o+i*a*s,this._y=i*a*o-r*n*s,this._z=i*n*s-r*a*o,this._w=i*n*o+r*a*s):"ZXY"===l?(this._x=r*n*o-i*a*s,this._y=i*a*o+r*n*s,this._z=i*n*s+r*a*o,this._w=i*n*o-r*a*s):"ZYX"===l?(this._x=r*n*o-i*a*s,this._y=i*a*o+r*n*s,this._z=i*n*s-r*a*o,this._w=i*n*o+r*a*s):"YZX"===l?(this._x=r*n*o+i*a*s,this._y=i*a*o+r*n*s,this._z=i*n*s-r*a*o,this._w=i*n*o-r*a*s):"XZY"===l&&(this._x=r*n*o-i*a*s,this._y=i*a*o-r*n*s,this._z=i*n*s+r*a*o,this._w=i*n*o+r*a*s),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,i=t.elements,n=i[0],o=i[4],r=i[8],a=i[1],s=i[5],l=i[9],c=i[2],u=i[6],h=i[10],d=n+s+h;return this._z=0<d?(e=.5/Math.sqrt(d+1),this._w=.25/e,this._x=(u-l)*e,this._y=(r-c)*e,(a-o)*e):s<n&&h<n?(e=2*Math.sqrt(1+n-s-h),this._w=(u-l)/e,this._x=.25*e,this._y=(o+a)/e,(r+c)/e):h<s?(e=2*Math.sqrt(1+s-n-h),this._w=(r-c)/e,this._x=(o+a)/e,this._y=.25*e,(l+u)/e):(e=2*Math.sqrt(1+h-n-s),this._w=(a-o)/e,this._x=(r+c)/e,this._y=(l+u)/e,.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(t,e){return void 0===i&&(i=new We.Vector3),(n=t.dot(e)+1)<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?i.set(-t.y,t.x,0):i.set(0,-t.z,t.y)):i.crossVectors(t,e),this._x=i.x,this._y=i.y,this._z=i.z,this._w=n,this.normalize(),this},inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return this._w=0===t?(this._x=0,this._y=0,this._z=0,1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?this.multiplyQuaternions(t,e):this.multiplyQuaternions(this,t)},multiplyQuaternions:function(t,e){var i=t._x,n=t._y,o=t._z,r=t._w,a=e._x,s=e._y,l=e._z,c=e._w;return this._x=i*c+r*a+n*l-o*s,this._y=n*c+r*s+o*a-i*l,this._z=o*c+r*l+i*s-n*a,this._w=r*c-i*a-n*s-o*l,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var i=this._x,n=this._y,o=this._z,r=this._w,a=r*t._w+i*t._x+n*t._y+o*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),1<=a)return this._w=r,this._x=i,this._y=n,this._z=o,this;var s=Math.sqrt(1-a*a);if(Math.abs(s)<.001)return this._w=.5*(r+this._w),this._x=.5*(i+this._x),this._y=.5*(n+this._y),this._z=.5*(o+this._z),this;var l=Math.atan2(s,a),c=Math.sin((1-e)*l)/s,u=Math.sin(e*l)/s;return this._w=r*c+this._w*u,this._x=i*c+this._x*u,this._y=n*c+this._y*u,this._z=o*c+this._z*u,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},Object.assign(We.Quaternion,{slerp:function(t,e,i,n){return i.copy(t).slerp(e,n)},slerpFlat:function(t,e,i,n,o,r,a){var s=i[n+0],l=i[n+1],c=i[n+2],u=i[n+3],h=o[r+0],d=o[r+1],p=o[r+2],f=o[r+3];if(u!==f||s!==h||l!==d||c!==p){var m=1-a,g=s*h+l*d+c*p+u*f,v=0<=g?1:-1,y=1-g*g;if(y>Number.EPSILON){var b=Math.sqrt(y),w=Math.atan2(b,g*v);m=Math.sin(m*w)/b,a=Math.sin(a*w)/b}var x=a*v;if(s=s*m+h*x,l=l*m+d*x,c=c*m+p*x,u=u*m+f*x,m===1-a){var _=1/Math.sqrt(s*s+l*l+c*c+u*u);s*=_,l*=_,c*=_,u*=_}}t[e]=s,t[e+1]=l,t[e+2]=c,t[e+3]=u}}),We.Vector2=function(t,e){this.x=t||0,this.y=e||0},We.Vector2.prototype={constructor:We.Vector2,get width(){return this.x},set width(t){this.x=t},get height(){return this.y},set height(t){this.y=t},set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t):(this.x=0,this.y=0),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return void 0===o&&(o=new We.Vector2,r=new We.Vector2),o.set(t,t),r.set(e,e),this.clamp(o,r)},clampLength:function(t,e){var i=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,i))/i),this},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t),this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromAttribute:function(t,e,i){return void 0===i&&(i=0),e=e*t.itemSize+i,this.x=t.array[e],this.y=t.array[e+1],this},rotateAround:function(t,e){var i=Math.cos(e),n=Math.sin(e),o=this.x-t.x,r=this.y-t.y;return this.x=o*i-r*n+t.x,this.y=o*n+r*i+t.y,this}},We.Vector3=function(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0},We.Vector3.prototype={constructor:We.Vector3,set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?this.multiplyVectors(t,e):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t):(this.x=0,this.y=0,this.z=0),this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return We.Euler,void 0===m&&(m=new We.Quaternion),this.applyQuaternion(m.setFromEuler(t)),this},applyAxisAngle:function(t,e){return void 0===f&&(f=new We.Quaternion),this.applyQuaternion(f.setFromAxisAngle(t,e)),this},applyMatrix3:function(t){var e=this.x,i=this.y,n=this.z,o=t.elements;return this.x=o[0]*e+o[3]*i+o[6]*n,this.y=o[1]*e+o[4]*i+o[7]*n,this.z=o[2]*e+o[5]*i+o[8]*n,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,o=t.elements;return this.x=o[0]*e+o[4]*i+o[8]*n+o[12],this.y=o[1]*e+o[5]*i+o[9]*n+o[13],this.z=o[2]*e+o[6]*i+o[10]*n+o[14],this},applyProjection:function(t){var e=this.x,i=this.y,n=this.z,o=t.elements,r=1/(o[3]*e+o[7]*i+o[11]*n+o[15]);return this.x=(o[0]*e+o[4]*i+o[8]*n+o[12])*r,this.y=(o[1]*e+o[5]*i+o[9]*n+o[13])*r,this.z=(o[2]*e+o[6]*i+o[10]*n+o[14])*r,this},applyQuaternion:function(t){var e=this.x,i=this.y,n=this.z,o=t.x,r=t.y,a=t.z,s=t.w,l=s*e+r*n-a*i,c=s*i+a*e-o*n,u=s*n+o*i-r*e,h=-o*e-r*i-a*n;return this.x=l*s+h*-o+c*-a-u*-r,this.y=c*s+h*-r+u*-o-l*-a,this.z=u*s+h*-a+l*-r-c*-o,this},project:function(t){return void 0===p&&(p=new We.Matrix4),p.multiplyMatrices(t.projectionMatrix,p.getInverse(t.matrixWorld)),this.applyProjection(p)},unproject:function(t){return void 0===d&&(d=new We.Matrix4),d.multiplyMatrices(t.matrixWorld,d.getInverse(t.projectionMatrix)),this.applyProjection(d)},transformDirection:function(t){var e=this.x,i=this.y,n=this.z,o=t.elements;return this.x=o[0]*e+o[4]*i+o[8]*n,this.y=o[1]*e+o[5]*i+o[9]*n,this.z=o[2]*e+o[6]*i+o[10]*n,this.normalize(),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return void 0===u&&(u=new We.Vector3,h=new We.Vector3),u.set(t,t,t),h.set(e,e,e),this.clamp(u,h)},clampLength:function(t,e){var i=this.length();return this.multiplyScalar(Math.max(t,Math.min(e,i))/i),this},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t),this},cross:function(t,e){if(void 0!==e)return this.crossVectors(t,e);var i=this.x,n=this.y,o=this.z;return this.x=n*t.z-o*t.y,this.y=o*t.x-i*t.z,this.z=i*t.y-n*t.x,this},crossVectors:function(t,e){var i=t.x,n=t.y,o=t.z,r=e.x,a=e.y,s=e.z;return this.x=n*s-o*a,this.y=o*r-i*s,this.z=i*a-n*r,this},projectOnVector:function(t){return void 0===l&&(l=new We.Vector3),l.copy(t).normalize(),c=this.dot(l),this.copy(l).multiplyScalar(c)},projectOnPlane:function(t){return void 0===s&&(s=new We.Vector3),s.copy(this).projectOnVector(t),this.sub(s)},reflect:function(t){return void 0===a&&(a=new We.Vector3),this.sub(a.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(We.Math.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromMatrixPosition:function(t){return this.setFromMatrixColumn(t,3)},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=n,this},setFromMatrixColumn:function(t,e){return"number"==typeof t&&(t=arguments[1],e=arguments[0]),this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromAttribute:function(t,e,i){return void 0===i&&(i=0),e=e*t.itemSize+i,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this}},We.Vector4=function(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==n?n:1},We.Vector4.prototype={constructor:We.Vector4,set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return isFinite(t)?(this.x*=t,this.y*=t,this.z*=t,this.w*=t):(this.x=0,this.y=0,this.z=0,this.w=0),this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,o=this.w,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n+r[12]*o,this.y=r[1]*e+r[5]*i+r[9]*n+r[13]*o,this.z=r[2]*e+r[6]*i+r[10]*n+r[14]*o,this.w=r[3]*e+r[7]*i+r[11]*n+r[15]*o,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return this.z=e<1e-4?(this.x=1,this.y=0):(this.x=t.x/e,this.y=t.y/e,t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,i,n,o,r=t.elements,a=r[0],s=r[4],l=r[8],c=r[1],u=r[5],h=r[9],d=r[2],p=r[6],f=r[10];if(Math.abs(s-c)<.01&&Math.abs(l-d)<.01&&Math.abs(h-p)<.01){if(Math.abs(s+c)<.1&&Math.abs(l+d)<.1&&Math.abs(h+p)<.1&&Math.abs(a+u+f-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var m=(a+1)/2,g=(u+1)/2,v=(f+1)/2,y=(s+c)/4,b=(l+d)/4,w=(h+p)/4;return g<m&&v<m?o=m<.01?(i=0,n=.707106781):(n=y/(i=Math.sqrt(m)),b/i):v<g?o=g<.01?(n=0,i=.707106781):(i=y/(n=Math.sqrt(g)),w/n):v<.01?(n=i=.707106781,o=0):(i=b/(o=Math.sqrt(v)),n=w/o),this.set(i,n,o,e),this}var x=Math.sqrt((p-h)*(p-h)+(l-d)*(l-d)+(c-s)*(c-s));return Math.abs(x)<.001&&(x=1),this.x=(p-h)/x,this.y=(l-d)/x,this.z=(c-s)/x,this.w=Math.acos((a+u+f-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return void 0===g&&(g=new We.Vector4,v=new We.Vector4),g.set(t,t,t,t),v.set(e,e,e,e),this.clamp(g,v)},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){return this.multiplyScalar(t/this.length())},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t),this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromAttribute:function(t,e,i){return void 0===i&&(i=0),e=e*t.itemSize+i,this.x=t.array[e],this.y=t.array[e+1],this.z=t.array[e+2],this.w=t.array[e+3],this}},We.Euler=function(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._order=n||We.Euler.DefaultOrder},We.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],We.Euler.DefaultOrder="XYZ",We.Euler.prototype={constructor:We.Euler,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get order(){return this._order},set order(t){this._order=t,this.onChangeCallback()},set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,i){var n=We.Math.clamp,o=t.elements,r=o[0],a=o[4],s=o[8],l=o[1],c=o[5],u=o[9],h=o[2],d=o[6],p=o[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(n(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-u,p),this._z=Math.atan2(-a,r)):(this._x=Math.atan2(d,c),this._z=0)):"YXZ"===e?(this._x=Math.asin(-n(u,-1,1)),Math.abs(u)<.99999?(this._y=Math.atan2(s,p),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-h,r),this._z=0)):"ZXY"===e?(this._x=Math.asin(n(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,r))):"ZYX"===e?(this._y=Math.asin(-n(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,r)):(this._x=0,this._z=Math.atan2(-a,c))):"YZX"===e?(this._z=Math.asin(n(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-h,r)):(this._x=0,this._y=Math.atan2(s,p))):"XZY"===e&&(this._z=Math.asin(-n(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(d,c),this._y=Math.atan2(s,r)):(this._x=Math.atan2(-u,p),this._y=0)),this._order=e,!1!==i&&this.onChangeCallback(),this},setFromQuaternion:function(t,e,i){return void 0===b&&(b=new We.Matrix4),b.makeRotationFromQuaternion(t),this.setFromRotationMatrix(b,e,i),this},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:(y=new We.Quaternion,function(t){y.setFromEuler(this),this.setFromQuaternion(y,t)}),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new We.Vector3(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}},We.Line3=function(t,e){this.start=void 0!==t?t:new We.Vector3,this.end=void 0!==e?e:new We.Vector3},We.Line3.prototype={constructor:We.Line3,set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},center:function(t){return(t||new We.Vector3).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return(t||new We.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){var i=e||new We.Vector3;return this.delta(i).multiplyScalar(t).add(this.start)},closestPointToPointParameter:(w=new We.Vector3,x=new We.Vector3,function(t,e){w.subVectors(t,this.start),x.subVectors(this.end,this.start);var i=x.dot(x),n=x.dot(w)/i;return e&&(n=We.Math.clamp(n,0,1)),n}),closestPointToPoint:function(t,e,i){var n=this.closestPointToPointParameter(t,e),o=i||new We.Vector3;return this.delta(o).multiplyScalar(n).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}},We.Box2=function(t,e){this.min=void 0!==t?t:new We.Vector2(1/0,1/0),this.max=void 0!==e?e:new We.Vector2(-1/0,-1/0)},We.Box2.prototype={constructor:We.Box2,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:(S=new We.Vector2,function(t,e){var i=S.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(t){return(t||new We.Vector2).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){return(t||new We.Vector2).subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return(e||new We.Vector2).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return(e||new We.Vector2).copy(t).clamp(this.min,this.max)},distanceToPoint:(_=new We.Vector2,function(t){return _.copy(t).clamp(this.min,this.max).sub(t).length()}),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},We.Box3=function(t,e){this.min=void 0!==t?t:new We.Vector3(1/0,1/0,1/0),this.max=void 0!==e?e:new We.Vector3(-1/0,-1/0,-1/0)},We.Box3.prototype={constructor:We.Box3,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){this.makeEmpty();for(var e=1/0,i=1/0,n=1/0,o=-1/0,r=-1/0,a=-1/0,s=0,l=t.length;s<l;s+=3){var c=t[s],u=t[s+1],h=t[s+2];c<e&&(e=c),u<i&&(i=u),h<n&&(n=h),o<c&&(o=c),r<u&&(r=u),a<h&&(a=h)}this.min.set(e,i,n),this.max.set(o,r,a)},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:(A=new We.Vector3,function(t,e){var i=A.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}),setFromObject:function(t){void 0===C&&(C=new We.Box3);var e=this;return this.makeEmpty(),t.updateMatrixWorld(!0),t.traverse(function(t){var i=t.geometry;void 0!==i&&(null===i.boundingBox&&i.computeBoundingBox(),!1===i.boundingBox.isEmpty()&&(C.copy(i.boundingBox),C.applyMatrix4(t.matrixWorld),e.union(C)))}),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(t){return(t||new We.Vector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(t){return(t||new We.Vector3).subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return(e||new We.Vector3).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return void 0===P&&(P=new We.Vector3),this.clampPoint(t.center,P),P.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var e,i;return i=0<t.normal.x?(e=t.normal.x*this.min.x,t.normal.x*this.max.x):(e=t.normal.x*this.max.x,t.normal.x*this.min.x),0<t.normal.y?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),0<t.normal.z?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=t.constant&&i>=t.constant},clampPoint:function(t,e){return(e||new We.Vector3).copy(t).clamp(this.min,this.max)},distanceToPoint:(I=new We.Vector3,function(t){return I.copy(t).clamp(this.min,this.max).sub(t).length()}),getBoundingSphere:(M=new We.Vector3,function(t){var e=t||new We.Sphere;return e.center=this.center(),e.radius=.5*this.size(M).length(),e}),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:(T=[new We.Vector3,new We.Vector3,new We.Vector3,new We.Vector3,new We.Vector3,new We.Vector3,new We.Vector3,new We.Vector3],function(t){return T[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),T[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),T[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),T[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),T[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),T[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),T[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),T[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.makeEmpty(),this.setFromPoints(T),this}),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},We.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),arguments.length},We.Matrix3.prototype={constructor:We.Matrix3,set:function(t,e,i,n,o,r,a,s,l){var c=this.elements;return c[0]=t,c[1]=n,c[2]=a,c[3]=e,c[4]=o,c[5]=s,c[6]=i,c[7]=r,c[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=t.elements;return this.set(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]),this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToVector3Array:function(t,e,i){void 0===L&&(L=new We.Vector3),void 0===e&&(e=0),void 0===i&&(i=t.length);for(var n=0,o=e;n<i;n+=3,o+=3)L.fromArray(t,o),L.applyMatrix3(this),L.toArray(t,o);return t},applyToBuffer:function(t,e,i){void 0===E&&(E=new We.Vector3),void 0===e&&(e=0),void 0===i&&(i=t.length/t.itemSize);for(var n=0,o=e;n<i;n++,o++)E.x=t.getX(o),E.y=t.getY(o),E.z=t.getZ(o),E.applyMatrix3(this),t.setXYZ(E.x,E.y,E.z);return t},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],i=t[1],n=t[2],o=t[3],r=t[4],a=t[5],s=t[6],l=t[7],c=t[8];return e*r*c-e*a*l-i*o*c+i*a*s+n*o*l-n*r*s},getInverse:function(t,e){We.Matrix4;var i=t.elements,n=this.elements,o=i[0],r=i[1],a=i[2],s=i[3],l=i[4],c=i[5],u=i[6],h=i[7],d=i[8],p=d*l-c*h,f=c*u-d*s,m=h*s-l*u,g=o*p+r*f+a*m;if(0!==g)return n[0]=p,n[1]=a*h-d*r,n[2]=c*r-a*l,n[3]=f,n[4]=d*o-a*u,n[5]=a*s-c*o,n[6]=m,n[7]=r*u-h*o,n[8]=l*o-r*s,this.multiplyScalar(1/g);var v="THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0";if(e)throw new Error(v);return this.identity()},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},flattenToArrayOffset:function(t,e){var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]}},We.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length},We.Matrix4.prototype={constructor:We.Matrix4,set:function(t,e,i,n,o,r,a,s,l,c,u,h,d,p,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=i,g[12]=n,g[1]=o,g[5]=r,g[9]=a,g[13]=s,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new We.Matrix4).fromArray(this.elements)},copy:function(t){return this.elements.set(t.elements),this},copyPosition:function(t){var e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this},extractBasis:function(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this},extractRotation:function(t){void 0===z&&(z=new We.Vector3);var e=this.elements,i=t.elements,n=1/z.setFromMatrixColumn(t,0).length(),o=1/z.setFromMatrixColumn(t,1).length(),r=1/z.setFromMatrixColumn(t,2).length();return e[0]=i[0]*n,e[1]=i[1]*n,e[2]=i[2]*n,e[4]=i[4]*o,e[5]=i[5]*o,e[6]=i[6]*o,e[8]=i[8]*r,e[9]=i[9]*r,e[10]=i[10]*r,this},makeRotationFromEuler:function(t){We.Euler;var e=this.elements,i=t.x,n=t.y,o=t.z,r=Math.cos(i),a=Math.sin(i),s=Math.cos(n),l=Math.sin(n),c=Math.cos(o),u=Math.sin(o);if("XYZ"===t.order){var h=r*c,d=r*u,p=a*c,f=a*u;e[0]=s*c,e[4]=-s*u,e[8]=l,e[1]=d+p*l,e[5]=h-f*l,e[9]=-a*s,e[2]=f-h*l,e[6]=p+d*l,e[10]=r*s}else if("YXZ"===t.order){var m=s*c,g=s*u,v=l*c,y=l*u;e[0]=m+y*a,e[4]=v*a-g,e[8]=r*l,e[1]=r*u,e[5]=r*c,e[9]=-a,e[2]=g*a-v,e[6]=y+m*a,e[10]=r*s}else if("ZXY"===t.order)m=s*c,g=s*u,v=l*c,y=l*u,e[0]=m-y*a,e[4]=-r*u,e[8]=v+g*a,e[1]=g+v*a,e[5]=r*c,e[9]=y-m*a,e[2]=-r*l,e[6]=a,e[10]=r*s;else if("ZYX"===t.order)h=r*c,d=r*u,p=a*c,f=a*u,e[0]=s*c,e[4]=p*l-d,e[8]=h*l+f,e[1]=s*u,e[5]=f*l+h,e[9]=d*l-p,e[2]=-l,e[6]=a*s,e[10]=r*s;else if("YZX"===t.order){var b=r*s,w=r*l,x=a*s,_=a*l;e[0]=s*c,e[4]=_-b*u,e[8]=x*u+w,e[1]=u,e[5]=r*c,e[9]=-a*c,e[2]=-l*c,e[6]=w*u+x,e[10]=b-_*u}else"XZY"===t.order&&(b=r*s,w=r*l,x=a*s,_=a*l,e[0]=s*c,e[4]=-u,e[8]=l*c,e[1]=b*u+_,e[5]=r*c,e[9]=w*u-x,e[2]=x*u-w,e[6]=a*c,e[10]=_*u+b);return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,i=t.x,n=t.y,o=t.z,r=t.w,a=i+i,s=n+n,l=o+o,c=i*a,u=i*s,h=i*l,d=n*s,p=n*l,f=o*l,m=r*a,g=r*s,v=r*l;return e[0]=1-(d+f),e[4]=u-v,e[8]=h+g,e[1]=u+v,e[5]=1-(c+f),e[9]=p-m,e[2]=h-g,e[6]=p+m,e[10]=1-(c+d),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(t,e,i){void 0===N&&(N=new We.Vector3),void 0===U&&(U=new We.Vector3),void 0===B&&(B=new We.Vector3);var n=this.elements;return B.subVectors(t,e).normalize(),0===B.lengthSq()&&(B.z=1),N.crossVectors(i,B).normalize(),0===N.lengthSq()&&(B.x+=1e-4,N.crossVectors(i,B).normalize()),U.crossVectors(B,N),n[0]=N.x,n[4]=U.x,n[8]=B.x,n[1]=N.y,n[5]=U.y,n[9]=B.y,n[2]=N.z,n[6]=U.z,n[10]=B.z,this},multiply:function(t,e){return void 0!==e?this.multiplyMatrices(t,e):this.multiplyMatrices(this,t)},multiplyMatrices:function(t,e){var i=t.elements,n=e.elements,o=this.elements,r=i[0],a=i[4],s=i[8],l=i[12],c=i[1],u=i[5],h=i[9],d=i[13],p=i[2],f=i[6],m=i[10],g=i[14],v=i[3],y=i[7],b=i[11],w=i[15],x=n[0],_=n[4],S=n[8],T=n[12],M=n[1],I=n[5],P=n[9],C=n[13],A=n[2],E=n[6],L=n[10],D=n[14],k=n[3],R=n[7],O=n[11],F=n[15];return o[0]=r*x+a*M+s*A+l*k,o[4]=r*_+a*I+s*E+l*R,o[8]=r*S+a*P+s*L+l*O,o[12]=r*T+a*C+s*D+l*F,o[1]=c*x+u*M+h*A+d*k,o[5]=c*_+u*I+h*E+d*R,o[9]=c*S+u*P+h*L+d*O,o[13]=c*T+u*C+h*D+d*F,o[2]=p*x+f*M+m*A+g*k,o[6]=p*_+f*I+m*E+g*R,o[10]=p*S+f*P+m*L+g*O,o[14]=p*T+f*C+m*D+g*F,o[3]=v*x+y*M+b*A+w*k,o[7]=v*_+y*I+b*E+w*R,o[11]=v*S+y*P+b*L+w*O,o[15]=v*T+y*C+b*D+w*F,this},multiplyToArray:function(t,e,i){var n=this.elements;return this.multiplyMatrices(t,e),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToVector3Array:function(t,e,i){void 0===F&&(F=new We.Vector3),void 0===e&&(e=0),void 0===i&&(i=t.length);for(var n=0,o=e;n<i;n+=3,o+=3)F.fromArray(t,o),F.applyMatrix4(this),F.toArray(t,o);return t},applyToBuffer:function(t,e,i){void 0===O&&(O=new We.Vector3),void 0===e&&(e=0),void 0===i&&(i=t.length/t.itemSize);for(var n=0,o=e;n<i;n++,o++)O.x=t.getX(o),O.y=t.getY(o),O.z=t.getZ(o),O.applyMatrix4(this),t.setXYZ(O.x,O.y,O.z);return t},determinant:function(){var t=this.elements,e=t[0],i=t[4],n=t[8],o=t[12],r=t[1],a=t[5],s=t[9],l=t[13],c=t[2],u=t[6],h=t[10],d=t[14];return t[3]*(+o*s*u-n*l*u-o*a*h+i*l*h+n*a*d-i*s*d)+t[7]*(+e*s*d-e*l*h+o*r*h-n*r*d+n*l*c-o*s*c)+t[11]*(+e*l*u-e*a*d-o*r*u+i*r*d+o*a*c-i*l*c)+t[15]*(-n*a*c-e*s*u+e*a*h+n*r*u-i*r*h+i*s*c)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArrayOffset:function(t,e){var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t},getPosition:function(){return void 0===R&&(R=new We.Vector3),R.setFromMatrixColumn(this,3)},setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var i=this.elements,n=t.elements,o=n[0],r=n[1],a=n[2],s=n[3],l=n[4],c=n[5],u=n[6],h=n[7],d=n[8],p=n[9],f=n[10],m=n[11],g=n[12],v=n[13],y=n[14],b=n[15],w=p*y*h-v*f*h+v*u*m-c*y*m-p*u*b+c*f*b,x=g*f*h-d*y*h-g*u*m+l*y*m+d*u*b-l*f*b,_=d*v*h-g*p*h+g*c*m-l*v*m-d*c*b+l*p*b,S=g*p*u-d*v*u-g*c*f+l*v*f+d*c*y-l*p*y,T=o*w+r*x+a*_+s*S;if(0!==T)return i[0]=w,i[1]=v*f*s-p*y*s-v*a*m+r*y*m+p*a*b-r*f*b,i[2]=c*y*s-v*u*s+v*a*h-r*y*h-c*a*b+r*u*b,i[3]=p*u*s-c*f*s-p*a*h+r*f*h+c*a*m-r*u*m,i[4]=x,i[5]=d*y*s-g*f*s+g*a*m-o*y*m-d*a*b+o*f*b,i[6]=g*u*s-l*y*s-g*a*h+o*y*h+l*a*b-o*u*b,i[7]=l*f*s-d*u*s+d*a*h-o*f*h-l*a*m+o*u*m,i[8]=_,i[9]=g*p*s-d*v*s-g*r*m+o*v*m+d*r*b-o*p*b,i[10]=l*v*s-g*c*s+g*r*h-o*v*h-l*r*b+o*c*b,i[11]=d*c*s-l*p*s-d*r*h+o*p*h+l*r*m-o*c*m,i[12]=S,i[13]=d*v*a-g*p*a+g*r*f-o*v*f-d*r*y+o*p*y,i[14]=g*c*a-l*v*a-g*r*u+o*v*u+l*r*y-o*c*y,i[15]=l*p*a-d*c*a+d*r*u-o*p*u-l*r*f+o*c*f,this.multiplyScalar(1/T);var M="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(e)throw new Error(M);return this.identity()},scale:function(t){var e=this.elements,i=t.x,n=t.y,o=t.z;return e[0]*=i,e[4]*=n,e[8]*=o,e[1]*=i,e[5]*=n,e[9]*=o,e[2]*=i,e[6]*=n,e[10]*=o,e[3]*=i,e[7]*=n,e[11]*=o,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))},makeTranslation:function(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var i=Math.cos(e),n=Math.sin(e),o=1-i,r=t.x,a=t.y,s=t.z,l=o*r,c=o*a;return this.set(l*r+i,l*a-n*s,l*s+n*a,0,l*a+n*s,c*a+i,c*s-n*r,0,l*s-n*a,c*s+n*r,o*s*s+i,0,0,0,0,1),this},makeScale:function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this},compose:function(t,e,i){return this.makeRotationFromQuaternion(e),this.scale(i),this.setPosition(t),this},decompose:function(t,e,i){void 0===D&&(D=new We.Vector3),void 0===k&&(k=new We.Matrix4);var n=this.elements,o=D.set(n[0],n[1],n[2]).length(),r=D.set(n[4],n[5],n[6]).length(),a=D.set(n[8],n[9],n[10]).length();this.determinant()<0&&(o=-o),t.x=n[12],t.y=n[13],t.z=n[14],k.elements.set(this.elements);var s=1/o,l=1/r,c=1/a;return k.elements[0]*=s,k.elements[1]*=s,k.elements[2]*=s,k.elements[4]*=l,k.elements[5]*=l,k.elements[6]*=l,k.elements[8]*=c,k.elements[9]*=c,k.elements[10]*=c,e.setFromRotationMatrix(k),i.x=o,i.y=r,i.z=a,this},makeFrustum:function(t,e,i,n,o,r){var a=this.elements,s=2*o/(e-t),l=2*o/(n-i),c=(e+t)/(e-t),u=(n+i)/(n-i),h=-(r+o)/(r-o),d=-2*r*o/(r-o);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=l,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makePerspective:function(t,e,i,n){var o=i*Math.tan(We.Math.degToRad(.5*t)),r=-o,a=r*e,s=o*e;return this.makeFrustum(a,s,r,o,i,n)},makeOrthographic:function(t,e,i,n,o,r){var a=this.elements,s=1/(e-t),l=1/(i-n),c=1/(r-o),u=(e+t)*s,h=(i+n)*l,d=(r+o)*c;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,i=t.elements,n=0;n<16;n++)if(e[n]!==i[n])return!1;return!0},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}},We.Ray=function(t,e){this.origin=void 0!==t?t:new We.Vector3,this.direction=void 0!==e?e:new We.Vector3},We.Ray.prototype={constructor:We.Ray,set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return(e||new We.Vector3).copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){this.direction.copy(t).sub(this.origin).normalize()},recast:(Z=new We.Vector3,function(t){return this.origin.copy(this.at(t,Z)),this}),closestPointToPoint:function(t,e){var i=e||new We.Vector3;i.subVectors(t,this.origin);var n=i.dot(this.direction);return n<0?i.copy(this.origin):i.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:(Q=new We.Vector3,function(t){var e=Q.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Q.copy(this.direction).multiplyScalar(e).add(this.origin),Q.distanceToSquared(t))}),distanceSqToSegment:($=new We.Vector3,Y=new We.Vector3,X=new We.Vector3,function(t,e,i,n){$.copy(t).add(e).multiplyScalar(.5),Y.copy(e).sub(t).normalize(),X.copy(this.origin).sub($);var o,r,a,s,l=.5*t.distanceTo(e),c=-this.direction.dot(Y),u=X.dot(this.direction),h=-X.dot(Y),d=X.lengthSq(),p=Math.abs(1-c*c);if(0<p)if(r=c*u-h,s=l*p,0<=(o=c*h-u))if(-s<=r)if(r<=s){var f=1/p;a=(o*=f)*(o+c*(r*=f)+2*u)+r*(c*o+r+2*h)+d}else r=l,a=-(o=Math.max(0,-(c*r+u)))*o+r*(r+2*h)+d;else r=-l,a=-(o=Math.max(0,-(c*r+u)))*o+r*(r+2*h)+d;else a=r<=-s?-(o=Math.max(0,-(-c*l+u)))*o+(r=0<o?-l:Math.min(Math.max(-l,-h),l))*(r+2*h)+d:r<=s?(o=0,(r=Math.min(Math.max(-l,-h),l))*(r+2*h)+d):-(o=Math.max(0,-(c*l+u)))*o+(r=0<o?l:Math.min(Math.max(-l,-h),l))*(r+2*h)+d;else r=0<c?-l:l,a=-(o=Math.max(0,-(c*r+u)))*o+r*(r+2*h)+d;return i&&i.copy(this.direction).multiplyScalar(o).add(this.origin),n&&n.copy(Y).multiplyScalar(r).add($),a}),intersectSphere:(q=new We.Vector3,function(t,e){q.subVectors(t.center,this.origin);var i=q.dot(this.direction),n=q.dot(q)-i*i,o=t.radius*t.radius;if(o<n)return null;var r=Math.sqrt(o-n),a=i-r,s=i+r;return a<0&&s<0?null:a<0?this.at(s,e):this.at(a,e)}),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var i=-(this.origin.dot(t.normal)+t.constant)/e;return 0<=i?i:null},intersectPlane:function(t,e){var i=this.distanceToPlane(t);return null===i?null:this.at(i,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var i,n,o,r,a,s,l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return n=0<=l?(i=(t.min.x-h.x)*l,(t.max.x-h.x)*l):(i=(t.max.x-h.x)*l,(t.min.x-h.x)*l),(r=0<=c?(o=(t.min.y-h.y)*c,(t.max.y-h.y)*c):(o=(t.max.y-h.y)*c,(t.min.y-h.y)*c))<i||n<o?null:((i<o||i!=i)&&(i=o),(r<n||n!=n)&&(n=r),(s=0<=u?(a=(t.min.z-h.z)*u,(t.max.z-h.z)*u):(a=(t.max.z-h.z)*u,(t.min.z-h.z)*u))<i||n<a?null:((i<a||i!=i)&&(i=a),(s<n||n!=n)&&(n=s),n<0?null:this.at(0<=i?i:n,e)))},intersectsBox:(W=new We.Vector3,function(t){return null!==this.intersectBox(t,W)}),intersectTriangle:(V=new We.Vector3,G=new We.Vector3,j=new We.Vector3,H=new We.Vector3,function(t,e,i,n,o){G.subVectors(e,t),j.subVectors(i,t),H.crossVectors(G,j);var r,a=this.direction.dot(H);if(0<a){if(n)return null;r=1}else{if(!(a<0))return null;r=-1,a=-a}V.subVectors(this.origin,t);var s=r*this.direction.dot(j.crossVectors(V,j));if(s<0)return null;var l=r*this.direction.dot(G.cross(V));if(l<0)return null;if(a<s+l)return null;var c=-r*V.dot(H);return c<0?null:this.at(c/a,o)}),applyMatrix4:function(t){return this.direction.add(this.origin).applyMatrix4(t),this.origin.applyMatrix4(t),this.direction.sub(this.origin),this.direction.normalize(),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}},We.Sphere=function(t,e){this.center=void 0!==t?t:new We.Vector3,this.radius=void 0!==e?e:0},We.Sphere.prototype={constructor:We.Sphere,set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:(K=new We.Box3,function(t,e){var i=this.center;void 0!==e?i.copy(e):K.setFromPoints(t).center(i);for(var n=0,o=0,r=t.length;o<r;o++)n=Math.max(n,i.distanceToSquared(t[o]));return this.radius=Math.sqrt(n),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(this.center.dot(t.normal)-t.constant)<=this.radius},clampPoint:function(t,e){var i=this.center.distanceToSquared(t),n=e||new We.Vector3;return n.copy(t),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(t){var e=t||new We.Box3;return e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}},We.Frustum=function(t,e,i,n,o,r){this.planes=[void 0!==t?t:new We.Plane,void 0!==e?e:new We.Plane,void 0!==i?i:new We.Plane,void 0!==n?n:new We.Plane,void 0!==o?o:new We.Plane,void 0!==r?r:new We.Plane]},We.Frustum.prototype={constructor:We.Frustum,set:function(t,e,i,n,o,r){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(i),a[3].copy(n),a[4].copy(o),a[5].copy(r),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,i=0;i<6;i++)e[i].copy(t.planes[i]);return this},setFromMatrix:function(t){var e=this.planes,i=t.elements,n=i[0],o=i[1],r=i[2],a=i[3],s=i[4],l=i[5],c=i[6],u=i[7],h=i[8],d=i[9],p=i[10],f=i[11],m=i[12],g=i[13],v=i[14],y=i[15];return e[0].setComponents(a-n,u-s,f-h,y-m).normalize(),e[1].setComponents(a+n,u+s,f+h,y+m).normalize(),e[2].setComponents(a+o,u+l,f+d,y+g).normalize(),e[3].setComponents(a-o,u-l,f-d,y-g).normalize(),e[4].setComponents(a-r,u-c,f-p,y-v).normalize(),e[5].setComponents(a+r,u+c,f+p,y+v).normalize(),this},intersectsObject:(et=new We.Sphere,function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),et.copy(e.boundingSphere),et.applyMatrix4(t.matrixWorld),this.intersectsSphere(et)}),intersectsSphere:function(t){for(var e=this.planes,i=t.center,n=-t.radius,o=0;o<6;o++)if(e[o].distanceToPoint(i)<n)return!1;return!0},intersectsBox:(J=new We.Vector3,tt=new We.Vector3,function(t){for(var e=this.planes,i=0;i<6;i++){var n=e[i];J.x=0<n.normal.x?t.min.x:t.max.x,tt.x=0<n.normal.x?t.max.x:t.min.x,J.y=0<n.normal.y?t.min.y:t.max.y,tt.y=0<n.normal.y?t.max.y:t.min.y,J.z=0<n.normal.z?t.min.z:t.max.z,tt.z=0<n.normal.z?t.max.z:t.min.z;var o=n.distanceToPoint(J),r=n.distanceToPoint(tt);if(o<0&&r<0)return!1}return!0}),containsPoint:function(t){for(var e=this.planes,i=0;i<6;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0}},We.Plane=function(t,e){this.normal=void 0!==t?t:new We.Vector3(1,0,0),this.constant=void 0!==e?e:0},We.Plane.prototype={constructor:We.Plane,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,i,n){return this.normal.set(t,e,i),this.constant=n,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:(at=new We.Vector3,st=new We.Vector3,function(t,e,i){var n=at.subVectors(i,e).cross(st.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(n,t),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return this.orthoPoint(t,e).sub(t).negate()},orthoPoint:function(t,e){var i=this.distanceToPoint(t);return(e||new We.Vector3).copy(this.normal).multiplyScalar(i)},intersectLine:(rt=new We.Vector3,function(t,e){var i=e||new We.Vector3,n=t.delta(rt),o=this.normal.dot(n);if(0===o)return 0===this.distanceToPoint(t.start)?i.copy(t.start):void 0;var r=-(t.start.dot(this.normal)+this.constant)/o;return r<0||1<r?void 0:i.copy(n).multiplyScalar(r).add(t.start)}),intersectsLine:function(t){var e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return e<0&&0<i||i<0&&0<e},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return(t||new We.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:(it=new We.Vector3,nt=new We.Vector3,ot=new We.Matrix3,function(t,e){var i=e||ot.getNormalMatrix(t),n=it.copy(this.normal).applyMatrix3(i),o=this.coplanarPoint(nt);return o.applyMatrix4(t),this.setFromNormalAndCoplanarPoint(n,o),this}),translate:function(t){return this.constant=this.constant-t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}},We.Spherical=function(t,e,i){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==i?i:0,this},We.Spherical.prototype={constructor:We.Spherical,set:function(t,e,i){this.radius=t,this.phi=e,this.theta=i},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius.copy(t.radius),this.phi.copy(t.phi),this.theta.copy(t.theta),this},makeSafe:function(){this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi))},setFromVector3:function(t){return this.radius=t.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t.x,t.z),this.phi=Math.acos(We.Math.clamp(t.y/this.radius,-1,1))),this}},We.Math={generateUUID:(ht="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),dt=new Array(36),pt=0,function(){for(var t=0;t<36;t++)dt[t]=8===t||13===t||18===t||23===t?"-":14===t?"4":(pt<=2&&(pt=33554432+16777216*Math.random()|0),ut=15&pt,pt>>=4,ht[19===t?3&ut|8:ut]);return dt.join("")}),clamp:function(t,e,i){return Math.max(e,Math.min(i,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,i,n,o){return n+(t-e)*(o-n)/(i-e)},smoothstep:function(t,e,i){return t<=e?0:i<=t?1:(t=(t-e)/(i-e))*t*(3-2*t)},smootherstep:function(t,e,i){return t<=e?0:i<=t?1:(t=(t-e)/(i-e))*t*t*(t*(6*t-15)+10)},random16:function(){return Math.random()},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:(ct=Math.PI/180,function(t){return t*ct}),radToDeg:(lt=180/Math.PI,function(t){return t*lt}),isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},nearestPowerOfTwo:function(t){return Math.pow(2,Math.round(Math.log(t)/Math.LN2))},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}},We.Spline=function(t){this.points=t;var e,i,n,o,r,a,s,l,c,u=[],h={x:0,y:0,z:0};function d(t,e,i,n,o,r,a){var s=.5*(i-t),l=.5*(n-e);return(2*(e-i)+s+l)*a+(-3*(e-i)-2*s-l)*r+s*o+e}this.initFromArray=function(t){this.points=[];for(var e=0;e<t.length;e++)this.points[e]={x:t[e][0],y:t[e][1],z:t[e][2]}},this.getPoint=function(t){return e=(this.points.length-1)*t,i=Math.floor(e),n=e-i,u[0]=0===i?i:i-1,u[1]=i,u[2]=i>this.points.length-2?this.points.length-1:i+1,u[3]=i>this.points.length-3?this.points.length-1:i+2,a=this.points[u[0]],s=this.points[u[1]],l=this.points[u[2]],c=this.points[u[3]],r=n*(o=n*n),h.x=d(a.x,s.x,l.x,c.x,n,o,r),h.y=d(a.y,s.y,l.y,c.y,n,o,r),h.z=d(a.z,s.z,l.z,c.z,n,o,r),h},this.getControlPointsArray=function(){var t,e,i=this.points.length,n=[];for(t=0;t<i;t++)e=this.points[t],n[t]=[e.x,e.y,e.z];return n},this.getLength=function(t){var e,i,n,o,r=0,a=0,s=0,l=new We.Vector3,c=new We.Vector3,u=[],h=0;for(u[0]=0,t||(t=100),n=this.points.length*t,l.copy(this.points[0]),e=1;e<n;e++)i=e/n,o=this.getPoint(i),c.copy(o),h+=c.distanceTo(l),l.copy(o),r=(this.points.length-1)*i,(a=Math.floor(r))!==s&&(u[a]=h,s=a);return u[u.length]=h,{chunks:u,total:h}},this.reparametrizeByArcLength=function(t){var e,i,n,o,r,a,s,l,c=[],u=new We.Vector3,h=this.getLength();for(c.push(u.copy(this.points[0]).clone()),e=1;e<this.points.length;e++){for(a=h.chunks[e]-h.chunks[e-1],s=Math.ceil(t*a/h.total),o=(e-1)/(this.points.length-1),r=e/(this.points.length-1),i=1;i<s-1;i++)n=o+i*(1/s)*(r-o),l=this.getPoint(n),c.push(u.copy(l).clone());c.push(u.copy(this.points[e]).clone())}this.points=c}},We.Triangle=function(t,e,i){this.a=void 0!==t?t:new We.Vector3,this.b=void 0!==e?e:new We.Vector3,this.c=void 0!==i?i:new We.Vector3},We.Triangle.normal=(ft=new We.Vector3,function(t,e,i,n){var o=n||new We.Vector3;o.subVectors(i,e),ft.subVectors(t,e),o.cross(ft);var r=o.lengthSq();return 0<r?o.multiplyScalar(1/Math.sqrt(r)):o.set(0,0,0)}),We.Triangle.barycoordFromPoint=(mt=new We.Vector3,gt=new We.Vector3,vt=new We.Vector3,function(t,e,i,n,o){mt.subVectors(n,e),gt.subVectors(i,e),vt.subVectors(t,e);var r=mt.dot(mt),a=mt.dot(gt),s=mt.dot(vt),l=gt.dot(gt),c=gt.dot(vt),u=r*l-a*a,h=o||new We.Vector3;if(0===u)return h.set(-2,-1,-1);var d=1/u,p=(l*s-a*c)*d,f=(r*c-a*s)*d;return h.set(1-p-f,f,p)}),We.Triangle.containsPoint=(yt=new We.Vector3,function(t,e,i,n){var o=We.Triangle.barycoordFromPoint(t,e,i,n,yt);return 0<=o.x&&0<=o.y&&o.x+o.y<=1}),We.Triangle.prototype={constructor:We.Triangle,set:function(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this},setFromPointsAndIndices:function(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:(bt=new We.Vector3,wt=new We.Vector3,function(){return bt.subVectors(this.c,this.b),wt.subVectors(this.a,this.b),.5*bt.cross(wt).length()}),midpoint:function(t){return(t||new We.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return We.Triangle.normal(this.a,this.b,this.c,t)},plane:function(t){return(t||new We.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return We.Triangle.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return We.Triangle.containsPoint(t,this.a,this.b,this.c)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},We.Interpolant=function(t,e,i,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(i),this.sampleValues=e,this.valueSize=i},We.Interpolant.prototype={constructor:We.Interpolant,evaluate:function(t){var e=this.parameterPositions,i=this._cachedIndex,n=e[i],o=e[i-1];t:{e:{var r;i:{n:if(!(t<n)){for(var a=i+2;;){if(void 0===n){if(t<o)break n;return i=e.length,this._cachedIndex=i,this.afterEnd_(i-1,t,o)}if(i===a)break;if(o=n,t<(n=e[++i]))break e}r=e.length;break i}if(o<=t)break t;var s=e[1];for(t<s&&(i=2,o=s),a=i-2;;){if(void 0===o)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(i===a)break;if(n=o,(o=e[--i-1])<=t)break e}r=i,i=0}for(;i<r;){var l=i+r>>>1;t<e[l]?r=l:i=l+1}if(n=e[i],void 0===(o=e[i-1]))return this._cachedIndex=0,this.beforeStart_(0,t,n);if(void 0===n)return i=e.length,this._cachedIndex=i,this.afterEnd_(i-1,o,t)}this._cachedIndex=i,this.intervalChanged_(i,o,n)}return this.interpolate_(i,o,t,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,i=this.sampleValues,n=this.valueSize,o=t*n,r=0;r!==n;++r)e[r]=i[o+r];return e},interpolate_:function(t,e,i,n){throw new Error("call to abstract method")},intervalChanged_:function(t,e,i){}},Object.assign(We.Interpolant.prototype,{beforeStart_:We.Interpolant.prototype.copySampleValue_,afterEnd_:We.Interpolant.prototype.copySampleValue_}),We.CubicInterpolant=function(t,e,i,n){We.Interpolant.call(this,t,e,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0},We.CubicInterpolant.prototype=Object.assign(Object.create(We.Interpolant.prototype),{constructor:We.CubicInterpolant,DefaultSettings_:{endingStart:We.ZeroCurvatureEnding,endingEnd:We.ZeroCurvatureEnding},intervalChanged_:function(t,e,i){var n=this.parameterPositions,o=t-2,r=t+1,a=n[o],s=n[r];if(void 0===a)switch(this.getSettings_().endingStart){case We.ZeroSlopeEnding:o=t,a=2*e-i;break;case We.WrapAroundEnding:a=e+n[o=n.length-2]-n[o+1];break;default:o=t,a=i}if(void 0===s)switch(this.getSettings_().endingEnd){case We.ZeroSlopeEnding:r=t,s=2*i-e;break;case We.WrapAroundEnding:s=i+n[r=1]-n[0];break;default:r=t-1,s=e}var l=.5*(i-e),c=this.valueSize;this._weightPrev=l/(e-a),this._weightNext=l/(s-i),this._offsetPrev=o*c,this._offsetNext=r*c},interpolate_:function(t,e,i,n){for(var o=this.resultBuffer,r=this.sampleValues,a=this.valueSize,s=t*a,l=s-a,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(i-e)/(n-e),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,v=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,b=d*m-d*f,w=0;w!==a;++w)o[w]=g*r[c+w]+v*r[l+w]+y*r[s+w]+b*r[u+w];return o}}),We.DiscreteInterpolant=function(t,e,i,n){We.Interpolant.call(this,t,e,i,n)},We.DiscreteInterpolant.prototype=Object.assign(Object.create(We.Interpolant.prototype),{constructor:We.DiscreteInterpolant,interpolate_:function(t,e,i,n){return this.copySampleValue_(t-1)}}),We.LinearInterpolant=function(t,e,i,n){We.Interpolant.call(this,t,e,i,n)},We.LinearInterpolant.prototype=Object.assign(Object.create(We.Interpolant.prototype),{constructor:We.LinearInterpolant,interpolate_:function(t,e,i,n){for(var o=this.resultBuffer,r=this.sampleValues,a=this.valueSize,s=t*a,l=s-a,c=(i-e)/(n-e),u=1-c,h=0;h!==a;++h)o[h]=r[l+h]*u+r[s+h]*c;return o}}),We.QuaternionLinearInterpolant=function(t,e,i,n){We.Interpolant.call(this,t,e,i,n)},We.QuaternionLinearInterpolant.prototype=Object.assign(Object.create(We.Interpolant.prototype),{constructor:We.QuaternionLinearInterpolant,interpolate_:function(t,e,i,n){for(var o=this.resultBuffer,r=this.sampleValues,a=this.valueSize,s=t*a,l=(i-e)/(n-e),c=s+a;s!==c;s+=4)We.Quaternion.slerpFlat(o,0,r,s-a,r,s,l);return o}}),We.Clock=function(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1},We.Clock.prototype={constructor:We.Clock,start:function(){this.startTime=performance.now(),this.oldTime=this.startTime,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running&&this.start(),this.running){var e=performance.now();t=.001*(e-this.oldTime),this.oldTime=e,this.elapsedTime+=t}return t}},We.EventDispatcher=function(){},We.EventDispatcher.prototype={constructor:We.EventDispatcher,apply:function(t){t.addEventListener=We.EventDispatcher.prototype.addEventListener,t.hasEventListener=We.EventDispatcher.prototype.hasEventListener,t.removeEventListener=We.EventDispatcher.prototype.removeEventListener,t.dispatchEvent=We.EventDispatcher.prototype.dispatchEvent},addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[t]&&-1!==i[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var i=this._listeners[t];if(void 0!==i){var n=i.indexOf(e);-1!==n&&i.splice(n,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var i=[],n=e.length,o=0;o<n;o++)i[o]=e[o];for(o=0;o<n;o++)i[o].call(this,t)}}}},We.Layers=function(){this.mask=1},We.Layers.prototype={constructor:We.Layers,set:function(t){this.mask=1<<t},enable:function(t){this.mask|=1<<t},toggle:function(t){this.mask^=1<<t},disable:function(t){this.mask&=~(1<<t)},test:function(t){return 0!=(this.mask&t.mask)}},function(t){function e(t,e){return t.distance-e.distance}function i(t,e,n,o){if(!1!==t.visible&&(t.raycast(e,n),!0===o))for(var r=t.children,a=0,s=r.length;a<s;a++)i(r[a],e,n,!0)}t.Raycaster=function(e,i,n,o){this.ray=new t.Ray(e,i),this.near=n||0,this.far=o||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return this.Points}}})},t.Raycaster.prototype={constructor:t.Raycaster,linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(e,i){i instanceof t.PerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(i).sub(this.ray.origin).normalize()):i instanceof t.OrthographicCamera&&(this.ray.origin.set(e.x,e.y,-1).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld))},intersectObject:function(t,n){var o=[];return i(t,this,o,n),o.sort(e),o},intersectObjects:function(t,n){var o=[];if(!1===Array.isArray(t))return o;for(var r=0,a=t.length;r<a;r++)i(t[r],this,o,n);return o.sort(e),o}}}(We),We.Object3D=function(){Object.defineProperty(this,"id",{value:We.Object3DIdCount++}),this.uuid=We.Math.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=We.Object3D.DefaultUp.clone();var t=new We.Vector3,e=new We.Euler,i=new We.Quaternion,n=new We.Vector3(1,1,1);e.onChange(function(){i.setFromEuler(e,!1)}),i.onChange(function(){e.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:t},rotation:{enumerable:!0,value:e},quaternion:{enumerable:!0,value:i},scale:{enumerable:!0,value:n},modelViewMatrix:{value:new We.Matrix4},normalMatrix:{value:new We.Matrix3}}),this.rotationAutoUpdate=!0,this.matrix=new We.Matrix4,this.matrixWorld=new We.Matrix4,this.matrixAutoUpdate=We.Object3D.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new We.Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}},We.Object3D.DefaultUp=new We.Vector3(0,1,0),We.Object3D.DefaultMatrixAutoUpdate=!0,We.Object3D.prototype={constructor:We.Object3D,applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:(Ft=new We.Quaternion,function(t,e){return Ft.setFromAxisAngle(t,e),this.quaternion.multiply(Ft),this}),rotateX:(Ot=new We.Vector3(1,0,0),function(t){return this.rotateOnAxis(Ot,t)}),rotateY:(Rt=new We.Vector3(0,1,0),function(t){return this.rotateOnAxis(Rt,t)}),rotateZ:(kt=new We.Vector3(0,0,1),function(t){return this.rotateOnAxis(kt,t)}),translateOnAxis:(Dt=new We.Vector3,function(t,e){return Dt.copy(t).applyQuaternion(this.quaternion),this.position.add(Dt.multiplyScalar(e)),this}),translateX:(Lt=new We.Vector3(1,0,0),function(t){return this.translateOnAxis(Lt,t)}),translateY:(Et=new We.Vector3(0,1,0),function(t){return this.translateOnAxis(Et,t)}),translateZ:(At=new We.Vector3(0,0,1),function(t){return this.translateOnAxis(At,t)}),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:(Ct=new We.Matrix4,function(t){return t.applyMatrix4(Ct.getInverse(this.matrixWorld))}),lookAt:(Pt=new We.Matrix4,function(t){Pt.lookAt(t,this.position,this.up),this.quaternion.setFromRotationMatrix(Pt)}),add:function(t){if(1<arguments.length){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this||t instanceof We.Object3D&&(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)),this},remove:function(t){if(1<arguments.length)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);var i=this.children.indexOf(t);-1!==i&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(i,1))},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var i=0,n=this.children.length;i<n;i++){var o=this.children[i].getObjectByProperty(t,e);if(void 0!==o)return o}},getWorldPosition:function(t){var e=t||new We.Vector3;return this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(Mt=new We.Vector3,It=new We.Vector3,function(t){var e=t||new We.Quaternion;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(Mt,e,It),e}),getWorldRotation:(Tt=new We.Quaternion,function(t){var e=t||new We.Euler;return this.getWorldQuaternion(Tt),e.setFromQuaternion(Tt,this.rotation.order,!1)}),getWorldScale:(_t=new We.Vector3,St=new We.Quaternion,function(t){var e=t||new We.Vector3;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(_t,St,e),e}),getWorldDirection:(xt=new We.Quaternion,function(t){var e=t||new We.Vector3;return this.getWorldQuaternion(xt),e.set(0,0,1).applyQuaternion(xt)}),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){!0===this.matrixAutoUpdate&&this.updateMatrix(),!0!==this.matrixWorldNeedsUpdate&&!0!==t||(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t=!(this.matrixWorldNeedsUpdate=!1));for(var e=0,i=this.children.length;e<i;e++)this.children[e].updateMatrixWorld(t)},toJSON:function(t){var e=void 0===t,i={};e&&(t={geometries:{},materials:{},textures:{},images:{}},i.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"});var n={};if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),n.matrix=this.matrix.toArray(),void 0!==this.geometry&&(void 0===t.geometries[this.geometry.uuid]&&(t.geometries[this.geometry.uuid]=this.geometry.toJSON(t)),n.geometry=this.geometry.uuid),void 0!==this.material&&(void 0===t.materials[this.material.uuid]&&(t.materials[this.material.uuid]=this.material.toJSON(t)),n.material=this.material.uuid),0<this.children.length){n.children=[];for(var o=0;o<this.children.length;o++)n.children.push(this.children[o].toJSON(t).object)}if(e){var r=c(t.geometries),a=c(t.materials),s=c(t.textures),l=c(t.images);0<r.length&&(i.geometries=r),0<a.length&&(i.materials=a),0<s.length&&(i.textures=s),0<l.length&&(i.images=l)}return i.object=n,i;function c(t){var e=[];for(var i in t){var n=t[i];delete n.metadata,e.push(n)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.rotationAutoUpdate=t.rotationAutoUpdate,this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var i=0;i<t.children.length;i++){var n=t.children[i];this.add(n.clone())}return this}},We.EventDispatcher.prototype.apply(We.Object3D.prototype),We.Object3DIdCount=0,We.Face3=function(t,e,i,n,o,r){this.a=t,this.b=e,this.c=i,this.normal=n instanceof We.Vector3?n:new We.Vector3,this.vertexNormals=Array.isArray(n)?n:[],this.color=o instanceof We.Color?o:new We.Color,this.vertexColors=Array.isArray(o)?o:[],this.materialIndex=void 0!==r?r:0},We.Face3.prototype={constructor:We.Face3,clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,i=t.vertexNormals.length;e<i;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,i=t.vertexColors.length;e<i;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}},We.BufferAttribute=function(t,e){this.uuid=We.Math.generateUUID(),this.array=t,this.itemSize=e,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0},We.BufferAttribute.prototype={constructor:We.BufferAttribute,get count(){return this.array.length/this.itemSize},set needsUpdate(t){!0===t&&this.version++},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.itemSize,i*=e.itemSize;for(var n=0,o=this.itemSize;n<o;n++)this.array[t+n]=e.array[i+n];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,i=0,n=0,o=t.length;n<o;n++){var r=t[n];void 0===r&&(r=new We.Color),e[i++]=r.r,e[i++]=r.g,e[i++]=r.b}return this},copyIndicesArray:function(t){for(var e=this.array,i=0,n=0,o=t.length;n<o;n++){var r=t[n];e[i++]=r.a,e[i++]=r.b,e[i++]=r.c}return this},copyVector2sArray:function(t){for(var e=this.array,i=0,n=0,o=t.length;n<o;n++){var r=t[n];void 0===r&&(r=new We.Vector2),e[i++]=r.x,e[i++]=r.y}return this},copyVector3sArray:function(t){for(var e=this.array,i=0,n=0,o=t.length;n<o;n++){var r=t[n];void 0===r&&(r=new We.Vector3),e[i++]=r.x,e[i++]=r.y,e[i++]=r.z}return this},copyVector4sArray:function(t){for(var e=this.array,i=0,n=0,o=t.length;n<o;n++){var r=t[n];void 0===r&&(r=new We.Vector4),e[i++]=r.x,e[i++]=r.y,e[i++]=r.z,e[i++]=r.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this},setXYZW:function(t,e,i,n,o){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this.array[t+3]=o,this},clone:function(){return(new this.constructor).copy(this)}},We.Int8Attribute=function(t,e){return new We.BufferAttribute(new Int8Array(t),e)},We.Uint8Attribute=function(t,e){return new We.BufferAttribute(new Uint8Array(t),e)},We.Uint8ClampedAttribute=function(t,e){return new We.BufferAttribute(new Uint8ClampedArray(t),e)},We.Int16Attribute=function(t,e){return new We.BufferAttribute(new Int16Array(t),e)},We.Uint16Attribute=function(t,e){return new We.BufferAttribute(new Uint16Array(t),e)},We.Int32Attribute=function(t,e){return new We.BufferAttribute(new Int32Array(t),e)},We.Uint32Attribute=function(t,e){return new We.BufferAttribute(new Uint32Array(t),e)},We.Float32Attribute=function(t,e){return new We.BufferAttribute(new Float32Array(t),e)},We.Float64Attribute=function(t,e){return new We.BufferAttribute(new Float64Array(t),e)},We.DynamicBufferAttribute=function(t,e){return new We.BufferAttribute(t,e).setDynamic(!0)},We.InstancedBufferAttribute=function(t,e,i){We.BufferAttribute.call(this,t,e),this.meshPerAttribute=i||1},We.InstancedBufferAttribute.prototype=Object.create(We.BufferAttribute.prototype),We.InstancedBufferAttribute.prototype.constructor=We.InstancedBufferAttribute,We.InstancedBufferAttribute.prototype.copy=function(t){return We.BufferAttribute.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},We.InterleavedBuffer=function(t,e){this.uuid=We.Math.generateUUID(),this.array=t,this.stride=e,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0},We.InterleavedBuffer.prototype={constructor:We.InterleavedBuffer,get length(){return this.array.length},get count(){return this.array.length/this.stride},set needsUpdate(t){!0===t&&this.version++},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.stride,i*=e.stride;for(var n=0,o=this.stride;n<o;n++)this.array[t+n]=e.array[i+n];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)}},We.InstancedInterleavedBuffer=function(t,e,i){We.InterleavedBuffer.call(this,t,e),this.meshPerAttribute=i||1},We.InstancedInterleavedBuffer.prototype=Object.create(We.InterleavedBuffer.prototype),We.InstancedInterleavedBuffer.prototype.constructor=We.InstancedInterleavedBuffer,We.InstancedInterleavedBuffer.prototype.copy=function(t){return We.InterleavedBuffer.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},We.InterleavedBufferAttribute=function(t,e,i){this.uuid=We.Math.generateUUID(),this.data=t,this.itemSize=e,this.offset=i},We.InterleavedBufferAttribute.prototype={constructor:We.InterleavedBufferAttribute,get length(){return this.array.length},get count(){return this.data.count},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this},setXYZW:function(t,e,i,n,o){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this.data.array[t+3]=o,this}},We.Geometry=function(){Object.defineProperty(this,"id",{value:We.GeometryIdCount++}),this.uuid=We.Math.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1},We.Geometry.prototype={constructor:We.Geometry,applyMatrix:function(t){for(var e=(new We.Matrix3).getNormalMatrix(t),i=0,n=this.vertices.length;i<n;i++)this.vertices[i].applyMatrix4(t);for(i=0,n=this.faces.length;i<n;i++){var o=this.faces[i];o.normal.applyMatrix3(e).normalize();for(var r=0,a=o.vertexNormals.length;r<a;r++)o.vertexNormals[r].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(t){return void 0===Gt&&(Gt=new We.Matrix4),Gt.makeRotationX(t),this.applyMatrix(Gt),this},rotateY:function(t){return void 0===Vt&&(Vt=new We.Matrix4),Vt.makeRotationY(t),this.applyMatrix(Vt),this},rotateZ:function(t){return void 0===zt&&(zt=new We.Matrix4),zt.makeRotationZ(t),this.applyMatrix(zt),this},translate:function(t,e,i){return void 0===Bt&&(Bt=new We.Matrix4),Bt.makeTranslation(t,e,i),this.applyMatrix(Bt),this},scale:function(t,e,i){return void 0===Ut&&(Ut=new We.Matrix4),Ut.makeScale(t,e,i),this.applyMatrix(Ut),this},lookAt:function(t){void 0===Nt&&(Nt=new We.Object3D),Nt.lookAt(t),Nt.updateMatrix(),this.applyMatrix(Nt.matrix)},fromBufferGeometry:function(t){var e=this,i=null!==t.index?t.index.array:void 0,n=t.attributes,o=n.position.array,r=void 0!==n.normal?n.normal.array:void 0,a=void 0!==n.color?n.color.array:void 0,s=void 0!==n.uv?n.uv.array:void 0,l=void 0!==n.uv2?n.uv2.array:void 0;void 0!==l&&(this.faceVertexUvs[1]=[]);for(var c=[],u=[],h=[],d=0,p=0;d<o.length;d+=3,p+=2)e.vertices.push(new We.Vector3(o[d],o[d+1],o[d+2])),void 0!==r&&c.push(new We.Vector3(r[d],r[d+1],r[d+2])),void 0!==a&&e.colors.push(new We.Color(a[d],a[d+1],a[d+2])),void 0!==s&&u.push(new We.Vector2(s[p],s[p+1])),void 0!==l&&h.push(new We.Vector2(l[p],l[p+1]));function f(t,i,n,o){var d=void 0!==r?[c[t].clone(),c[i].clone(),c[n].clone()]:[],p=void 0!==a?[e.colors[t].clone(),e.colors[i].clone(),e.colors[n].clone()]:[],f=new We.Face3(t,i,n,d,p,o);e.faces.push(f),void 0!==s&&e.faceVertexUvs[0].push([u[t].clone(),u[i].clone(),u[n].clone()]),void 0!==l&&e.faceVertexUvs[1].push([h[t].clone(),h[i].clone(),h[n].clone()])}if(void 0!==i){var m=t.groups;if(0<m.length)for(d=0;d<m.length;d++)for(var g=m[d],v=g.start,y=(p=v,v+g.count);p<y;p+=3)f(i[p],i[p+1],i[p+2],g.materialIndex);else for(d=0;d<i.length;d+=3)f(i[d],i[d+1],i[d+2])}else for(d=0;d<o.length/3;d+=3)f(d,d+1,d+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.center().negate();return this.translate(t.x,t.y,t.z),t},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,i=0===e?1:1/e,n=new We.Matrix4;return n.set(i,0,0,-i*t.x,0,i,0,-i*t.y,0,0,i,-i*t.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var t=new We.Vector3,e=new We.Vector3,i=0,n=this.faces.length;i<n;i++){var o=this.faces[i],r=this.vertices[o.a],a=this.vertices[o.b],s=this.vertices[o.c];t.subVectors(s,a),e.subVectors(r,a),t.cross(e),t.normalize(),o.normal.copy(t)}},computeVertexNormals:function(t){var e,i,n,o,r,a;for(void 0===t&&(t=!0),a=new Array(this.vertices.length),e=0,i=this.vertices.length;e<i;e++)a[e]=new We.Vector3;if(t){var s,l,c,u=new We.Vector3,h=new We.Vector3;for(n=0,o=this.faces.length;n<o;n++)r=this.faces[n],s=this.vertices[r.a],l=this.vertices[r.b],c=this.vertices[r.c],u.subVectors(c,l),h.subVectors(s,l),u.cross(h),a[r.a].add(u),a[r.b].add(u),a[r.c].add(u)}else for(n=0,o=this.faces.length;n<o;n++)a[(r=this.faces[n]).a].add(r.normal),a[r.b].add(r.normal),a[r.c].add(r.normal);for(e=0,i=this.vertices.length;e<i;e++)a[e].normalize();for(n=0,o=this.faces.length;n<o;n++){var d=(r=this.faces[n]).vertexNormals;3===d.length?(d[0].copy(a[r.a]),d[1].copy(a[r.b]),d[2].copy(a[r.c])):(d[0]=a[r.a].clone(),d[1]=a[r.b].clone(),d[2]=a[r.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,i,n,o;for(i=0,n=this.faces.length;i<n;i++)for((o=this.faces[i]).__originalFaceNormal?o.__originalFaceNormal.copy(o.normal):o.__originalFaceNormal=o.normal.clone(),o.__originalVertexNormals||(o.__originalVertexNormals=[]),t=0,e=o.vertexNormals.length;t<e;t++)o.__originalVertexNormals[t]?o.__originalVertexNormals[t].copy(o.vertexNormals[t]):o.__originalVertexNormals[t]=o.vertexNormals[t].clone();var r=new We.Geometry;for(r.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var a=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(i=0,n=this.faces.length;i<n;i++)l=new We.Vector3,c={a:new We.Vector3,b:new We.Vector3,c:new We.Vector3},a.push(l),s.push(c)}var l,c,u=this.morphNormals[t];for(r.vertices=this.morphTargets[t].vertices,r.computeFaceNormals(),r.computeVertexNormals(),i=0,n=this.faces.length;i<n;i++)o=this.faces[i],l=u.faceNormals[i],c=u.vertexNormals[i],l.copy(o.normal),c.a.copy(o.vertexNormals[0]),c.b.copy(o.vertexNormals[1]),c.c.copy(o.vertexNormals[2])}for(i=0,n=this.faces.length;i<n;i++)(o=this.faces[i]).normal=o.__originalFaceNormal,o.vertexNormals=o.__originalVertexNormals},computeTangents:function(){},computeLineDistances:function(){for(var t=0,e=this.vertices,i=0,n=e.length;i<n;i++)0<i&&(t+=e[i].distanceTo(e[i-1])),this.lineDistances[i]=t},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new We.Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new We.Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,i){if(t instanceof We.Geometry!=0){var n,o=this.vertices.length,r=this.vertices,a=t.vertices,s=this.faces,l=t.faces,c=this.faceVertexUvs[0],u=t.faceVertexUvs[0];void 0===i&&(i=0),void 0!==e&&(n=(new We.Matrix3).getNormalMatrix(e));for(var h=0,d=a.length;h<d;h++){var p=a[h].clone();void 0!==e&&p.applyMatrix4(e),r.push(p)}for(h=0,d=l.length;h<d;h++){var f,m,g,v=l[h],y=v.vertexNormals,b=v.vertexColors;(f=new We.Face3(v.a+o,v.b+o,v.c+o)).normal.copy(v.normal),void 0!==n&&f.normal.applyMatrix3(n).normalize();for(var w=0,x=y.length;w<x;w++)m=y[w].clone(),void 0!==n&&m.applyMatrix3(n).normalize(),f.vertexNormals.push(m);for(f.color.copy(v.color),w=0,x=b.length;w<x;w++)g=b[w],f.vertexColors.push(g.clone());f.materialIndex=v.materialIndex+i,s.push(f)}for(h=0,d=u.length;h<d;h++){var _=u[h],S=[];if(void 0!==_){for(w=0,x=_.length;w<x;w++)S.push(_[w].clone());c.push(S)}}}},mergeMesh:function(t){t instanceof We.Mesh!=0&&(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix))},mergeVertices:function(){var t,e,i,n,o,r,a,s,l={},c=[],u=[],h=Math.pow(10,4);for(i=0,n=this.vertices.length;i<n;i++)t=this.vertices[i],void 0===l[e=Math.round(t.x*h)+"_"+Math.round(t.y*h)+"_"+Math.round(t.z*h)]?(l[e]=i,c.push(this.vertices[i]),u[i]=c.length-1):u[i]=u[l[e]];var d=[];for(i=0,n=this.faces.length;i<n;i++){(o=this.faces[i]).a=u[o.a],o.b=u[o.b],o.c=u[o.c],r=[o.a,o.b,o.c];for(var p=0;p<3;p++)if(r[p]===r[(p+1)%3]){d.push(i);break}}for(i=d.length-1;0<=i;i--){var f=d[i];for(this.faces.splice(f,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(f,1)}var m=this.vertices.length-c.length;return this.vertices=c,m},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,i=0;i<e;i++)t[i]._id=i;t.sort(function(t,e){return t.materialIndex-e.materialIndex});var n,o,r=this.faceVertexUvs[0],a=this.faceVertexUvs[1];for(r&&r.length===e&&(n=[]),a&&a.length===e&&(o=[]),i=0;i<e;i++){var s=t[i]._id;n&&n.push(r[s]),o&&o.push(a[s])}n&&(this.faceVertexUvs[0]=n),o&&(this.faceVertexUvs[1]=o)},toJSON:function(){var t={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var i in e)void 0!==e[i]&&(t[i]=e[i]);return t}for(var n=[],o=0;o<this.vertices.length;o++){var r=this.vertices[o];n.push(r.x,r.y,r.z)}var a=[],s=[],l={},c=[],u={},h=[],d={};for(o=0;o<this.faces.length;o++){var p=this.faces[o],f=void 0!==this.faceVertexUvs[0][o],m=0<p.normal.length(),g=0<p.vertexNormals.length,v=1!==p.color.r||1!==p.color.g||1!==p.color.b,y=0<p.vertexColors.length,b=0;if(b=S(b=S(b=S(b=S(b=S(b=S(b=S(b=S(b,0,0),1,!0),2,!1),3,f),4,m),5,g),6,v),7,y),a.push(b),a.push(p.a,p.b,p.c),a.push(p.materialIndex),f){var w=this.faceVertexUvs[0][o];a.push(I(w[0]),I(w[1]),I(w[2]))}if(m&&a.push(T(p.normal)),g){var x=p.vertexNormals;a.push(T(x[0]),T(x[1]),T(x[2]))}if(v&&a.push(M(p.color)),y){var _=p.vertexColors;a.push(M(_[0]),M(_[1]),M(_[2]))}}function S(t,e,i){return i?t|1<<e:t&~(1<<e)}function T(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==l[e]||(l[e]=s.length/3,s.push(t.x,t.y,t.z)),l[e]}function M(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==u[e]||(u[e]=c.length,c.push(t.getHex())),u[e]}function I(t){var e=t.x.toString()+t.y.toString();return void 0!==d[e]||(d[e]=h.length/2,h.push(t.x,t.y)),d[e]}return t.data={},t.data.vertices=n,t.data.normals=s,0<c.length&&(t.data.colors=c),0<h.length&&(t.data.uvs=[h]),t.data.faces=a,t},clone:function(){return(new We.Geometry).copy(this)},copy:function(t){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]];for(var e=t.vertices,i=0,n=e.length;i<n;i++)this.vertices.push(e[i].clone());var o=t.faces;for(i=0,n=o.length;i<n;i++)this.faces.push(o[i].clone());for(i=0,n=t.faceVertexUvs.length;i<n;i++){var r=t.faceVertexUvs[i];void 0===this.faceVertexUvs[i]&&(this.faceVertexUvs[i]=[]);for(var a=0,s=r.length;a<s;a++){for(var l=r[a],c=[],u=0,h=l.length;u<h;u++){var d=l[u];c.push(d.clone())}this.faceVertexUvs[i].push(c)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}},We.EventDispatcher.prototype.apply(We.Geometry.prototype),We.GeometryIdCount=0,We.DirectGeometry=function(){Object.defineProperty(this,"id",{value:We.GeometryIdCount++}),this.uuid=We.Math.generateUUID(),this.name="",this.type="DirectGeometry",this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1},We.DirectGeometry.prototype={constructor:We.DirectGeometry,computeBoundingBox:We.Geometry.prototype.computeBoundingBox,computeBoundingSphere:We.Geometry.prototype.computeBoundingSphere,computeFaceNormals:function(){},computeVertexNormals:function(){},computeGroups:function(t){for(var e,i,n=[],o=t.faces,r=0;r<o.length;r++){var a=o[r];a.materialIndex!==i&&(i=a.materialIndex,void 0!==e&&(e.count=3*r-e.start,n.push(e)),e={start:3*r,materialIndex:i})}void 0!==e&&(e.count=3*r-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e,i=t.faces,n=t.vertices,o=t.faceVertexUvs,r=o[0]&&0<o[0].length,a=o[1]&&0<o[1].length,s=t.morphTargets,l=s.length;if(0<l){e=[];for(var c=0;c<l;c++)e[c]=[];this.morphTargets.position=e}var u,h=t.morphNormals,d=h.length;if(0<d){for(u=[],c=0;c<d;c++)u[c]=[];this.morphTargets.normal=u}var p=t.skinIndices,f=t.skinWeights,m=p.length===n.length,g=f.length===n.length;for(c=0;c<i.length;c++){var v=i[c];this.vertices.push(n[v.a],n[v.b],n[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var b=v.normal;this.normals.push(b,b,b)}var w,x=v.vertexColors;if(3===x.length)this.colors.push(x[0],x[1],x[2]);else{var _=v.color;this.colors.push(_,_,_)}!0===r&&(void 0!==(w=o[0][c])?this.uvs.push(w[0],w[1],w[2]):this.uvs.push(new We.Vector2,new We.Vector2,new We.Vector2)),!0===a&&(void 0!==(w=o[1][c])?this.uvs2.push(w[0],w[1],w[2]):this.uvs2.push(new We.Vector2,new We.Vector2,new We.Vector2));for(var S=0;S<l;S++){var T=s[S].vertices;e[S].push(T[v.a],T[v.b],T[v.c])}for(S=0;S<d;S++){var M=h[S].vertexNormals[c];u[S].push(M.a,M.b,M.c)}m&&this.skinIndices.push(p[v.a],p[v.b],p[v.c]),g&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},We.EventDispatcher.prototype.apply(We.DirectGeometry.prototype),We.BufferGeometry=function(){Object.defineProperty(this,"id",{value:We.GeometryIdCount++}),this.uuid=We.Math.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}},We.BufferGeometry.prototype={constructor:We.BufferGeometry,getIndex:function(){return this.index},setIndex:function(t){this.index=t},addAttribute:function(t,e){return e instanceof We.BufferAttribute==0&&e instanceof We.InterleavedBufferAttribute==0?void this.addAttribute(t,new We.BufferAttribute(e,arguments[2])):"index"===t?void this.setIndex(e):(this.attributes[t]=e,this)},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,i){this.groups.push({start:t,count:e,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToVector3Array(e.array),e.needsUpdate=!0);var i=this.attributes.normal;return void 0!==i&&((new We.Matrix3).getNormalMatrix(t).applyToVector3Array(i.array),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return void 0===Qt&&(Qt=new We.Matrix4),Qt.makeRotationX(t),this.applyMatrix(Qt),this},rotateY:function(t){return void 0===Xt&&(Xt=new We.Matrix4),Xt.makeRotationY(t),this.applyMatrix(Xt),this},rotateZ:function(t){return void 0===Yt&&(Yt=new We.Matrix4),Yt.makeRotationZ(t),this.applyMatrix(Yt),this},translate:function(t,e,i){return void 0===$t&&($t=new We.Matrix4),$t.makeTranslation(t,e,i),this.applyMatrix($t),this},scale:function(t,e,i){return void 0===qt&&(qt=new We.Matrix4),qt.makeScale(t,e,i),this.applyMatrix(qt),this},lookAt:function(t){void 0===Wt&&(Wt=new We.Object3D),Wt.lookAt(t),Wt.updateMatrix(),this.applyMatrix(Wt.matrix)},center:function(){this.computeBoundingBox();var t=this.boundingBox.center().negate();return this.translate(t.x,t.y,t.z),t},setFromObject:function(t){var e=t.geometry;if(t instanceof We.Points||t instanceof We.Line){var i=new We.Float32Attribute(3*e.vertices.length,3),n=new We.Float32Attribute(3*e.colors.length,3);if(this.addAttribute("position",i.copyVector3sArray(e.vertices)),this.addAttribute("color",n.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var o=new We.Float32Attribute(e.lineDistances.length,1);this.addAttribute("lineDistance",o.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t instanceof We.Mesh&&e instanceof We.Geometry&&this.fromGeometry(e);return this},updateFromObject:function(t){var e,i=t.geometry;if(t instanceof We.Mesh){var n=i.__directGeometry;if(void 0===n)return this.fromGeometry(i);n.verticesNeedUpdate=i.verticesNeedUpdate,n.normalsNeedUpdate=i.normalsNeedUpdate,n.colorsNeedUpdate=i.colorsNeedUpdate,n.uvsNeedUpdate=i.uvsNeedUpdate,n.groupsNeedUpdate=i.groupsNeedUpdate,i.verticesNeedUpdate=!1,i.normalsNeedUpdate=!1,i.colorsNeedUpdate=!1,i.uvsNeedUpdate=!1,i.groupsNeedUpdate=!1,i=n}return!0===i.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(i.vertices),e.needsUpdate=!0),i.verticesNeedUpdate=!1),!0===i.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(i.normals),e.needsUpdate=!0),i.normalsNeedUpdate=!1),!0===i.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(i.colors),e.needsUpdate=!0),i.colorsNeedUpdate=!1),i.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVector2sArray(i.uvs),e.needsUpdate=!0),i.uvsNeedUpdate=!1),i.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(i.lineDistances),e.needsUpdate=!0),i.lineDistancesNeedUpdate=!1),i.groupsNeedUpdate&&(i.computeGroups(t.geometry),this.groups=i.groups,i.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new We.DirectGeometry).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new We.BufferAttribute(e,3).copyVector3sArray(t.vertices)),0<t.normals.length){var i=new Float32Array(3*t.normals.length);this.addAttribute("normal",new We.BufferAttribute(i,3).copyVector3sArray(t.normals))}if(0<t.colors.length){var n=new Float32Array(3*t.colors.length);this.addAttribute("color",new We.BufferAttribute(n,3).copyColorsArray(t.colors))}if(0<t.uvs.length){var o=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new We.BufferAttribute(o,2).copyVector2sArray(t.uvs))}if(0<t.uvs2.length){var r=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new We.BufferAttribute(r,2).copyVector2sArray(t.uvs2))}if(0<t.indices.length){var a=new(65535<t.vertices.length?Uint32Array:Uint16Array)(3*t.indices.length);this.setIndex(new We.BufferAttribute(a,1).copyIndicesArray(t.indices))}for(var s in this.groups=t.groups,t.morphTargets){for(var l=[],c=t.morphTargets[s],u=0,h=c.length;u<h;u++){var d=c[u],p=new We.Float32Attribute(3*d.length,3);l.push(p.copyVector3sArray(d))}this.morphAttributes[s]=l}if(0<t.skinIndices.length){var f=new We.Float32Attribute(4*t.skinIndices.length,4);this.addAttribute("skinIndex",f.copyVector4sArray(t.skinIndices))}if(0<t.skinWeights.length){var m=new We.Float32Attribute(4*t.skinWeights.length,4);this.addAttribute("skinWeight",m.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:(new We.Vector3,function(){null===this.boundingBox&&(this.boundingBox=new We.Box3);var t=this.attributes.position.array;t&&this.boundingBox.setFromArray(t),void 0!==t&&0!==t.length||(this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)),isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)}),computeBoundingSphere:(jt=new We.Box3,Ht=new We.Vector3,function(){null===this.boundingSphere&&(this.boundingSphere=new We.Sphere);var t=this.attributes.position.array;if(t){var e=this.boundingSphere.center;jt.setFromArray(t),jt.center(e);for(var i=0,n=0,o=t.length;n<o;n+=3)Ht.fromArray(t,n),i=Math.max(i,e.distanceToSquared(Ht));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)}}),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,i=this.groups;if(e.position){var n=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new We.BufferAttribute(new Float32Array(n.length),3));else for(var o=e.normal.array,r=0,a=o.length;r<a;r++)o[r]=0;var s,l,c,u=e.normal.array,h=new We.Vector3,d=new We.Vector3,p=new We.Vector3,f=new We.Vector3,m=new We.Vector3;if(t){var g=t.array;0===i.length&&this.addGroup(0,g.length);for(var v=0,y=i.length;v<y;++v){var b=i[v],w=b.start;for(r=w,a=w+b.count;r<a;r+=3)s=3*g[r+0],l=3*g[r+1],c=3*g[r+2],h.fromArray(n,s),d.fromArray(n,l),p.fromArray(n,c),f.subVectors(p,d),m.subVectors(h,d),f.cross(m),u[s]+=f.x,u[s+1]+=f.y,u[s+2]+=f.z,u[l]+=f.x,u[l+1]+=f.y,u[l+2]+=f.z,u[c]+=f.x,u[c+1]+=f.y,u[c+2]+=f.z}}else for(r=0,a=n.length;r<a;r+=9)h.fromArray(n,r),d.fromArray(n,r+3),p.fromArray(n,r+6),f.subVectors(p,d),m.subVectors(h,d),f.cross(m),u[r]=f.x,u[r+1]=f.y,u[r+2]=f.z,u[r+3]=f.x,u[r+4]=f.y,u[r+5]=f.z,u[r+6]=f.x,u[r+7]=f.y,u[r+8]=f.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t instanceof We.BufferGeometry!=0){void 0===e&&(e=0);var i=this.attributes;for(var n in i)if(void 0!==t.attributes[n])for(var o=i[n].array,r=t.attributes[n],a=r.array,s=0,l=r.itemSize*e;s<a.length;s++,l++)o[l]=a[s];return this}},normalizeNormals:function(){for(var t,e,i,n,o=this.attributes.normal.array,r=0,a=o.length;r<a;r+=3)t=o[r],e=o[r+1],i=o[r+2],n=1/Math.sqrt(t*t+e*e+i*i),o[r]*=n,o[r+1]*=n,o[r+2]*=n},toNonIndexed:function(){if(null===this.index)return this;var t=new We.BufferGeometry,e=this.index.array,i=this.attributes;for(var n in i){for(var o=i[n],r=o.array,a=o.itemSize,s=new r.constructor(e.length*a),l=0,c=0,u=0,h=e.length;u<h;u++){l=e[u]*a;for(var d=0;d<a;d++)s[c++]=r[l++]}t.addAttribute(n,new We.BufferAttribute(s,a))}return t},toJSON:function(){var t={metadata:{version:4.4,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var i in e)void 0!==e[i]&&(t[i]=e[i]);return t}t.data={attributes:{}};var n=this.index;if(null!==n){var o=Array.prototype.slice.call(n.array);t.data.index={type:n.array.constructor.name,array:o}}var r=this.attributes;for(var i in r){var a=r[i];o=Array.prototype.slice.call(a.array),t.data.attributes[i]={itemSize:a.itemSize,type:a.array.constructor.name,array:o}}var s=this.groups;0<s.length&&(t.data.groups=JSON.parse(JSON.stringify(s)));var l=this.boundingSphere;return null!==l&&(t.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),t},clone:function(){return(new We.BufferGeometry).copy(this)},copy:function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var i=t.attributes;for(var n in i){var o=i[n];this.addAttribute(n,o.clone())}for(var r=t.groups,a=0,s=r.length;a<s;a++){var l=r[a];this.addGroup(l.start,l.count)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}},We.EventDispatcher.prototype.apply(We.BufferGeometry.prototype),We.BufferGeometry.MaxIndex=65535,We.InstancedBufferGeometry=function(){We.BufferGeometry.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0},We.InstancedBufferGeometry.prototype=Object.create(We.BufferGeometry.prototype),We.InstancedBufferGeometry.prototype.constructor=We.InstancedBufferGeometry,We.InstancedBufferGeometry.prototype.addGroup=function(t,e,i){this.groups.push({start:t,count:e,instances:i})},We.InstancedBufferGeometry.prototype.copy=function(t){var e=t.index;null!==e&&this.setIndex(e.clone());var i=t.attributes;for(var n in i){var o=i[n];this.addAttribute(n,o.clone())}for(var r=t.groups,a=0,s=r.length;a<s;a++){var l=r[a];this.addGroup(l.start,l.count,l.instances)}return this},We.EventDispatcher.prototype.apply(We.InstancedBufferGeometry.prototype),We.Uniform=function(t,e){this.type=t,this.value=e,this.dynamic=!1},We.Uniform.prototype={constructor:We.Uniform,onUpdate:function(t){return this.dynamic=!0,this.onUpdateCallback=t,this}},We.AnimationClip=function(t,e,i){this.name=t||We.Math.generateUUID(),this.tracks=i,this.duration=void 0!==e?e:-1,this.duration<0&&this.resetDuration(),this.trim(),this.optimize()},We.AnimationClip.prototype={constructor:We.AnimationClip,resetDuration:function(){for(var t=0,e=0,i=this.tracks.length;e!==i;++e){var n=this.tracks[e];t=Math.max(t,n.times[n.times.length-1])}this.duration=t},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}},Object.assign(We.AnimationClip,{parse:function(t){for(var e=[],i=t.tracks,n=1/(t.fps||1),o=0,r=i.length;o!==r;++o)e.push(We.KeyframeTrack.parse(i[o]).scale(n));return new We.AnimationClip(t.name,t.duration,e)},toJSON:function(t){for(var e=[],i=t.tracks,n={name:t.name,duration:t.duration,tracks:e},o=0,r=i.length;o!==r;++o)e.push(We.KeyframeTrack.toJSON(i[o]));return n},CreateFromMorphTargetSequence:function(t,e,i){for(var n=e.length,o=[],r=0;r<n;r++){var a=[],s=[];a.push((r+n-1)%n,r,(r+1)%n),s.push(0,1,0);var l=We.AnimationUtils.getKeyframeOrder(a);a=We.AnimationUtils.sortedArray(a,1,l),s=We.AnimationUtils.sortedArray(s,1,l),0===a[0]&&(a.push(n),s.push(s[0])),o.push(new We.NumberKeyframeTrack(".morphTargetInfluences["+e[r].name+"]",a,s).scale(1/i))}return new We.AnimationClip(t,-1,o)},findByName:function(t,e){for(var i=0;i<t.length;i++)if(t[i].name===e)return t[i];return null},CreateClipsFromMorphTargetSequences:function(t,e){for(var i={},n=/^([\w-]*?)([\d]+)$/,o=0,r=t.length;o<r;o++){var a=t[o],s=a.name.match(n);if(s&&1<s.length){var l=i[u=s[1]];l||(i[u]=l=[]),l.push(a)}}var c=[];for(var u in i)c.push(We.AnimationClip.CreateFromMorphTargetSequence(u,i[u],e));return c},parseAnimation:function(t,e,i){if(!t)return null;for(var n=function(t,e,i,n,o){if(0!==i.length){var r=[],a=[];We.AnimationUtils.flattenJSON(i,r,a,n),0!==r.length&&o.push(new t(e,r,a))}},o=[],r=t.name||"default",a=t.length||-1,s=t.fps||30,l=t.hierarchy||[],c=0;c<l.length;c++){var u=l[c].keys;if(u&&0!=u.length)if(u[0].morphTargets){for(var h={},d=0;d<u.length;d++)if(u[d].morphTargets)for(var p=0;p<u[d].morphTargets.length;p++)h[u[d].morphTargets[p]]=-1;for(var f in h){var m=[],g=[];for(p=0;p!==u[d].morphTargets.length;++p){var v=u[d];m.push(v.time),g.push(v.morphTarget===f?1:0)}o.push(new We.NumberKeyframeTrack(".morphTargetInfluence["+f+"]",m,g))}a=h.length*(s||1)}else{var y=".bones["+e[c].name+"]";n(We.VectorKeyframeTrack,y+".position",u,"pos",o),n(We.QuaternionKeyframeTrack,y+".quaternion",u,"rot",o),n(We.VectorKeyframeTrack,y+".scale",u,"scl",o)}}return 0===o.length?null:new We.AnimationClip(r,a,o)}}),We.AnimationMixer=function(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1},We.AnimationMixer.prototype={constructor:We.AnimationMixer,clipAction:function(t,e){var i,n=(e||this._root).uuid,o="string"==typeof t?t:t.name,r=t!==o?t:null,a=this._actionsByClip[o];if(void 0!==a){var s=a.actionByRoot[n];if(void 0!==s)return s;if(r=(i=a.knownActions[0])._clip,t!==o&&t!==r)throw new Error("Different clips with the same name detected!")}if(null===r)return null;var l=new We.AnimationMixer._Action(this,r,e);return this._bindAction(l,i),this._addInactiveAction(l,o,n),l},existingAction:function(t,e){var i=(e||this._root).uuid,n="string"==typeof t?t:t.name,o=this._actionsByClip[n];return void 0!==o&&o.actionByRoot[i]||null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,i=this._bindings,n=this._nActiveBindings;this._nActiveActions=0;for(var o=this._nActiveBindings=0;o!==e;++o)t[o].reset();for(o=0;o!==n;++o)i[o].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,i=this._nActiveActions,n=this.time+=t,o=Math.sign(t),r=this._accuIndex^=1,a=0;a!==i;++a){var s=e[a];s.enabled&&s._update(n,t,o,r)}var l=this._bindings,c=this._nActiveBindings;for(a=0;a!==c;++a)l[a].apply(r);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,i=t.name,n=this._actionsByClip,o=n[i];if(void 0!==o){for(var r=o.knownActions,a=0,s=r.length;a!==s;++a){var l=r[a];this._deactivateAction(l);var c=l._cacheIndex,u=e[e.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,e[u._cacheIndex=c]=u,e.pop(),this._removeInactiveBindingsForAction(l)}delete n[i]}},uncacheRoot:function(t){var e=t.uuid,i=this._actionsByClip;for(var n in i){var o=i[n].actionByRoot[e];void 0!==o&&(this._deactivateAction(o),this._removeInactiveAction(o))}var r=this._bindingsByRootAndName[e];if(void 0!==r)for(var a in r){var s=r[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(t,e){var i=this.existingAction(t,e);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}},We.EventDispatcher.prototype.apply(We.AnimationMixer.prototype),We.AnimationMixer._Action=function(t,e,i){this._mixer=t,this._clip=e,this._localRoot=i||null;for(var n=e.tracks,o=n.length,r=new Array(o),a={endingStart:We.ZeroCurvatureEnding,endingEnd:We.ZeroCurvatureEnding},s=0;s!==o;++s){var l=n[s].createInterpolant(null);(r[s]=l).settings=a}this._interpolantSettings=a,this._interpolants=r,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=We.LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0},We.AnimationMixer._Action.prototype={constructor:We.AnimationMixer._Action,play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this._startTime,this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,i){if(this._mixer,t.fadeOut(e),this.fadeIn(e),i){var n=this._clip.duration,o=t._clip.duration,r=o/n,a=n/o;t.warp(1,r,e),this.warp(a,1,e)}return this},crossFadeTo:function(t,e,i){return t.crossFadeFrom(this,e,i)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._currentTimeScale,0,t)},warp:function(t,e,i){var n=this._mixer,o=n.time,r=this._timeScaleInterpolant,a=this.timeScale;null===r&&(r=n._lendControlInterpolant(),this._timeScaleInterpolant=r);var s=r.parameterPositions,l=r.sampleValues;return s[0]=o,s[1]=o+i,l[0]=t/a,l[1]=e/a,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,i,n){var o=this._startTime;if(null!==o){var r=(t-o)*i;if(r<0||0===i)return;this._startTime=null,e=i*r}e*=this._updateTimeScale(t);var a=this._updateTime(e),s=this._updateWeight(t);if(0<s)for(var l=this._interpolants,c=this._propertyBindings,u=0,h=l.length;u!==h;++u)l[u].evaluate(a),c[u].accumulate(n,s)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var i=this._weightInterpolant;if(null!==i){var n=i.evaluate(t)[0];e*=n,t>i.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var i=this._timeScaleInterpolant;null!==i&&(e*=i.evaluate(t)[0],t>i.parameterPositions[1]&&(this.stopWarping(),0===e?this.pause=!0:this.timeScale=e))}return this._effectiveTimeScale=e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var i=this._clip.duration,n=this.loop,o=this._loopCount,r=!1;switch(n){case We.LoopOnce:if(-1===o&&(this.loopCount=0,this._setEndings(!0,!0,!1)),i<=e)e=i;else{if(!(e<0))break;e=0}this.clampWhenFinished?this.pause=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1});break;case We.LoopPingPong:r=!0;case We.LoopRepeat:if(-1===o&&(0<t?(o=0,this._setEndings(!0,0===this.repetitions,r)):this._setEndings(0===this.repetitions,!0,r)),i<=e||e<0){var a=Math.floor(e/i);e-=i*a,o+=Math.abs(a);var s=this.repetitions-o;if(s<0){this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=0<t?i:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<t?1:-1});break}if(0===s){var l=t<0;this._setEndings(l,!l,r)}else this._setEndings(!1,!1,r);this._loopCount=o,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}if(n===We.LoopPingPong&&1==(1&o))return i-(this.time=e)}return this.time=e},_setEndings:function(t,e,i){var n=this._interpolantSettings;n.endingEnd=i?(n.endingStart=We.ZeroSlopeEnding,We.ZeroSlopeEnding):(n.endingStart=t?this.zeroSlopeAtStart?We.ZeroSlopeEnding:We.ZeroCurvatureEnding:We.WrapAroundEnding,e?this.zeroSlopeAtEnd?We.ZeroSlopeEnding:We.ZeroCurvatureEnding:We.WrapAroundEnding)},_scheduleFading:function(t,e,i){var n=this._mixer,o=n.time,r=this._weightInterpolant;null===r&&(r=n._lendControlInterpolant(),this._weightInterpolant=r);var a=r.parameterPositions,s=r.sampleValues;return a[0]=o,s[0]=e,a[1]=o+t,s[1]=i,this}},Object.assign(We.AnimationMixer.prototype,{_bindAction:function(t,e){var i=t._localRoot||this._root,n=t._clip.tracks,o=n.length,r=t._propertyBindings,a=t._interpolants,s=i.uuid,l=this._bindingsByRootAndName,c=l[s];void 0===c&&(c={},l[s]=c);for(var u=0;u!==o;++u){var h=n[u],d=h.name,p=c[d];if(void 0!==p)r[u]=p;else{if(void 0!==(p=r[u])){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,d));continue}var f=e&&e._propertyBindings[u].binding.parsedPath;++(p=new We.PropertyMixer(We.PropertyBinding.create(i,d,f),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(p,s,d),r[u]=p}a[u].resultBuffer=p.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,i=t._clip.name,n=this._actionsByClip[i];this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,i,e)}for(var o=t._propertyBindings,r=0,a=o.length;r!==a;++r){var s=o[r];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,i=0,n=e.length;i!==n;++i){var o=e[i];0==--o.useCount&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,i){var n=this._actions,o=this._actionsByClip,r=o[e];if(void 0===r)r={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,o[e]=r;else{var a=r.knownActions;t._byClipCacheIndex=a.length,a.push(t)}t._cacheIndex=n.length,n.push(t),r.actionByRoot[i]=t},_removeInactiveAction:function(t){var e=this._actions,i=e[e.length-1],n=t._cacheIndex;e[i._cacheIndex=n]=i,e.pop(),t._cacheIndex=null;var o=t._clip.name,r=this._actionsByClip,a=r[o],s=a.knownActions,l=s[s.length-1],c=t._byClipCacheIndex;s[l._byClipCacheIndex=c]=l,s.pop(),t._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete r[o],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,i=0,n=e.length;i!==n;++i){var o=e[i];0==--o.referenceCount&&this._removeInactiveBinding(o)}},_lendAction:function(t){var e=this._actions,i=t._cacheIndex,n=this._nActiveActions++,o=e[n];e[t._cacheIndex=n]=t,e[o._cacheIndex=i]=o},_takeBackAction:function(t){var e=this._actions,i=t._cacheIndex,n=--this._nActiveActions,o=e[n];e[t._cacheIndex=n]=t,e[o._cacheIndex=i]=o},_addInactiveBinding:function(t,e,i){var n=this._bindingsByRootAndName,o=n[e],r=this._bindings;void 0===o&&(o={},n[e]=o),(o[i]=t)._cacheIndex=r.length,r.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,i=t.binding,n=i.rootNode.uuid,o=i.path,r=this._bindingsByRootAndName,a=r[n],s=e[e.length-1],l=t._cacheIndex;e[s._cacheIndex=l]=s,e.pop(),delete a[o];t:{for(var c in a)break t;delete r[n]}},_lendBinding:function(t){var e=this._bindings,i=t._cacheIndex,n=this._nActiveBindings++,o=e[n];e[t._cacheIndex=n]=t,e[o._cacheIndex=i]=o},_takeBackBinding:function(t){var e=this._bindings,i=t._cacheIndex,n=--this._nActiveBindings,o=e[n];e[t._cacheIndex=n]=t,e[o._cacheIndex=i]=o},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,i=t[e];return void 0===i&&(t[(i=new We.LinearInterpolant(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e]=i),i},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,i=t.__cacheIndex,n=--this._nActiveControlInterpolants,o=e[n];e[t.__cacheIndex=n]=t,e[o.__cacheIndex=i]=o},_controlInterpolantsResultBuffer:new Float32Array(1)}),We.AnimationObjectGroup=function(t){this.uuid=We.Math.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var i=0,n=arguments.length;i!==n;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var o=this;this.stats={objects:{get total(){return o._objects.length},get inUse(){return this.total-o.nCachedObjects_}},get bindingsPerObject(){return o._bindings.length}}},We.AnimationObjectGroup.prototype={constructor:We.AnimationObjectGroup,add:function(t){for(var e=this._objects,i=e.length,n=this.nCachedObjects_,o=this._indicesByUUID,r=this._paths,a=this._parsedPaths,s=this._bindings,l=s.length,c=0,u=arguments.length;c!==u;++c){var h=arguments[c],d=h.uuid,p=o[d];if(void 0===p){p=i++,o[d]=p,e.push(h);for(var f=0,m=l;f!==m;++f)s[f].push(new We.PropertyBinding(h,r[f],a[f]))}else if(p<n){e[p];var g=--n,v=e[g];for(e[o[v.uuid]=p]=v,e[o[d]=g]=h,f=0,m=l;f!==m;++f){var y=s[f],b=y[g],w=y[p];y[p]=b,void 0===w&&(w=new We.PropertyBinding(h,r[f],a[f])),y[g]=w}}else e[p]}this.nCachedObjects_=n},remove:function(t){for(var e=this._objects,i=(e.length,this.nCachedObjects_),n=this._indicesByUUID,o=this._bindings,r=o.length,a=0,s=arguments.length;a!==s;++a){var l=arguments[a],c=l.uuid,u=n[c];if(void 0!==u&&i<=u){var h=i++,d=e[h];e[n[d.uuid]=u]=d,e[n[c]=h]=l;for(var p=0,f=r;p!==f;++p){var m=o[p],g=m[h],v=m[u];m[u]=g,m[h]=v}}}this.nCachedObjects_=i},uncache:function(t){for(var e=this._objects,i=e.length,n=this.nCachedObjects_,o=this._indicesByUUID,r=this._bindings,a=r.length,s=0,l=arguments.length;s!==l;++s){var c=arguments[s].uuid,u=o[c];if(void 0!==u)if(delete o[c],u<n){var h=--n,d=e[h],p=e[y=--i];e[o[d.uuid]=u]=d,e[o[p.uuid]=h]=p,e.pop();for(var f=0,m=a;f!==m;++f){var g=(b=r[f])[h],v=b[y];b[u]=g,b[h]=v,b.pop()}}else{var y;for(e[o[(p=e[y=--i]).uuid]=u]=p,e.pop(),f=0,m=a;f!==m;++f){var b;(b=r[f])[u]=b[y],b.pop()}}}this.nCachedObjects_=n},subscribe_:function(t,e){var i=this._bindingsIndicesByPath,n=i[t],o=this._bindings;if(void 0!==n)return o[n];var r=this._paths,a=this._parsedPaths,s=this._objects,l=s.length,c=this.nCachedObjects_,u=new Array(l);n=o.length,i[t]=n,r.push(t),a.push(e),o.push(u);for(var h=c,d=s.length;h!==d;++h){var p=s[h];u[h]=new We.PropertyBinding(p,t,e)}return u},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,i=e[t];if(void 0!==i){var n=this._paths,o=this._parsedPaths,r=this._bindings,a=r.length-1,s=r[a];r[e[t[a]]=i]=s,r.pop(),o[i]=o[a],o.pop(),n[i]=n[a],n.pop()}}},We.AnimationUtils={arraySlice:function(t,e,i){return We.AnimationUtils.isTypedArray(t)?new t.constructor(t.subarray(e,i)):t.slice(e,i)},convertArray:function(t,e,i){return!t||!i&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,i=new Array(e),n=0;n!==e;++n)i[n]=n;return i.sort(function(e,i){return t[e]-t[i]}),i},sortedArray:function(t,e,i){for(var n=t.length,o=new t.constructor(n),r=0,a=0;a!==n;++r)for(var s=i[r]*e,l=0;l!==e;++l)o[a++]=t[s+l];return o},flattenJSON:function(t,e,i,n){for(var o=1,r=t[0];void 0!==r&&void 0===r[n];)r=t[o++];if(void 0!==r){var a=r[n];if(void 0!==a)if(Array.isArray(a))for(;void 0!==(a=r[n])&&(e.push(r.time),i.push.apply(i,a)),void 0!==(r=t[o++]););else if(void 0!==a.toArray)for(;void 0!==(a=r[n])&&(e.push(r.time),a.toArray(i,i.length)),void 0!==(r=t[o++]););else for(;void 0!==(a=r[n])&&(e.push(r.time),i.push(a)),void 0!==(r=t[o++]););}}},We.KeyframeTrack=function(t,e,i,n){if(void 0===t)throw new Error("track name is undefined");if(void 0===e||0===e.length)throw new Error("no keyframes in track named "+t);this.name=t,this.times=We.AnimationUtils.convertArray(e,this.TimeBufferType),this.values=We.AnimationUtils.convertArray(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation),this.validate(),this.optimize()},We.KeyframeTrack.prototype={constructor:We.KeyframeTrack,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:We.InterpolateLinear,InterpolantFactoryMethodDiscrete:function(t){return new We.DiscreteInterpolant(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new We.LinearInterpolant(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new We.CubicInterpolant(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e=void 0;switch(t){case We.InterpolateDiscrete:e=this.InterpolantFactoryMethodDiscrete;break;case We.InterpolateLinear:e=this.InterpolantFactoryMethodLinear;break;case We.InterpolateSmooth:e=this.InterpolantFactoryMethodSmooth}if(void 0!==e)this.createInterpolant=e;else{var i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}}},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return We.InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return We.InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return We.InterpolateSmooth}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,i=0,n=e.length;i!==n;++i)e[i]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,i=0,n=e.length;i!==n;++i)e[i]*=t;return this},trim:function(t,e){for(var i=this.times,n=i.length,o=0,r=n-1;o!==n&&i[o]<t;)++o;for(;-1!==r&&i[r]>e;)--r;if(++r,0!==o||r!==n){r<=o&&(o=(r=Math.max(r,1))-1);var a=this.getValueSize();this.times=We.AnimationUtils.arraySlice(i,o,r),this.values=We.AnimationUtils.arraySlice(this.values,o*a,r*a)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(t=!1);var i=this.times,n=this.values,o=i.length;0===o&&(t=!1);for(var r=null,a=0;a!==o;a++){var s=i[a];if("number"==typeof s&&isNaN(s)){t=!1;break}if(null!==r&&s<r){t=!1;break}r=s}if(void 0!==n&&We.AnimationUtils.isTypedArray(n)){a=0;for(var l=n.length;a!==l;++a){var c=n[a];if(isNaN(c)){t=!1;break}}}return t},optimize:function(){for(var t=this.times,e=this.values,i=this.getValueSize(),n=1,o=1,r=t.length-1;o<=r;++o){var a=!1,s=t[o];if(s!==t[o+1]&&(1!==o||s!==s[0]))for(var l=o*i,c=l-i,u=l+i,h=0;h!==i;++h){var d=e[l+h];if(d!==e[c+h]||d!==e[u+h]){a=!0;break}}if(a){if(o!==n){t[n]=t[o];var p=o*i,f=n*i;for(h=0;h!==i;++h)e[f+h]=e[p+h]}++n}}return n!==t.length&&(this.times=We.AnimationUtils.arraySlice(t,0,n),this.values=We.AnimationUtils.arraySlice(e,0,n*i)),this}},Object.assign(We.KeyframeTrack,{parse:function(t){if(void 0===t.type)throw new Error("track type undefined, can not parse");var e=We.KeyframeTrack._getTrackTypeForValueTypeName(t.type);if(void 0===t.times){var i=[],n=[];We.AnimationUtils.flattenJSON(t.keys,i,n,"value"),t.times=i,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)},toJSON:function(t){var e,i=t.constructor;if(void 0!==i.toJSON)e=i.toJSON(t);else{e={name:t.name,times:We.AnimationUtils.convertArray(t.times,Array),values:We.AnimationUtils.convertArray(t.values,Array)};var n=t.getInterpolation();n!==t.DefaultInterpolation&&(e.interpolation=n)}return e.type=t.ValueTypeName,e},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return We.NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return We.VectorKeyframeTrack;case"color":return We.ColorKeyframeTrack;case"quaternion":return We.QuaternionKeyframeTrack;case"bool":case"boolean":return We.BooleanKeyframeTrack;case"string":return We.StringKeyframeTrack}throw new Error("Unsupported typeName: "+t)}}),We.PropertyBinding=function(t,e,i){this.path=e,this.parsedPath=i||We.PropertyBinding.parseTrackName(e),this.node=We.PropertyBinding.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t},We.PropertyBinding.prototype={constructor:We.PropertyBinding,getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,i=e.objectName,n=e.propertyName,o=e.propertyIndex;if(t||(t=We.PropertyBinding.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(i){var r=e.objectIndex;switch(i){case"materials":if(!t.material)return;if(!t.material.materials)return;t=t.material.materials;break;case"bones":if(!t.skeleton)return;t=t.skeleton.bones;for(var a=0;a<t.length;a++)if(t[a].name===r){r=a;break}break;default:if(void 0===t[i])return;t=t[i]}if(void 0!==r){if(void 0===t[r])return;t=t[r]}}var s=t[n];if(s){var l=this.Versioning.None;void 0!==t.needsUpdate?(l=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t);var c=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===n){if(!t.geometry)return;if(!t.geometry.morphTargets)return;for(a=0;a<this.node.geometry.morphTargets.length;a++)if(t.geometry.morphTargets[a].name===o){o=a;break}}c=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=o}else void 0!==s.fromArray&&void 0!==s.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=s):void 0!==s.length?(c=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][l]}else e.nodeName}},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}},Object.assign(We.PropertyBinding.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},_getValue_unbound:We.PropertyBinding.prototype.getValue,_setValue_unbound:We.PropertyBinding.prototype.setValue,BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var i=this.resolvedProperty,n=0,o=i.length;n!==o;++n)t[e++]=i[n]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.node[this.propertyName]=t[e]},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.node[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var i=this.resolvedProperty,n=0,o=i.length;n!==o;++n)i[n]=t[e++]},function(t,e){for(var i=this.resolvedProperty,n=0,o=i.length;n!==o;++n)i[n]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var i=this.resolvedProperty,n=0,o=i.length;n!==o;++n)i[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]]}),We.PropertyBinding.Composite=function(t,e,i){var n=i||We.PropertyBinding.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,n)},We.PropertyBinding.Composite.prototype={constructor:We.PropertyBinding.Composite,getValue:function(t,e){this.bind();var i=this._targetGroup.nCachedObjects_,n=this._bindings[i];void 0!==n&&n.getValue(t,e)},setValue:function(t,e){for(var i=this._bindings,n=this._targetGroup.nCachedObjects_,o=i.length;n!==o;++n)i[n].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}},We.PropertyBinding.create=function(t,e,i){return t instanceof We.AnimationObjectGroup?new We.PropertyBinding.Composite(t,e,i):new We.PropertyBinding(t,e,i)},We.PropertyBinding.parseTrackName=function(t){var e=/^(([\w]+\/)*)([\w-\d]+)?(\.([\w]+)(\[([\w\d\[\]\_.:\- ]+)\])?)?(\.([\w.]+)(\[([\w\d\[\]\_. ]+)\])?)$/,i=e.exec(t);if(!i)throw new Error("cannot parse trackName at all: "+t);i.index===e.lastIndex&&e.lastIndex++;var n={nodeName:i[3],objectName:i[5],objectIndex:i[7],propertyName:i[9],propertyIndex:i[11]};if(null===n.propertyName||0===n.propertyName.length)throw new Error("can not parse propertyName from trackName: "+t);return n},We.PropertyBinding.findNode=function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var i=function(t){for(var i=0;i<t.bones.length;i++){var n=t.bones[i];if(n.name===e)return n}return null}(t.skeleton);if(i)return i}if(t.children){var n=function(t){for(var i=0;i<t.length;i++){var o=t[i];if(o.name===e||o.uuid===e)return o;var r=n(o.children);if(r)return r}return null},o=n(t.children);if(o)return o}return null},We.PropertyMixer=function(t,e,i){this.binding=t,this.valueSize=i;var n,o=Float64Array;switch(e){case"quaternion":n=this._slerp;break;case"string":case"bool":o=Array,n=this._select;break;default:n=this._lerp}this.buffer=new o(4*i),this._mixBufferRegion=n,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0},We.PropertyMixer.prototype={constructor:We.PropertyMixer,accumulate:function(t,e){var i=this.buffer,n=this.valueSize,o=t*n+n,r=this.cumulativeWeight;if(0===r){for(var a=0;a!==n;++a)i[o+a]=i[a];r=e}else{var s=e/(r+=e);this._mixBufferRegion(i,o,0,s,n)}this.cumulativeWeight=r},apply:function(t){var e=this.valueSize,i=this.buffer,n=t*e+e,o=this.cumulativeWeight,r=this.binding;if(this.cumulativeWeight=0,o<1){var a=3*e;this._mixBufferRegion(i,n,a,1-o,e)}for(var s=e,l=e+e;s!==l;++s)if(i[s]!==i[s+e]){r.setValue(i,n);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,i=this.valueSize,n=3*i;t.getValue(e,n);for(var o=i,r=n;o!==r;++o)e[o]=e[n+o%i];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,i,n,o){if(.5<=n)for(var r=0;r!==o;++r)t[e+r]=t[i+r]},_slerp:function(t,e,i,n,o){We.Quaternion.slerpFlat(t,e,t,e,t,i,n)},_lerp:function(t,e,i,n,o){for(var r=1-n,a=0;a!==o;++a){var s=e+a;t[s]=t[s]*r+t[i+a]*n}}},We.BooleanKeyframeTrack=function(t,e,i){We.KeyframeTrack.call(this,t,e,i)},We.BooleanKeyframeTrack.prototype=Object.assign(Object.create(We.KeyframeTrack.prototype),{constructor:We.BooleanKeyframeTrack,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:We.IntepolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),We.NumberKeyframeTrack=function(t,e,i,n){We.KeyframeTrack.call(this,t,e,i,n)},We.NumberKeyframeTrack.prototype=Object.assign(Object.create(We.KeyframeTrack.prototype),{constructor:We.NumberKeyframeTrack,ValueTypeName:"number"}),We.QuaternionKeyframeTrack=function(t,e,i,n){We.KeyframeTrack.call(this,t,e,i,n)},We.QuaternionKeyframeTrack.prototype=Object.assign(Object.create(We.KeyframeTrack.prototype),{constructor:We.QuaternionKeyframeTrack,ValueTypeName:"quaternion",DefaultInterpolation:We.InterpolateLinear,InterpolantFactoryMethodLinear:function(t){return new We.QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),We.StringKeyframeTrack=function(t,e,i,n){We.KeyframeTrack.call(this,t,e,i,n)},We.StringKeyframeTrack.prototype=Object.assign(Object.create(We.KeyframeTrack.prototype),{constructor:We.StringKeyframeTrack,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:We.IntepolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),We.VectorKeyframeTrack=function(t,e,i,n){We.KeyframeTrack.call(this,t,e,i,n)},We.VectorKeyframeTrack.prototype=Object.assign(Object.create(We.KeyframeTrack.prototype),{constructor:We.VectorKeyframeTrack,ValueTypeName:"vector"}),We.Audio=function(t){We.Object3D.call(this),this.type="Audio",this.context=t.context,this.source=this.context.createBufferSource(),this.source.onended=this.onEnded.bind(this),this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.startTime=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filter=null},We.Audio.prototype=Object.create(We.Object3D.prototype),We.Audio.prototype.constructor=We.Audio,We.Audio.prototype.getOutput=function(){return this.gain},We.Audio.prototype.load=function(t){var e=new We.AudioBuffer(this.context);return e.load(t),this.setBuffer(e),this},We.Audio.prototype.setNodeSource=function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},We.Audio.prototype.setBuffer=function(t){var e=this;return t.onReady(function(t){e.source.buffer=t,e.sourceType="buffer",e.autoplay&&e.play()}),this},We.Audio.prototype.play=function(){if(!0!==this.isPlaying&&!1!==this.hasPlaybackControl){var t=this.context.createBufferSource();t.buffer=this.source.buffer,t.loop=this.source.loop,t.onended=this.source.onended,t.start(0,this.startTime),t.playbackRate.value=this.playbackRate,this.isPlaying=!0,this.source=t,this.connect()}},We.Audio.prototype.pause=function(){!1!==this.hasPlaybackControl&&(this.source.stop(),this.startTime=this.context.currentTime)},We.Audio.prototype.stop=function(){!1!==this.hasPlaybackControl&&(this.source.stop(),this.startTime=0)},We.Audio.prototype.connect=function(){null!==this.filter?(this.source.connect(this.filter),this.filter.connect(this.getOutput())):this.source.connect(this.getOutput())},We.Audio.prototype.disconnect=function(){null!==this.filter?(this.source.disconnect(this.filter),this.filter.disconnect(this.getOutput())):this.source.disconnect(this.getOutput())},We.Audio.prototype.getFilter=function(){return this.filter},We.Audio.prototype.setFilter=function(t){void 0===t&&(t=null),!0===this.isPlaying?(this.disconnect(),this.filter=t,this.connect()):this.filter=t},We.Audio.prototype.setPlaybackRate=function(t){!1!==this.hasPlaybackControl&&(this.playbackRate=t,!0===this.isPlaying&&(this.source.playbackRate.value=this.playbackRate))},We.Audio.prototype.getPlaybackRate=function(){return this.playbackRate},We.Audio.prototype.onEnded=function(){this.isPlaying=!1},We.Audio.prototype.setLoop=function(t){!1!==this.hasPlaybackControl&&(this.source.loop=t)},We.Audio.prototype.getLoop=function(){return!1!==this.hasPlaybackControl&&this.source.loop},We.Audio.prototype.setVolume=function(t){this.gain.gain.value=t},We.Audio.prototype.getVolume=function(){return this.gain.gain.value},We.AudioAnalyser=function(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)},We.AudioAnalyser.prototype={constructor:We.AudioAnalyser,getData:function(){return this.analyser.getByteFrequencyData(this.data),this.data}},We.AudioBuffer=function(t){this.context=t,this.ready=!1,this.readyCallbacks=[]},We.AudioBuffer.prototype.load=function(t){var e=this,i=new XMLHttpRequest;return i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(t){e.context.decodeAudioData(this.response,function(t){e.buffer=t,e.ready=!0;for(var i=0;i<e.readyCallbacks.length;i++)e.readyCallbacks[i](e.buffer);e.readyCallbacks=[]})},i.send(),this},We.AudioBuffer.prototype.onReady=function(t){this.ready?t(this.buffer):this.readyCallbacks.push(t)},We.PositionalAudio=function(t){We.Audio.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)},We.PositionalAudio.prototype=Object.create(We.Audio.prototype),We.PositionalAudio.prototype.constructor=We.PositionalAudio,We.PositionalAudio.prototype.getOutput=function(){return this.panner},We.PositionalAudio.prototype.setRefDistance=function(t){this.panner.refDistance=t},We.PositionalAudio.prototype.getRefDistance=function(){return this.panner.refDistance},We.PositionalAudio.prototype.setRolloffFactor=function(t){this.panner.rolloffFactor=t},We.PositionalAudio.prototype.getRolloffFactor=function(){return this.panner.rolloffFactor},We.PositionalAudio.prototype.setDistanceModel=function(t){this.panner.distanceModel=t},We.PositionalAudio.prototype.getDistanceModel=function(){return this.panner.distanceModel},We.PositionalAudio.prototype.setMaxDistance=function(t){this.panner.maxDistance=t},We.PositionalAudio.prototype.getMaxDistance=function(){return this.panner.maxDistance},We.PositionalAudio.prototype.updateMatrixWorld=(Zt=new We.Vector3,function(t){We.Object3D.prototype.updateMatrixWorld.call(this,t),Zt.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(Zt.x,Zt.y,Zt.z)}),We.AudioListener=function(){We.Object3D.call(this),this.type="AudioListener",this.context=new(window.AudioContext||window.webkitAudioContext),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null},We.AudioListener.prototype=Object.create(We.Object3D.prototype),We.AudioListener.prototype.constructor=We.AudioListener,We.AudioListener.prototype.getInput=function(){return this.gain},We.AudioListener.prototype.removeFilter=function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},We.AudioListener.prototype.setFilter=function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},We.AudioListener.prototype.getFilter=function(){return this.filter},We.AudioListener.prototype.setMasterVolume=function(t){this.gain.gain.value=t},We.AudioListener.prototype.getMasterVolume=function(){return this.gain.gain.value},We.AudioListener.prototype.updateMatrixWorld=(Kt=new We.Vector3,Jt=new We.Quaternion,te=new We.Vector3,ee=new We.Vector3,function(t){We.Object3D.prototype.updateMatrixWorld.call(this,t);var e=this.context.listener,i=this.up;this.matrixWorld.decompose(Kt,Jt,te),ee.set(0,0,-1).applyQuaternion(Jt),e.setPosition(Kt.x,Kt.y,Kt.z),e.setOrientation(ee.x,ee.y,ee.z,i.x,i.y,i.z)}),We.Camera=function(){We.Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new We.Matrix4,this.projectionMatrix=new We.Matrix4},We.Camera.prototype=Object.create(We.Object3D.prototype),We.Camera.prototype.constructor=We.Camera,We.Camera.prototype.getWorldDirection=(ie=new We.Quaternion,function(t){var e=t||new We.Vector3;return this.getWorldQuaternion(ie),e.set(0,0,-1).applyQuaternion(ie)}),We.Camera.prototype.lookAt=(ne=new We.Matrix4,function(t){ne.lookAt(this.position,t,this.up),this.quaternion.setFromRotationMatrix(ne)}),We.Camera.prototype.clone=function(){return(new this.constructor).copy(this)},We.Camera.prototype.copy=function(t){return We.Object3D.prototype.copy.call(this,t),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},We.CubeCamera=function(t,e,i){We.Object3D.call(this),this.type="CubeCamera";var n=new We.PerspectiveCamera(90,1,t,e);n.up.set(0,-1,0),n.lookAt(new We.Vector3(1,0,0)),this.add(n);var o=new We.PerspectiveCamera(90,1,t,e);o.up.set(0,-1,0),o.lookAt(new We.Vector3(-1,0,0)),this.add(o);var r=new We.PerspectiveCamera(90,1,t,e);r.up.set(0,0,1),r.lookAt(new We.Vector3(0,1,0)),this.add(r);var a=new We.PerspectiveCamera(90,1,t,e);a.up.set(0,0,-1),a.lookAt(new We.Vector3(0,-1,0)),this.add(a);var s=new We.PerspectiveCamera(90,1,t,e);s.up.set(0,-1,0),s.lookAt(new We.Vector3(0,0,1)),this.add(s);var l=new We.PerspectiveCamera(90,1,t,e);l.up.set(0,-1,0),l.lookAt(new We.Vector3(0,0,-1)),this.add(l);var c={format:We.RGBFormat,magFilter:We.LinearFilter,minFilter:We.LinearFilter};this.renderTarget=new We.WebGLRenderTargetCube(i,i,c),this.updateCubeMap=function(t,e){null===this.parent&&this.updateMatrixWorld();var i=this.renderTarget,c=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,i.activeCubeFace=0,t.render(e,n,i),i.activeCubeFace=1,t.render(e,o,i),i.activeCubeFace=2,t.render(e,r,i),i.activeCubeFace=3,t.render(e,a,i),i.activeCubeFace=4,t.render(e,s,i),i.texture.generateMipmaps=c,i.activeCubeFace=5,t.render(e,l,i),t.setRenderTarget(null)}},We.CubeCamera.prototype=Object.create(We.Object3D.prototype),We.CubeCamera.prototype.constructor=We.CubeCamera,We.OrthographicCamera=function(t,e,i,n,o,r){We.Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.left=t,this.right=e,this.top=i,this.bottom=n,this.near=void 0!==o?o:.1,this.far=void 0!==r?r:2e3,this.updateProjectionMatrix()},We.OrthographicCamera.prototype=Object.create(We.Camera.prototype),We.OrthographicCamera.prototype.constructor=We.OrthographicCamera,We.OrthographicCamera.prototype.updateProjectionMatrix=function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(i-t,i+t,n+e,n-e,this.near,this.far)},We.OrthographicCamera.prototype.copy=function(t){return We.Camera.prototype.copy.call(this,t),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this},We.OrthographicCamera.prototype.toJSON=function(t){var e=We.Object3D.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,e},We.PerspectiveCamera=function(t,e,i,n){We.Camera.call(this),this.type="PerspectiveCamera",this.focalLength=10,this.zoom=1,this.fov=void 0!==t?t:50,this.aspect=void 0!==e?e:1,this.near=void 0!==i?i:.1,this.far=void 0!==n?n:2e3,this.updateProjectionMatrix()},We.PerspectiveCamera.prototype=Object.create(We.Camera.prototype),We.PerspectiveCamera.prototype.constructor=We.PerspectiveCamera,We.PerspectiveCamera.prototype.setLens=function(t,e){void 0===e&&(e=24),this.fov=2*We.Math.radToDeg(Math.atan(e/(2*t))),this.updateProjectionMatrix()},We.PerspectiveCamera.prototype.setViewOffset=function(t,e,i,n,o,r){this.fullWidth=t,this.fullHeight=e,this.x=i,this.y=n,this.width=o,this.height=r,this.updateProjectionMatrix()},We.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var t=We.Math.radToDeg(2*Math.atan(Math.tan(.5*We.Math.degToRad(this.fov))/this.zoom));if(this.fullWidth){var e=this.fullWidth/this.fullHeight,i=Math.tan(We.Math.degToRad(.5*t))*this.near,n=-i,o=e*n,r=e*i,a=Math.abs(r-o),s=Math.abs(i-n);this.projectionMatrix.makeFrustum(o+this.x*a/this.fullWidth,o+(this.x+this.width)*a/this.fullWidth,i-(this.y+this.height)*s/this.fullHeight,i-this.y*s/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(t,this.aspect,this.near,this.far)},We.PerspectiveCamera.prototype.copy=function(t){return We.Camera.prototype.copy.call(this,t),this.focalLength=t.focalLength,this.zoom=t.zoom,this.fov=t.fov,this.aspect=t.aspect,this.near=t.near,this.far=t.far,this},We.PerspectiveCamera.prototype.toJSON=function(t){var e=We.Object3D.prototype.toJSON.call(this,t);return e.object.focalLength=this.focalLength,e.object.zoom=this.zoom,e.object.fov=this.fov,e.object.aspect=this.aspect,e.object.near=this.near,e.object.far=this.far,e},We.StereoCamera=function(){this.type="StereoCamera",this.aspect=1,this.cameraL=new We.PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new We.PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1},We.StereoCamera.prototype={constructor:We.StereoCamera,update:(ce=new We.Matrix4,ue=new We.Matrix4,function(t){if(oe!==t.focalLength||re!==t.fov||ae!==t.aspect*this.aspect||se!==t.near||le!==t.far){oe=t.focalLength,re=t.fov,ae=t.aspect*this.aspect,se=t.near,le=t.far;var e,i,n=t.projectionMatrix.clone(),o=.032*se/oe,r=se*Math.tan(We.Math.degToRad(.5*re));ue.elements[12]=-.032,ce.elements[12]=.032,e=-r*ae+o,i=r*ae+o,n.elements[0]=2*se/(i-e),n.elements[8]=(i+e)/(i-e),this.cameraL.projectionMatrix.copy(n),e=-r*ae-o,i=r*ae-o,n.elements[0]=2*se/(i-e),n.elements[8]=(i+e)/(i-e),this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(ue),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(ce)})},We.Light=function(t,e){We.Object3D.call(this),this.type="Light",this.color=new We.Color(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0},We.Light.prototype=Object.create(We.Object3D.prototype),We.Light.prototype.constructor=We.Light,We.Light.prototype.copy=function(t){return We.Object3D.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},We.Light.prototype.toJSON=function(t){var e=We.Object3D.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),e},We.LightShadow=function(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new We.Vector2(512,512),this.map=null,this.matrix=new We.Matrix4},We.LightShadow.prototype={constructor:We.LightShadow,copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)}},We.AmbientLight=function(t,e){We.Light.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0},We.AmbientLight.prototype=Object.create(We.Light.prototype),We.AmbientLight.prototype.constructor=We.AmbientLight,We.DirectionalLight=function(t,e){We.Light.call(this,t,e),this.type="DirectionalLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new We.Object3D,this.shadow=new We.LightShadow(new We.OrthographicCamera(-5,5,5,-5,.5,500))},We.DirectionalLight.prototype=Object.create(We.Light.prototype),We.DirectionalLight.prototype.constructor=We.DirectionalLight,We.DirectionalLight.prototype.copy=function(t){return We.Light.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this},We.HemisphereLight=function(t,e,i){We.Light.call(this,t,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.set(0,1,0),this.updateMatrix(),this.groundColor=new We.Color(e)},We.HemisphereLight.prototype=Object.create(We.Light.prototype),We.HemisphereLight.prototype.constructor=We.HemisphereLight,We.HemisphereLight.prototype.copy=function(t){return We.Light.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this},We.PointLight=function(t,e,i,n){We.Light.call(this,t,e),this.type="PointLight",this.distance=void 0!==i?i:0,this.decay=void 0!==n?n:1,this.shadow=new We.LightShadow(new We.PerspectiveCamera(90,1,.5,500))},We.PointLight.prototype=Object.create(We.Light.prototype),We.PointLight.prototype.constructor=We.PointLight,Object.defineProperty(We.PointLight.prototype,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),We.PointLight.prototype.copy=function(t){return We.Light.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this},We.SpotLight=function(t,e,i,n,o,r){We.Light.call(this,t,e),this.type="SpotLight",this.position.set(0,1,0),this.updateMatrix(),this.target=new We.Object3D,this.distance=void 0!==i?i:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==o?o:0,this.decay=void 0!==r?r:1,this.shadow=new We.LightShadow(new We.PerspectiveCamera(50,1,.5,500))},We.SpotLight.prototype=Object.create(We.Light.prototype),We.SpotLight.prototype.constructor=We.SpotLight,Object.defineProperty(We.SpotLight.prototype,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),We.SpotLight.prototype.copy=function(t){return We.Light.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this},We.Cache={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},We.Loader=function(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}},We.Loader.prototype={constructor:We.Loader,crossOrigin:void 0,extractUrlBase:function(t){var e=t.split("/");return 1===e.length?"./":(e.pop(),e.join("/")+"/")},initMaterials:function(t,e,i){for(var n=[],o=0;o<t.length;++o)n[o]=this.createMaterial(t[o],e,i);return n},createMaterial:function(t,e,i){void 0===he&&(he=new We.Color),void 0===de&&(de=new We.TextureLoader),void 0===pe&&(pe=new We.MaterialLoader);var n={};function o(t,o,r,a,s){var l,c=e+t,u=We.Loader.Handlers.get(c);l=null!==u?u.load(c):(de.setCrossOrigin(i),de.load(c)),void 0!==o&&(l.repeat.fromArray(o),1!==o[0]&&(l.wrapS=We.RepeatWrapping),1!==o[1]&&(l.wrapT=We.RepeatWrapping)),void 0!==r&&l.offset.fromArray(r),void 0!==a&&("repeat"===a[0]&&(l.wrapS=We.RepeatWrapping),"mirror"===a[0]&&(l.wrapS=We.MirroredRepeatWrapping),"repeat"===a[1]&&(l.wrapT=We.RepeatWrapping),"mirror"===a[1]&&(l.wrapT=We.MirroredRepeatWrapping)),void 0!==s&&(l.anisotropy=s);var h=We.Math.generateUUID();return n[h]=l,h}var r={uuid:We.Math.generateUUID(),type:"MeshLambertMaterial"};for(var a in t){var s=t[a];switch(a){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":r.name=s;break;case"blending":r.blending=We[s];break;case"colorAmbient":case"mapAmbient":break;case"colorDiffuse":r.color=he.fromArray(s).getHex();break;case"colorSpecular":r.specular=he.fromArray(s).getHex();break;case"colorEmissive":r.emissive=he.fromArray(s).getHex();break;case"specularCoef":r.shininess=s;break;case"shading":"basic"===s.toLowerCase()&&(r.type="MeshBasicMaterial"),"phong"===s.toLowerCase()&&(r.type="MeshPhongMaterial");break;case"mapDiffuse":r.map=o(s,t.mapDiffuseRepeat,t.mapDiffuseOffset,t.mapDiffuseWrap,t.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapLight":r.lightMap=o(s,t.mapLightRepeat,t.mapLightOffset,t.mapLightWrap,t.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":r.aoMap=o(s,t.mapAORepeat,t.mapAOOffset,t.mapAOWrap,t.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":r.bumpMap=o(s,t.mapBumpRepeat,t.mapBumpOffset,t.mapBumpWrap,t.mapBumpAnisotropy);break;case"mapBumpScale":r.bumpScale=s;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":r.normalMap=o(s,t.mapNormalRepeat,t.mapNormalOffset,t.mapNormalWrap,t.mapNormalAnisotropy);break;case"mapNormalFactor":r.normalScale=[s,s];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":r.specularMap=o(s,t.mapSpecularRepeat,t.mapSpecularOffset,t.mapSpecularWrap,t.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapAlpha":r.alphaMap=o(s,t.mapAlphaRepeat,t.mapAlphaOffset,t.mapAlphaWrap,t.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":r.side=We.BackSide;break;case"doubleSided":r.side=We.DoubleSide;break;case"transparency":r.opacity=s;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":r[a]=s;break;case"vertexColors":!0===s&&(r.vertexColors=We.VertexColors),"face"===s&&(r.vertexColors=We.FaceColors)}}return"MeshBasicMaterial"===r.type&&delete r.emissive,"MeshPhongMaterial"!==r.type&&delete r.specular,r.opacity<1&&(r.transparent=!0),pe.setTextures(n),pe.parse(r)}},We.Loader.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,i=0,n=e.length;i<n;i+=2){var o=e[i],r=e[i+1];if(o.test(t))return r}return null}},We.XHRLoader=function(t){this.manager=void 0!==t?t:We.DefaultLoadingManager},We.XHRLoader.prototype={constructor:We.XHRLoader,load:function(t,e,i,n){void 0!==this.path&&(t=this.path+t);var o=this,r=We.Cache.get(t);if(void 0!==r)return e&&setTimeout(function(){e(r)},0),r;var a=new XMLHttpRequest;return a.overrideMimeType("text/plain"),a.open("GET",t,!0),a.addEventListener("load",function(i){var r=i.target.response;We.Cache.add(t,r),200===this.status?(e&&e(r),o.manager.itemEnd(t)):0===this.status?(e&&e(r),o.manager.itemEnd(t)):(n&&n(i),o.manager.itemError(t))},!1),void 0!==i&&a.addEventListener("progress",function(t){i(t)},!1),a.addEventListener("error",function(e){n&&n(e),o.manager.itemError(t)},!1),void 0!==this.responseType&&(a.responseType=this.responseType),void 0!==this.withCredentials&&(a.withCredentials=this.withCredentials),a.send(null),o.manager.itemStart(t),a},setPath:function(t){this.path=t},setResponseType:function(t){this.responseType=t},setWithCredentials:function(t){this.withCredentials=t}},We.FontLoader=function(t){this.manager=void 0!==t?t:We.DefaultLoadingManager},We.FontLoader.prototype={constructor:We.FontLoader,load:function(t,e,i,n){new We.XHRLoader(this.manager).load(t,function(t){e(new We.Font(JSON.parse(t.substring(65,t.length-2))))},i,n)}},We.ImageLoader=function(t){this.manager=void 0!==t?t:We.DefaultLoadingManager},We.ImageLoader.prototype={constructor:We.ImageLoader,load:function(t,e,i,n){void 0!==this.path&&(t=this.path+t);var o=this,r=We.Cache.get(t);if(void 0!==r)return o.manager.itemStart(t),e?setTimeout(function(){e(r),o.manager.itemEnd(t)},0):o.manager.itemEnd(t),r;var a=document.createElement("img");return a.addEventListener("load",function(i){We.Cache.add(t,this),e&&e(this),o.manager.itemEnd(t)},!1),void 0!==i&&a.addEventListener("progress",function(t){i(t)},!1),a.addEventListener("error",function(e){n&&n(e),o.manager.itemError(t)},!1),void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),o.manager.itemStart(t),a.src=t,a},setCrossOrigin:function(t){this.crossOrigin=t},setPath:function(t){this.path=t}},We.JSONLoader=function(t){"boolean"==typeof t&&(t=void 0),this.manager=void 0!==t?t:We.DefaultLoadingManager,this.withCredentials=!1},We.JSONLoader.prototype={constructor:We.JSONLoader,get statusDomElement(){return void 0===this._statusDomElement&&(this._statusDomElement=document.createElement("div")),this._statusDomElement},load:function(t,e,i,n){var o=this,r=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:We.Loader.prototype.extractUrlBase(t),a=new We.XHRLoader(this.manager);a.setWithCredentials(this.withCredentials),a.load(t,function(t){var i=JSON.parse(t),n=i.metadata;if(void 0!==n){var a=n.type;if(void 0!==a){if("object"===a.toLowerCase())return;if("scene"===a.toLowerCase())return}}var s=o.parse(i,r);e(s.geometry,s.materials)},i,n)},setTexturePath:function(t){this.texturePath=t},parse:function(t,e){var i=new We.Geometry,n=void 0!==t.scale?1/t.scale:1;if(function(e){function n(t,e){return t&1<<e}var o,r,a,s,l,c,u,h,d,p,f,m,g,v,y,b,w,x,_,S,T,M,I,P,C,A,E,L=t.faces,D=t.vertices,k=t.normals,R=t.colors,O=0;if(void 0!==t.uvs){for(o=0;o<t.uvs.length;o++)t.uvs[o].length&&O++;for(o=0;o<O;o++)i.faceVertexUvs[o]=[]}for(s=0,l=D.length;s<l;)(x=new We.Vector3).x=D[s++]*e,x.y=D[s++]*e,x.z=D[s++]*e,i.vertices.push(x);for(s=0,l=L.length;s<l;)if(f=n(p=L[s++],0),m=n(p,1),g=n(p,3),v=n(p,4),y=n(p,5),b=n(p,6),w=n(p,7),f){if((S=new We.Face3).a=L[s],S.b=L[s+1],S.c=L[s+3],(T=new We.Face3).a=L[s+1],T.b=L[s+2],T.c=L[s+3],s+=4,m&&(d=L[s++],S.materialIndex=d,T.materialIndex=d),a=i.faces.length,g)for(o=0;o<O;o++)for(P=t.uvs[o],i.faceVertexUvs[o][a]=[],i.faceVertexUvs[o][a+1]=[],r=0;r<4;r++)A=P[2*(h=L[s++])],E=P[2*h+1],C=new We.Vector2(A,E),2!==r&&i.faceVertexUvs[o][a].push(C),0!==r&&i.faceVertexUvs[o][a+1].push(C);if(v&&(u=3*L[s++],S.normal.set(k[u++],k[u++],k[u]),T.normal.copy(S.normal)),y)for(o=0;o<4;o++)u=3*L[s++],I=new We.Vector3(k[u++],k[u++],k[u]),2!==o&&S.vertexNormals.push(I),0!==o&&T.vertexNormals.push(I);if(b&&(M=R[c=L[s++]],S.color.setHex(M),T.color.setHex(M)),w)for(o=0;o<4;o++)M=R[c=L[s++]],2!==o&&S.vertexColors.push(new We.Color(M)),0!==o&&T.vertexColors.push(new We.Color(M));i.faces.push(S),i.faces.push(T)}else{if((_=new We.Face3).a=L[s++],_.b=L[s++],_.c=L[s++],m&&(d=L[s++],_.materialIndex=d),a=i.faces.length,g)for(o=0;o<O;o++)for(P=t.uvs[o],i.faceVertexUvs[o][a]=[],r=0;r<3;r++)A=P[2*(h=L[s++])],E=P[2*h+1],C=new We.Vector2(A,E),i.faceVertexUvs[o][a].push(C);if(v&&(u=3*L[s++],_.normal.set(k[u++],k[u++],k[u])),y)for(o=0;o<3;o++)u=3*L[s++],I=new We.Vector3(k[u++],k[u++],k[u]),_.vertexNormals.push(I);if(b&&(c=L[s++],_.color.setHex(R[c])),w)for(o=0;o<3;o++)c=L[s++],_.vertexColors.push(new We.Color(R[c]));i.faces.push(_)}}(n),function(){var e=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var n=0,o=t.skinWeights.length;n<o;n+=e){var r=t.skinWeights[n],a=1<e?t.skinWeights[n+1]:0,s=2<e?t.skinWeights[n+2]:0,l=3<e?t.skinWeights[n+3]:0;i.skinWeights.push(new We.Vector4(r,a,s,l))}if(t.skinIndices)for(n=0,o=t.skinIndices.length;n<o;n+=e){var c=t.skinIndices[n],u=1<e?t.skinIndices[n+1]:0,h=2<e?t.skinIndices[n+2]:0,d=3<e?t.skinIndices[n+3]:0;i.skinIndices.push(new We.Vector4(c,u,h,d))}i.bones=t.bones,i.bones&&0<i.bones.length&&(i.skinWeights.length!==i.skinIndices.length||(i.skinIndices.length,i.vertices.length))}(),function(e){if(void 0!==t.morphTargets)for(var n=0,o=t.morphTargets.length;n<o;n++){i.morphTargets[n]={},i.morphTargets[n].name=t.morphTargets[n].name,i.morphTargets[n].vertices=[];for(var r=i.morphTargets[n].vertices,a=t.morphTargets[n].vertices,s=0,l=a.length;s<l;s+=3){var c=new We.Vector3;c.x=a[s]*e,c.y=a[s+1]*e,c.z=a[s+2]*e,r.push(c)}}if(void 0!==t.morphColors&&0<t.morphColors.length){var u=i.faces,h=t.morphColors[0].colors;for(n=0,o=u.length;n<o;n++)u[n].color.fromArray(h,3*n)}}(n),function(){var e=[],n=[];void 0!==t.animation&&n.push(t.animation),void 0!==t.animations&&(t.animations.length?n=n.concat(t.animations):n.push(t.animations));for(var o=0;o<n.length;o++){var r=We.AnimationClip.parseAnimation(n[o],i.bones);r&&e.push(r)}if(i.morphTargets){var a=We.AnimationClip.CreateClipsFromMorphTargetSequences(i.morphTargets,10);e=e.concat(a)}0<e.length&&(i.animations=e)}(),i.computeFaceNormals(),i.computeBoundingSphere(),void 0===t.materials||0===t.materials.length)return{geometry:i};var o=We.Loader.prototype.initMaterials(t.materials,e,this.crossOrigin);return{geometry:i,materials:o}}},We.LoadingManager=function(t,e,i){var n=this,o=!1,r=0,a=0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(t){a++,!1===o&&void 0!==n.onStart&&n.onStart(t,r,a),o=!0},this.itemEnd=function(t){r++,void 0!==n.onProgress&&n.onProgress(t,r,a),r===a&&(o=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(t){void 0!==n.onError&&n.onError(t)}},We.DefaultLoadingManager=new We.LoadingManager,We.BufferGeometryLoader=function(t){this.manager=void 0!==t?t:We.DefaultLoadingManager},We.BufferGeometryLoader.prototype={constructor:We.BufferGeometryLoader,load:function(t,e,i,n){var o=this;new We.XHRLoader(o.manager).load(t,function(t){e(o.parse(JSON.parse(t)))},i,n)},parse:function(t){var e=new We.BufferGeometry,i=t.data.index,n={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};if(void 0!==i){var o=new n[i.type](i.array);e.setIndex(new We.BufferAttribute(o,1))}var r=t.data.attributes;for(var a in r){var s=r[a];o=new n[s.type](s.array),e.addAttribute(a,new We.BufferAttribute(o,s.itemSize))}var l=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==l)for(var c=0,u=l.length;c!==u;++c){var h=l[c];e.addGroup(h.start,h.count,h.materialIndex)}var d=t.data.boundingSphere;if(void 0!==d){var p=new We.Vector3;void 0!==d.center&&p.fromArray(d.center),e.boundingSphere=new We.Sphere(p,d.radius)}return e}},We.MaterialLoader=function(t){this.manager=void 0!==t?t:We.DefaultLoadingManager,this.textures={}},We.MaterialLoader.prototype={constructor:We.MaterialLoader,load:function(t,e,i,n){var o=this;new We.XHRLoader(o.manager).load(t,function(t){e(o.parse(JSON.parse(t)))},i,n)},setTextures:function(t){this.textures=t},getTexture:function(t){var e=this.textures;return e[t],e[t]},parse:function(t){var e=new We[t.type];if(void 0!==t.uuid&&(e.uuid=t.uuid),void 0!==t.name&&(e.name=t.name),void 0!==t.color&&e.color.setHex(t.color),void 0!==t.roughness&&(e.roughness=t.roughness),void 0!==t.metalness&&(e.metalness=t.metalness),void 0!==t.emissive&&e.emissive.setHex(t.emissive),void 0!==t.specular&&e.specular.setHex(t.specular),void 0!==t.shininess&&(e.shininess=t.shininess),void 0!==t.uniforms&&(e.uniforms=t.uniforms),void 0!==t.vertexShader&&(e.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(e.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(e.vertexColors=t.vertexColors),void 0!==t.shading&&(e.shading=t.shading),void 0!==t.blending&&(e.blending=t.blending),void 0!==t.side&&(e.side=t.side),void 0!==t.opacity&&(e.opacity=t.opacity),void 0!==t.transparent&&(e.transparent=t.transparent),void 0!==t.alphaTest&&(e.alphaTest=t.alphaTest),void 0!==t.depthTest&&(e.depthTest=t.depthTest),void 0!==t.depthWrite&&(e.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(e.colorWrite=t.colorWrite),void 0!==t.wireframe&&(e.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(e.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.size&&(e.size=t.size),void 0!==t.sizeAttenuation&&(e.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(e.map=this.getTexture(t.map)),void 0!==t.alphaMap&&(e.alphaMap=this.getTexture(t.alphaMap),e.transparent=!0),void 0!==t.bumpMap&&(e.bumpMap=this.getTexture(t.bumpMap)),void 0!==t.bumpScale&&(e.bumpScale=t.bumpScale),void 0!==t.normalMap&&(e.normalMap=this.getTexture(t.normalMap)),void 0!==t.normalScale){var i=t.normalScale;!1===Array.isArray(i)&&(i=[i,i]),e.normalScale=(new We.Vector2).fromArray(i)}if(void 0!==t.displacementMap&&(e.displacementMap=this.getTexture(t.displacementMap)),void 0!==t.displacementScale&&(e.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(e.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(e.roughnessMap=this.getTexture(t.roughnessMap)),void 0!==t.metalnessMap&&(e.metalnessMap=this.getTexture(t.metalnessMap)),void 0!==t.emissiveMap&&(e.emissiveMap=this.getTexture(t.emissiveMap)),void 0!==t.emissiveIntensity&&(e.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(e.specularMap=this.getTexture(t.specularMap)),void 0!==t.envMap&&(e.envMap=this.getTexture(t.envMap),e.combine=We.MultiplyOperation),t.reflectivity&&(e.reflectivity=t.reflectivity),void 0!==t.lightMap&&(e.lightMap=this.getTexture(t.lightMap)),void 0!==t.lightMapIntensity&&(e.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(e.aoMap=this.getTexture(t.aoMap)),void 0!==t.aoMapIntensity&&(e.aoMapIntensity=t.aoMapIntensity),void 0!==t.materials)for(var n=0,o=t.materials.length;n<o;n++)e.materials.push(this.parse(t.materials[n]));return e}},We.ObjectLoader=function(t){this.manager=void 0!==t?t:We.DefaultLoadingManager,this.texturePath=""},We.ObjectLoader.prototype={constructor:We.ObjectLoader,load:function(t,e,i,n){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var o=this;new We.XHRLoader(o.manager).load(t,function(t){o.parse(JSON.parse(t),e)},i,n)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var i=this.parseGeometries(t.geometries),n=this.parseImages(t.images,function(){void 0!==e&&e(a)}),o=this.parseTextures(t.textures,n),r=this.parseMaterials(t.materials,o),a=this.parseObject(t.object,i,r);return t.animations&&(a.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(a),a},parseGeometries:function(t){var e={};if(void 0!==t)for(var i=new We.JSONLoader,n=new We.BufferGeometryLoader,o=0,r=t.length;o<r;o++){var a,s=t[o];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new We[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new We[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new We[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new We[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new We[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":a=new We.DodecahedronGeometry(s.radius,s.detail);break;case"IcosahedronGeometry":a=new We.IcosahedronGeometry(s.radius,s.detail);break;case"OctahedronGeometry":a=new We.OctahedronGeometry(s.radius,s.detail);break;case"TetrahedronGeometry":a=new We.TetrahedronGeometry(s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new We[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new We[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new We[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"LatheGeometry":a=new We.LatheGeometry(s.points,s.segments,s.phiStart,s.phiLength);break;case"BufferGeometry":a=n.parse(s);break;case"Geometry":a=i.parse(s.data,this.texturePath).geometry;break;default:continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),e[s.uuid]=a}return e},parseMaterials:function(t,e){var i={};if(void 0!==t){var n=new We.MaterialLoader;n.setTextures(e);for(var o=0,r=t.length;o<r;o++){var a=n.parse(t[o]);i[a.uuid]=a}}return i},parseAnimations:function(t){for(var e=[],i=0;i<t.length;i++){var n=We.AnimationClip.parse(t[i]);e.push(n)}return e},parseImages:function(t,e){var i=this,n={};function o(t){return i.manager.itemStart(t),a.load(t,function(){i.manager.itemEnd(t)})}if(void 0!==t&&0<t.length){var r=new We.LoadingManager(e),a=new We.ImageLoader(r);a.setCrossOrigin(this.crossOrigin);for(var s=0,l=t.length;s<l;s++){var c=t[s],u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:i.texturePath+c.url;n[c.uuid]=o(u)}}return n},parseTextures:function(t,e){function i(t){return"number"==typeof t?t:We[t]}var n={};if(void 0!==t)for(var o=0,r=t.length;o<r;o++){var a=t[o];a.image,e[a.image];var s=new We.Texture(e[a.image]);s.needsUpdate=!0,s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.mapping&&(s.mapping=i(a.mapping)),void 0!==a.offset&&(s.offset=new We.Vector2(a.offset[0],a.offset[1])),void 0!==a.repeat&&(s.repeat=new We.Vector2(a.repeat[0],a.repeat[1])),void 0!==a.minFilter&&(s.minFilter=i(a.minFilter)),void 0!==a.magFilter&&(s.magFilter=i(a.magFilter)),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),Array.isArray(a.wrap)&&(s.wrapS=i(a.wrap[0]),s.wrapT=i(a.wrap[1])),n[a.uuid]=s}return n},parseObject:(fe=new We.Matrix4,function(t,e,i){var n;function o(t){return e[t],e[t]}function r(t){if(void 0!==t)return i[t],i[t]}switch(t.type){case"Scene":n=new We.Scene;break;case"PerspectiveCamera":n=new We.PerspectiveCamera(t.fov,t.aspect,t.near,t.far);break;case"OrthographicCamera":n=new We.OrthographicCamera(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":n=new We.AmbientLight(t.color,t.intensity);break;case"DirectionalLight":n=new We.DirectionalLight(t.color,t.intensity);break;case"PointLight":n=new We.PointLight(t.color,t.intensity,t.distance,t.decay);break;case"SpotLight":n=new We.SpotLight(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":n=new We.HemisphereLight(t.color,t.groundColor,t.intensity);break;case"Mesh":var a=o(t.geometry),s=r(t.material);n=a.bones&&0<a.bones.length?new We.SkinnedMesh(a,s):new We.Mesh(a,s);break;case"LOD":n=new We.LOD;break;case"Line":n=new We.Line(o(t.geometry),r(t.material),t.mode);break;case"PointCloud":case"Points":n=new We.Points(o(t.geometry),r(t.material));break;case"Sprite":n=new We.Sprite(r(t.material));break;case"Group":n=new We.Group;break;default:n=new We.Object3D}if(n.uuid=t.uuid,void 0!==t.name&&(n.name=t.name),void 0!==t.matrix?(fe.fromArray(t.matrix),fe.decompose(n.position,n.quaternion,n.scale)):(void 0!==t.position&&n.position.fromArray(t.position),void 0!==t.rotation&&n.rotation.fromArray(t.rotation),void 0!==t.scale&&n.scale.fromArray(t.scale)),void 0!==t.castShadow&&(n.castShadow=t.castShadow),void 0!==t.receiveShadow&&(n.receiveShadow=t.receiveShadow),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.children)for(var l in t.children)n.add(this.parseObject(t.children[l],e,i));if("LOD"===t.type)for(var c=t.levels,u=0;u<c.length;u++){var h=c[u];void 0!==(l=n.getObjectByProperty("uuid",h.object))&&n.addLevel(l,h.distance)}return n})},We.TextureLoader=function(t){this.manager=void 0!==t?t:We.DefaultLoadingManager},We.TextureLoader.prototype={constructor:We.TextureLoader,load:function(t,e,i,n){var o=new We.Texture,r=new We.ImageLoader(this.manager);return r.setCrossOrigin(this.crossOrigin),r.setPath(this.path),r.load(t,function(t){o.image=t,o.needsUpdate=!0,void 0!==e&&e(o)},i,n),o},setCrossOrigin:function(t){this.crossOrigin=t},setPath:function(t){this.path=t}},We.CubeTextureLoader=function(t){this.manager=void 0!==t?t:We.DefaultLoadingManager},We.CubeTextureLoader.prototype={constructor:We.CubeTextureLoader,load:function(t,e,i,n){var o=new We.CubeTexture,r=new We.ImageLoader(this.manager);r.setCrossOrigin(this.crossOrigin),r.setPath(this.path);var a=0;function s(i){r.load(t[i],function(t){o.images[i]=t,6==++a&&(o.needsUpdate=!0,e&&e(o))},void 0,n)}for(var l=0;l<t.length;++l)s(l);return o},setCrossOrigin:function(t){this.crossOrigin=t},setPath:function(t){this.path=t}},We.DataTextureLoader=We.BinaryTextureLoader=function(t){this.manager=void 0!==t?t:We.DefaultLoadingManager,this._parser=null},We.BinaryTextureLoader.prototype={constructor:We.BinaryTextureLoader,load:function(t,e,i,n){var o=this,r=new We.DataTexture,a=new We.XHRLoader(this.manager);return a.setResponseType("arraybuffer"),a.load(t,function(t){var i=o._parser(t);i&&(void 0!==i.image?r.image=i.image:void 0!==i.data&&(r.image.width=i.width,r.image.height=i.height,r.image.data=i.data),r.wrapS=void 0!==i.wrapS?i.wrapS:We.ClampToEdgeWrapping,r.wrapT=void 0!==i.wrapT?i.wrapT:We.ClampToEdgeWrapping,r.magFilter=void 0!==i.magFilter?i.magFilter:We.LinearFilter,r.minFilter=void 0!==i.minFilter?i.minFilter:We.LinearMipMapLinearFilter,r.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,void 0!==i.format&&(r.format=i.format),void 0!==i.type&&(r.type=i.type),void 0!==i.mipmaps&&(r.mipmaps=i.mipmaps),1===i.mipmapCount&&(r.minFilter=We.LinearFilter),r.needsUpdate=!0,e&&e(r,i))},i,n),r}},We.CompressedTextureLoader=function(t){this.manager=void 0!==t?t:We.DefaultLoadingManager,this._parser=null},We.CompressedTextureLoader.prototype={constructor:We.CompressedTextureLoader,load:function(t,e,i,n){var o=this,r=[],a=new We.CompressedTexture;a.image=r;var s=new We.XHRLoader(this.manager);function l(l){s.load(t[l],function(t){var i=o._parser(t,!0);r[l]={width:i.width,height:i.height,format:i.format,mipmaps:i.mipmaps},6===(c+=1)&&(1===i.mipmapCount&&(a.minFilter=We.LinearFilter),a.format=i.format,a.needsUpdate=!0,e&&e(a))},i,n)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(t))for(var c=0,u=0,h=t.length;u<h;++u)l(u);else s.load(t,function(t){var i=o._parser(t,!0);if(i.isCubemap)for(var n=i.mipmaps.length/i.mipmapCount,s=0;s<n;s++){r[s]={mipmaps:[]};for(var l=0;l<i.mipmapCount;l++)r[s].mipmaps.push(i.mipmaps[s*i.mipmapCount+l]),r[s].format=i.format,r[s].width=i.width,r[s].height=i.height}else a.image.width=i.width,a.image.height=i.height,a.mipmaps=i.mipmaps;1===i.mipmapCount&&(a.minFilter=We.LinearFilter),a.format=i.format,a.needsUpdate=!0,e&&e(a)},i,n);return a},setPath:function(t){this.path=t}},We.Material=function(){Object.defineProperty(this,"id",{value:We.MaterialIdCount++}),this.uuid=We.Math.generateUUID(),this.name="",this.type="Material",this.side=We.FrontSide,this.opacity=1,this.transparent=!1,this.blending=We.NormalBlending,this.blendSrc=We.SrcAlphaFactor,this.blendDst=We.OneMinusSrcAlphaFactor,this.blendEquation=We.AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=We.LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this._needsUpdate=!0},We.Material.prototype={constructor:We.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(t){!0===t&&this.update(),this._needsUpdate=t},setValues:function(t){if(void 0!==t)for(var e in t){var i=t[e];if(void 0!==i){var n=this[e];void 0!==n&&(n instanceof We.Color?n.set(i):n instanceof We.Vector3&&i instanceof We.Vector3?n.copy(i):this[e]="overdraw"===e?Number(i):i)}}},toJSON:function(t){var e=void 0===t;e&&(t={textures:{},images:{}});var i={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};function n(t){var e=[];for(var i in t){var n=t[i];delete n.metadata,e.push(n)}return e}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color instanceof We.Color&&(i.color=this.color.getHex()),.5!==this.roughness&&(i.roughness=this.roughness),.5!==this.metalness&&(i.metalness=this.metalness),this.emissive instanceof We.Color&&(i.emissive=this.emissive.getHex()),this.specular instanceof We.Color&&(i.specular=this.specular.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),this.map instanceof We.Texture&&(i.map=this.map.toJSON(t).uuid),this.alphaMap instanceof We.Texture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap instanceof We.Texture&&(i.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap instanceof We.Texture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap instanceof We.Texture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalScale=this.normalScale.toArray()),this.displacementMap instanceof We.Texture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap instanceof We.Texture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap instanceof We.Texture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap instanceof We.Texture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap instanceof We.Texture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.envMap instanceof We.Texture&&(i.envMap=this.envMap.toJSON(t).uuid,i.reflectivity=this.reflectivity),void 0!==this.size&&(i.size=this.size),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),void 0!==this.vertexColors&&this.vertexColors!==We.NoColors&&(i.vertexColors=this.vertexColors),void 0!==this.shading&&this.shading!==We.SmoothShading&&(i.shading=this.shading),void 0!==this.blending&&this.blending!==We.NormalBlending&&(i.blending=this.blending),void 0!==this.side&&this.side!==We.FrontSide&&(i.side=this.side),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),0<this.alphaTest&&(i.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),1<this.wireframeLinewidth&&(i.wireframeLinewidth=this.wireframeLinewidth),e){var o=n(t.textures),r=n(t.images);0<o.length&&(i.textures=o),0<r.length&&(i.images=r)}return i},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.side=t.side,this.opacity=t.opacity,this.transparent=t.transparent,this.blending=t.blending,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}},We.EventDispatcher.prototype.apply(We.Material.prototype),We.MaterialIdCount=0,We.LineBasicMaterial=function(t){We.Material.call(this),this.type="LineBasicMaterial",this.color=new We.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.blending=We.NormalBlending,this.vertexColors=We.NoColors,this.fog=!0,this.setValues(t)},We.LineBasicMaterial.prototype=Object.create(We.Material.prototype),We.LineBasicMaterial.prototype.constructor=We.LineBasicMaterial,We.LineBasicMaterial.prototype.copy=function(t){return We.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.vertexColors=t.vertexColors,this.fog=t.fog,this},We.LineDashedMaterial=function(t){We.Material.call(this),this.type="LineDashedMaterial",this.color=new We.Color(16777215),this.linewidth=1,this.scale=1,this.dashSize=3,this.gapSize=1,this.blending=We.NormalBlending,this.vertexColors=We.NoColors,this.fog=!0,this.setValues(t)},We.LineDashedMaterial.prototype=Object.create(We.Material.prototype),We.LineDashedMaterial.prototype.constructor=We.LineDashedMaterial,We.LineDashedMaterial.prototype.copy=function(t){return We.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this.vertexColors=t.vertexColors,this.fog=t.fog,this},We.MeshBasicMaterial=function(t){We.Material.call(this),this.type="MeshBasicMaterial",this.color=new We.Color(16777215),this.map=null,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=We.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=We.SmoothShading,this.blending=We.NormalBlending,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=We.NoColors,this.skinning=!1,this.morphTargets=!1,this.setValues(t)},We.MeshBasicMaterial.prototype=Object.create(We.Material.prototype),We.MeshBasicMaterial.prototype.constructor=We.MeshBasicMaterial,We.MeshBasicMaterial.prototype.copy=function(t){return We.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},We.MeshLambertMaterial=function(t){We.Material.call(this),this.type="MeshLambertMaterial",this.color=new We.Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new We.Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=We.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.blending=We.NormalBlending,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=We.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)},We.MeshLambertMaterial.prototype=Object.create(We.Material.prototype),We.MeshLambertMaterial.prototype.constructor=We.MeshLambertMaterial,We.MeshLambertMaterial.prototype.copy=function(t){return We.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},We.MeshPhongMaterial=function(t){We.Material.call(this),this.type="MeshPhongMaterial",this.color=new We.Color(16777215),this.specular=new We.Color(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new We.Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new We.Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=We.MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.shading=We.SmoothShading,this.blending=We.NormalBlending,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=We.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)},We.MeshPhongMaterial.prototype=Object.create(We.Material.prototype),We.MeshPhongMaterial.prototype.constructor=We.MeshPhongMaterial,We.MeshPhongMaterial.prototype.copy=function(t){return We.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},We.MeshStandardMaterial=function(t){We.Material.call(this),this.type="MeshStandardMaterial",this.color=new We.Color(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new We.Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new We.Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.fog=!0,this.shading=We.SmoothShading,this.blending=We.NormalBlending,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.vertexColors=We.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)},We.MeshStandardMaterial.prototype=Object.create(We.Material.prototype),We.MeshStandardMaterial.prototype.constructor=We.MeshStandardMaterial,We.MeshStandardMaterial.prototype.copy=function(t){return We.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.fog=t.fog,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},We.MeshDepthMaterial=function(t){We.Material.call(this),this.type="MeshDepthMaterial",this.morphTargets=!1,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)},We.MeshDepthMaterial.prototype=Object.create(We.Material.prototype),We.MeshDepthMaterial.prototype.constructor=We.MeshDepthMaterial,We.MeshDepthMaterial.prototype.copy=function(t){return We.Material.prototype.copy.call(this,t),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},We.MeshNormalMaterial=function(t){We.Material.call(this,t),this.type="MeshNormalMaterial",this.wireframe=!1,this.wireframeLinewidth=1,this.morphTargets=!1,this.setValues(t)},We.MeshNormalMaterial.prototype=Object.create(We.Material.prototype),We.MeshNormalMaterial.prototype.constructor=We.MeshNormalMaterial,We.MeshNormalMaterial.prototype.copy=function(t){return We.Material.prototype.copy.call(this,t),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},We.MultiMaterial=function(t){this.uuid=We.Math.generateUUID(),this.type="MultiMaterial",this.materials=t instanceof Array?t:[],this.visible=!0},We.MultiMaterial.prototype={constructor:We.MultiMaterial,toJSON:function(t){for(var e={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]},i=this.materials,n=0,o=i.length;n<o;n++){var r=i[n].toJSON(t);delete r.metadata,e.materials.push(r)}return e.visible=this.visible,e},clone:function(){for(var t=new this.constructor,e=0;e<this.materials.length;e++)t.materials.push(this.materials[e].clone());return t.visible=this.visible,t}},We.PointsMaterial=function(t){We.Material.call(this),this.type="PointsMaterial",this.color=new We.Color(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.blending=We.NormalBlending,this.vertexColors=We.NoColors,this.fog=!0,this.setValues(t)},We.PointsMaterial.prototype=Object.create(We.Material.prototype),We.PointsMaterial.prototype.constructor=We.PointsMaterial,We.PointsMaterial.prototype.copy=function(t){return We.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.vertexColors=t.vertexColors,this.fog=t.fog,this},We.ShaderMaterial=function(t){We.Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.shading=We.SmoothShading,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.vertexColors=We.NoColors,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},(this.index0AttributeName=void 0)!==t&&(t.attributes,this.setValues(t))},We.ShaderMaterial.prototype=Object.create(We.Material.prototype),We.ShaderMaterial.prototype.constructor=We.ShaderMaterial,We.ShaderMaterial.prototype.copy=function(t){return We.Material.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=We.UniformsUtils.clone(t.uniforms),this.defines=t.defines,this.shading=t.shading,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.vertexColors=t.vertexColors,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},We.ShaderMaterial.prototype.toJSON=function(t){var e=We.Material.prototype.toJSON.call(this,t);return e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e},We.RawShaderMaterial=function(t){We.ShaderMaterial.call(this,t),this.type="RawShaderMaterial"},We.RawShaderMaterial.prototype=Object.create(We.ShaderMaterial.prototype),We.RawShaderMaterial.prototype.constructor=We.RawShaderMaterial,We.SpriteMaterial=function(t){We.Material.call(this),this.type="SpriteMaterial",this.color=new We.Color(16777215),this.map=null,this.rotation=0,this.fog=!1,this.setValues(t)},We.SpriteMaterial.prototype=Object.create(We.Material.prototype),We.SpriteMaterial.prototype.constructor=We.SpriteMaterial,We.SpriteMaterial.prototype.copy=function(t){return We.Material.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this.fog=t.fog,this},We.Texture=function(t,e,i,n,o,r,a,s,l){Object.defineProperty(this,"id",{value:We.TextureIdCount++}),this.uuid=We.Math.generateUUID(),this.name="",this.sourceFile="",this.image=void 0!==t?t:We.Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:We.Texture.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:We.ClampToEdgeWrapping,this.wrapT=void 0!==n?n:We.ClampToEdgeWrapping,this.magFilter=void 0!==o?o:We.LinearFilter,this.minFilter=void 0!==r?r:We.LinearMipMapLinearFilter,this.anisotropy=void 0!==l?l:1,this.format=void 0!==a?a:We.RGBAFormat,this.type=void 0!==s?s:We.UnsignedByteType,this.offset=new We.Vector2(0,0),this.repeat=new We.Vector2(1,1),this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=We.LinearEncoding,this.version=0,this.onUpdate=null},We.Texture.DEFAULT_IMAGE=void 0,We.Texture.DEFAULT_MAPPING=We.UVMapping,We.Texture.prototype={constructor:We.Texture,set needsUpdate(t){!0===t&&this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){if(void 0!==t.textures[this.uuid])return t.textures[this.uuid];var e,i,n={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy};if(void 0!==this.image){var o=this.image;void 0===o.uuid&&(o.uuid=We.Math.generateUUID()),void 0===t.images[o.uuid]&&(t.images[o.uuid]={uuid:o.uuid,url:(e=o,void 0!==e.toDataURL?i=e:((i=document.createElement("canvas")).width=e.width,i.height=e.height,i.getContext("2d").drawImage(e,0,0,e.width,e.height)),2048<i.width||2048<i.height?i.toDataURL("image/jpeg",.6):i.toDataURL("image/png"))}),n.image=o.uuid}return t.textures[this.uuid]=n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping===We.UVMapping){if(t.multiply(this.repeat),t.add(this.offset),t.x<0||1<t.x)switch(this.wrapS){case We.RepeatWrapping:t.x=t.x-Math.floor(t.x);break;case We.ClampToEdgeWrapping:t.x=t.x<0?0:1;break;case We.MirroredRepeatWrapping:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||1<t.y)switch(this.wrapT){case We.RepeatWrapping:t.y=t.y-Math.floor(t.y);break;case We.ClampToEdgeWrapping:t.y=t.y<0?0:1;break;case We.MirroredRepeatWrapping:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}},We.EventDispatcher.prototype.apply(We.Texture.prototype),We.TextureIdCount=0,We.CanvasTexture=function(t,e,i,n,o,r,a,s,l){We.Texture.call(this,t,e,i,n,o,r,a,s,l),this.needsUpdate=!0},We.CanvasTexture.prototype=Object.create(We.Texture.prototype),We.CanvasTexture.prototype.constructor=We.CanvasTexture,We.CubeTexture=function(t,e,i,n,o,r,a,s,l){t=void 0!==t?t:[],e=void 0!==e?e:We.CubeReflectionMapping,We.Texture.call(this,t,e,i,n,o,r,a,s,l),this.flipY=!1},We.CubeTexture.prototype=Object.create(We.Texture.prototype),We.CubeTexture.prototype.constructor=We.CubeTexture,Object.defineProperty(We.CubeTexture.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),We.CompressedTexture=function(t,e,i,n,o,r,a,s,l,c,u){We.Texture.call(this,null,r,a,s,l,c,n,o,u),this.image={width:e,height:i},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1},We.CompressedTexture.prototype=Object.create(We.Texture.prototype),We.CompressedTexture.prototype.constructor=We.CompressedTexture,We.DataTexture=function(t,e,i,n,o,r,a,s,l,c,u){We.Texture.call(this,null,r,a,s,l,c,n,o,u),this.image={data:t,width:e,height:i},this.magFilter=void 0!==l?l:We.NearestFilter,this.minFilter=void 0!==c?c:We.NearestFilter,this.flipY=!1,this.generateMipmaps=!1},We.DataTexture.prototype=Object.create(We.Texture.prototype),We.DataTexture.prototype.constructor=We.DataTexture,We.VideoTexture=function(t,e,i,n,o,r,a,s,l){We.Texture.call(this,t,e,i,n,o,r,a,s,l),this.generateMipmaps=!1;var c=this;!function e(){requestAnimationFrame(e),t.readyState===t.HAVE_ENOUGH_DATA&&(c.needsUpdate=!0)}()},We.VideoTexture.prototype=Object.create(We.Texture.prototype),We.VideoTexture.prototype.constructor=We.VideoTexture,We.Group=function(){We.Object3D.call(this),this.type="Group"},We.Group.prototype=Object.create(We.Object3D.prototype),We.Group.prototype.constructor=We.Group,We.Points=function(t,e){We.Object3D.call(this),this.type="Points",this.geometry=void 0!==t?t:new We.Geometry,this.material=void 0!==e?e:new We.PointsMaterial({color:16777215*Math.random()})},We.Points.prototype=Object.create(We.Object3D.prototype),We.Points.prototype.constructor=We.Points,We.Points.prototype.raycast=(me=new We.Matrix4,ge=new We.Ray,ve=new We.Sphere,function(t,e){var i=this,n=this.geometry,o=this.matrixWorld,r=t.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),ve.copy(n.boundingSphere),ve.applyMatrix4(o),!1!==t.ray.intersectsSphere(ve)){me.getInverse(o),ge.copy(t.ray).applyMatrix4(me);var a=r/((this.scale.x+this.scale.y+this.scale.z)/3),s=a*a,l=new We.Vector3;if(n instanceof We.BufferGeometry){var c=n.index,u=n.attributes.position.array;if(null!==c)for(var h=c.array,d=0,p=h.length;d<p;d++){var f=h[d];l.fromArray(u,3*f),v(l,f)}else{d=0;for(var m=u.length/3;d<m;d++)l.fromArray(u,3*d),v(l,d)}}else{var g=n.vertices;for(d=0,m=g.length;d<m;d++)v(g[d],d)}}function v(n,r){var a=ge.distanceSqToPoint(n);if(a<s){var l=ge.closestPointToPoint(n);l.applyMatrix4(o);var c=t.ray.origin.distanceTo(l);if(c<t.near||c>t.far)return;e.push({distance:c,distanceToRay:Math.sqrt(a),point:l.clone(),index:r,face:null,object:i})}}}),We.Points.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},We.Line=function(t,e,i){if(1===i)return new We.LineSegments(t,e);We.Object3D.call(this),this.type="Line",this.geometry=void 0!==t?t:new We.Geometry,this.material=void 0!==e?e:new We.LineBasicMaterial({color:16777215*Math.random()})},We.Line.prototype=Object.create(We.Object3D.prototype),We.Line.prototype.constructor=We.Line,We.Line.prototype.raycast=(ye=new We.Matrix4,be=new We.Ray,we=new We.Sphere,function(t,e){var i=t.linePrecision,n=i*i,o=this.geometry,r=this.matrixWorld;if(null===o.boundingSphere&&o.computeBoundingSphere(),we.copy(o.boundingSphere),we.applyMatrix4(r),!1!==t.ray.intersectsSphere(we)){ye.getInverse(r),be.copy(t.ray).applyMatrix4(ye);var a=new We.Vector3,s=new We.Vector3,l=new We.Vector3,c=new We.Vector3,u=this instanceof We.LineSegments?2:1;if(o instanceof We.BufferGeometry){var h=o.index,d=o.attributes.position.array;if(null!==h)for(var p=h.array,f=0,m=p.length-1;f<m;f+=u){var g=p[f],v=p[f+1];a.fromArray(d,3*g),s.fromArray(d,3*v),n<be.distanceSqToSegment(a,s,c,l)||(c.applyMatrix4(this.matrixWorld),(w=t.ray.origin.distanceTo(c))<t.near||w>t.far||e.push({distance:w,point:l.clone().applyMatrix4(this.matrixWorld),index:f,face:null,faceIndex:null,object:this}))}else for(f=0,m=d.length/3-1;f<m;f+=u)a.fromArray(d,3*f),s.fromArray(d,3*f+3),n<be.distanceSqToSegment(a,s,c,l)||(c.applyMatrix4(this.matrixWorld),(w=t.ray.origin.distanceTo(c))<t.near||w>t.far||e.push({distance:w,point:l.clone().applyMatrix4(this.matrixWorld),index:f,face:null,faceIndex:null,object:this}))}else if(o instanceof We.Geometry){var y=o.vertices,b=y.length;for(f=0;f<b-1;f+=u){var w;n<be.distanceSqToSegment(y[f],y[f+1],c,l)||(c.applyMatrix4(this.matrixWorld),(w=t.ray.origin.distanceTo(c))<t.near||w>t.far||e.push({distance:w,point:l.clone().applyMatrix4(this.matrixWorld),index:f,face:null,faceIndex:null,object:this}))}}}}),We.Line.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},We.LineStrip=0,We.LinePieces=1,We.LineSegments=function(t,e){We.Line.call(this,t,e),this.type="LineSegments"},We.LineSegments.prototype=Object.create(We.Line.prototype),We.LineSegments.prototype.constructor=We.LineSegments,We.Mesh=function(t,e){We.Object3D.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new We.Geometry,this.material=void 0!==e?e:new We.MeshBasicMaterial({color:16777215*Math.random()}),this.drawMode=We.TrianglesDrawMode,this.updateMorphTargets()},We.Mesh.prototype=Object.create(We.Object3D.prototype),We.Mesh.prototype.constructor=We.Mesh,We.Mesh.prototype.setDrawMode=function(t){this.drawMode=t},We.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&0<this.geometry.morphTargets.length){this.morphTargetBase=-1,this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var t=0,e=this.geometry.morphTargets.length;t<e;t++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[t].name]=t}},We.Mesh.prototype.getMorphTargetIndexByName=function(t){return void 0!==this.morphTargetDictionary[t]?this.morphTargetDictionary[t]:0},We.Mesh.prototype.raycast=function(){var t=new We.Matrix4,e=new We.Ray,i=new We.Sphere,n=new We.Vector3,o=new We.Vector3,r=new We.Vector3,a=new We.Vector3,s=new We.Vector3,l=new We.Vector3,c=new We.Vector2,u=new We.Vector2,h=new We.Vector2,d=new We.Vector3,p=new We.Vector3,f=new We.Vector3;function m(t,e,i,n,o,r,a){return We.Triangle.barycoordFromPoint(t,e,i,n,d),o.multiplyScalar(d.x),r.multiplyScalar(d.y),a.multiplyScalar(d.z),o.add(r).add(a),o.clone()}function g(t,e,i,n,o,r,a){var s=t.material;if(null===(s.side===We.BackSide?i.intersectTriangle(r,o,n,!0,a):i.intersectTriangle(n,o,r,s.side!==We.DoubleSide,a)))return null;f.copy(a),f.applyMatrix4(t.matrixWorld);var l=e.ray.origin.distanceTo(f);return l<e.near||l>e.far?null:{distance:l,point:f.clone(),object:t}}function v(t,e,i,a,s,l,d,f){n.fromArray(a,3*l),o.fromArray(a,3*d),r.fromArray(a,3*f);var v=g(t,e,i,n,o,r,p);return v&&(s&&(c.fromArray(s,2*l),u.fromArray(s,2*d),h.fromArray(s,2*f),v.uv=m(p,n,o,r,c,u,h)),v.face=new We.Face3(l,d,f,We.Triangle.normal(n,o,r)),v.faceIndex=l),v}return function(d,f){var y,b,w=this.geometry,x=this.material,_=this.matrixWorld;if(void 0!==x&&(null===w.boundingSphere&&w.computeBoundingSphere(),i.copy(w.boundingSphere),i.applyMatrix4(_),!1!==d.ray.intersectsSphere(i)&&(t.getInverse(_),e.copy(d.ray).applyMatrix4(t),null===w.boundingBox||!1!==e.intersectsBox(w.boundingBox))))if(w instanceof We.BufferGeometry){var S,T,M,I=w.index,P=w.attributes,C=P.position.array;if(void 0!==P.uv&&(y=P.uv.array),null!==I)for(var A=I.array,E=0,L=A.length;E<L;E+=3)S=A[E],T=A[E+1],M=A[E+2],(b=v(this,d,e,C,y,S,T,M))&&(b.faceIndex=Math.floor(E/3),f.push(b));else for(E=0,L=C.length;E<L;E+=9)(b=v(this,d,e,C,y,S=E/3,T=S+1,M=S+2))&&(b.index=S,f.push(b))}else if(w instanceof We.Geometry){var D,k,R,O=x instanceof We.MultiMaterial,F=!0===O?x.materials:null,N=w.vertices,U=w.faces,B=w.faceVertexUvs[0];0<B.length&&(y=B);for(var z=0,V=U.length;z<V;z++){var G=U[z],j=!0===O?F[G.materialIndex]:x;if(void 0!==j){if(D=N[G.a],k=N[G.b],R=N[G.c],!0===j.morphTargets){var H=w.morphTargets,W=this.morphTargetInfluences;n.set(0,0,0),o.set(0,0,0),r.set(0,0,0);for(var q=0,$=H.length;q<$;q++){var Y=W[q];if(0!==Y){var X=H[q].vertices;n.addScaledVector(a.subVectors(X[G.a],D),Y),o.addScaledVector(s.subVectors(X[G.b],k),Y),r.addScaledVector(l.subVectors(X[G.c],R),Y)}}n.add(D),o.add(k),r.add(R),D=n,k=o,R=r}if(b=g(this,d,e,D,k,R,p)){if(y){var Q=y[z];c.copy(Q[0]),u.copy(Q[1]),h.copy(Q[2]),b.uv=m(p,D,k,R,c,u,h)}b.face=G,b.faceIndex=z,f.push(b)}}}}}}(),We.Mesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material).copy(this)},We.Bone=function(t){We.Object3D.call(this),this.type="Bone",this.skin=t},We.Bone.prototype=Object.create(We.Object3D.prototype),We.Bone.prototype.constructor=We.Bone,We.Bone.prototype.copy=function(t){return We.Object3D.prototype.copy.call(this,t),this.skin=t.skin,this},We.Skeleton=function(t,e,i){if(this.useVertexTexture=void 0===i||i,this.identityMatrix=new We.Matrix4,t=t||[],this.bones=t.slice(0),this.useVertexTexture){var n=Math.sqrt(4*this.bones.length);n=We.Math.nextPowerOfTwo(Math.ceil(n)),n=Math.max(n,4),this.boneTextureWidth=n,this.boneTextureHeight=n,this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4),this.boneTexture=new We.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,We.RGBAFormat,We.FloatType)}else this.boneMatrices=new Float32Array(16*this.bones.length);if(void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{this.boneInverses=[];for(var o=0,r=this.bones.length;o<r;o++)this.boneInverses.push(new We.Matrix4)}},We.Skeleton.prototype.calculateInverses=function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var i=new We.Matrix4;this.bones[t]&&i.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(i)}},We.Skeleton.prototype.pose=function(){for(var t,e=0,i=this.bones.length;e<i;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,i=this.bones.length;e<i;e++)(t=this.bones[e])&&(t.parent?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},We.Skeleton.prototype.update=(xe=new We.Matrix4,function(){for(var t=0,e=this.bones.length;t<e;t++){var i=this.bones[t]?this.bones[t].matrixWorld:this.identityMatrix;xe.multiplyMatrices(i,this.boneInverses[t]),xe.flattenToArrayOffset(this.boneMatrices,16*t)}this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)}),We.Skeleton.prototype.clone=function(){return new We.Skeleton(this.bones,this.boneInverses,this.useVertexTexture)},We.SkinnedMesh=function(t,e,i){We.Mesh.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new We.Matrix4,this.bindMatrixInverse=new We.Matrix4;var n=[];if(this.geometry&&void 0!==this.geometry.bones){for(var o,r,a=0,s=this.geometry.bones.length;a<s;++a)r=this.geometry.bones[a],o=new We.Bone(this),n.push(o),o.name=r.name,o.position.fromArray(r.pos),o.quaternion.fromArray(r.rotq),void 0!==r.scl&&o.scale.fromArray(r.scl);for(a=0,s=this.geometry.bones.length;a<s;++a)-1!==(r=this.geometry.bones[a]).parent&&null!==r.parent?n[r.parent].add(n[a]):this.add(n[a])}this.normalizeSkinWeights(),this.updateMatrixWorld(!0),this.bind(new We.Skeleton(n,void 0,i),this.matrixWorld)},We.SkinnedMesh.prototype=Object.create(We.Mesh.prototype),We.SkinnedMesh.prototype.constructor=We.SkinnedMesh,We.SkinnedMesh.prototype.bind=function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},We.SkinnedMesh.prototype.pose=function(){this.skeleton.pose()},We.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof We.Geometry)for(var t=0;t<this.geometry.skinWeights.length;t++){var e=this.geometry.skinWeights[t];(o=1/e.lengthManhattan())!=1/0?e.multiplyScalar(o):e.set(1,0,0,0)}else if(this.geometry instanceof We.BufferGeometry){var i=new We.Vector4,n=this.geometry.attributes.skinWeight;for(t=0;t<n.count;t++){var o;i.x=n.getX(t),i.y=n.getY(t),i.z=n.getZ(t),i.w=n.getW(t),(o=1/i.lengthManhattan())!=1/0?i.multiplyScalar(o):i.set(1,0,0,0),n.setXYZW(t,i.x,i.y,i.z,i.w)}}},We.SkinnedMesh.prototype.updateMatrixWorld=function(t){We.Mesh.prototype.updateMatrixWorld.call(this,!0),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode&&this.bindMatrixInverse.getInverse(this.bindMatrix)},We.SkinnedMesh.prototype.clone=function(){return new this.constructor(this.geometry,this.material,this.useVertexTexture).copy(this)},We.LOD=function(){We.Object3D.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},objects:{get:function(){return this.levels}}})},We.LOD.prototype=Object.create(We.Object3D.prototype),We.LOD.prototype.constructor=We.LOD,We.LOD.prototype.addLevel=function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var i=this.levels,n=0;n<i.length&&!(e<i[n].distance);n++);i.splice(n,0,{distance:e,object:t}),this.add(t)},We.LOD.prototype.getObjectForDistance=function(t){for(var e=this.levels,i=1,n=e.length;i<n&&!(t<e[i].distance);i++);return e[i-1].object},We.LOD.prototype.raycast=(_e=new We.Vector3,function(t,e){_e.setFromMatrixPosition(this.matrixWorld);var i=t.ray.origin.distanceTo(_e);this.getObjectForDistance(i).raycast(t,e)}),We.LOD.prototype.update=(Se=new We.Vector3,Te=new We.Vector3,function(t){var e=this.levels;if(1<e.length){Se.setFromMatrixPosition(t.matrixWorld),Te.setFromMatrixPosition(this.matrixWorld);var i=Se.distanceTo(Te);e[0].object.visible=!0;for(var n=1,o=e.length;n<o&&i>=e[n].distance;n++)e[n-1].object.visible=!1,e[n].object.visible=!0;for(;n<o;n++)e[n].object.visible=!1}}),We.LOD.prototype.copy=function(t){We.Object3D.prototype.copy.call(this,t,!1);for(var e=t.levels,i=0,n=e.length;i<n;i++){var o=e[i];this.addLevel(o.object.clone(),o.distance)}return this},We.LOD.prototype.toJSON=function(t){var e=We.Object3D.prototype.toJSON.call(this,t);e.object.levels=[];for(var i=this.levels,n=0,o=i.length;n<o;n++){var r=i[n];e.object.levels.push({object:r.object.uuid,distance:r.distance})}return e},We.Sprite=(Me=new Uint16Array([0,1,2,0,2,3]),Ie=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0,-.5,.5,0]),Pe=new Float32Array([0,0,1,0,1,1,0,1]),(Ce=new We.BufferGeometry).setIndex(new We.BufferAttribute(Me,1)),Ce.addAttribute("position",new We.BufferAttribute(Ie,3)),Ce.addAttribute("uv",new We.BufferAttribute(Pe,2)),function(t){We.Object3D.call(this),this.type="Sprite",this.geometry=Ce,this.material=void 0!==t?t:new We.SpriteMaterial}),We.Sprite.prototype=Object.create(We.Object3D.prototype),We.Sprite.prototype.constructor=We.Sprite,We.Sprite.prototype.raycast=(Ae=new We.Vector3,function(t,e){Ae.setFromMatrixPosition(this.matrixWorld);var i=t.ray.distanceSqToPoint(Ae);this.scale.x*this.scale.y<i||e.push({distance:Math.sqrt(i),point:this.position,face:null,object:this})}),We.Sprite.prototype.clone=function(){return new this.constructor(this.material).copy(this)},We.Particle=We.Sprite,We.LensFlare=function(t,e,i,n,o){We.Object3D.call(this),this.lensFlares=[],this.positionScreen=new We.Vector3,(this.customUpdateCallback=void 0)!==t&&this.add(t,e,i,n,o)},We.LensFlare.prototype=Object.create(We.Object3D.prototype),We.LensFlare.prototype.constructor=We.LensFlare,We.LensFlare.prototype.add=function(t,e,i,n,o,r){void 0===e&&(e=-1),void 0===i&&(i=0),void 0===r&&(r=1),void 0===o&&(o=new We.Color(16777215)),void 0===n&&(n=We.NormalBlending),i=Math.min(i,Math.max(0,i)),this.lensFlares.push({texture:t,size:e,distance:i,x:0,y:0,z:0,scale:1,rotation:0,opacity:r,color:o,blending:n})},We.LensFlare.prototype.updateLensFlares=function(){var t,e,i=this.lensFlares.length,n=2*-this.positionScreen.x,o=2*-this.positionScreen.y;for(t=0;t<i;t++)(e=this.lensFlares[t]).x=this.positionScreen.x+n*e.distance,e.y=this.positionScreen.y+o*e.distance,e.wantedRotation=e.x*Math.PI*.25,e.rotation+=.25*(e.wantedRotation-e.rotation)},We.LensFlare.prototype.copy=function(t){We.Object3D.prototype.copy.call(this,t),this.positionScreen.copy(t.positionScreen),this.customUpdateCallback=t.customUpdateCallback;for(var e=0,i=t.lensFlares.length;e<i;e++)this.lensFlares.push(t.lensFlares[e]);return this},We.Scene=function(){We.Object3D.call(this),this.type="Scene",this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0},We.Scene.prototype=Object.create(We.Object3D.prototype),We.Scene.prototype.constructor=We.Scene,We.Scene.prototype.copy=function(t,e){return We.Object3D.prototype.copy.call(this,t,e),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},We.Fog=function(t,e,i){this.name="",this.color=new We.Color(t),this.near=void 0!==e?e:1,this.far=void 0!==i?i:1e3},We.Fog.prototype.clone=function(){return new We.Fog(this.color.getHex(),this.near,this.far)},We.FogExp2=function(t,e){this.name="",this.color=new We.Color(t),this.density=void 0!==e?e:25e-5},We.FogExp2.prototype.clone=function(){return new We.FogExp2(this.color.getHex(),this.density)},We.ShaderChunk={},We.ShaderChunk.alphamap_fragment="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",We.ShaderChunk.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",We.ShaderChunk.alphatest_fragment="#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",We.ShaderChunk.aomap_fragment="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",We.ShaderChunk.aomap_pars_fragment="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",We.ShaderChunk.begin_vertex="\nvec3 transformed = vec3( position );\n",We.ShaderChunk.beginnormal_vertex="\nvec3 objectNormal = vec3( normal );\n",We.ShaderChunk.bsdfs="bool testLightInRange( const in float lightDistance, const in float cutoffDistance ) {\n\treturn any( bvec2( cutoffDistance == 0.0, lightDistance < cutoffDistance ) );\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t\t}\n\t\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_Smith( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",We.ShaderChunk.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",We.ShaderChunk.color_fragment="#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",We.ShaderChunk.color_pars_fragment="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",We.ShaderChunk.color_pars_vertex="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",We.ShaderChunk.color_vertex="#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",We.ShaderChunk.common="#define PI 3.14159\n#define PI2 6.28318\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\n",We.ShaderChunk.cube_uv_reflection_fragment="#ifdef ENVMAP_TYPE_CUBE_UV\nconst float cubeUV_textureSize = 1024.0;\nint getFaceFromDirection(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    int face = -1;\n    if( absDirection.x > absDirection.z ) {\n        if(absDirection.x > absDirection.y )\n            face = direction.x > 0.0 ? 0 : 3;\n        else\n            face = direction.y > 0.0 ? 1 : 4;\n    }\n    else {\n        if(absDirection.z > absDirection.y )\n            face = direction.z > 0.0 ? 2 : 5;\n        else\n            face = direction.y > 0.0 ? 1 : 4;\n    }\n    return face;\n}\nconst float cubeUV_maxLods1 = log2(cubeUV_textureSize*0.25) - 1.0;\nconst float cubeUV_rangeClamp = exp2((6.0 - 1.0) * 2.0);\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n    float scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n    float dxRoughness = dFdx(roughness);\n    float dyRoughness = dFdy(roughness);\n    vec3 dx = dFdx( vec * scale * dxRoughness );\n    vec3 dy = dFdy( vec * scale * dyRoughness );\n    float d = max( dot( dx, dx ), dot( dy, dy ) );\n    d = clamp(d, 1.0, cubeUV_rangeClamp);\n    float mipLevel = 0.5 * log2(d);\n    return vec2(floor(mipLevel), fract(mipLevel));\n}\nconst float cubeUV_maxLods2 = log2(cubeUV_textureSize*0.25) - 2.0;\nconst float cubeUV_rcpTextureSize = 1.0 / cubeUV_textureSize;\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n    mipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n    float a = 16.0 * cubeUV_rcpTextureSize;\n    vec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n    vec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n    float powScale = exp2_packed.x * exp2_packed.y;\n    float scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n    float mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n    bool bRes = mipLevel == 0.0;\n    scale =  bRes && (scale < a) ? a : scale;\n    vec3 r;\n    vec2 offset;\n    int face = getFaceFromDirection(direction);\n    float rcpPowScale = 1.0 / powScale;\n    if( face == 0) {\n        r = vec3(direction.x, -direction.z, direction.y);\n        offset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n        offset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n    }\n    else if( face == 1) {\n        r = vec3(direction.y, direction.x, direction.z);\n        offset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n        offset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n    }\n    else if( face == 2) {\n        r = vec3(direction.z, direction.x, direction.y);\n        offset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n        offset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n    }\n    else if( face == 3) {\n        r = vec3(direction.x, direction.z, direction.y);\n        offset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n        offset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n    }\n    else if( face == 4) {\n        r = vec3(direction.y, direction.x, -direction.z);\n        offset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n        offset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n    }\n    else {\n        r = vec3(direction.z, -direction.x, direction.y);\n        offset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n        offset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n    }\n    r = normalize(r);\n    float texelOffset = 0.5 * cubeUV_rcpTextureSize;\n    vec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n    vec2 base = offset + vec2( texelOffset );\n    return base + s * ( scale - 2.0 * texelOffset );\n}\nconst float cubeUV_maxLods3 = log2(cubeUV_textureSize*0.25) - 3.0;\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n    float roughnessVal = roughness* cubeUV_maxLods3;\n    float r1 = floor(roughnessVal);\n    float r2 = r1 + 1.0;\n    float t = fract(roughnessVal);\n    vec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n    float s = mipInfo.y;\n    float level0 = mipInfo.x;\n    float level1 = level0 + 1.0;\n    level1 = level1 > 5.0 ? 5.0 : level1;\n    level0 += min( floor( s + 0.5 ), 5.0 );\n    vec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n    vec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n    vec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n    vec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n    vec4 result = mix(color10, color20, t);\n    return vec4(result.rgb, 1.0);\n}\n#endif\n",We.ShaderChunk.defaultnormal_vertex="#ifdef FLIP_SIDED\n\tobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n",We.ShaderChunk.displacementmap_vertex="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",We.ShaderChunk.displacementmap_pars_vertex="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",We.ShaderChunk.emissivemap_fragment="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",We.ShaderChunk.emissivemap_pars_fragment="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",We.ShaderChunk.encodings_pars_fragment="\nvec4 LinearToLinear( in vec4 value ) {\n  return value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n  return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n  return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n  float maxComponent = max( max( value.r, value.g ), value.b );\n  float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n  return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n  return vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n  float maxRGB = max( value.x, max( value.g, value.b ) );\n  float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n  M            = ceil( M * 255.0 ) / 255.0;\n  return vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n    return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n    float maxRGB = max( value.x, max( value.g, value.b ) );\n    float D      = max( maxRange / maxRGB, 1.0 );\n    D            = min( floor( D ) / 255.0, 1.0 );\n    return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n  vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n  Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n  vec4 vResult;\n  vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n  float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n  vResult.w = fract(Le);\n  vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n  return vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n  float Le = value.z * 255.0 + value.w;\n  vec3 Xp_Y_XYZp;\n  Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n  Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n  Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n  vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n  return vec4( max(vRGB, 0.0), 1.0 );\n}\n",We.ShaderChunk.encodings_fragment="  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",We.ShaderChunk.envmap_fragment="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#else\n\t\tfloat flipNormal = 1.0;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",We.ShaderChunk.envmap_pars_fragment="#if defined( USE_ENVMAP ) || defined( STANDARD )\n\tuniform float reflectivity;\n\tuniform float envMapIntenstiy;\n#endif\n#ifdef USE_ENVMAP\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( STANDARD )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",We.ShaderChunk.envmap_pars_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG ) && ! defined( STANDARD )\n\tvarying vec3 vReflect;\n\tuniform float refractionRatio;\n#endif\n",We.ShaderChunk.envmap_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP ) && ! defined( PHONG ) && ! defined( STANDARD )\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t#ifdef ENVMAP_MODE_REFLECTION\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t#else\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t#endif\n#endif\n",We.ShaderChunk.fog_fragment="#ifdef USE_FOG\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",We.ShaderChunk.fog_pars_fragment="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",We.ShaderChunk.lightmap_fragment="#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",We.ShaderChunk.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",We.ShaderChunk.lights_lambert_vertex="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tdirectLight = getPointDirectLightIrradiance( pointLights[ i ], geometry );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tdirectLight = getSpotDirectLightIrradiance( spotLights[ i ], geometry );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectLight = getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",We.ShaderChunk.lights_pars="uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tIncidentLight getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry ) {\n\t\tIncidentLight directLight;\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t\treturn directLight;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tIncidentLight getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry ) {\n\t\tIncidentLight directLight;\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tif ( testLightInRange( lightDistance, pointLight.distance ) ) {\n\t\t\tdirectLight.color = pointLight.color;\n\t\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t\treturn directLight;\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tIncidentLight getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry ) {\n\t\tIncidentLight directLight;\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( all( bvec2( angleCos > spotLight.coneCos, testLightInRange( lightDistance, spotLight.distance ) ) ) ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t\treturn directLight;\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( STANDARD )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#else\n\t\t\tfloat flipNormal = 1.0;\n\t\t#endif\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#else\n\t\t\tfloat flipNormal = 1.0;\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t#endif\n\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",We.ShaderChunk.lights_phong_fragment="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",We.ShaderChunk.lights_phong_pars_fragment="#ifdef USE_ENVMAP\n\tvarying vec3 vWorldPosition;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",We.ShaderChunk.lights_phong_pars_vertex="#ifdef USE_ENVMAP\n\tvarying vec3 vWorldPosition;\n#endif\n",We.ShaderChunk.lights_phong_vertex="#ifdef USE_ENVMAP\n\tvWorldPosition = worldPosition.xyz;\n#endif\n",We.ShaderChunk.lights_standard_fragment="StandardMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\nmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n",We.ShaderChunk.lights_standard_pars_fragment="struct StandardMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n};\nvoid RE_Direct_Standard( const in IncidentLight directLight, const in GeometricContext geometry, const in StandardMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n}\nvoid RE_IndirectDiffuse_Standard( const in vec3 irradiance, const in GeometricContext geometry, const in StandardMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Standard( const in vec3 radiance, const in GeometricContext geometry, const in StandardMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectSpecular += radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Standard\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Standard\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Standard\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",We.ShaderChunk.lights_template="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tdirectLight = getPointDirectLightIrradiance( pointLight, geometry );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tdirectLight = getSpotDirectLightIrradiance( spotLight, geometry );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tdirectLight = getDirectionalDirectLightIrradiance( directionalLight, geometry );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t \tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\tRE_IndirectSpecular( radiance, geometry, material, reflectedLight );\n#endif\n",We.ShaderChunk.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif",We.ShaderChunk.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",We.ShaderChunk.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",We.ShaderChunk.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n",We.ShaderChunk.map_fragment="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",We.ShaderChunk.map_pars_fragment="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",We.ShaderChunk.map_particle_fragment="#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",We.ShaderChunk.map_particle_pars_fragment="#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n",We.ShaderChunk.metalnessmap_fragment="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.r;\n#endif\n",We.ShaderChunk.metalnessmap_pars_fragment="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",We.ShaderChunk.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",We.ShaderChunk.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",We.ShaderChunk.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",We.ShaderChunk.normal_fragment="#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\t#endif\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",We.ShaderChunk.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",We.ShaderChunk.premultiplied_alpha_fragment="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",We.ShaderChunk.project_vertex="#ifdef USE_SKINNING\n\tvec4 mvPosition = modelViewMatrix * skinned;\n#else\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n",We.ShaderChunk.roughnessmap_fragment="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.r;\n#endif\n",We.ShaderChunk.roughnessmap_pars_fragment="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",We.ShaderChunk.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\t\treturn dot( rgba_depth, bit_shift );\n\t}\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn 1.0;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",We.ShaderChunk.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",We.ShaderChunk.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",We.ShaderChunk.shadowmask_pars_fragment="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",We.ShaderChunk.skinbase_vertex="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",We.ShaderChunk.skinning_pars_vertex="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",We.ShaderChunk.skinning_vertex="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n#endif\n",We.ShaderChunk.skinnormal_vertex="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",We.ShaderChunk.specularmap_fragment="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",We.ShaderChunk.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",We.ShaderChunk.tonemapping_fragment="#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",We.ShaderChunk.tonemapping_pars_fragment="#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n  return toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  color = max( vec3( 0.0 ), color - 0.004 );\n  return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",We.ShaderChunk.uv2_pars_fragment="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",We.ShaderChunk.uv2_pars_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",We.ShaderChunk.uv2_vertex="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",We.ShaderChunk.uv_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",We.ShaderChunk.uv_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n",We.ShaderChunk.uv_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",We.ShaderChunk.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( STANDARD ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\t#ifdef USE_SKINNING\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\t#else\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t#endif\n#endif\n",We.UniformsUtils={merge:function(t){for(var e={},i=0;i<t.length;i++){var n=this.clone(t[i]);for(var o in n)e[o]=n[o]}return e},clone:function(t){var e={};for(var i in t)for(var n in e[i]={},t[i]){var o=t[i][n];o instanceof We.Color||o instanceof We.Vector2||o instanceof We.Vector3||o instanceof We.Vector4||o instanceof We.Matrix3||o instanceof We.Matrix4||o instanceof We.Texture?e[i][n]=o.clone():Array.isArray(o)?e[i][n]=o.slice():e[i][n]=o}return e}},We.UniformsLib={common:{diffuse:{type:"c",value:new We.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new We.Vector4(0,0,1,1)},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98}},aomap:{aoMap:{type:"t",value:null},aoMapIntensity:{type:"f",value:1}},lightmap:{lightMap:{type:"t",value:null},lightMapIntensity:{type:"f",value:1}},emissivemap:{emissiveMap:{type:"t",value:null}},bumpmap:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new We.Vector2(1,1)}},displacementmap:{displacementMap:{type:"t",value:null},displacementScale:{type:"f",value:1},displacementBias:{type:"f",value:0}},roughnessmap:{roughnessMap:{type:"t",value:null}},metalnessmap:{metalnessMap:{type:"t",value:null}},fog:{fogDensity:{type:"f",value:25e-5},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},fogColor:{type:"c",value:new We.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLights:{type:"sa",value:[],properties:{direction:{type:"v3"},color:{type:"c"},shadow:{type:"i"},shadowBias:{type:"f"},shadowRadius:{type:"f"},shadowMapSize:{type:"v2"}}},directionalShadowMap:{type:"tv",value:[]},directionalShadowMatrix:{type:"m4v",value:[]},spotLights:{type:"sa",value:[],properties:{color:{type:"c"},position:{type:"v3"},direction:{type:"v3"},distance:{type:"f"},coneCos:{type:"f"},penumbraCos:{type:"f"},decay:{type:"f"},shadow:{type:"i"},shadowBias:{type:"f"},shadowRadius:{type:"f"},shadowMapSize:{type:"v2"}}},spotShadowMap:{type:"tv",value:[]},spotShadowMatrix:{type:"m4v",value:[]},pointLights:{type:"sa",value:[],properties:{color:{type:"c"},position:{type:"v3"},decay:{type:"f"},distance:{type:"f"},shadow:{type:"i"},shadowBias:{type:"f"},shadowRadius:{type:"f"},shadowMapSize:{type:"v2"}}},pointShadowMap:{type:"tv",value:[]},pointShadowMatrix:{type:"m4v",value:[]},hemisphereLights:{type:"sa",value:[],properties:{direction:{type:"v3"},skyColor:{type:"c"},groundColor:{type:"c"}}}},points:{diffuse:{type:"c",value:new We.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new We.Vector4(0,0,1,1)}}},We.ShaderChunk.cube_frag="uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\t#include <logdepthbuf_fragment>\n}\n",We.ShaderChunk.cube_vert="varying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t#include <logdepthbuf_vertex>\n}\n",We.ShaderChunk.depth_frag="uniform float mNear;\nuniform float mFar;\nuniform float opacity;\n#include <common>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );\n\tgl_FragColor = vec4( vec3( color ), opacity );\n}\n",We.ShaderChunk.depth_vert="#include <common>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n}\n",We.ShaderChunk.depthRGBA_frag="#include <common>\n#include <logdepthbuf_pars_fragment>\nvec4 pack_depth( const in float depth ) {\n\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\n\tres -= res.xxyz * bit_mask;\n\treturn res;\n}\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );\n\t#else\n\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n\t#endif\n}\n",We.ShaderChunk.depthRGBA_vert="#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n}\n",We.ShaderChunk.distanceRGBA_frag="uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\nvec4 pack1K ( float depth ) {\n\tdepth /= 1000.0;\n\tconst vec4 bitSh = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n\tconst vec4 bitMsk = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n\tvec4 res = mod( depth * bitSh * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\n\tres -= res.xxyz * bitMsk;\n\treturn res;\n}\nfloat unpack1K ( vec4 color ) {\n\tconst vec4 bitSh = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\treturn dot( color, bitSh ) * 1000.0;\n}\nvoid main () {\n\tgl_FragColor = pack1K( length( vWorldPosition.xyz - lightPos.xyz ) );\n}\n",We.ShaderChunk.distanceRGBA_vert="varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\tvWorldPosition = worldPosition;\n}\n",We.ShaderChunk.equirect_frag="uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <logdepthbuf_fragment>\n}\n",We.ShaderChunk.equirect_vert="varying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t#include <logdepthbuf_vertex>\n}\n",We.ShaderChunk.linedashed_frag="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",We.ShaderChunk.linedashed_vert="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n}\n",We.ShaderChunk.meshbasic_frag="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight;\n\treflectedLight.directDiffuse = vec3( 0.0 );\n\treflectedLight.directSpecular = vec3( 0.0 );\n\treflectedLight.indirectDiffuse = diffuseColor.rgb;\n\treflectedLight.indirectSpecular = vec3( 0.0 );\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",We.ShaderChunk.meshbasic_vert="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n}\n",We.ShaderChunk.meshlambert_frag="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",We.ShaderChunk.meshlambert_vert="#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n}\n",We.ShaderChunk.meshphong_frag="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",We.ShaderChunk.meshphong_vert="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <lights_phong_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_phong_vertex>\n\t#include <shadowmap_vertex>\n}\n",We.ShaderChunk.meshstandard_frag="#define STANDARD\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\nuniform float envMapIntensity;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_standard_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_standard_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",We.ShaderChunk.meshstandard_vert="#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n}\n",We.ShaderChunk.normal_frag="uniform float opacity;\nvarying vec3 vNormal;\n#include <common>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n\t#include <logdepthbuf_fragment>\n}\n",We.ShaderChunk.normal_vert="varying vec3 vNormal;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\tvNormal = normalize( normalMatrix * normal );\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n}\n",We.ShaderChunk.points_frag="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",We.ShaderChunk.points_vert="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n",We.ShaderLib={basic:{uniforms:We.UniformsUtils.merge([We.UniformsLib.common,We.UniformsLib.aomap,We.UniformsLib.fog]),vertexShader:We.ShaderChunk.meshbasic_vert,fragmentShader:We.ShaderChunk.meshbasic_frag},lambert:{uniforms:We.UniformsUtils.merge([We.UniformsLib.common,We.UniformsLib.aomap,We.UniformsLib.lightmap,We.UniformsLib.emissivemap,We.UniformsLib.fog,We.UniformsLib.lights,{emissive:{type:"c",value:new We.Color(0)}}]),vertexShader:We.ShaderChunk.meshlambert_vert,fragmentShader:We.ShaderChunk.meshlambert_frag},phong:{uniforms:We.UniformsUtils.merge([We.UniformsLib.common,We.UniformsLib.aomap,We.UniformsLib.lightmap,We.UniformsLib.emissivemap,We.UniformsLib.bumpmap,We.UniformsLib.normalmap,We.UniformsLib.displacementmap,We.UniformsLib.fog,We.UniformsLib.lights,{emissive:{type:"c",value:new We.Color(0)},specular:{type:"c",value:new We.Color(1118481)},shininess:{type:"f",value:30}}]),vertexShader:We.ShaderChunk.meshphong_vert,fragmentShader:We.ShaderChunk.meshphong_frag},standard:{uniforms:We.UniformsUtils.merge([We.UniformsLib.common,We.UniformsLib.aomap,We.UniformsLib.lightmap,We.UniformsLib.emissivemap,We.UniformsLib.bumpmap,We.UniformsLib.normalmap,We.UniformsLib.displacementmap,We.UniformsLib.roughnessmap,We.UniformsLib.metalnessmap,We.UniformsLib.fog,We.UniformsLib.lights,{emissive:{type:"c",value:new We.Color(0)},roughness:{type:"f",value:.5},metalness:{type:"f",value:0},envMapIntensity:{type:"f",value:1}}]),vertexShader:We.ShaderChunk.meshstandard_vert,fragmentShader:We.ShaderChunk.meshstandard_frag},points:{uniforms:We.UniformsUtils.merge([We.UniformsLib.points,We.UniformsLib.fog]),vertexShader:We.ShaderChunk.points_vert,fragmentShader:We.ShaderChunk.points_frag},dashed:{uniforms:We.UniformsUtils.merge([We.UniformsLib.common,We.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:We.ShaderChunk.linedashed_vert,fragmentShader:We.ShaderChunk.linedashed_frag},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2e3},opacity:{type:"f",value:1}},vertexShader:We.ShaderChunk.depth_vert,fragmentShader:We.ShaderChunk.depth_frag},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:We.ShaderChunk.normal_vert,fragmentShader:We.ShaderChunk.normal_frag},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:We.ShaderChunk.cube_vert,fragmentShader:We.ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:We.ShaderChunk.equirect_vert,fragmentShader:We.ShaderChunk.equirect_frag},depthRGBA:{uniforms:{},vertexShader:We.ShaderChunk.depthRGBA_vert,fragmentShader:We.ShaderChunk.depthRGBA_frag},distanceRGBA:{uniforms:{lightPos:{type:"v3",value:new We.Vector3(0,0,0)}},vertexShader:We.ShaderChunk.distanceRGBA_vert,fragmentShader:We.ShaderChunk.distanceRGBA_frag}},We.WebGLRenderer=function(t){var e=void 0!==(t=t||{}).canvas?t.canvas:document.createElement("canvas"),i=void 0!==t.context?t.context:null,n=void 0!==t.alpha&&t.alpha,o=void 0===t.depth||t.depth,r=void 0===t.stencil||t.stencil,a=void 0!==t.antialias&&t.antialias,s=void 0===t.premultipliedAlpha||t.premultipliedAlpha,l=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,c=[],u=[],h=-1,d=[],p=-1,f=new Float32Array(8),m=[],g=[];this.domElement=e,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=We.LinearToneMapping,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4,this.autoScaleCubemaps=!0;var v,y=this,b=null,w=null,x=null,_=-1,S="",T=null,M=new We.Vector4,I=null,P=new We.Vector4,C=0,A=new We.Color(0),E=0,L=e.width,D=e.height,k=1,R=new We.Vector4(0,0,L,D),O=!1,F=new We.Vector4(0,0,L,D),N=new We.Frustum,U=new We.Matrix4,B=new We.Vector3,z={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[],shadowsPointLight:0},V={geometries:0,textures:0},G={calls:0,vertices:0,faces:0,points:0};this.info={render:G,memory:V,programs:null};try{var j={alpha:n,depth:o,stencil:r,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:l};if(null===(v=i||e.getContext("webgl",j)||e.getContext("experimental-webgl",j)))throw null!==e.getContext("webgl")?"Error creating WebGL context with your selected attributes.":"Error creating WebGL context.";void 0===v.getShaderPrecisionFormat&&(v.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),e.addEventListener("webglcontextlost",st,!1)}catch(t){}var H=new We.WebGLExtensions(v);H.get("OES_texture_float"),H.get("OES_texture_float_linear"),H.get("OES_texture_half_float"),H.get("OES_texture_half_float_linear"),H.get("OES_standard_derivatives"),H.get("ANGLE_instanced_arrays"),H.get("OES_element_index_uint")&&(We.BufferGeometry.MaxIndex=4294967296);var W=new We.WebGLCapabilities(v,H,t),q=new We.WebGLState(v,H,Lt),$=new We.WebGLProperties,Y=new We.WebGLObjects(v,$,this.info),X=new We.WebGLPrograms(this,W),Q=new We.WebGLLights;this.info.programs=X.programs;var Z=new We.WebGLBufferRenderer(v,H,G),K=new We.WebGLIndexedBufferRenderer(v,H,G);function J(){return null===w?k:1}function tt(t,e,i,n){!0===s&&(t*=n,e*=n,i*=n),q.clearColor(t,e,i,n)}function et(){q.init(),q.scissor(M.copy(R).multiplyScalar(k)),q.viewport(P.copy(F).multiplyScalar(k)),tt(A.r,A.g,A.b,E)}function it(){T=b=null,S="",_=-1,q.reset()}et(),this.context=v,this.capabilities=W,this.extensions=H,this.properties=$,this.state=q;var nt=new We.WebGLShadowMap(this,z,Y);this.shadowMap=nt;var ot,rt=new We.SpritePlugin(this,m),at=new We.LensFlarePlugin(this,g);function st(t){t.preventDefault(),it(),et(),$.clear()}function lt(t){var e=t.target;e.removeEventListener("dispose",lt),function(t){var e=$.get(t);if(t.image&&e.__image__webglTextureCube)v.deleteTexture(e.__image__webglTextureCube);else{if(void 0===e.__webglInit)return;v.deleteTexture(e.__webglTexture)}$.delete(t)}(e),V.textures--}function ct(t){var e=t.target;e.removeEventListener("dispose",ct),function(t){var e=$.get(t),i=$.get(t.texture);if(t&&void 0!==i.__webglTexture){if(v.deleteTexture(i.__webglTexture),t instanceof We.WebGLRenderTargetCube)for(var n=0;n<6;n++)v.deleteFramebuffer(e.__webglFramebuffer[n]),v.deleteRenderbuffer(e.__webglDepthbuffer[n]);else v.deleteFramebuffer(e.__webglFramebuffer),v.deleteRenderbuffer(e.__webglDepthbuffer);$.delete(t.texture),$.delete(t)}}(e),V.textures--}function ut(t){var e,i=t.target;i.removeEventListener("dispose",ut),ht(e=i),$.delete(e)}function ht(t){var e=$.get(t).program;(t.program=void 0)!==e&&X.releaseProgram(e)}function dt(t,e){return Math.abs(e[0])-Math.abs(t[0])}function pt(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function ft(t,e){return t.object.renderOrder!==e.object.renderOrder?t.object.renderOrder-e.object.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function mt(t,e,i,n,o){var r,a;a=i.transparent?(r=d,++p):(r=u,++h);var s=r[a];void 0!==s?(s.id=t.id,s.object=t,s.geometry=e,s.material=i,s.z=B.z,s.group=o):(s={id:t.id,object:t,geometry:e,material:i,z:B.z,group:o},r.push(s))}function gt(t,e,i,n){for(var o=0,r=t.length;o<r;o++){var a=t[o],s=a.object,l=a.geometry,c=void 0===n?a.material:n,u=a.group;if(s.modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,s.matrixWorld),s.normalMatrix.getNormalMatrix(s.modelViewMatrix),s instanceof We.ImmediateRenderObject){vt(c);var h=yt(e,i,c,s);S="",s.render(function(t){y.renderBufferImmediate(t,h,c)})}else y.renderBufferDirect(e,i,l,c,s,u)}}function vt(t){var e;(e=t).side!==We.DoubleSide?q.enable(v.CULL_FACE):q.disable(v.CULL_FACE),q.setFlipSided(e.side===We.BackSide),!0===t.transparent?q.setBlending(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha):q.setBlending(We.NoBlending),q.setDepthFunc(t.depthFunc),q.setDepthTest(t.depthTest),q.setDepthWrite(t.depthWrite),q.setColorWrite(t.colorWrite),q.setPolygonOffset(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)}function yt(t,i,n,o){C=0;var r=$.get(n);void 0===r.program&&(n.needsUpdate=!0),void 0!==r.lightsHash&&r.lightsHash!==z.hash&&(n.needsUpdate=!0),n.needsUpdate&&(function(t,e,i){var n=$.get(t),o=X.getParameters(t,z,e,i),r=X.getProgramCode(t,o),a=n.program,s=!0;if(void 0===a)t.addEventListener("dispose",ut);else if(a.code!==r)ht(t);else{if(void 0!==o.shaderID)return;s=!1}if(s){if(o.shaderID){var l=We.ShaderLib[o.shaderID];n.__webglShader={name:t.type,uniforms:We.UniformsUtils.clone(l.uniforms),vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}}else n.__webglShader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.__webglShader=n.__webglShader,a=X.acquireProgram(t,o,r),n.program=a,t.program=a}var c=a.getAttributes();if(t.morphTargets)for(var u=t.numSupportedMorphTargets=0;u<y.maxMorphTargets;u++)0<=c["morphTarget"+u]&&t.numSupportedMorphTargets++;if(t.morphNormals)for(u=t.numSupportedMorphNormals=0;u<y.maxMorphNormals;u++)0<=c["morphNormal"+u]&&t.numSupportedMorphNormals++;n.uniformsList=[];var h=n.__webglShader.uniforms,d=n.program.getUniforms();for(var p in h){var f=d[p];f&&n.uniformsList.push([n.__webglShader.uniforms[p],f])}(t instanceof We.MeshPhongMaterial||t instanceof We.MeshLambertMaterial||t instanceof We.MeshStandardMaterial||t.lights)&&(n.lightsHash=z.hash,h.ambientLightColor.value=z.ambient,h.directionalLights.value=z.directional,h.spotLights.value=z.spot,h.pointLights.value=z.point,h.hemisphereLights.value=z.hemi,h.directionalShadowMap.value=z.directionalShadowMap,h.directionalShadowMatrix.value=z.directionalShadowMatrix,h.spotShadowMap.value=z.spotShadowMap,h.spotShadowMatrix.value=z.spotShadowMatrix,h.pointShadowMap.value=z.pointShadowMap,h.pointShadowMatrix.value=z.pointShadowMatrix),n.hasDynamicUniforms=!1;for(var m=0,g=n.uniformsList.length;m<g;m++)if(!0===n.uniformsList[m][0].dynamic){n.hasDynamicUniforms=!0;break}}(n,i,o),n.needsUpdate=!1);var a,s,l,c,u,h,d,p,f=!1,m=!1,g=!1,w=r.program,x=w.getUniforms(),S=r.__webglShader.uniforms;if(w.id!==b&&(v.useProgram(w.program),b=w.id,g=m=f=!0),n.id!==_&&(_=n.id,m=!0),(f||t!==T)&&(v.uniformMatrix4fv(x.projectionMatrix,!1,t.projectionMatrix.elements),W.logarithmicDepthBuffer&&v.uniform1f(x.logDepthBufFC,2/(Math.log(t.far+1)/Math.LN2)),t!==T&&(T=t,g=m=!0),(n instanceof We.ShaderMaterial||n instanceof We.MeshPhongMaterial||n instanceof We.MeshStandardMaterial||n.envMap)&&void 0!==x.cameraPosition&&(B.setFromMatrixPosition(t.matrixWorld),v.uniform3f(x.cameraPosition,B.x,B.y,B.z)),(n instanceof We.MeshPhongMaterial||n instanceof We.MeshLambertMaterial||n instanceof We.MeshBasicMaterial||n instanceof We.MeshStandardMaterial||n instanceof We.ShaderMaterial||n.skinning)&&void 0!==x.viewMatrix&&v.uniformMatrix4fv(x.viewMatrix,!1,t.matrixWorldInverse.elements),void 0!==x.toneMappingExposure&&v.uniform1f(x.toneMappingExposure,y.toneMappingExposure),void 0!==x.toneMappingWhitePoint&&v.uniform1f(x.toneMappingWhitePoint,y.toneMappingWhitePoint)),n.skinning)if(o.bindMatrix&&void 0!==x.bindMatrix&&v.uniformMatrix4fv(x.bindMatrix,!1,o.bindMatrix.elements),o.bindMatrixInverse&&void 0!==x.bindMatrixInverse&&v.uniformMatrix4fv(x.bindMatrixInverse,!1,o.bindMatrixInverse.elements),W.floatVertexTextures&&o.skeleton&&o.skeleton.useVertexTexture){if(void 0!==x.boneTexture){var M=wt();v.uniform1i(x.boneTexture,M),y.setTexture(o.skeleton.boneTexture,M)}void 0!==x.boneTextureWidth&&v.uniform1i(x.boneTextureWidth,o.skeleton.boneTextureWidth),void 0!==x.boneTextureHeight&&v.uniform1i(x.boneTextureHeight,o.skeleton.boneTextureHeight)}else o.skeleton&&o.skeleton.boneMatrices&&void 0!==x.boneGlobalMatrices&&v.uniformMatrix4fv(x.boneGlobalMatrices,!1,o.skeleton.boneMatrices);return m&&((n instanceof We.MeshPhongMaterial||n instanceof We.MeshLambertMaterial||n instanceof We.MeshStandardMaterial||n.lights)&&(h=g,(u=S).ambientLightColor.needsUpdate=h,u.directionalLights.needsUpdate=h,u.pointLights.needsUpdate=h,u.spotLights.needsUpdate=h,u.hemisphereLights.needsUpdate=h),i&&n.fog&&(c=i,(l=S).fogColor.value=c.color,c instanceof We.Fog?(l.fogNear.value=c.near,l.fogFar.value=c.far):c instanceof We.FogExp2&&(l.fogDensity.value=c.density)),(n instanceof We.MeshBasicMaterial||n instanceof We.MeshLambertMaterial||n instanceof We.MeshPhongMaterial||n instanceof We.MeshStandardMaterial)&&function(t,e){var i;if(t.opacity.value=e.opacity,t.diffuse.value=e.color,e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),t.map.value=e.map,t.specularMap.value=e.specularMap,t.alphaMap.value=e.alphaMap,e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?i=e.map:e.specularMap?i=e.specularMap:e.displacementMap?i=e.displacementMap:e.normalMap?i=e.normalMap:e.bumpMap?i=e.bumpMap:e.roughnessMap?i=e.roughnessMap:e.metalnessMap?i=e.metalnessMap:e.alphaMap?i=e.alphaMap:e.emissiveMap&&(i=e.emissiveMap),void 0!==i){i instanceof We.WebGLRenderTarget&&(i=i.texture);var n=i.offset,o=i.repeat;t.offsetRepeat.value.set(n.x,n.y,o.x,o.y)}t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap instanceof We.WebGLRenderTargetCube?1:-1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio}(S,n),n instanceof We.LineBasicMaterial?bt(S,n):n instanceof We.LineDashedMaterial?(bt(S,n),s=n,(a=S).dashSize.value=s.dashSize,a.totalSize.value=s.dashSize+s.gapSize,a.scale.value=s.scale):n instanceof We.PointsMaterial?function(t,i){if(t.diffuse.value=i.color,t.opacity.value=i.opacity,t.size.value=i.size*k,t.scale.value=e.clientHeight/2,t.map.value=i.map,null!==i.map){var n=i.map.offset,o=i.map.repeat;t.offsetRepeat.value.set(n.x,n.y,o.x,o.y)}}(S,n):n instanceof We.MeshLambertMaterial?function(t,e){e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(S,n):n instanceof We.MeshPhongMaterial?function(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(S,n):n instanceof We.MeshStandardMaterial?function(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}(S,n):n instanceof We.MeshDepthMaterial?(S.mNear.value=t.near,S.mFar.value=t.far,S.opacity.value=n.opacity):n instanceof We.MeshNormalMaterial&&(S.opacity.value=n.opacity),_t(r.uniformsList)),d=x,p=o,v.uniformMatrix4fv(d.modelViewMatrix,!1,p.modelViewMatrix.elements),d.normalMatrix&&v.uniformMatrix3fv(d.normalMatrix,!1,p.normalMatrix.elements),void 0!==x.modelMatrix&&v.uniformMatrix4fv(x.modelMatrix,!1,o.matrixWorld.elements),!0===r.hasDynamicUniforms&&function(t,e,i){for(var n=[],o=0,r=t.length;o<r;o++){var a=t[o][0],s=a.onUpdateCallback;void 0!==s&&(s.bind(a)(e,i),n.push(t[o]))}_t(n)}(r.uniformsList,o,t),w}function bt(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}function wt(){var t=C;return W.maxTextures,C+=1,t}function xt(t,e,i,n){var o,r;if("1i"===e)v.uniform1i(i,n);else if("1f"===e)v.uniform1f(i,n);else if("2f"===e)v.uniform2f(i,n[0],n[1]);else if("3f"===e)v.uniform3f(i,n[0],n[1],n[2]);else if("4f"===e)v.uniform4f(i,n[0],n[1],n[2],n[3]);else if("1iv"===e)v.uniform1iv(i,n);else if("3iv"===e)v.uniform3iv(i,n);else if("1fv"===e)v.uniform1fv(i,n);else if("2fv"===e)v.uniform2fv(i,n);else if("3fv"===e)v.uniform3fv(i,n);else if("4fv"===e)v.uniform4fv(i,n);else if("Matrix2fv"===e)v.uniformMatrix2fv(i,!1,n);else if("Matrix3fv"===e)v.uniformMatrix3fv(i,!1,n);else if("Matrix4fv"===e)v.uniformMatrix4fv(i,!1,n);else if("i"===e)v.uniform1i(i,n);else if("f"===e)v.uniform1f(i,n);else if("v2"===e)v.uniform2f(i,n.x,n.y);else if("v3"===e)v.uniform3f(i,n.x,n.y,n.z);else if("v4"===e)v.uniform4f(i,n.x,n.y,n.z,n.w);else if("c"===e)v.uniform3f(i,n.r,n.g,n.b);else if("s"===e){var a=t.properties;for(var s in a){var l=a[s],c=i[s],u=n[s];xt(l,l.type,c,u)}}else if("sa"===e){a=t.properties;for(var h=0,d=n.length;h<d;h++)for(var s in a)l=a[s],c=i[h][s],u=n[h][s],xt(l,l.type,c,u)}else if("iv1"===e)v.uniform1iv(i,n);else if("iv"===e)v.uniform3iv(i,n);else if("fv1"===e)v.uniform1fv(i,n);else if("fv"===e)v.uniform3fv(i,n);else if("v2v"===e){void 0===t._array&&(t._array=new Float32Array(2*n.length)),h=0;for(var p=0,f=n.length;h<f;h++,p+=2)t._array[p+0]=n[h].x,t._array[p+1]=n[h].y;v.uniform2fv(i,t._array)}else if("v3v"===e){void 0===t._array&&(t._array=new Float32Array(3*n.length)),h=0;var m=0;for(f=n.length;h<f;h++,m+=3)t._array[m+0]=n[h].x,t._array[m+1]=n[h].y,t._array[m+2]=n[h].z;v.uniform3fv(i,t._array)}else if("v4v"===e){void 0===t._array&&(t._array=new Float32Array(4*n.length)),h=0;var g=0;for(f=n.length;h<f;h++,g+=4)t._array[g+0]=n[h].x,t._array[g+1]=n[h].y,t._array[g+2]=n[h].z,t._array[g+3]=n[h].w;v.uniform4fv(i,t._array)}else if("m2"===e)v.uniformMatrix2fv(i,!1,n.elements);else if("m3"===e)v.uniformMatrix3fv(i,!1,n.elements);else if("m3v"===e){for(void 0===t._array&&(t._array=new Float32Array(9*n.length)),h=0,f=n.length;h<f;h++)n[h].flattenToArrayOffset(t._array,9*h);v.uniformMatrix3fv(i,!1,t._array)}else if("m4"===e)v.uniformMatrix4fv(i,!1,n.elements);else if("m4v"===e){for(void 0===t._array&&(t._array=new Float32Array(16*n.length)),h=0,f=n.length;h<f;h++)n[h].flattenToArrayOffset(t._array,16*h);v.uniformMatrix4fv(i,!1,t._array)}else if("t"===e){if(o=n,r=wt(),v.uniform1i(i,r),!o)return;o instanceof We.CubeTexture||Array.isArray(o.image)&&6===o.image.length?It(o,r):o instanceof We.WebGLRenderTargetCube?Pt(o.texture,r):o instanceof We.WebGLRenderTarget?y.setTexture(o.texture,r):y.setTexture(o,r)}else if("tv"===e){for(void 0===t._array&&(t._array=[]),h=0,f=t.value.length;h<f;h++)t._array[h]=wt();for(v.uniform1iv(i,t._array),h=0,f=t.value.length;h<f;h++)o=t.value[h],r=t._array[h],o&&(o instanceof We.CubeTexture||o.image instanceof Array&&6===o.image.length?It(o,r):o instanceof We.WebGLRenderTarget?y.setTexture(o.texture,r):o instanceof We.WebGLRenderTargetCube?Pt(o.texture,r):y.setTexture(o,r))}}function _t(t){for(var e=0,i=t.length;e<i;e++){var n=t[e][0];!1!==n.needsUpdate&&xt(n,n.type,t[e][1],n.value)}}function St(t,e,i){var n;if(i?(v.texParameteri(t,v.TEXTURE_WRAP_S,Lt(e.wrapS)),v.texParameteri(t,v.TEXTURE_WRAP_T,Lt(e.wrapT)),v.texParameteri(t,v.TEXTURE_MAG_FILTER,Lt(e.magFilter)),v.texParameteri(t,v.TEXTURE_MIN_FILTER,Lt(e.minFilter))):(v.texParameteri(t,v.TEXTURE_WRAP_S,v.CLAMP_TO_EDGE),v.texParameteri(t,v.TEXTURE_WRAP_T,v.CLAMP_TO_EDGE),e.wrapS===We.ClampToEdgeWrapping&&(e.wrapT,We.ClampToEdgeWrapping),v.texParameteri(t,v.TEXTURE_MAG_FILTER,Et(e.magFilter)),v.texParameteri(t,v.TEXTURE_MIN_FILTER,Et(e.minFilter)),e.minFilter!==We.NearestFilter&&(e.minFilter,We.LinearFilter)),n=H.get("EXT_texture_filter_anisotropic")){if(e.type===We.FloatType&&null===H.get("OES_texture_float_linear"))return;if(e.type===We.HalfFloatType&&null===H.get("OES_texture_half_float_linear"))return;(1<e.anisotropy||$.get(e).__currentAnisotropy)&&(v.texParameterf(t,n.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(e.anisotropy,y.getMaxAnisotropy())),$.get(e).__currentAnisotropy=e.anisotropy)}}function Tt(t,e){if(t.width>e||t.height>e){var i=e/Math.max(t.width,t.height),n=document.createElement("canvas");return n.width=Math.floor(t.width*i),n.height=Math.floor(t.height*i),n.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,n.width,n.height),n}return t}function Mt(t){return We.Math.isPowerOfTwo(t.width)&&We.Math.isPowerOfTwo(t.height)}function It(t,e){var i=$.get(t);if(6===t.image.length)if(0<t.version&&i.__version!==t.version){i.__image__webglTextureCube||(t.addEventListener("dispose",lt),i.__image__webglTextureCube=v.createTexture(),V.textures++),q.activeTexture(v.TEXTURE0+e),q.bindTexture(v.TEXTURE_CUBE_MAP,i.__image__webglTextureCube),v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var n=t instanceof We.CompressedTexture,o=t.image[0]instanceof We.DataTexture,r=[],a=0;a<6;a++)!y.autoScaleCubemaps||n||o?r[a]=o?t.image[a].image:t.image[a]:r[a]=Tt(t.image[a],W.maxCubemapSize);var s=Mt(r[0]),l=Lt(t.format),c=Lt(t.type);for(St(v.TEXTURE_CUBE_MAP,t,s),a=0;a<6;a++)if(n)for(var u,h=r[a].mipmaps,d=0,p=h.length;d<p;d++)u=h[d],t.format!==We.RGBAFormat&&t.format!==We.RGBFormat?-1<q.getCompressedTextureFormats().indexOf(l)&&q.compressedTexImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+a,d,l,u.width,u.height,0,u.data):q.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+a,d,l,u.width,u.height,0,l,c,u.data);else o?q.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+a,0,l,r[a].width,r[a].height,0,l,c,r[a].data):q.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+a,0,l,l,c,r[a]);t.generateMipmaps&&s&&v.generateMipmap(v.TEXTURE_CUBE_MAP),i.__version=t.version,t.onUpdate&&t.onUpdate(t)}else q.activeTexture(v.TEXTURE0+e),q.bindTexture(v.TEXTURE_CUBE_MAP,i.__image__webglTextureCube)}function Pt(t,e){q.activeTexture(v.TEXTURE0+e),q.bindTexture(v.TEXTURE_CUBE_MAP,$.get(t).__webglTexture)}function Ct(t,e,i,n){var o=Lt(e.texture.format),r=Lt(e.texture.type);q.texImage2D(n,0,o,e.width,e.height,0,o,r,null),v.bindFramebuffer(v.FRAMEBUFFER,t),v.framebufferTexture2D(v.FRAMEBUFFER,i,n,$.get(e.texture).__webglTexture,0),v.bindFramebuffer(v.FRAMEBUFFER,null)}function At(t,e){v.bindRenderbuffer(v.RENDERBUFFER,t),e.depthBuffer&&!e.stencilBuffer?(v.renderbufferStorage(v.RENDERBUFFER,v.DEPTH_COMPONENT16,e.width,e.height),v.framebufferRenderbuffer(v.FRAMEBUFFER,v.DEPTH_ATTACHMENT,v.RENDERBUFFER,t)):e.depthBuffer&&e.stencilBuffer?(v.renderbufferStorage(v.RENDERBUFFER,v.DEPTH_STENCIL,e.width,e.height),v.framebufferRenderbuffer(v.FRAMEBUFFER,v.DEPTH_STENCIL_ATTACHMENT,v.RENDERBUFFER,t)):v.renderbufferStorage(v.RENDERBUFFER,v.RGBA4,e.width,e.height),v.bindRenderbuffer(v.RENDERBUFFER,null)}function Et(t){return t===We.NearestFilter||t===We.NearestMipMapNearestFilter||t===We.NearestMipMapLinearFilter?v.NEAREST:v.LINEAR}function Lt(t){var e;if(t===We.RepeatWrapping)return v.REPEAT;if(t===We.ClampToEdgeWrapping)return v.CLAMP_TO_EDGE;if(t===We.MirroredRepeatWrapping)return v.MIRRORED_REPEAT;if(t===We.NearestFilter)return v.NEAREST;if(t===We.NearestMipMapNearestFilter)return v.NEAREST_MIPMAP_NEAREST;if(t===We.NearestMipMapLinearFilter)return v.NEAREST_MIPMAP_LINEAR;if(t===We.LinearFilter)return v.LINEAR;if(t===We.LinearMipMapNearestFilter)return v.LINEAR_MIPMAP_NEAREST;if(t===We.LinearMipMapLinearFilter)return v.LINEAR_MIPMAP_LINEAR;if(t===We.UnsignedByteType)return v.UNSIGNED_BYTE;if(t===We.UnsignedShort4444Type)return v.UNSIGNED_SHORT_4_4_4_4;if(t===We.UnsignedShort5551Type)return v.UNSIGNED_SHORT_5_5_5_1;if(t===We.UnsignedShort565Type)return v.UNSIGNED_SHORT_5_6_5;if(t===We.ByteType)return v.BYTE;if(t===We.ShortType)return v.SHORT;if(t===We.UnsignedShortType)return v.UNSIGNED_SHORT;if(t===We.IntType)return v.INT;if(t===We.UnsignedIntType)return v.UNSIGNED_INT;if(t===We.FloatType)return v.FLOAT;if(null!==(e=H.get("OES_texture_half_float"))&&t===We.HalfFloatType)return e.HALF_FLOAT_OES;if(t===We.AlphaFormat)return v.ALPHA;if(t===We.RGBFormat)return v.RGB;if(t===We.RGBAFormat)return v.RGBA;if(t===We.LuminanceFormat)return v.LUMINANCE;if(t===We.LuminanceAlphaFormat)return v.LUMINANCE_ALPHA;if(t===We.AddEquation)return v.FUNC_ADD;if(t===We.SubtractEquation)return v.FUNC_SUBTRACT;if(t===We.ReverseSubtractEquation)return v.FUNC_REVERSE_SUBTRACT;if(t===We.ZeroFactor)return v.ZERO;if(t===We.OneFactor)return v.ONE;if(t===We.SrcColorFactor)return v.SRC_COLOR;if(t===We.OneMinusSrcColorFactor)return v.ONE_MINUS_SRC_COLOR;if(t===We.SrcAlphaFactor)return v.SRC_ALPHA;if(t===We.OneMinusSrcAlphaFactor)return v.ONE_MINUS_SRC_ALPHA;if(t===We.DstAlphaFactor)return v.DST_ALPHA;if(t===We.OneMinusDstAlphaFactor)return v.ONE_MINUS_DST_ALPHA;if(t===We.DstColorFactor)return v.DST_COLOR;if(t===We.OneMinusDstColorFactor)return v.ONE_MINUS_DST_COLOR;if(t===We.SrcAlphaSaturateFactor)return v.SRC_ALPHA_SATURATE;if(null!==(e=H.get("WEBGL_compressed_texture_s3tc"))){if(t===We.RGB_S3TC_DXT1_Format)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===We.RGBA_S3TC_DXT1_Format)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===We.RGBA_S3TC_DXT3_Format)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===We.RGBA_S3TC_DXT5_Format)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(null!==(e=H.get("WEBGL_compressed_texture_pvrtc"))){if(t===We.RGB_PVRTC_4BPPV1_Format)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===We.RGB_PVRTC_2BPPV1_Format)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===We.RGBA_PVRTC_4BPPV1_Format)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===We.RGBA_PVRTC_2BPPV1_Format)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(null!==(e=H.get("WEBGL_compressed_texture_etc1"))&&t===We.RGB_ETC1_Format)return e.COMPRESSED_RGB_ETC1_WEBGL;if(null!==(e=H.get("EXT_blend_minmax"))){if(t===We.MinEquation)return e.MIN_EXT;if(t===We.MaxEquation)return e.MAX_EXT}return 0}this.getContext=function(){return v},this.getContextAttributes=function(){return v.getContextAttributes()},this.forceContextLoss=function(){H.get("WEBGL_lose_context").loseContext()},this.getMaxAnisotropy=function(){if(void 0!==ot)return ot;var t=H.get("EXT_texture_filter_anisotropic");return ot=null!==t?v.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},this.getPrecision=function(){return W.precision},this.getPixelRatio=function(){return k},this.setPixelRatio=function(t){void 0!==t&&(k=t,this.setSize(F.z,F.w,!1))},this.getSize=function(){return{width:L,height:D}},this.setSize=function(t,i,n){L=t,D=i,e.width=t*k,e.height=i*k,!1!==n&&(e.style.width=t+"px",e.style.height=i+"px"),this.setViewport(0,0,t,i)},this.setViewport=function(t,e,i,n){q.viewport(F.set(t,e,i,n))},this.setScissor=function(t,e,i,n){q.scissor(R.set(t,e,i,n))},this.setScissorTest=function(t){q.setScissorTest(O=t)},this.getClearColor=function(){return A},this.setClearColor=function(t,e){A.set(t),E=void 0!==e?e:1,tt(A.r,A.g,A.b,E)},this.getClearAlpha=function(){return E},this.setClearAlpha=function(t){E=t,tt(A.r,A.g,A.b,E)},this.clear=function(t,e,i){var n=0;(void 0===t||t)&&(n|=v.COLOR_BUFFER_BIT),(void 0===e||e)&&(n|=v.DEPTH_BUFFER_BIT),(void 0===i||i)&&(n|=v.STENCIL_BUFFER_BIT),v.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,i,n){this.setRenderTarget(t),this.clear(e,i,n)},this.resetGLState=it,this.dispose=function(){e.removeEventListener("webglcontextlost",st,!1)},this.renderBufferImmediate=function(t,e,i){q.initAttributes();var n=$.get(t);t.hasPositions&&!n.position&&(n.position=v.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=v.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=v.createBuffer()),t.hasColors&&!n.color&&(n.color=v.createBuffer());var o=e.getAttributes();if(t.hasPositions&&(v.bindBuffer(v.ARRAY_BUFFER,n.position),v.bufferData(v.ARRAY_BUFFER,t.positionArray,v.DYNAMIC_DRAW),q.enableAttribute(o.position),v.vertexAttribPointer(o.position,3,v.FLOAT,!1,0,0)),t.hasNormals){if(v.bindBuffer(v.ARRAY_BUFFER,n.normal),"MeshPhongMaterial"!==i.type&&"MeshStandardMaterial"!==i.type&&i.shading===We.FlatShading)for(var r=0,a=3*t.count;r<a;r+=9){var s=t.normalArray,l=(s[r+0]+s[r+3]+s[r+6])/3,c=(s[r+1]+s[r+4]+s[r+7])/3,u=(s[r+2]+s[r+5]+s[r+8])/3;s[r+0]=l,s[r+1]=c,s[r+2]=u,s[r+3]=l,s[r+4]=c,s[r+5]=u,s[r+6]=l,s[r+7]=c,s[r+8]=u}v.bufferData(v.ARRAY_BUFFER,t.normalArray,v.DYNAMIC_DRAW),q.enableAttribute(o.normal),v.vertexAttribPointer(o.normal,3,v.FLOAT,!1,0,0)}t.hasUvs&&i.map&&(v.bindBuffer(v.ARRAY_BUFFER,n.uv),v.bufferData(v.ARRAY_BUFFER,t.uvArray,v.DYNAMIC_DRAW),q.enableAttribute(o.uv),v.vertexAttribPointer(o.uv,2,v.FLOAT,!1,0,0)),t.hasColors&&i.vertexColors!==We.NoColors&&(v.bindBuffer(v.ARRAY_BUFFER,n.color),v.bufferData(v.ARRAY_BUFFER,t.colorArray,v.DYNAMIC_DRAW),q.enableAttribute(o.color),v.vertexAttribPointer(o.color,3,v.FLOAT,!1,0,0)),q.disableUnusedAttributes(),v.drawArrays(v.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,i,n,o,r){vt(n);var a=yt(t,e,n,o),s=!1,l=i.id+"_"+a.id+"_"+n.wireframe;l!==S&&(S=l,s=!0);var c=o.morphTargetInfluences;if(void 0!==c){for(var u=[],h=0,d=c.length;h<d;h++){var p=c[h];u.push([p,h])}u.sort(dt),8<u.length&&(u.length=8);var m=i.morphAttributes;for(h=0,d=u.length;h<d;h++)if(p=u[h],f[h]=p[0],0!==p[0]){var g=p[1];!0===n.morphTargets&&m.position&&i.addAttribute("morphTarget"+h,m.position[g]),!0===n.morphNormals&&m.normal&&i.addAttribute("morphNormal"+h,m.normal[g])}else!0===n.morphTargets&&i.removeAttribute("morphTarget"+h),!0===n.morphNormals&&i.removeAttribute("morphNormal"+h);var y=a.getUniforms();null!==y.morphTargetInfluences&&v.uniform1fv(y.morphTargetInfluences,f),s=!0}g=i.index;var b,w=i.attributes.position;!0===n.wireframe&&(g=Y.getWireframeAttribute(i)),null!==g?(b=K).setIndex(g):b=Z,s&&(function(t,e,i,n){var o;if(!(i instanceof We.InstancedBufferGeometry&&null===(o=H.get("ANGLE_instanced_arrays")))){void 0===n&&(n=0),q.initAttributes();var r=i.attributes,a=e.getAttributes(),s=t.defaultAttributeValues;for(var l in a){var c=a[l];if(0<=c){var u=r[l];if(void 0!==u){var h=u.itemSize,d=Y.getAttributeBuffer(u);if(u instanceof We.InterleavedBufferAttribute){var p=u.data,f=p.stride,m=u.offset;p instanceof We.InstancedInterleavedBuffer?(q.enableAttributeAndDivisor(c,p.meshPerAttribute,o),void 0===i.maxInstancedCount&&(i.maxInstancedCount=p.meshPerAttribute*p.count)):q.enableAttribute(c),v.bindBuffer(v.ARRAY_BUFFER,d),v.vertexAttribPointer(c,h,v.FLOAT,!1,f*p.array.BYTES_PER_ELEMENT,(n*f+m)*p.array.BYTES_PER_ELEMENT)}else u instanceof We.InstancedBufferAttribute?(q.enableAttributeAndDivisor(c,u.meshPerAttribute,o),void 0===i.maxInstancedCount&&(i.maxInstancedCount=u.meshPerAttribute*u.count)):q.enableAttribute(c),v.bindBuffer(v.ARRAY_BUFFER,d),v.vertexAttribPointer(c,h,v.FLOAT,!1,0,n*h*4)}else if(void 0!==s){var g=s[l];if(void 0!==g)switch(g.length){case 2:v.vertexAttrib2fv(c,g);break;case 3:v.vertexAttrib3fv(c,g);break;case 4:v.vertexAttrib4fv(c,g);break;default:v.vertexAttrib1fv(c,g)}}}}q.disableUnusedAttributes()}}(n,a,i),null!==g&&v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,Y.getAttributeBuffer(g)));var x=1/0;null!==g?x=g.count:void 0!==w&&(x=w.count);var _=i.drawRange.start,T=i.drawRange.count,M=null!==r?r.start:0,I=null!==r?r.count:1/0,P=Math.max(0,_,M),C=Math.min(0+x,_+T,M+I)-1,A=Math.max(0,C-P+1);if(o instanceof We.Mesh)if(!0===n.wireframe)q.setLineWidth(n.wireframeLinewidth*J()),b.setMode(v.LINES);else switch(o.drawMode){case We.TrianglesDrawMode:b.setMode(v.TRIANGLES);break;case We.TriangleStripDrawMode:b.setMode(v.TRIANGLE_STRIP);break;case We.TriangleFanDrawMode:b.setMode(v.TRIANGLE_FAN)}else if(o instanceof We.Line){var E=n.linewidth;void 0===E&&(E=1),q.setLineWidth(E*J()),o instanceof We.LineSegments?b.setMode(v.LINES):b.setMode(v.LINE_STRIP)}else o instanceof We.Points&&b.setMode(v.POINTS);i instanceof We.InstancedBufferGeometry?0<i.maxInstancedCount&&b.renderInstances(i,P,A):b.render(P,A)},this.render=function(t,e,i,n){if(e instanceof We.Camera!=0){var o,r,a,s=t.fog;if(S="",_=-1,!(T=null)===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld),U.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),N.setFromMatrix(U),c.length=0,p=h=-1,m.length=0,g.length=0,function t(e,i){if(!1!==e.visible){if(e.layers.test(i.layers))if(e instanceof We.Light)c.push(e);else if(e instanceof We.Sprite)!1!==e.frustumCulled&&!0!==N.intersectsObject(e)||m.push(e);else if(e instanceof We.LensFlare)g.push(e);else if(e instanceof We.ImmediateRenderObject)!0===y.sortObjects&&(B.setFromMatrixPosition(e.matrixWorld),B.applyProjection(U)),mt(e,null,e.material,B.z,null);else if((e instanceof We.Mesh||e instanceof We.Line||e instanceof We.Points)&&(e instanceof We.SkinnedMesh&&e.skeleton.update(),!1===e.frustumCulled||!0===N.intersectsObject(e))){var n=e.material;if(!0===n.visible){!0===y.sortObjects&&(B.setFromMatrixPosition(e.matrixWorld),B.applyProjection(U));var o=Y.update(e);if(n instanceof We.MultiMaterial)for(var r=o.groups,a=n.materials,s=0,l=r.length;s<l;s++){var u=r[s],h=a[u.materialIndex];!0===h.visible&&mt(e,o,h,B.z,u)}else mt(e,o,n,B.z,null)}}var d=e.children;for(s=0,l=d.length;s<l;s++)t(d[s],i)}}(t,e),u.length=h+1,d.length=p+1,!0===y.sortObjects&&(u.sort(pt),d.sort(ft)),function(t,e){var i,n,o,r,a,s,l=0,c=0,u=0,h=e.matrixWorldInverse,d=0,p=0,f=0,m=0,g=0;for(z.shadowsPointLight=0,i=0,n=t.length;i<n;i++)if(r=(o=t[i]).color,a=o.intensity,s=o.distance,o instanceof We.AmbientLight)l+=r.r*a,c+=r.g*a,u+=r.b*a;else if(o instanceof We.DirectionalLight){(v=Q.get(o)).color.copy(o.color).multiplyScalar(o.intensity),v.direction.setFromMatrixPosition(o.matrixWorld),B.setFromMatrixPosition(o.target.matrixWorld),v.direction.sub(B),v.direction.transformDirection(h),v.shadow=o.castShadow,o.castShadow&&(v.shadowBias=o.shadow.bias,v.shadowRadius=o.shadow.radius,v.shadowMapSize=o.shadow.mapSize,z.shadows[g++]=o),z.directionalShadowMap[d]=o.shadow.map,z.directionalShadowMatrix[d]=o.shadow.matrix,z.directional[d++]=v}else if(o instanceof We.SpotLight){(v=Q.get(o)).position.setFromMatrixPosition(o.matrixWorld),v.position.applyMatrix4(h),v.color.copy(r).multiplyScalar(a),v.distance=s,v.direction.setFromMatrixPosition(o.matrixWorld),B.setFromMatrixPosition(o.target.matrixWorld),v.direction.sub(B),v.direction.transformDirection(h),v.coneCos=Math.cos(o.angle),v.penumbraCos=Math.cos(o.angle*(1-o.penumbra)),v.decay=0===o.distance?0:o.decay,v.shadow=o.castShadow,o.castShadow&&(v.shadowBias=o.shadow.bias,v.shadowRadius=o.shadow.radius,v.shadowMapSize=o.shadow.mapSize,z.shadows[g++]=o),z.spotShadowMap[f]=o.shadow.map,z.spotShadowMatrix[f]=o.shadow.matrix,z.spot[f++]=v}else if(o instanceof We.PointLight){(v=Q.get(o)).position.setFromMatrixPosition(o.matrixWorld),v.position.applyMatrix4(h),v.color.copy(o.color).multiplyScalar(o.intensity),v.distance=o.distance,v.decay=0===o.distance?0:o.decay,v.shadow=o.castShadow,o.castShadow&&(v.shadowBias=o.shadow.bias,v.shadowRadius=o.shadow.radius,v.shadowMapSize=o.shadow.mapSize,z.shadows[g++]=o),z.pointShadowMap[p]=o.shadow.map,void 0===z.pointShadowMatrix[p]&&(z.pointShadowMatrix[p]=new We.Matrix4),B.setFromMatrixPosition(o.matrixWorld).negate(),z.pointShadowMatrix[p].identity().setPosition(B),z.point[p++]=v}else if(o instanceof We.HemisphereLight){var v;(v=Q.get(o)).direction.setFromMatrixPosition(o.matrixWorld),v.direction.transformDirection(h),v.direction.normalize(),v.skyColor.copy(o.color).multiplyScalar(a),v.groundColor.copy(o.groundColor).multiplyScalar(a),z.hemi[m++]=v}z.ambient[0]=l,z.ambient[1]=c,z.ambient[2]=u,z.directional.length=d,z.spot.length=f,z.point.length=p,z.hemi.length=m,z.shadows.length=g,z.hash=d+","+p+","+f+","+m+","+g}(c,e),nt.render(t,e),G.calls=0,G.vertices=0,G.faces=0,void(G.points=0)===i&&(i=null),this.setRenderTarget(i),(this.autoClear||n)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil),t.overrideMaterial){var l=t.overrideMaterial;gt(u,e,s,l),gt(d,e,s,l)}else q.setBlending(We.NoBlending),gt(u,e,s),gt(d,e,s);if(rt.render(t,e),at.render(t,e,P),i){var f=i.texture;f.generateMipmaps&&Mt(i)&&f.minFilter!==We.NearestFilter&&f.minFilter!==We.LinearFilter&&(r=(o=i)instanceof We.WebGLRenderTargetCube?v.TEXTURE_CUBE_MAP:v.TEXTURE_2D,a=$.get(o.texture).__webglTexture,q.bindTexture(r,a),v.generateMipmap(r),q.bindTexture(r,null))}q.setDepthTest(!0),q.setDepthWrite(!0),q.setColorWrite(!0)}},this.setFaceCulling=function(t,e){t===We.CullFaceNone?q.disable(v.CULL_FACE):(e===We.FrontFaceDirectionCW?v.frontFace(v.CW):v.frontFace(v.CCW),t===We.CullFaceBack?v.cullFace(v.BACK):t===We.CullFaceFront?v.cullFace(v.FRONT):v.cullFace(v.FRONT_AND_BACK),q.enable(v.CULL_FACE))},this.setTexture=function(t,e){var i=$.get(t);if(0<t.version&&i.__version!==t.version){var n=t.image;return void 0===n?void 0:!1===n.complete?void 0:void function(t,e,i){void 0===t.__webglInit&&(t.__webglInit=!0,e.addEventListener("dispose",lt),t.__webglTexture=v.createTexture(),V.textures++),q.activeTexture(v.TEXTURE0+i),q.bindTexture(v.TEXTURE_2D,t.__webglTexture),v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,e.flipY),v.pixelStorei(v.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),v.pixelStorei(v.UNPACK_ALIGNMENT,e.unpackAlignment);var n,o=Tt(e.image,W.maxTextureSize);((n=e).wrapS!==We.ClampToEdgeWrapping||n.wrapT!==We.ClampToEdgeWrapping||n.minFilter!==We.NearestFilter&&n.minFilter!==We.LinearFilter)&&!1===Mt(o)&&(o=function(t){if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement){var e=document.createElement("canvas");return e.width=We.Math.nearestPowerOfTwo(t.width),e.height=We.Math.nearestPowerOfTwo(t.height),e.getContext("2d").drawImage(t,0,0,e.width,e.height),e}return t}(o));var r=Mt(o),a=Lt(e.format),s=Lt(e.type);St(v.TEXTURE_2D,e,r);var l,c=e.mipmaps;if(e instanceof We.DataTexture)if(0<c.length&&r){for(var u=0,h=c.length;u<h;u++)l=c[u],q.texImage2D(v.TEXTURE_2D,u,a,l.width,l.height,0,a,s,l.data);e.generateMipmaps=!1}else q.texImage2D(v.TEXTURE_2D,0,a,o.width,o.height,0,a,s,o.data);else if(e instanceof We.CompressedTexture)for(u=0,h=c.length;u<h;u++)l=c[u],e.format!==We.RGBAFormat&&e.format!==We.RGBFormat?-1<q.getCompressedTextureFormats().indexOf(a)&&q.compressedTexImage2D(v.TEXTURE_2D,u,a,l.width,l.height,0,l.data):q.texImage2D(v.TEXTURE_2D,u,a,l.width,l.height,0,a,s,l.data);else if(0<c.length&&r){for(u=0,h=c.length;u<h;u++)l=c[u],q.texImage2D(v.TEXTURE_2D,u,a,a,s,l);e.generateMipmaps=!1}else q.texImage2D(v.TEXTURE_2D,0,a,a,s,o);e.generateMipmaps&&r&&v.generateMipmap(v.TEXTURE_2D),t.__version=e.version,e.onUpdate&&e.onUpdate(e)}(i,t,e)}q.activeTexture(v.TEXTURE0+e),q.bindTexture(v.TEXTURE_2D,i.__webglTexture)},this.getCurrentRenderTarget=function(){return w},this.setRenderTarget=function(t){(w=t)&&void 0===$.get(t).__webglFramebuffer&&function(t){var e=$.get(t),i=$.get(t.texture);t.addEventListener("dispose",ct),i.__webglTexture=v.createTexture(),V.textures++;var n=t instanceof We.WebGLRenderTargetCube,o=We.Math.isPowerOfTwo(t.width)&&We.Math.isPowerOfTwo(t.height);if(n){e.__webglFramebuffer=[];for(var r=0;r<6;r++)e.__webglFramebuffer[r]=v.createFramebuffer()}else e.__webglFramebuffer=v.createFramebuffer();if(n){for(q.bindTexture(v.TEXTURE_CUBE_MAP,i.__webglTexture),St(v.TEXTURE_CUBE_MAP,t.texture,o),r=0;r<6;r++)Ct(e.__webglFramebuffer[r],t,v.COLOR_ATTACHMENT0,v.TEXTURE_CUBE_MAP_POSITIVE_X+r);t.texture.generateMipmaps&&o&&v.generateMipmap(v.TEXTURE_CUBE_MAP),q.bindTexture(v.TEXTURE_CUBE_MAP,null)}else q.bindTexture(v.TEXTURE_2D,i.__webglTexture),St(v.TEXTURE_2D,t.texture,o),Ct(e.__webglFramebuffer,t,v.COLOR_ATTACHMENT0,v.TEXTURE_2D),t.texture.generateMipmaps&&o&&v.generateMipmap(v.TEXTURE_2D),q.bindTexture(v.TEXTURE_2D,null);t.depthBuffer&&function(t){var e=$.get(t);if(t instanceof We.WebGLRenderTargetCube){e.__webglDepthbuffer=[];for(var i=0;i<6;i++)v.bindFramebuffer(v.FRAMEBUFFER,e.__webglFramebuffer[i]),e.__webglDepthbuffer[i]=v.createRenderbuffer(),At(e.__webglDepthbuffer[i],t)}else v.bindFramebuffer(v.FRAMEBUFFER,e.__webglFramebuffer),e.__webglDepthbuffer=v.createRenderbuffer(),At(e.__webglDepthbuffer,t);v.bindFramebuffer(v.FRAMEBUFFER,null)}(t)}(t);var e,i=t instanceof We.WebGLRenderTargetCube;if(t){var n=$.get(t);e=i?n.__webglFramebuffer[t.activeCubeFace]:n.__webglFramebuffer,M.copy(t.scissor),I=t.scissorTest,P.copy(t.viewport)}else e=null,M.copy(R).multiplyScalar(k),I=O,P.copy(F).multiplyScalar(k);if(x!==e&&(v.bindFramebuffer(v.FRAMEBUFFER,e),x=e),q.scissor(M),q.setScissorTest(I),q.viewport(P),i){var o=$.get(t.texture);v.framebufferTexture2D(v.FRAMEBUFFER,v.COLOR_ATTACHMENT0,v.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,o.__webglTexture,t.activeMipMapLevel)}},this.readRenderTargetPixels=function(t,e,i,n,o,r){if(t instanceof We.WebGLRenderTarget!=0){var a=$.get(t).__webglFramebuffer;if(a){var s=!1;a!==x&&(v.bindFramebuffer(v.FRAMEBUFFER,a),s=!0);try{var l=t.texture;if(l.format!==We.RGBAFormat&&Lt(l.format)!==v.getParameter(v.IMPLEMENTATION_COLOR_READ_FORMAT))return;if(!(l.type===We.UnsignedByteType||Lt(l.type)===v.getParameter(v.IMPLEMENTATION_COLOR_READ_TYPE)||l.type===We.FloatType&&H.get("WEBGL_color_buffer_float")||l.type===We.HalfFloatType&&H.get("EXT_color_buffer_half_float")))return;v.checkFramebufferStatus(v.FRAMEBUFFER)===v.FRAMEBUFFER_COMPLETE&&v.readPixels(e,i,n,o,Lt(l.format),Lt(l.type),r)}finally{s&&v.bindFramebuffer(v.FRAMEBUFFER,x)}}}}},We.WebGLRenderTarget=function(t,e,i){this.uuid=We.Math.generateUUID(),this.width=t,this.height=e,this.scissor=new We.Vector4(0,0,t,e),this.scissorTest=!1,this.viewport=new We.Vector4(0,0,t,e),void 0===(i=i||{}).minFilter&&(i.minFilter=We.LinearFilter),this.texture=new We.Texture(void 0,void 0,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy),this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0===i.stencilBuffer||i.stencilBuffer},We.WebGLRenderTarget.prototype={constructor:We.WebGLRenderTarget,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this},dispose:function(){this.dispatchEvent({type:"dispose"})}},We.EventDispatcher.prototype.apply(We.WebGLRenderTarget.prototype),We.WebGLRenderTargetCube=function(t,e,i){We.WebGLRenderTarget.call(this,t,e,i),this.activeCubeFace=0,this.activeMipMapLevel=0},We.WebGLRenderTargetCube.prototype=Object.create(We.WebGLRenderTarget.prototype),We.WebGLRenderTargetCube.prototype.constructor=We.WebGLRenderTargetCube,We.WebGLBufferRenderer=function(t,e,i){var n;this.setMode=function(t){n=t},this.render=function(e,o){t.drawArrays(n,e,o),i.calls++,i.vertices+=o,n===t.TRIANGLES&&(i.faces+=o/3)},this.renderInstances=function(o){var r=e.get("ANGLE_instanced_arrays");if(null!==r){var a,s=o.attributes.position;a=s instanceof We.InterleavedBufferAttribute?s.data.count:s.count,r.drawArraysInstancedANGLE(n,0,a,o.maxInstancedCount),i.calls++,i.vertices+=a*o.maxInstancedCount,n===t.TRIANGLES&&(i.faces+=o.maxInstancedCount*a/3)}}},We.WebGLIndexedBufferRenderer=function(t,e,i){var n,o,r;this.setMode=function(t){n=t},this.setIndex=function(i){r=i.array instanceof Uint32Array&&e.get("OES_element_index_uint")?(o=t.UNSIGNED_INT,4):(o=t.UNSIGNED_SHORT,2)},this.render=function(e,a){t.drawElements(n,a,o,e*r),i.calls++,i.vertices+=a,n===t.TRIANGLES&&(i.faces+=a/3)},this.renderInstances=function(a,s,l){var c=e.get("ANGLE_instanced_arrays");null!==c&&(c.drawElementsInstancedANGLE(n,l,o,s*r,a.maxInstancedCount),i.calls++,i.vertices+=l*a.maxInstancedCount,n===t.TRIANGLES&&(i.faces+=a.maxInstancedCount*l/3))}},We.WebGLExtensions=function(t){var e={};this.get=function(i){if(void 0!==e[i])return e[i];var n;switch(i){case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":n=t.getExtension("WEBGL_compressed_texture_etc1");break;default:n=t.getExtension(i)}return e[i]=n}},We.WebGLCapabilities=function(t,e,i){function n(e){if("highp"===e){if(0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision)return"highp";e="mediump"}return"mediump"===e&&0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision?"mediump":"lowp"}this.getMaxPrecision=n,this.precision=void 0!==i.precision?i.precision:"highp",this.logarithmicDepthBuffer=void 0!==i.logarithmicDepthBuffer&&i.logarithmicDepthBuffer,this.maxTextures=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),this.maxVertexTextures=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.maxCubemapSize=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),this.maxAttributes=t.getParameter(t.MAX_VERTEX_ATTRIBS),this.maxVertexUniforms=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),this.maxVaryings=t.getParameter(t.MAX_VARYING_VECTORS),this.maxFragmentUniforms=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),this.vertexTextures=0<this.maxVertexTextures,this.floatFragmentTextures=!!e.get("OES_texture_float"),this.floatVertexTextures=this.vertexTextures&&this.floatFragmentTextures;var o=n(this.precision);o!==this.precision&&(this.precision=o),this.logarithmicDepthBuffer&&(this.logarithmicDepthBuffer=!!e.get("EXT_frag_depth"))},We.WebGLGeometries=function(t,e,i){var n={};function o(t){var a=t.target,s=n[a.id];null!==s.index&&r(s.index),function(t){for(var e in t)r(t[e])}(s.attributes),a.removeEventListener("dispose",o),delete n[a.id];var l=e.get(a);l.wireframe&&r(l.wireframe),e.delete(a);var c=e.get(s);c.wireframe&&r(c.wireframe),e.delete(s),i.memory.geometries--}function r(i){var n,o,r=(n=i)instanceof We.InterleavedBufferAttribute?e.get(n.data).__webglBuffer:e.get(n).__webglBuffer;void 0!==r&&(t.deleteBuffer(r),(o=i)instanceof We.InterleavedBufferAttribute?e.delete(o.data):e.delete(o))}this.get=function(t){var e,r=t.geometry;return void 0!==n[r.id]?n[r.id]:(r.addEventListener("dispose",o),r instanceof We.BufferGeometry?e=r:r instanceof We.Geometry&&(void 0===r._bufferGeometry&&(r._bufferGeometry=(new We.BufferGeometry).setFromObject(t)),e=r._bufferGeometry),n[r.id]=e,i.memory.geometries++,e)}},We.WebGLLights=function(){var t={};this.get=function(e){if(void 0!==t[e.id])return t[e.id];var i;switch(e.type){case"DirectionalLight":i={direction:new We.Vector3,color:new We.Color,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new We.Vector2};break;case"SpotLight":i={position:new We.Vector3,direction:new We.Vector3,color:new We.Color,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new We.Vector2};break;case"PointLight":i={position:new We.Vector3,color:new We.Color,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new We.Vector2};break;case"HemisphereLight":i={direction:new We.Vector3,skyColor:new We.Color,groundColor:new We.Color}}return t[e.id]=i}},We.WebGLObjects=function(t,e,i){var n=new We.WebGLGeometries(t,e,i);function o(i,n){var o=i instanceof We.InterleavedBufferAttribute?i.data:i,r=e.get(o);void 0===r.__webglBuffer?function(e,i,n){e.__webglBuffer=t.createBuffer(),t.bindBuffer(n,e.__webglBuffer);var o=i.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW;t.bufferData(n,i.array,o),e.version=i.version}(r,o,n):r.version!==o.version&&function(e,i,n){t.bindBuffer(n,e.__webglBuffer),!1===i.dynamic||-1===i.updateRange.count?t.bufferSubData(n,0,i.array):0===i.updateRange.count||(t.bufferSubData(n,i.updateRange.offset*i.array.BYTES_PER_ELEMENT,i.array.subarray(i.updateRange.offset,i.updateRange.offset+i.updateRange.count)),i.updateRange.count=0),e.version=i.version}(r,o,n)}function r(t,e,i){if(i<e){var n=e;e=i,i=n}var o=t[e];return void 0===o?(t[e]=[i],!0):-1===o.indexOf(i)&&(o.push(i),!0)}this.getAttributeBuffer=function(t){return t instanceof We.InterleavedBufferAttribute?e.get(t.data).__webglBuffer:e.get(t).__webglBuffer},this.getWireframeAttribute=function(i){var n=e.get(i);if(void 0!==n.wireframe)return n.wireframe;var a,s=[],l=i.index,c=i.attributes,u=c.position;if(null!==l)for(var h={},d=0,p=(a=l.array).length;d<p;d+=3){var f=a[d+0],m=a[d+1],g=a[d+2];r(h,f,m)&&s.push(f,m),r(h,m,g)&&s.push(m,g),r(h,g,f)&&s.push(g,f)}else for(d=0,p=(a=c.position.array).length/3-1;d<p;d+=3)f=d+0,m=d+1,g=d+2,s.push(f,m,m,g,g,f);var v=65535<u.count?Uint32Array:Uint16Array,y=new We.BufferAttribute(new v(s),1);return o(y,t.ELEMENT_ARRAY_BUFFER),n.wireframe=y},this.update=function(e){var i=n.get(e);e.geometry instanceof We.Geometry&&i.updateFromObject(e);var r=i.index,a=i.attributes;for(var s in null!==r&&o(r,t.ELEMENT_ARRAY_BUFFER),a)o(a[s],t.ARRAY_BUFFER);var l=i.morphAttributes;for(var s in l)for(var c=l[s],u=0,h=c.length;u<h;u++)o(c[u],t.ARRAY_BUFFER);return i}},We.WebGLProgram=function(){var t=0,e=/^([\w\d_]+)\.([\w\d_]+)$/,i=/^([\w\d_]+)\[(\d+)\]\.([\w\d_]+)$/,n=/^([\w\d_]+)\[0\]$/;function o(t){switch(t){case We.LinearEncoding:return["Linear","( value )"];case We.sRGBEncoding:return["sRGB","( value )"];case We.RGBEEncoding:return["RGBE","( value )"];case We.RGBM7Encoding:return["RGBM","( value, 7.0 )"];case We.RGBM16Encoding:return["RGBM","( value, 16.0 )"];case We.RGBDEncoding:return["RGBD","( value, 256.0 )"];case We.GammaEncoding:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}}function r(t,e){var i=o(e);return"vec4 "+t+"( vec4 value ) { return "+i[0]+"ToLinear"+i[1]+"; }"}function a(t){return""!==t}function s(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function l(t){return t.replace(/#include +<([\w\d.]+)>/g,function(t,e){var i=We.ShaderChunk[e];if(void 0===i)throw new Error("Can not resolve #include <"+e+">");return l(i)})}function c(t){return t.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(t,e,i,n){for(var o="",r=parseInt(e);r<parseInt(i);r++)o+=n.replace(/\[ i \]/g,"[ "+r+" ]");return o})}return function(u,h,d,p){var f=u.context,m=d.extensions,g=d.defines,v=d.__webglShader.vertexShader,y=d.__webglShader.fragmentShader,b="SHADOWMAP_TYPE_BASIC";p.shadowMapType===We.PCFShadowMap?b="SHADOWMAP_TYPE_PCF":p.shadowMapType===We.PCFSoftShadowMap&&(b="SHADOWMAP_TYPE_PCF_SOFT");var w="ENVMAP_TYPE_CUBE",x="ENVMAP_MODE_REFLECTION",_="ENVMAP_BLENDING_MULTIPLY";if(p.envMap){switch(d.envMap.mapping){case We.CubeReflectionMapping:case We.CubeRefractionMapping:w="ENVMAP_TYPE_CUBE";break;case We.CubeUVReflectionMapping:case We.CubeUVRefractionMapping:w="ENVMAP_TYPE_CUBE_UV";break;case We.EquirectangularReflectionMapping:case We.EquirectangularRefractionMapping:w="ENVMAP_TYPE_EQUIREC";break;case We.SphericalReflectionMapping:w="ENVMAP_TYPE_SPHERE"}switch(d.envMap.mapping){case We.CubeRefractionMapping:case We.EquirectangularRefractionMapping:x="ENVMAP_MODE_REFRACTION"}switch(d.combine){case We.MultiplyOperation:_="ENVMAP_BLENDING_MULTIPLY";break;case We.MixOperation:_="ENVMAP_BLENDING_MIX";break;case We.AddOperation:_="ENVMAP_BLENDING_ADD"}}var S,T,M,I,P,C,A,E,L=0<u.gammaFactor?u.gammaFactor:1,D=(S=m,T=p,M=u.extensions,[(S=S||{}).derivatives||T.envMapCubeUV||T.bumpMap||T.normalMap||T.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(S.fragDepth||T.logarithmicDepthBuffer)&&M.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",S.drawBuffers&&M.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(S.shaderTextureLOD||T.envMap)&&M.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(a).join("\n")),k=function(t){var e=[];for(var i in t){var n=t[i];!1!==n&&e.push("#define "+i+" "+n)}return e.join("\n")}(g),R=f.createProgram();P=d instanceof We.RawShaderMaterial?I="":(I=["precision "+p.precision+" float;","precision "+p.precision+" int;","#define SHADER_NAME "+d.__webglShader.name,k,p.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+L,"#define MAX_BONES "+p.maxBones,p.map?"#define USE_MAP":"",p.envMap?"#define USE_ENVMAP":"",p.envMap?"#define "+x:"",p.lightMap?"#define USE_LIGHTMAP":"",p.aoMap?"#define USE_AOMAP":"",p.emissiveMap?"#define USE_EMISSIVEMAP":"",p.bumpMap?"#define USE_BUMPMAP":"",p.normalMap?"#define USE_NORMALMAP":"",p.displacementMap&&p.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",p.specularMap?"#define USE_SPECULARMAP":"",p.roughnessMap?"#define USE_ROUGHNESSMAP":"",p.metalnessMap?"#define USE_METALNESSMAP":"",p.alphaMap?"#define USE_ALPHAMAP":"",p.vertexColors?"#define USE_COLOR":"",p.flatShading?"#define FLAT_SHADED":"",p.skinning?"#define USE_SKINNING":"",p.useVertexTexture?"#define BONE_TEXTURE":"",p.morphTargets?"#define USE_MORPHTARGETS":"",p.morphNormals&&!1===p.flatShading?"#define USE_MORPHNORMALS":"",p.doubleSided?"#define DOUBLE_SIDED":"",p.flipSided?"#define FLIP_SIDED":"",p.shadowMapEnabled?"#define USE_SHADOWMAP":"",p.shadowMapEnabled?"#define "+b:"",0<p.pointLightShadows?"#define POINT_LIGHT_SHADOWS":"",p.sizeAttenuation?"#define USE_SIZEATTENUATION":"",p.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",p.logarithmicDepthBuffer&&u.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(a).join("\n"),[D,"precision "+p.precision+" float;","precision "+p.precision+" int;","#define SHADER_NAME "+d.__webglShader.name,k,p.alphaTest?"#define ALPHATEST "+p.alphaTest:"","#define GAMMA_FACTOR "+L,p.useFog&&p.fog?"#define USE_FOG":"",p.useFog&&p.fogExp?"#define FOG_EXP2":"",p.map?"#define USE_MAP":"",p.envMap?"#define USE_ENVMAP":"",p.envMap?"#define "+w:"",p.envMap?"#define "+x:"",p.envMap?"#define "+_:"",p.lightMap?"#define USE_LIGHTMAP":"",p.aoMap?"#define USE_AOMAP":"",p.emissiveMap?"#define USE_EMISSIVEMAP":"",p.bumpMap?"#define USE_BUMPMAP":"",p.normalMap?"#define USE_NORMALMAP":"",p.specularMap?"#define USE_SPECULARMAP":"",p.roughnessMap?"#define USE_ROUGHNESSMAP":"",p.metalnessMap?"#define USE_METALNESSMAP":"",p.alphaMap?"#define USE_ALPHAMAP":"",p.vertexColors?"#define USE_COLOR":"",p.flatShading?"#define FLAT_SHADED":"",p.doubleSided?"#define DOUBLE_SIDED":"",p.flipSided?"#define FLIP_SIDED":"",p.shadowMapEnabled?"#define USE_SHADOWMAP":"",p.shadowMapEnabled?"#define "+b:"",0<p.pointLightShadows?"#define POINT_LIGHT_SHADOWS":"",p.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",p.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",p.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",p.logarithmicDepthBuffer&&u.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",p.envMap&&u.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",p.toneMapping!==We.NoToneMapping?"#define TONE_MAPPING":"",p.toneMapping!==We.NoToneMapping?We.ShaderChunk.tonemapping_pars_fragment:"",p.toneMapping!==We.NoToneMapping?function(t,e){var i;switch(e){case We.LinearToneMapping:i="Linear";break;case We.ReinhardToneMapping:i="Reinhard";break;case We.Uncharted2ToneMapping:i="Uncharted2";break;case We.CineonToneMapping:i="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 toneMapping( vec3 color ) { return "+i+"ToneMapping( color ); }"}(0,p.toneMapping):"",p.outputEncoding||p.mapEncoding||p.envMapEncoding||p.emissiveMapEncoding?We.ShaderChunk.encodings_pars_fragment:"",p.mapEncoding?r("mapTexelToLinear",p.mapEncoding):"",p.envMapEncoding?r("envMapTexelToLinear",p.envMapEncoding):"",p.emissiveMapEncoding?r("emissiveMapTexelToLinear",p.emissiveMapEncoding):"",p.outputEncoding?(C="linearToOutputTexel",A=p.outputEncoding,E=o(A),"vec4 "+C+"( vec4 value ) { return LinearTo"+E[0]+E[1]+"; }"):"","\n"].filter(a).join("\n")),v=s(v=l(v),p),y=s(y=l(y),p),d instanceof We.ShaderMaterial==0&&(v=c(v),y=c(y));var O=I+v,F=P+y,N=We.WebGLShader(f,f.VERTEX_SHADER,O),U=We.WebGLShader(f,f.FRAGMENT_SHADER,F);f.attachShader(R,N),f.attachShader(R,U),void 0!==d.index0AttributeName?f.bindAttribLocation(R,0,d.index0AttributeName):!0===p.morphTargets&&f.bindAttribLocation(R,0,"position"),f.linkProgram(R);var B,z,V=f.getProgramInfoLog(R),G=f.getShaderInfoLog(N),j=f.getShaderInfoLog(U),H=!0,W=!0;return!1===f.getProgramParameter(R,f.LINK_STATUS)?H=!1:""!==V||(""!==G&&""!==j||(W=!1)),W&&(this.diagnostics={runnable:H,material:d,programLog:V,vertexShader:{log:G,prefix:I},fragmentShader:{log:j,prefix:P}}),f.deleteShader(N),f.deleteShader(U),this.getUniforms=function(){return void 0===B&&(B=function(t,o,r){for(var a={},s=t.getProgramParameter(o,t.ACTIVE_UNIFORMS),l=0;l<s;l++){var c=t.getActiveUniform(o,l).name,u=t.getUniformLocation(o,c),h=e.exec(c);if(h){var d=h[1],p=h[2],f=a[d];f||(f=a[d]={}),f[p]=u}else if(h=i.exec(c)){var m=h[1],g=h[2],v=h[3],y=a[m];y||(y=a[m]=[]);var b=y[g];b||(b=y[g]={}),b[v]=u}else(h=n.exec(c))?a[m=h[1]]=u:a[c]=u}return a}(f,R)),B},this.getAttributes=function(){return void 0===z&&(z=function(t,e,i){for(var n={},o=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),r=0;r<o;r++){var a=t.getActiveAttrib(e,r).name;n[a]=t.getAttribLocation(e,a)}return n}(f,R)),z},this.destroy=function(){f.deleteProgram(R),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return this.getUniforms()}},attributes:{get:function(){return this.getAttributes()}}}),this.id=t++,this.code=h,this.usedTimes=1,this.program=R,this.vertexShader=N,this.fragmentShader=U,this}}(),We.WebGLPrograms=function(t,e){var i=[],n={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshStandardMaterial:"standard",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"},o=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","shadowMapEnabled","pointLightShadows","toneMapping","physicallyCorrectLights","shadowMapType","alphaTest","doubleSided","flipSided"];function r(t,e){var i;return t?t instanceof We.Texture?i=t.encoding:t instanceof We.WebGLRenderTarget&&(i=t.texture.encoding):i=We.LinearEncoding,i===We.LinearEncoding&&e&&(i=We.GammaEncoding),i}this.getParameters=function(i,o,a,s){var l=n[i.type],c=function(t){if(e.floatVertexTextures&&t&&t.skeleton&&t.skeleton.useVertexTexture)return 1024;var i=e.maxVertexUniforms,n=Math.floor((i-20)/4);return void 0!==t&&t instanceof We.SkinnedMesh&&(n=Math.min(t.skeleton.bones.length,n),t.skeleton.bones.length),n}(s),u=t.getPrecision();return null!==i.precision&&(u=e.getMaxPrecision(i.precision),i.precision),{shaderID:l,precision:u,supportsVertexTextures:e.vertexTextures,outputEncoding:r(t.getCurrentRenderTarget(),t.gammaOutput),map:!!i.map,mapEncoding:r(i.map,t.gammaInput),envMap:!!i.envMap,envMapMode:i.envMap&&i.envMap.mapping,envMapEncoding:r(i.envMap,t.gammaInput),envMapCubeUV:!!i.envMap&&(i.envMap.mapping===We.CubeUVReflectionMapping||i.envMap.mapping===We.CubeUVRefractionMapping),lightMap:!!i.lightMap,aoMap:!!i.aoMap,emissiveMap:!!i.emissiveMap,emissiveMapEncoding:r(i.emissiveMap,t.gammaInput),bumpMap:!!i.bumpMap,normalMap:!!i.normalMap,displacementMap:!!i.displacementMap,roughnessMap:!!i.roughnessMap,metalnessMap:!!i.metalnessMap,specularMap:!!i.specularMap,alphaMap:!!i.alphaMap,combine:i.combine,vertexColors:i.vertexColors,fog:a,useFog:i.fog,fogExp:a instanceof We.FogExp2,flatShading:i.shading===We.FlatShading,sizeAttenuation:i.sizeAttenuation,logarithmicDepthBuffer:e.logarithmicDepthBuffer,skinning:i.skinning,maxBones:c,useVertexTexture:e.floatVertexTextures&&s&&s.skeleton&&s.skeleton.useVertexTexture,morphTargets:i.morphTargets,morphNormals:i.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numHemiLights:o.hemi.length,pointLightShadows:o.shadowsPointLight,shadowMapEnabled:t.shadowMap.enabled&&s.receiveShadow&&0<o.shadows.length,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:i.premultipliedAlpha,alphaTest:i.alphaTest,doubleSided:i.side===We.DoubleSide,flipSided:i.side===We.BackSide}},this.getProgramCode=function(t,e){var i=[];if(e.shaderID?i.push(e.shaderID):(i.push(t.fragmentShader),i.push(t.vertexShader)),void 0!==t.defines)for(var n in t.defines)i.push(n),i.push(t.defines[n]);for(var r=0;r<o.length;r++){var a=o[r];i.push(a),i.push(e[a])}return i.join()},this.acquireProgram=function(e,n,o){for(var r,a=0,s=i.length;a<s;a++){var l=i[a];if(l.code===o){++(r=l).usedTimes;break}}return void 0===r&&(r=new We.WebGLProgram(t,o,e,n),i.push(r)),r},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=i.indexOf(t);i[e]=i[i.length-1],i.pop(),t.destroy()}},this.programs=i},We.WebGLProperties=function(){var t={};this.get=function(e){var i=e.uuid,n=t[i];return void 0===n&&(n={},t[i]=n),n},this.delete=function(e){delete t[e.uuid]},this.clear=function(){t={}}},We.WebGLShader=function(t,e,i){var n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS),t.getShaderInfoLog(n),n},We.WebGLShadowMap=function(t,e,i){for(var n=t.context,o=t.state,r=new We.Frustum,a=new We.Matrix4,s=new We.Vector2,l=new We.Vector3,c=new We.Vector3,u=[],h=1,d=2,p=1+(h|d),f=new Array(p),m=new Array(p),g=[new We.Vector3(1,0,0),new We.Vector3(-1,0,0),new We.Vector3(0,0,1),new We.Vector3(0,0,-1),new We.Vector3(0,1,0),new We.Vector3(0,-1,0)],v=[new We.Vector3(0,1,0),new We.Vector3(0,1,0),new We.Vector3(0,1,0),new We.Vector3(0,1,0),new We.Vector3(0,0,1),new We.Vector3(0,0,-1)],y=[new We.Vector4,new We.Vector4,new We.Vector4,new We.Vector4,new We.Vector4,new We.Vector4],b=We.ShaderLib.depthRGBA,w=We.UniformsUtils.clone(b.uniforms),x=We.ShaderLib.distanceRGBA,_=We.UniformsUtils.clone(x.uniforms),S=0;S!==p;++S){var T=0!=(S&h),M=0!=(S&d),I=new We.ShaderMaterial({uniforms:w,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader,morphTargets:T,skinning:M});f[S]=I;var P=new We.ShaderMaterial({defines:{USE_SHADOWMAP:""},uniforms:_,vertexShader:x.vertexShader,fragmentShader:x.fragmentShader,morphTargets:T,skinning:M});m[S]=P}var C=this;function A(t,e,i,n){var o=t.geometry,r=null,a=f,s=t.customDepthMaterial;if(i&&(a=m,s=t.customDistanceMaterial),s)r=s;else{var l=void 0!==o.morphTargets&&0<o.morphTargets.length&&e.morphTargets,c=t instanceof We.SkinnedMesh&&e.skinning,u=0;l&&(u|=h),c&&(u|=d),r=a[u]}return r.visible=e.visible,r.wireframe=e.wireframe,r.wireframeLinewidth=e.wireframeLinewidth,i&&void 0!==r.uniforms.lightPos&&r.uniforms.lightPos.value.copy(n),r}function E(t,e,i){if(!1!==t.visible){t.layers.test(e.layers)&&(t instanceof We.Mesh||t instanceof We.Line||t instanceof We.Points)&&(!t.castShadow||!1!==t.frustumCulled&&!0!==r.intersectsObject(t)||!0===t.material.visible&&(t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld),u.push(t)));for(var n=t.children,o=0,a=n.length;o<a;o++)E(n[o],e,i)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=We.PCFShadowMap,this.cullFace=We.CullFaceFront,this.render=function(h,d){var p,f,m=e.shadows;if(0!==m.length&&!1!==C.enabled&&(!1!==C.autoUpdate||!1!==C.needsUpdate)){o.clearColor(1,1,1,1),o.disable(n.BLEND),o.enable(n.CULL_FACE),n.frontFace(n.CCW),n.cullFace(C.cullFace===We.CullFaceFront?n.FRONT:n.BACK),o.setDepthTest(!0),o.setScissorTest(!1);for(var b=0,w=m.length;b<w;b++){var x=m[b],_=x.shadow,S=_.camera;if(s.copy(_.mapSize),x instanceof We.PointLight){p=6,f=!0;var T=s.x,M=s.y;y[0].set(2*T,M,T,M),y[1].set(0,M,T,M),y[2].set(3*T,M,T,M),y[3].set(T,M,T,M),y[4].set(3*T,0,T,M),y[5].set(T,0,T,M),s.x*=4,s.y*=2}else f=!(p=1);if(null===_.map){var I={minFilter:We.NearestFilter,magFilter:We.NearestFilter,format:We.RGBAFormat};_.map=new We.WebGLRenderTarget(s.x,s.y,I),x instanceof We.SpotLight&&(S.aspect=s.x/s.y),S.updateProjectionMatrix()}var P=_.map,L=_.matrix;c.setFromMatrixPosition(x.matrixWorld),S.position.copy(c),t.setRenderTarget(P),t.clear();for(var D=0;D<p;D++){if(f){l.copy(S.position),l.add(g[D]),S.up.copy(v[D]),S.lookAt(l);var k=y[D];o.viewport(k)}else l.setFromMatrixPosition(x.target.matrixWorld),S.lookAt(l);S.updateMatrixWorld(),S.matrixWorldInverse.getInverse(S.matrixWorld),L.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),L.multiply(S.projectionMatrix),L.multiply(S.matrixWorldInverse),a.multiplyMatrices(S.projectionMatrix,S.matrixWorldInverse),r.setFromMatrix(a),u.length=0,E(h,d,S);for(var R=0,O=u.length;R<O;R++){var F=u[R],N=i.update(F),U=F.material;if(U instanceof We.MultiMaterial)for(var B=N.groups,z=U.materials,V=0,G=B.length;V<G;V++){var j=B[V],H=z[j.materialIndex];if(!0===H.visible){var W=A(F,H,f,c);t.renderBufferDirect(S,null,N,W,F,j)}}else W=A(F,U,f,c),t.renderBufferDirect(S,null,N,W,F,null)}}}var q=t.getClearColor(),$=t.getClearAlpha();t.setClearColor(q,$),o.enable(n.BLEND),C.cullFace===We.CullFaceFront&&n.cullFace(n.BACK),C.needsUpdate=!1}}},We.WebGLState=function(t,e,i){var n=this,o=new We.Vector4,r=new Uint8Array(16),a=new Uint8Array(16),s=new Uint8Array(16),l={},c=null,u=null,h=null,d=null,p=null,f=null,m=null,g=null,v=!1,y=null,b=null,w=null,x=null,_=null,S=null,T=null,M=null,I=null,P=null,C=null,A=null,E=null,L=null,D=null,k=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),R=void 0,O={},F=new We.Vector4,N=null,U=null,B=new We.Vector4,z=new We.Vector4,V=t.createTexture();t.bindTexture(t.TEXTURE_2D,V),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGB,1,1,0,t.RGB,t.UNSIGNED_BYTE,new Uint8Array(3)),this.init=function(){this.clearColor(0,0,0,1),this.clearDepth(1),this.clearStencil(0),this.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.frontFace(t.CCW),t.cullFace(t.BACK),this.enable(t.CULL_FACE),this.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)},this.initAttributes=function(){for(var t=0,e=r.length;t<e;t++)r[t]=0},this.enableAttribute=function(i){r[i]=1,0===a[i]&&(t.enableVertexAttribArray(i),a[i]=1),0!==s[i]&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(i,0),s[i]=0)},this.enableAttributeAndDivisor=function(e,i,n){r[e]=1,0===a[e]&&(t.enableVertexAttribArray(e),a[e]=1),s[e]!==i&&(n.vertexAttribDivisorANGLE(e,i),s[e]=i)},this.disableUnusedAttributes=function(){for(var e=0,i=a.length;e<i;e++)a[e]!==r[e]&&(t.disableVertexAttribArray(e),a[e]=0)},this.enable=function(e){!0!==l[e]&&(t.enable(e),l[e]=!0)},this.disable=function(e){!1!==l[e]&&(t.disable(e),l[e]=!1)},this.getCompressedTextureFormats=function(){if(null===c&&(c=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")))for(var i=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),n=0;n<i.length;n++)c.push(i[n]);return c},this.setBlending=function(e,n,o,r,a,s,l,c){e===We.NoBlending?this.disable(t.BLEND):this.enable(t.BLEND),e===u&&c===v||(e===We.AdditiveBlending?c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE)):e===We.SubtractiveBlending?c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR)):e===We.MultiplyBlending?c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.SRC_COLOR,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR)):c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)),u=e,v=c),e===We.CustomBlending?(a=a||n,s=s||o,l=l||r,n===h&&a===f||(t.blendEquationSeparate(i(n),i(a)),h=n,f=a),o===d&&r===p&&s===m&&l===g||(t.blendFuncSeparate(i(o),i(r),i(s),i(l)),d=o,p=r,m=s,g=l)):g=m=f=p=d=h=null},this.setDepthFunc=function(e){if(y!==e){if(e)switch(e){case We.NeverDepth:t.depthFunc(t.NEVER);break;case We.AlwaysDepth:t.depthFunc(t.ALWAYS);break;case We.LessDepth:t.depthFunc(t.LESS);break;case We.LessEqualDepth:t.depthFunc(t.LEQUAL);break;case We.EqualDepth:t.depthFunc(t.EQUAL);break;case We.GreaterEqualDepth:t.depthFunc(t.GEQUAL);break;case We.GreaterDepth:t.depthFunc(t.GREATER);break;case We.NotEqualDepth:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);y=e}},this.setDepthTest=function(e){e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)},this.setDepthWrite=function(e){b!==e&&(t.depthMask(e),b=e)},this.setColorWrite=function(e){w!==e&&(t.colorMask(e,e,e,e),w=e)},this.setStencilFunc=function(e,i,n){_===e&&S===i&&T===n||(t.stencilFunc(e,i,n),_=e,S=i,T=n)},this.setStencilOp=function(e,i,n){M===e&&I===i&&P===n||(t.stencilOp(e,i,n),M=e,I=i,P=n)},this.setStencilTest=function(e){e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)},this.setStencilWrite=function(e){x!==e&&(t.stencilMask(e),x=e)},this.setFlipSided=function(e){C!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),C=e)},this.setLineWidth=function(e){e!==A&&(t.lineWidth(e),A=e)},this.setPolygonOffset=function(e,i,n){e?this.enable(t.POLYGON_OFFSET_FILL):this.disable(t.POLYGON_OFFSET_FILL),!e||E===i&&L===n||(t.polygonOffset(i,n),E=i,L=n)},this.getScissorTest=function(){return D},this.setScissorTest=function(e){(D=e)?this.enable(t.SCISSOR_TEST):this.disable(t.SCISSOR_TEST)},this.activeTexture=function(e){void 0===e&&(e=t.TEXTURE0+k-1),R!==e&&(t.activeTexture(e),R=e)},this.bindTexture=function(e,i){void 0===R&&n.activeTexture();var o=O[R];void 0===o&&(o={type:void 0,texture:void 0},O[R]=o),o.type===e&&o.texture===i||(t.bindTexture(e,i||V),o.type=e,o.texture=i)},this.compressedTexImage2D=function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){}},this.texImage2D=function(){try{t.texImage2D.apply(t,arguments)}catch(t){}},this.clearColor=function(e,i,n,r){o.set(e,i,n,r),!1===F.equals(o)&&(t.clearColor(e,i,n,r),F.copy(o))},this.clearDepth=function(e){N!==e&&(t.clearDepth(e),N=e)},this.clearStencil=function(e){U!==e&&(t.clearStencil(e),U=e)},this.scissor=function(e){!1===B.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),B.copy(e))},this.viewport=function(e){!1===z.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),z.copy(e))},this.reset=function(){for(var e=0;e<a.length;e++)1===a[e]&&(t.disableVertexAttribArray(e),a[e]=0);l={},R=void 0,O={},C=x=b=w=u=c=null}},We.LensFlarePlugin=function(t,e){var i,n,o,r,a,s,l,c,u=t.context,h=t.state;this.render=function(d,p,f){if(0!==e.length){var m=new We.Vector3,g=f.w/f.z,v=.5*f.z,y=.5*f.w,b=16/f.w,w=new We.Vector2(b*g,b),x=new We.Vector3(1,1,0),_=new We.Vector2(1,1);void 0===o&&function(){var e,d,p,f,m,g=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),v=new Uint16Array([0,1,2,0,2,3]);i=u.createBuffer(),n=u.createBuffer(),u.bindBuffer(u.ARRAY_BUFFER,i),u.bufferData(u.ARRAY_BUFFER,g,u.STATIC_DRAW),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,n),u.bufferData(u.ELEMENT_ARRAY_BUFFER,v,u.STATIC_DRAW),l=u.createTexture(),c=u.createTexture(),h.bindTexture(u.TEXTURE_2D,l),u.texImage2D(u.TEXTURE_2D,0,u.RGB,16,16,0,u.RGB,u.UNSIGNED_BYTE,null),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.NEAREST),h.bindTexture(u.TEXTURE_2D,c),u.texImage2D(u.TEXTURE_2D,0,u.RGBA,16,16,0,u.RGBA,u.UNSIGNED_BYTE,null),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.NEAREST),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.NEAREST),e=(s=0<u.getParameter(u.MAX_VERTEX_TEXTURE_IMAGE_UNITS))?{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if ( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if ( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if ( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")}:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uv;","vec2 pos = position;","if ( renderType == 2 ) {","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision mediump float;","uniform lowp int renderType;","uniform sampler2D map;","uniform sampler2D occlusionMap;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","void main() {","if ( renderType == 0 ) {","gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );","} else if ( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;","visibility = ( 1.0 - visibility / 4.0 );","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * visibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},d=u.createProgram(),p=u.createShader(u.FRAGMENT_SHADER),f=u.createShader(u.VERTEX_SHADER),m="precision "+t.getPrecision()+" float;\n",u.shaderSource(p,m+e.fragmentShader),u.shaderSource(f,m+e.vertexShader),u.compileShader(p),u.compileShader(f),u.attachShader(d,p),u.attachShader(d,f),u.linkProgram(d),o=d,r={vertex:u.getAttribLocation(o,"position"),uv:u.getAttribLocation(o,"uv")},a={renderType:u.getUniformLocation(o,"renderType"),map:u.getUniformLocation(o,"map"),occlusionMap:u.getUniformLocation(o,"occlusionMap"),opacity:u.getUniformLocation(o,"opacity"),color:u.getUniformLocation(o,"color"),scale:u.getUniformLocation(o,"scale"),rotation:u.getUniformLocation(o,"rotation"),screenPosition:u.getUniformLocation(o,"screenPosition")}}(),u.useProgram(o),h.initAttributes(),h.enableAttribute(r.vertex),h.enableAttribute(r.uv),h.disableUnusedAttributes(),u.uniform1i(a.occlusionMap,0),u.uniform1i(a.map,1),u.bindBuffer(u.ARRAY_BUFFER,i),u.vertexAttribPointer(r.vertex,2,u.FLOAT,!1,16,0),u.vertexAttribPointer(r.uv,2,u.FLOAT,!1,16,8),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,n),h.disable(u.CULL_FACE),h.setDepthWrite(!1);for(var S=0,T=e.length;S<T;S++){b=16/f.w,w.set(b*g,b);var M=e[S];if(m.set(M.matrixWorld.elements[12],M.matrixWorld.elements[13],M.matrixWorld.elements[14]),m.applyMatrix4(p.matrixWorldInverse),m.applyProjection(p.projectionMatrix),x.copy(m),_.x=x.x*v+v,_.y=x.y*y+y,s||0<_.x&&_.x<f.z&&0<_.y&&_.y<f.w){h.activeTexture(u.TEXTURE0),h.bindTexture(u.TEXTURE_2D,null),h.activeTexture(u.TEXTURE1),h.bindTexture(u.TEXTURE_2D,l),u.copyTexImage2D(u.TEXTURE_2D,0,u.RGB,f.x+_.x-8,f.y+_.y-8,16,16,0),u.uniform1i(a.renderType,0),u.uniform2f(a.scale,w.x,w.y),u.uniform3f(a.screenPosition,x.x,x.y,x.z),h.disable(u.BLEND),h.enable(u.DEPTH_TEST),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0),h.activeTexture(u.TEXTURE0),h.bindTexture(u.TEXTURE_2D,c),u.copyTexImage2D(u.TEXTURE_2D,0,u.RGBA,f.x+_.x-8,f.y+_.y-8,16,16,0),u.uniform1i(a.renderType,1),h.disable(u.DEPTH_TEST),h.activeTexture(u.TEXTURE1),h.bindTexture(u.TEXTURE_2D,l),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0),M.positionScreen.copy(x),M.customUpdateCallback?M.customUpdateCallback(M):M.updateLensFlares(),u.uniform1i(a.renderType,2),h.enable(u.BLEND);for(var I=0,P=M.lensFlares.length;I<P;I++){var C=M.lensFlares[I];.001<C.opacity&&.001<C.scale&&(x.x=C.x,x.y=C.y,x.z=C.z,b=C.size*C.scale/f.w,w.x=b*g,w.y=b,u.uniform3f(a.screenPosition,x.x,x.y,x.z),u.uniform2f(a.scale,w.x,w.y),u.uniform1f(a.rotation,C.rotation),u.uniform1f(a.opacity,C.opacity),u.uniform3f(a.color,C.color.r,C.color.g,C.color.b),h.setBlending(C.blending,C.blendEquation,C.blendSrc,C.blendDst),t.setTexture(C.texture,1),u.drawElements(u.TRIANGLES,6,u.UNSIGNED_SHORT,0))}}}h.enable(u.CULL_FACE),h.enable(u.DEPTH_TEST),h.setDepthWrite(!0),t.resetGLState()}}},We.SpritePlugin=function(t,e){var i,n,o,r,a,s,l=t.context,c=t.state,u=new We.Vector3,h=new We.Quaternion,d=new We.Vector3;function p(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}this.render=function(f,m){if(0!==e.length){void 0===o&&function(){var e,c,u,h=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),d=new Uint16Array([0,1,2,0,2,3]);i=l.createBuffer(),n=l.createBuffer(),l.bindBuffer(l.ARRAY_BUFFER,i),l.bufferData(l.ARRAY_BUFFER,h,l.STATIC_DRAW),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),l.bufferData(l.ELEMENT_ARRAY_BUFFER,d,l.STATIC_DRAW),e=l.createProgram(),c=l.createShader(l.VERTEX_SHADER),u=l.createShader(l.FRAGMENT_SHADER),l.shaderSource(c,["precision "+t.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n")),l.shaderSource(u,["precision "+t.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n")),l.compileShader(c),l.compileShader(u),l.attachShader(e,c),l.attachShader(e,u),l.linkProgram(e),o=e,r={position:l.getAttribLocation(o,"position"),uv:l.getAttribLocation(o,"uv")},a={uvOffset:l.getUniformLocation(o,"uvOffset"),uvScale:l.getUniformLocation(o,"uvScale"),rotation:l.getUniformLocation(o,"rotation"),scale:l.getUniformLocation(o,"scale"),color:l.getUniformLocation(o,"color"),map:l.getUniformLocation(o,"map"),opacity:l.getUniformLocation(o,"opacity"),modelViewMatrix:l.getUniformLocation(o,"modelViewMatrix"),projectionMatrix:l.getUniformLocation(o,"projectionMatrix"),fogType:l.getUniformLocation(o,"fogType"),fogDensity:l.getUniformLocation(o,"fogDensity"),fogNear:l.getUniformLocation(o,"fogNear"),fogFar:l.getUniformLocation(o,"fogFar"),fogColor:l.getUniformLocation(o,"fogColor"),alphaTest:l.getUniformLocation(o,"alphaTest")};var p=document.createElement("canvas");p.width=8,p.height=8;var f=p.getContext("2d");f.fillStyle="white",f.fillRect(0,0,8,8),(s=new We.Texture(p)).needsUpdate=!0}(),l.useProgram(o),c.initAttributes(),c.enableAttribute(r.position),c.enableAttribute(r.uv),c.disableUnusedAttributes(),c.disable(l.CULL_FACE),c.enable(l.BLEND),l.bindBuffer(l.ARRAY_BUFFER,i),l.vertexAttribPointer(r.position,2,l.FLOAT,!1,16,0),l.vertexAttribPointer(r.uv,2,l.FLOAT,!1,16,8),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n),l.uniformMatrix4fv(a.projectionMatrix,!1,m.projectionMatrix.elements),c.activeTexture(l.TEXTURE0),l.uniform1i(a.map,0);var g=0,v=0,y=f.fog;y?(l.uniform3f(a.fogColor,y.color.r,y.color.g,y.color.b),y instanceof We.Fog?(l.uniform1f(a.fogNear,y.near),l.uniform1f(a.fogFar,y.far),l.uniform1i(a.fogType,1),v=g=1):y instanceof We.FogExp2&&(l.uniform1f(a.fogDensity,y.density),l.uniform1i(a.fogType,2),v=g=2)):(l.uniform1i(a.fogType,0),v=g=0);for(var b=0,w=e.length;b<w;b++)(_=e[b]).modelViewMatrix.multiplyMatrices(m.matrixWorldInverse,_.matrixWorld),_.z=-_.modelViewMatrix.elements[14];e.sort(p);var x=[];for(b=0,w=e.length;b<w;b++){var _,S=(_=e[b]).material;l.uniform1f(a.alphaTest,S.alphaTest),l.uniformMatrix4fv(a.modelViewMatrix,!1,_.modelViewMatrix.elements),_.matrixWorld.decompose(u,h,d),x[0]=d.x,x[1]=d.y;var T=0;f.fog&&S.fog&&(T=v),g!==T&&(l.uniform1i(a.fogType,T),g=T),null!==S.map?(l.uniform2f(a.uvOffset,S.map.offset.x,S.map.offset.y),l.uniform2f(a.uvScale,S.map.repeat.x,S.map.repeat.y)):(l.uniform2f(a.uvOffset,0,0),l.uniform2f(a.uvScale,1,1)),l.uniform1f(a.opacity,S.opacity),l.uniform3f(a.color,S.color.r,S.color.g,S.color.b),l.uniform1f(a.rotation,S.rotation),l.uniform2fv(a.scale,x),c.setBlending(S.blending,S.blendEquation,S.blendSrc,S.blendDst),c.setDepthTest(S.depthTest),c.setDepthWrite(S.depthWrite),S.map&&S.map.image&&S.map.image.width?t.setTexture(S.map,0):t.setTexture(s,0),l.drawElements(l.TRIANGLES,6,l.UNSIGNED_SHORT,0)}c.enable(l.CULL_FACE),t.resetGLState()}}},Object.defineProperties(We.Box2.prototype,{empty:{value:function(){return this.isEmpty()}},isIntersectionBox:{value:function(t){return this.intersectsBox(t)}}}),Object.defineProperties(We.Box3.prototype,{empty:{value:function(){return this.isEmpty()}},isIntersectionBox:{value:function(t){return this.intersectsBox(t)}},isIntersectionSphere:{value:function(t){return this.intersectsSphere(t)}}}),Object.defineProperties(We.Matrix3.prototype,{multiplyVector3:{value:function(t){return t.applyMatrix3(this)}},multiplyVector3Array:{value:function(t){return this.applyToVector3Array(t)}}}),Object.defineProperties(We.Matrix4.prototype,{extractPosition:{value:function(t){return this.copyPosition(t)}},setRotationFromQuaternion:{value:function(t){return this.makeRotationFromQuaternion(t)}},multiplyVector3:{value:function(t){return t.applyProjection(this)}},multiplyVector4:{value:function(t){return t.applyMatrix4(this)}},multiplyVector3Array:{value:function(t){return this.applyToVector3Array(t)}},rotateAxis:{value:function(t){t.transformDirection(this)}},crossVector:{value:function(t){return t.applyMatrix4(this)}},translate:{value:function(t){}},rotateX:{value:function(t){}},rotateY:{value:function(t){}},rotateZ:{value:function(t){}},rotateByAxis:{value:function(t,e){}}}),Object.defineProperties(We.Plane.prototype,{isIntersectionLine:{value:function(t){return this.intersectsLine(t)}}}),Object.defineProperties(We.Quaternion.prototype,{multiplyVector3:{value:function(t){return t.applyQuaternion(this)}}}),Object.defineProperties(We.Ray.prototype,{isIntersectionBox:{value:function(t){return this.intersectsBox(t)}},isIntersectionPlane:{value:function(t){return this.intersectsPlane(t)}},isIntersectionSphere:{value:function(t){return this.intersectsSphere(t)}}}),Object.defineProperties(We.Vector3.prototype,{setEulerFromRotationMatrix:{value:function(){}},setEulerFromQuaternion:{value:function(){}},getPositionFromMatrix:{value:function(t){return this.setFromMatrixPosition(t)}},getScaleFromMatrix:{value:function(t){return this.setFromMatrixScale(t)}},getColumnFromMatrix:{value:function(t,e){return this.setFromMatrixColumn(t,e)}}}),We.Face4=function(t,e,i,n,o,r,a){return new We.Face3(t,e,i,o,r,a)},We.Vertex=function(t,e,i){return new We.Vector3(t,e,i)},Object.defineProperties(We.Object3D.prototype,{eulerOrder:{get:function(){return this.rotation.order},set:function(t){this.rotation.order=t}},getChildByName:{value:function(t){return this.getObjectByName(t)}},renderDepth:{set:function(t){}},translate:{value:function(t,e){return this.translateOnAxis(e,t)}},useQuaternion:{get:function(){},set:function(t){}}}),Object.defineProperties(We,{PointCloud:{value:function(t,e){return new We.Points(t,e)}},ParticleSystem:{value:function(t,e){return new We.Points(t,e)}}}),Object.defineProperties(We.Light.prototype,{onlyShadow:{set:function(t){}},shadowCameraFov:{set:function(t){this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){this.shadow.camera.far=t}},shadowCameraVisible:{set:function(t){}},shadowBias:{set:function(t){this.shadow.bias=t}},shadowDarkness:{set:function(t){}},shadowMapWidth:{set:function(t){this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){this.shadow.mapSize.height=t}}}),Object.defineProperties(We.BufferAttribute.prototype,{length:{get:function(){return this.array.length}}}),Object.defineProperties(We.BufferGeometry.prototype,{drawcalls:{get:function(){return this.groups}},offsets:{get:function(){return this.groups}},addIndex:{value:function(t){this.setIndex(t)}},addDrawCall:{value:function(t,e,i){this.addGroup(t,e)}},clearDrawCalls:{value:function(){this.clearGroups()}},computeTangents:{value:function(){}},computeOffsets:{value:function(){}}}),Object.defineProperties(We.Material.prototype,{wrapAround:{get:function(){},set:function(t){}},wrapRGB:{get:function(){return new We.Color}}}),Object.defineProperties(We,{PointCloudMaterial:{value:function(t){return new We.PointsMaterial(t)}},ParticleBasicMaterial:{value:function(t){return new We.PointsMaterial(t)}},ParticleSystemMaterial:{value:function(t){return new We.PointsMaterial(t)}}}),Object.defineProperties(We.MeshPhongMaterial.prototype,{metal:{get:function(){return!1},set:function(t){}}}),Object.defineProperties(We.ShaderMaterial.prototype,{derivatives:{get:function(){return this.extensions.derivatives},set:function(t){this.extensions.derivatives=t}}}),Object.defineProperties(We.WebGLRenderer.prototype,{supportsFloatTextures:{value:function(){return this.extensions.get("OES_texture_float")}},supportsHalfFloatTextures:{value:function(){return this.extensions.get("OES_texture_half_float")}},supportsStandardDerivatives:{value:function(){return this.extensions.get("OES_standard_derivatives")}},supportsCompressedTextureS3TC:{value:function(){return this.extensions.get("WEBGL_compressed_texture_s3tc")}},supportsCompressedTexturePVRTC:{value:function(){return this.extensions.get("WEBGL_compressed_texture_pvrtc")}},supportsBlendMinMax:{value:function(){return this.extensions.get("EXT_blend_minmax")}},supportsVertexTextures:{value:function(){return this.capabilities.vertexTextures}},supportsInstancedArrays:{value:function(){return this.extensions.get("ANGLE_instanced_arrays")}},enableScissorTest:{value:function(t){this.setScissorTest(t)}},initMaterial:{value:function(){}},addPrePlugin:{value:function(){}},addPostPlugin:{value:function(){}},updateShadowMap:{value:function(){}},shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){this.shadowMap.type=t}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(t){this.shadowMap.cullFace=t}}}),Object.defineProperties(We.WebGLRenderTarget.prototype,{wrapS:{get:function(){return this.texture.wrapS},set:function(t){this.texture.wrapS=t}},wrapT:{get:function(){return this.texture.wrapT},set:function(t){this.texture.wrapT=t}},magFilter:{get:function(){return this.texture.magFilter},set:function(t){this.texture.magFilter=t}},minFilter:{get:function(){return this.texture.minFilter},set:function(t){this.texture.minFilter=t}},anisotropy:{get:function(){return this.texture.anisotropy},set:function(t){this.texture.anisotropy=t}},offset:{get:function(){return this.texture.offset},set:function(t){this.texture.offset=t}},repeat:{get:function(){return this.texture.repeat},set:function(t){this.texture.repeat=t}},format:{get:function(){return this.texture.format},set:function(t){this.texture.format=t}},type:{get:function(){return this.texture.type},set:function(t){this.texture.type=t}},generateMipmaps:{get:function(){return this.texture.generateMipmaps},set:function(t){this.texture.generateMipmaps=t}}}),We.GeometryUtils={merge:function(t,e,i){var n;e instanceof We.Mesh&&(e.matrixAutoUpdate&&e.updateMatrix(),n=e.matrix,e=e.geometry),t.merge(e,n,i)},center:function(t){return t.center()}},We.ImageUtils={crossOrigin:void 0,loadTexture:function(t,e,i,n){var o=new We.TextureLoader;o.setCrossOrigin(this.crossOrigin);var r=o.load(t,i,void 0,n);return e&&(r.mapping=e),r},loadTextureCube:function(t,e,i,n){var o=new We.CubeTextureLoader;o.setCrossOrigin(this.crossOrigin);var r=o.load(t,i,void 0,n);return e&&(r.mapping=e),r},loadCompressedTexture:function(){},loadCompressedTextureCube:function(){}},We.Projector=function(){this.projectVector=function(t,e){t.project(e)},this.unprojectVector=function(t,e){t.unproject(e)},this.pickingRay=function(t,e){}},We.CanvasRenderer=function(){this.domElement=document.createElement("canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}},We.MeshFaceMaterial=We.MultiMaterial,We.CurveUtils={tangentQuadraticBezier:function(t,e,i,n){return 2*(1-t)*(i-e)+2*t*(n-i)},tangentCubicBezier:function(t,e,i,n,o){return-3*e*(1-t)*(1-t)+3*i*(1-t)*(1-t)-6*t*i*(1-t)+6*t*n*(1-t)-3*t*t*n+3*t*t*o},tangentSpline:function(t,e,i,n,o){return 6*t*t-6*t+(3*t*t-4*t+1)+(-6*t*t+6*t)+(3*t*t-2*t)},interpolate:function(t,e,i,n,o){var r=.5*(i-t),a=.5*(n-e),s=o*o;return(2*e-2*i+r+a)*(o*s)+(-3*e+3*i-2*r-a)*s+r*o+e}},We.SceneUtils={createMultiMaterialObject:function(t,e){for(var i=new We.Group,n=0,o=e.length;n<o;n++)i.add(new We.Mesh(t,e[n]));return i},detach:function(t,e,i){t.applyMatrix(e.matrixWorld),e.remove(t),i.add(t)},attach:function(t,e,i){var n=new We.Matrix4;n.getInverse(i.matrixWorld),t.applyMatrix(n),e.remove(t),i.add(t)}},We.ShapeUtils={area:function(t){for(var e=t.length,i=0,n=e-1,o=0;o<e;n=o++)i+=t[n].x*t[o].y-t[o].x*t[n].y;return.5*i},triangulate:function(){function t(t,e,i,n,o,r){var a,s,l,c,u,h,d,p,f,m,g,v,y,b,w,x,_;if(s=t[r[e]].x,l=t[r[e]].y,c=t[r[i]].x,u=t[r[i]].y,h=t[r[n]].x,d=t[r[n]].y,Number.EPSILON>(c-s)*(d-l)-(u-l)*(h-s))return!1;for(m=h-c,g=d-u,v=s-h,y=l-d,b=c-s,w=u-l,a=0;a<o;a++)if(p=t[r[a]].x,f=t[r[a]].y,!(p===s&&f===l||p===c&&f===u||p===h&&f===d)&&(x=b*(f-l)-w*(p-s),_=v*(f-d)-y*(p-h),m*(f-u)-g*(p-c)>=-Number.EPSILON&&_>=-Number.EPSILON&&x>=-Number.EPSILON))return!1;return!0}return function(e,i){var n=e.length;if(n<3)return null;var o,r,a,s=[],l=[],c=[];if(0<We.ShapeUtils.area(e))for(r=0;r<n;r++)l[r]=r;else for(r=0;r<n;r++)l[r]=n-1-r;var u=n,h=2*u;for(r=u-1;2<u;){if(h--<=0)return i?c:s;if(u<=(o=r)&&(o=0),u<=(r=o+1)&&(r=0),u<=(a=r+1)&&(a=0),t(e,o,r,a,u,l)){var d,p,f,m,g;for(d=l[o],p=l[r],f=l[a],s.push([e[d],e[p],e[f]]),c.push([l[o],l[r],l[a]]),g=(m=r)+1;g<u;m++,g++)l[m]=l[g];h=2*--u}}return i?c:s}}(),triangulateShape:function(t,e){function i(t,e,i){return t.x!==e.x?t.x<e.x?t.x<=i.x&&i.x<=e.x:e.x<=i.x&&i.x<=t.x:t.y<e.y?t.y<=i.y&&i.y<=e.y:e.y<=i.y&&i.y<=t.y}function n(t,e,n,o,r){var a=e.x-t.x,s=e.y-t.y,l=o.x-n.x,c=o.y-n.y,u=t.x-n.x,h=t.y-n.y,d=s*l-a*c,p=s*u-a*h;if(Math.abs(d)>Number.EPSILON){var f;if(0<d){if(p<0||d<p)return[];if((f=c*u-l*h)<0||d<f)return[]}else{if(0<p||p<d)return[];if(0<(f=c*u-l*h)||f<d)return[]}if(0===f)return!r||0!==p&&p!==d?[t]:[];if(f===d)return!r||0!==p&&p!==d?[e]:[];if(0===p)return[n];if(p===d)return[o];var m=f/d;return[{x:t.x+m*a,y:t.y+m*s}]}if(0!==p||c*u!=l*h)return[];var g,v,y,b,w,x,_,S,T=0===a&&0===s,M=0===l&&0===c;return T&&M?t.x!==n.x||t.y!==n.y?[]:[t]:T?i(n,o,t)?[t]:[]:M?i(t,e,n)?[n]:[]:(S=0!==a?(b=t.x<e.x?(y=(g=t).x,(v=e).x):(y=(g=e).x,(v=t).x),n.x<o.x?(_=(w=n).x,(x=o).x):(_=(w=o).x,(x=n).x)):(b=t.y<e.y?(y=(g=t).y,(v=e).y):(y=(g=e).y,(v=t).y),n.y<o.y?(_=(w=n).y,(x=o).y):(_=(w=o).y,(x=n).y)),y<=_?b<_?[]:b===_?r?[]:[w]:b<=S?[w,v]:[w,x]:S<y?[]:y===S?r?[]:[g]:b<=S?[g,v]:[g,x])}function o(t,e,i,n){var o=e.x-t.x,r=e.y-t.y,a=i.x-t.x,s=i.y-t.y,l=n.x-t.x,c=n.y-t.y,u=o*s-r*a,h=o*c-r*l;if(Math.abs(u)>Number.EPSILON){var d=l*s-c*a;return 0<u?0<=h&&0<=d:0<=h||0<=d}return 0<h}for(var r,a,s,l,c,u,h={},d=t.concat(),p=0,f=e.length;p<f;p++)Array.prototype.push.apply(d,e[p]);for(r=0,a=d.length;r<a;r++)h[c=d[r].x+":"+d[r].y],h[c]=r;var m=function(t,e){var i,r=t.concat();function a(t,e){var n=r.length-1,a=t-1;a<0&&(a=n);var s=t+1;n<s&&(s=0);var l=o(r[t],r[a],r[s],i[e]);if(!l)return!1;var c=i.length-1,u=e-1;u<0&&(u=c);var h=e+1;return c<h&&(h=0),!!(l=o(i[e],i[u],i[h],r[t]))}function s(t,e){var i,o;for(i=0;i<r.length;i++)if(o=i+1,o%=r.length,0<n(t,e,r[i],r[o],!0).length)return!0;return!1}var l=[];function c(t,i){var o,r,a,s;for(o=0;o<l.length;o++)for(r=e[l[o]],a=0;a<r.length;a++)if(s=a+1,s%=r.length,0<n(t,i,r[a],r[s],!0).length)return!0;return!1}for(var u,h,d,p,f,m,g,v,y,b,w=[],x=0,_=e.length;x<_;x++)l.push(x);for(var S=0,T=2*l.length;0<l.length&&!(--T<0);)for(h=S;h<r.length;h++){for(d=r[h],u=-1,x=0;x<l.length;x++)if(f=l[x],void 0===w[m=d.x+":"+d.y+":"+f]){i=e[f];for(var M=0;M<i.length;M++)if(p=i[M],a(h,M)&&!s(d,p)&&!c(d,p)){u=M,l.splice(x,1),g=r.slice(0,h+1),v=r.slice(h),y=i.slice(u),b=i.slice(0,u+1),r=g.concat(y).concat(b).concat(v),S=h;break}if(0<=u)break;w[m]=!0}if(0<=u)break}return r}(t,e),g=We.ShapeUtils.triangulate(m,!1);for(r=0,a=g.length;r<a;r++)for(l=g[r],s=0;s<3;s++)void 0!==(u=h[c=l[s].x+":"+l[s].y])&&(l[s]=u);return g.concat()},isClockWise:function(t){return We.ShapeUtils.area(t)<0},b2:function(t,e,i,n){return(a=1-t)*a*e+2*(1-(r=t))*r*i+(o=t)*o*n;var o,r,a},b3:function(t,e,i,n,o){return(c=1-t)*c*c*e+3*(l=1-(s=t))*l*s*i+3*(1-(a=t))*a*a*n+(r=t)*r*r*o;var r,a,s,l,c}},We.Curve=function(){},We.Curve.prototype={constructor:We.Curve,getPoint:function(t){return null},getPointAt:function(t){var e=this.getUtoTmapping(t);return this.getPoint(e)},getPoints:function(t){t||(t=5);var e,i=[];for(e=0;e<=t;e++)i.push(this.getPoint(e/t));return i},getSpacedPoints:function(t){t||(t=5);var e,i=[];for(e=0;e<=t;e++)i.push(this.getPointAt(e/t));return i},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,i,n=[],o=this.getPoint(0),r=0;for(n.push(0),i=1;i<=t;i++)r+=(e=this.getPoint(i/t)).distanceTo(o),n.push(r),o=e;return this.cacheArcLengths=n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var i,n=this.getLengths(),o=0,r=n.length;i=e||t*n[r-1];for(var a,s=0,l=r-1;s<=l;)if((a=n[o=Math.floor(s+(l-s)/2)]-i)<0)s=o+1;else{if(!(0<a)){l=o;break}l=o-1}if(n[o=l]===i)return o/(r-1);var c=n[o];return(o+(i-c)/(n[o+1]-c))/(r-1)},getTangent:function(t){var e=t-1e-4,i=t+1e-4;e<0&&(e=0),1<i&&(i=1);var n=this.getPoint(e);return this.getPoint(i).clone().sub(n).normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)}},We.Curve.create=function(t,e){return t.prototype=Object.create(We.Curve.prototype),(t.prototype.constructor=t).prototype.getPoint=e,t},We.CurvePath=function(){this.curves=[],this.autoClose=!1},We.CurvePath.prototype=Object.create(We.Curve.prototype),We.CurvePath.prototype.constructor=We.CurvePath,We.CurvePath.prototype.add=function(t){this.curves.push(t)},We.CurvePath.prototype.closePath=function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new We.LineCurve(e,t))},We.CurvePath.prototype.getPoint=function(t){for(var e=t*this.getLength(),i=this.getCurveLengths(),n=0;n<i.length;){if(i[n]>=e){var o=i[n]-e,r=this.curves[n],a=1-o/r.getLength();return r.getPointAt(a)}n++}return null},We.CurvePath.prototype.getLength=function(){var t=this.getCurveLengths();return t[t.length-1]},We.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,i=0,n=this.curves.length;i<n;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t},We.CurvePath.prototype.createPointsGeometry=function(t){var e=this.getPoints(t);return this.createGeometry(e)},We.CurvePath.prototype.createSpacedPointsGeometry=function(t){var e=this.getSpacedPoints(t);return this.createGeometry(e)},We.CurvePath.prototype.createGeometry=function(t){for(var e=new We.Geometry,i=0,n=t.length;i<n;i++){var o=t[i];e.vertices.push(new We.Vector3(o.x,o.y,o.z||0))}return e},We.Font=function(t){this.data=t},We.Font.prototype={constructor:We.Font,generateShapes:function(t,e,i){function n(t,e,n){var r=o.glyphs[t]||o.glyphs["?"];if(r){var a,s,l,c,u,h,d,p,f,m,g,v=new We.Path,y=[],b=We.ShapeUtils.b2,w=We.ShapeUtils.b3;if(r.o)for(var x=r._cachedOutline||(r._cachedOutline=r.o.split(" ")),_=0,S=x.length;_<S;)switch(x[_++]){case"m":a=x[_++]*e+n,s=x[_++]*e,v.moveTo(a,s);break;case"l":a=x[_++]*e+n,s=x[_++]*e,v.lineTo(a,s);break;case"q":if(l=x[_++]*e+n,c=x[_++]*e,d=x[_++]*e+n,p=x[_++]*e,v.quadraticCurveTo(d,p,l,c),g=y[y.length-1]){u=g.x,h=g.y;for(var T=1;T<=i;T++)b(M=T/i,u,d,l),b(M,h,p,c)}break;case"b":if(l=x[_++]*e+n,c=x[_++]*e,d=x[_++]*e+n,p=x[_++]*e,f=x[_++]*e+n,m=x[_++]*e,v.bezierCurveTo(d,p,f,m,l,c),g=y[y.length-1])for(u=g.x,h=g.y,T=1;T<=i;T++){var M;w(M=T/i,u,d,f,l),w(M,h,p,m,c)}}return{offset:r.ha*e,path:v}}}void 0===e&&(e=100),void 0===i&&(i=4);for(var o=this.data,r=function(t){for(var i=String(t).split(""),r=e/o.resolution,a=0,s=[],l=0;l<i.length;l++){var c=n(i[l],r,a);a+=c.offset,s.push(c.path)}return s}(t),a=[],s=0,l=r.length;s<l;s++)Array.prototype.push.apply(a,r[s].toShapes());return a}},We.Path=function(t){We.CurvePath.call(this),this.actions=[],t&&this.fromPoints(t)},We.Path.prototype=Object.create(We.CurvePath.prototype),We.Path.prototype.constructor=We.Path,We.Path.prototype.fromPoints=function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,i=t.length;e<i;e++)this.lineTo(t[e].x,t[e].y)},We.Path.prototype.moveTo=function(t,e){this.actions.push({action:"moveTo",args:[t,e]})},We.Path.prototype.lineTo=function(t,e){var i=this.actions[this.actions.length-1].args,n=i[i.length-2],o=i[i.length-1],r=new We.LineCurve(new We.Vector2(n,o),new We.Vector2(t,e));this.curves.push(r),this.actions.push({action:"lineTo",args:[t,e]})},We.Path.prototype.quadraticCurveTo=function(t,e,i,n){var o=this.actions[this.actions.length-1].args,r=o[o.length-2],a=o[o.length-1],s=new We.QuadraticBezierCurve(new We.Vector2(r,a),new We.Vector2(t,e),new We.Vector2(i,n));this.curves.push(s),this.actions.push({action:"quadraticCurveTo",args:[t,e,i,n]})},We.Path.prototype.bezierCurveTo=function(t,e,i,n,o,r){var a=this.actions[this.actions.length-1].args,s=a[a.length-2],l=a[a.length-1],c=new We.CubicBezierCurve(new We.Vector2(s,l),new We.Vector2(t,e),new We.Vector2(i,n),new We.Vector2(o,r));this.curves.push(c),this.actions.push({action:"bezierCurveTo",args:[t,e,i,n,o,r]})},We.Path.prototype.splineThru=function(t){var e=Array.prototype.slice.call(arguments),i=this.actions[this.actions.length-1].args,n=i[i.length-2],o=i[i.length-1],r=[new We.Vector2(n,o)];Array.prototype.push.apply(r,t);var a=new We.SplineCurve(r);this.curves.push(a),this.actions.push({action:"splineThru",args:e})},We.Path.prototype.arc=function(t,e,i,n,o,r){var a=this.actions[this.actions.length-1].args,s=a[a.length-2],l=a[a.length-1];this.absarc(t+s,e+l,i,n,o,r)},We.Path.prototype.absarc=function(t,e,i,n,o,r){this.absellipse(t,e,i,i,n,o,r)},We.Path.prototype.ellipse=function(t,e,i,n,o,r,a,s){var l=this.actions[this.actions.length-1].args,c=l[l.length-2],u=l[l.length-1];this.absellipse(t+c,e+u,i,n,o,r,a,s)},We.Path.prototype.absellipse=function(t,e,i,n,o,r,a,s){var l=[t,e,i,n,o,r,a,s||0],c=new We.EllipseCurve(t,e,i,n,o,r,a,s);this.curves.push(c);var u=c.getPoint(1);l.push(u.x),l.push(u.y),this.actions.push({action:"ellipse",args:l})},We.Path.prototype.getSpacedPoints=function(t){t||(t=40);for(var e=[],i=0;i<t;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e},We.Path.prototype.getPoints=function(t){t=t||12;for(var e,i,n,o,r,a,s,l,c,u,h,d=We.ShapeUtils.b2,p=We.ShapeUtils.b3,f=[],m=0,g=this.actions.length;m<g;m++){var v=this.actions[m],y=v.action,b=v.args;switch(y){case"moveTo":case"lineTo":f.push(new We.Vector2(b[0],b[1]));break;case"quadraticCurveTo":e=b[2],i=b[3],r=b[0],a=b[1],l=0<f.length?(s=(c=f[f.length-1]).x,c.y):(s=(c=this.actions[m-1].args)[c.length-2],c[c.length-1]);for(var w=1;w<=t;w++)u=d(D=w/t,s,r,e),h=d(D,l,a,i),f.push(new We.Vector2(u,h));break;case"bezierCurveTo":for(e=b[4],i=b[5],r=b[0],a=b[1],n=b[2],o=b[3],l=0<f.length?(s=(c=f[f.length-1]).x,c.y):(s=(c=this.actions[m-1].args)[c.length-2],c[c.length-1]),w=1;w<=t;w++)u=p(D=w/t,s,r,n,e),h=p(D,l,a,o,i),f.push(new We.Vector2(u,h));break;case"splineThru":c=this.actions[m-1].args;var x=[new We.Vector2(c[c.length-2],c[c.length-1])],_=t*b[0].length;x=x.concat(b[0]);var S=new We.SplineCurve(x);for(w=1;w<=_;w++)f.push(S.getPointAt(w/_));break;case"arc":var T=b[0],M=b[1],I=b[2],P=b[3],C=b[4],A=!!b[5],E=C-P,L=2*t;for(w=1;w<=L;w++){var D=w/L;A||(D=1-D),k=P+D*E,u=T+I*Math.cos(k),h=M+I*Math.sin(k),f.push(new We.Vector2(u,h))}break;case"ellipse":T=b[0],M=b[1];var k,R,O,F=b[2],N=b[3],U=(P=b[4],C=b[5],A=!!b[6],b[7]);for(E=C-P,L=2*t,0!==U&&(R=Math.cos(U),O=Math.sin(U)),w=1;w<=L;w++){if(D=w/L,A||(D=1-D),k=P+D*E,u=T+F*Math.cos(k),h=M+N*Math.sin(k),0!==U){var B=u;u=(B-T)*R-(h-M)*O+T,h=(B-T)*O+(h-M)*R+M}f.push(new We.Vector2(u,h))}}}var z=f[f.length-1];return Math.abs(z.x-f[0].x)<Number.EPSILON&&Math.abs(z.y-f[0].y)<Number.EPSILON&&f.splice(f.length-1,1),this.autoClose&&f.push(f[0]),f},We.Path.prototype.toShapes=function(t,e){function i(t){for(var e=[],i=0,n=t.length;i<n;i++){var o=t[i],r=new We.Shape;r.actions=o.actions,r.curves=o.curves,e.push(r)}return e}function n(t,e){for(var i=e.length,n=!1,o=i-1,r=0;r<i;o=r++){var a=e[o],s=e[r],l=s.x-a.x,c=s.y-a.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(a=e[r],l=-l,s=e[o],c=-c),t.y<a.y||t.y>s.y)continue;if(t.y===a.y){if(t.x===a.x)return!0}else{var u=c*(t.x-a.x)-l*(t.y-a.y);if(0===u)return!0;if(u<0)continue;n=!n}}else{if(t.y!==a.y)continue;if(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x)return!0}}return n}var o=We.ShapeUtils.isClockWise,r=function(t){for(var e=[],i=new We.Path,n=0,o=t.length;n<o;n++){var r=t[n],a=r.args,s=r.action;"moveTo"===s&&0!==i.actions.length&&(e.push(i),i=new We.Path),i[s].apply(i,a)}return 0!==i.actions.length&&e.push(i),e}(this.actions);if(0===r.length)return[];if(!0===e)return i(r);var a,s,l,c=[];if(1===r.length)return s=r[0],(l=new We.Shape).actions=s.actions,l.curves=s.curves,c.push(l),c;var u=!o(r[0].getPoints());u=t?!u:u;var h,d,p=[],f=[],m=[],g=0;f[g]=void 0,m[g]=[];for(var v=0,y=r.length;v<y;v++)a=o(h=(s=r[v]).getPoints()),(a=t?!a:a)?(!u&&f[g]&&g++,f[g]={s:new We.Shape,p:h},f[g].s.actions=s.actions,f[g].s.curves=s.curves,u&&g++,m[g]=[]):m[g].push({h:s,p:h[0]});if(!f[0])return i(r);if(1<f.length){for(var b=!1,w=[],x=0,_=f.length;x<_;x++)p[x]=[];for(x=0,_=f.length;x<_;x++)for(var S=m[x],T=0;T<S.length;T++){for(var M=S[T],I=!0,P=0;P<f.length;P++)n(M.p,f[P].p)&&(x!==P&&w.push({froms:x,tos:P,hole:T}),I?(I=!1,p[P].push(M)):b=!0);I&&p[x].push(M)}0<w.length&&(b||(m=p))}v=0;for(var C=f.length;v<C;v++){l=f[v].s,c.push(l);for(var A=0,E=(d=m[v]).length;A<E;A++)l.holes.push(d[A].h)}return c},We.Shape=function(){We.Path.apply(this,arguments),this.holes=[]},We.Shape.prototype=Object.create(We.Path.prototype),We.Shape.prototype.constructor=We.Shape,We.Shape.prototype.extrude=function(t){return new We.ExtrudeGeometry(this,t)},We.Shape.prototype.makeGeometry=function(t){return new We.ShapeGeometry(this,t)},We.Shape.prototype.getPointsHoles=function(t){for(var e=[],i=0,n=this.holes.length;i<n;i++)e[i]=this.holes[i].getPoints(t);return e},We.Shape.prototype.extractAllPoints=function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},We.Shape.prototype.extractPoints=function(t){return this.extractAllPoints(t)},We.LineCurve=function(t,e){this.v1=t,this.v2=e},We.LineCurve.prototype=Object.create(We.Curve.prototype),We.LineCurve.prototype.constructor=We.LineCurve,We.LineCurve.prototype.getPoint=function(t){var e=this.v2.clone().sub(this.v1);return e.multiplyScalar(t).add(this.v1),e},We.LineCurve.prototype.getPointAt=function(t){return this.getPoint(t)},We.LineCurve.prototype.getTangent=function(t){return this.v2.clone().sub(this.v1).normalize()},We.QuadraticBezierCurve=function(t,e,i){this.v0=t,this.v1=e,this.v2=i},We.QuadraticBezierCurve.prototype=Object.create(We.Curve.prototype),We.QuadraticBezierCurve.prototype.constructor=We.QuadraticBezierCurve,We.QuadraticBezierCurve.prototype.getPoint=function(t){var e=We.ShapeUtils.b2;return new We.Vector2(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y))},We.QuadraticBezierCurve.prototype.getTangent=function(t){var e=We.CurveUtils.tangentQuadraticBezier;return new We.Vector2(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y)).normalize()},We.CubicBezierCurve=function(t,e,i,n){this.v0=t,this.v1=e,this.v2=i,this.v3=n},We.CubicBezierCurve.prototype=Object.create(We.Curve.prototype),We.CubicBezierCurve.prototype.constructor=We.CubicBezierCurve,We.CubicBezierCurve.prototype.getPoint=function(t){var e=We.ShapeUtils.b3;return new We.Vector2(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y))},We.CubicBezierCurve.prototype.getTangent=function(t){var e=We.CurveUtils.tangentCubicBezier;return new We.Vector2(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y)).normalize()},We.SplineCurve=function(t){this.points=null==t?[]:t},We.SplineCurve.prototype=Object.create(We.Curve.prototype),We.SplineCurve.prototype.constructor=We.SplineCurve,We.SplineCurve.prototype.getPoint=function(t){var e=this.points,i=(e.length-1)*t,n=Math.floor(i),o=i-n,r=e[0===n?n:n-1],a=e[n],s=e[n>e.length-2?e.length-1:n+1],l=e[n>e.length-3?e.length-1:n+2],c=We.CurveUtils.interpolate;return new We.Vector2(c(r.x,a.x,s.x,l.x,o),c(r.y,a.y,s.y,l.y,o))},We.EllipseCurve=function(t,e,i,n,o,r,a,s){this.aX=t,this.aY=e,this.xRadius=i,this.yRadius=n,this.aStartAngle=o,this.aEndAngle=r,this.aClockwise=a,this.aRotation=s||0},We.EllipseCurve.prototype=Object.create(We.Curve.prototype),We.EllipseCurve.prototype.constructor=We.EllipseCurve,We.EllipseCurve.prototype.getPoint=function(t){var e,i=this.aEndAngle-this.aStartAngle;i<0&&(i+=2*Math.PI),i>2*Math.PI&&(i-=2*Math.PI),e=!0===this.aClockwise?this.aEndAngle+(1-t)*(2*Math.PI-i):this.aStartAngle+t*i;var n=this.aX+this.xRadius*Math.cos(e),o=this.aY+this.yRadius*Math.sin(e);if(0!==this.aRotation){var r=Math.cos(this.aRotation),a=Math.sin(this.aRotation),s=n,l=o;n=(s-this.aX)*r-(l-this.aY)*a+this.aX,o=(s-this.aX)*a+(l-this.aY)*r+this.aY}return new We.Vector2(n,o)},We.ArcCurve=function(t,e,i,n,o,r){We.EllipseCurve.call(this,t,e,i,i,n,o,r)},We.ArcCurve.prototype=Object.create(We.EllipseCurve.prototype),We.ArcCurve.prototype.constructor=We.ArcCurve,We.LineCurve3=We.Curve.create(function(t,e){this.v1=t,this.v2=e},function(t){var e=new We.Vector3;return e.subVectors(this.v2,this.v1),e.multiplyScalar(t),e.add(this.v1),e}),We.QuadraticBezierCurve3=We.Curve.create(function(t,e,i){this.v0=t,this.v1=e,this.v2=i},function(t){var e=We.ShapeUtils.b2;return new We.Vector3(e(t,this.v0.x,this.v1.x,this.v2.x),e(t,this.v0.y,this.v1.y,this.v2.y),e(t,this.v0.z,this.v1.z,this.v2.z))}),We.CubicBezierCurve3=We.Curve.create(function(t,e,i,n){this.v0=t,this.v1=e,this.v2=i,this.v3=n},function(t){var e=We.ShapeUtils.b3;return new We.Vector3(e(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),e(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),e(t,this.v0.z,this.v1.z,this.v2.z,this.v3.z))}),We.SplineCurve3=We.Curve.create(function(t){this.points=null==t?[]:t},function(t){var e=this.points,i=(e.length-1)*t,n=Math.floor(i),o=i-n,r=e[0==n?n:n-1],a=e[n],s=e[n>e.length-2?e.length-1:n+1],l=e[n>e.length-3?e.length-1:n+2],c=We.CurveUtils.interpolate;return new We.Vector3(c(r.x,a.x,s.x,l.x,o),c(r.y,a.y,s.y,l.y,o),c(r.z,a.z,s.z,l.z,o))}),We.CatmullRomCurve3=function(){var t=new We.Vector3,e=new o,i=new o,n=new o;function o(){}return o.prototype.init=function(t,e,i,n){this.c0=t,this.c1=i,this.c2=-3*t+3*e-2*i-n,this.c3=2*t-2*e+i+n},o.prototype.initNonuniformCatmullRom=function(t,e,i,n,o,r,a){var s=(e-t)/o-(i-t)/(o+r)+(i-e)/r,l=(i-e)/r-(n-e)/(r+a)+(n-i)/a;s*=r,l*=r,this.init(e,i,s,l)},o.prototype.initCatmullRom=function(t,e,i,n,o){this.init(e,i,o*(i-t),o*(n-e))},o.prototype.calc=function(t){var e=t*t,i=e*t;return this.c0+this.c1*t+this.c2*e+this.c3*i},We.Curve.create(function(t){this.points=t||[],this.closed=!1},function(o){var r,a,s,l,c,u,h,d,p=this.points;if(s=(r=((l=p.length)-(this.closed?0:1))*o)-(a=Math.floor(r)),this.closed?a+=0<a?0:(Math.floor(Math.abs(a)/p.length)+1)*p.length:0===s&&a===l-1&&(a=l-2,s=1),c=this.closed||0<a?p[(a-1)%l]:(t.subVectors(p[0],p[1]).add(p[0]),t),u=p[a%l],h=p[(a+1)%l],d=this.closed||a+2<l?p[(a+2)%l]:(t.subVectors(p[l-1],p[l-2]).add(p[l-1]),t),void 0===this.type||"centripetal"===this.type||"chordal"===this.type){var f="chordal"===this.type?.5:.25,m=Math.pow(c.distanceToSquared(u),f),g=Math.pow(u.distanceToSquared(h),f),v=Math.pow(h.distanceToSquared(d),f);g<1e-4&&(g=1),m<1e-4&&(m=g),v<1e-4&&(v=g),e.initNonuniformCatmullRom(c.x,u.x,h.x,d.x,m,g,v),i.initNonuniformCatmullRom(c.y,u.y,h.y,d.y,m,g,v),n.initNonuniformCatmullRom(c.z,u.z,h.z,d.z,m,g,v)}else if("catmullrom"===this.type){var y=void 0!==this.tension?this.tension:.5;e.initCatmullRom(c.x,u.x,h.x,d.x,y),i.initCatmullRom(c.y,u.y,h.y,d.y,y),n.initCatmullRom(c.z,u.z,h.z,d.z,y)}return new We.Vector3(e.calc(s),i.calc(s),n.calc(s))})}(),We.ClosedSplineCurve3=function(t){We.CatmullRomCurve3.call(this,t),this.type="catmullrom",this.closed=!0},We.ClosedSplineCurve3.prototype=Object.create(We.CatmullRomCurve3.prototype),We.BoxGeometry=function(t,e,i,n,o,r){We.Geometry.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:o,depthSegments:r},this.fromBufferGeometry(new We.BoxBufferGeometry(t,e,i,n,o,r)),this.mergeVertices()},We.BoxGeometry.prototype=Object.create(We.Geometry.prototype),We.BoxGeometry.prototype.constructor=We.BoxGeometry,We.CubeGeometry=We.BoxGeometry,We.BoxBufferGeometry=function(t,e,i,n,o,r){We.BufferGeometry.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:o,depthSegments:r};var a=this;n=Math.floor(n)||1,o=Math.floor(o)||1,r=Math.floor(r)||1;var s,l,c,u,h=(u=0,u+=(s=n)*(l=o)*2,u+=s*(c=r)*2,4*(u+=c*l*2)),d=h/4*6,p=new(65535<d?Uint32Array:Uint16Array)(d),f=new Float32Array(3*h),m=new Float32Array(3*h),g=new Float32Array(2*h),v=0,y=0,b=0,w=0,x=0;function _(t,e,i,n,o,r,s,l,c,u,h){for(var d=r/c,_=s/u,S=r/2,T=s/2,M=l/2,I=c+1,P=u+1,C=0,A=0,E=new We.Vector3,L=0;L<P;L++)for(var D=L*_-T,k=0;k<I;k++){var R=k*d-S;E[t]=R*n,E[e]=D*o,E[i]=M,f[v]=E.x,f[v+1]=E.y,f[v+2]=E.z,E[t]=0,E[e]=0,E[i]=0<l?1:-1,m[v]=E.x,m[v+1]=E.y,m[v+2]=E.z,g[y]=k/c,g[y+1]=1-L/u,v+=3,y+=2,C+=1}for(L=0;L<u;L++)for(k=0;k<c;k++){var O=w+k+I*L,F=w+k+I*(L+1),N=w+(k+1)+I*(L+1),U=w+(k+1)+I*L;p[b]=O,p[b+1]=F,p[b+2]=U,p[b+3]=F,p[b+4]=N,p[b+5]=U,b+=6,A+=6}a.addGroup(x,A,h),x+=A,w+=C}_("z","y","x",-1,-1,i,e,t,r,o,0),_("z","y","x",1,-1,i,e,-t,r,o,1),_("x","z","y",1,1,t,i,e,n,r,2),_("x","z","y",1,-1,t,i,-e,n,r,3),_("x","y","z",1,-1,t,e,i,n,o,4),_("x","y","z",-1,-1,t,e,-i,n,o,5),this.setIndex(new We.BufferAttribute(p,1)),this.addAttribute("position",new We.BufferAttribute(f,3)),this.addAttribute("normal",new We.BufferAttribute(m,3)),this.addAttribute("uv",new We.BufferAttribute(g,2))},We.BoxBufferGeometry.prototype=Object.create(We.BufferGeometry.prototype),We.BoxBufferGeometry.prototype.constructor=We.BoxBufferGeometry,We.CircleGeometry=function(t,e,i,n){We.Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:n},this.fromBufferGeometry(new We.CircleBufferGeometry(t,e,i,n))},We.CircleGeometry.prototype=Object.create(We.Geometry.prototype),We.CircleGeometry.prototype.constructor=We.CircleGeometry,We.CircleBufferGeometry=function(t,e,i,n){We.BufferGeometry.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:n},t=t||50,e=void 0!==e?Math.max(3,e):8,i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI;var o=e+2,r=new Float32Array(3*o),a=new Float32Array(3*o),s=new Float32Array(2*o);a[2]=1,s[0]=.5,s[1]=.5;for(var l=0,c=3,u=2;l<=e;l++,c+=3,u+=2){var h=i+l/e*n;r[c]=t*Math.cos(h),r[c+1]=t*Math.sin(h),a[c+2]=1,s[u]=(r[c]/t+1)/2,s[u+1]=(r[c+1]/t+1)/2}var d=[];for(c=1;c<=e;c++)d.push(c,c+1,0);this.setIndex(new We.BufferAttribute(new Uint16Array(d),1)),this.addAttribute("position",new We.BufferAttribute(r,3)),this.addAttribute("normal",new We.BufferAttribute(a,3)),this.addAttribute("uv",new We.BufferAttribute(s,2)),this.boundingSphere=new We.Sphere(new We.Vector3,t)},We.CircleBufferGeometry.prototype=Object.create(We.BufferGeometry.prototype),We.CircleBufferGeometry.prototype.constructor=We.CircleBufferGeometry,We.CylinderBufferGeometry=function(t,e,i,n,o,r,a,s){We.BufferGeometry.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:n,heightSegments:o,openEnded:r,thetaStart:a,thetaLength:s},t=void 0!==t?t:20,e=void 0!==e?e:20,i=void 0!==i?i:100,n=Math.floor(n)||8,o=Math.floor(o)||1,r=void 0!==r&&r,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var l=function(){var t=(n+1)*(o+1);return!1===r&&(t+=2*(n+1)+2*n),t}(),c=function(){var t=n*o*2*3;return!1===r&&(t+=2*n*3),t}(),u=new We.BufferAttribute(new(65535<c?Uint32Array:Uint16Array)(c),1),h=new We.BufferAttribute(new Float32Array(3*l),3),d=new We.BufferAttribute(new Float32Array(3*l),3),p=new We.BufferAttribute(new Float32Array(2*l),2),f=0,m=0,g=[],v=i/2;function y(i){var o,r,l,c=new We.Vector2,g=new We.Vector3,y=!0===i?t:e,b=!0===i?1:-1;for(r=f,o=1;o<=n;o++)h.setXYZ(f,0,v*b,0),d.setXYZ(f,0,b,0),c.y=!0===i?(c.x=o/n,0):(c.x=(o-1)/n,1),p.setXY(f,c.x,c.y),f++;for(l=f,o=0;o<=n;o++){var w=o/n;g.x=y*Math.sin(w*s+a),g.y=v*b,g.z=y*Math.cos(w*s+a),h.setXYZ(f,g.x,g.y,g.z),d.setXYZ(f,0,b,0),p.setXY(f,w,!0===i?1:0),f++}for(o=0;o<n;o++){var x=r+o,_=l+o;!0===i?(u.setX(m,_),m++,u.setX(m,_+1)):(u.setX(m,_+1),m++,u.setX(m,_)),m++,u.setX(m,x),m++}}!function(){var r,l,c=new We.Vector3,y=new We.Vector3,b=(e-t)/i;for(l=0;l<=o;l++){var w=[],x=l/o,_=x*(e-t)+t;for(r=0;r<=n;r++){var S=r/n;y.x=_*Math.sin(S*s+a),y.y=-x*i+v,y.z=_*Math.cos(S*s+a),h.setXYZ(f,y.x,y.y,y.z),c.copy(y),(0===t&&0===l||0===e&&l===o)&&(c.x=Math.sin(S*s+a),c.z=Math.cos(S*s+a)),c.setY(Math.sqrt(c.x*c.x+c.z*c.z)*b).normalize(),d.setXYZ(f,c.x,c.y,c.z),p.setXY(f,S,1-x),w.push(f),f++}g.push(w)}for(r=0;r<n;r++)for(l=0;l<o;l++){var T=g[l][r],M=g[l+1][r],I=g[l+1][r+1],P=g[l][r+1];u.setX(m,T),m++,u.setX(m,M),m++,u.setX(m,P),m++,u.setX(m,M),m++,u.setX(m,I),m++,u.setX(m,P),m++}}(),!1===r&&(0<t&&y(!0),0<e&&y(!1)),this.setIndex(u),this.addAttribute("position",h),this.addAttribute("normal",d),this.addAttribute("uv",p)},We.CylinderBufferGeometry.prototype=Object.create(We.BufferGeometry.prototype),We.CylinderBufferGeometry.prototype.constructor=We.CylinderBufferGeometry,We.CylinderGeometry=function(t,e,i,n,o,r,a,s){We.Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:n,heightSegments:o,openEnded:r,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new We.CylinderBufferGeometry(t,e,i,n,o,r,a,s)),this.mergeVertices()},We.CylinderGeometry.prototype=Object.create(We.Geometry.prototype),We.CylinderGeometry.prototype.constructor=We.CylinderGeometry,We.EdgesGeometry=function(t,e){We.BufferGeometry.call(this),e=void 0!==e?e:1;var i=Math.cos(We.Math.degToRad(e)),n=[0,0],o={};function r(t,e){return t-e}var a,s=["a","b","c"];t instanceof We.BufferGeometry?(a=new We.Geometry).fromBufferGeometry(t):a=t.clone(),a.mergeVertices(),a.computeFaceNormals();for(var l=a.vertices,c=a.faces,u=0,h=c.length;u<h;u++)for(var d=c[u],p=0;p<3;p++)n[0]=d[s[p]],n[1]=d[s[(p+1)%3]],n.sort(r),void 0===o[m=n.toString()]?o[m]={vert1:n[0],vert2:n[1],face1:u,face2:void 0}:o[m].face2=u;var f=[];for(var m in o){var g=o[m];if(void 0===g.face2||c[g.face1].normal.dot(c[g.face2].normal)<=i){var v=l[g.vert1];f.push(v.x),f.push(v.y),f.push(v.z),v=l[g.vert2],f.push(v.x),f.push(v.y),f.push(v.z)}}this.addAttribute("position",new We.BufferAttribute(new Float32Array(f),3))};We.EdgesGeometry.prototype=Object.create(We.BufferGeometry.prototype),We.EdgesGeometry.prototype.constructor=We.EdgesGeometry,We.ExtrudeGeometry=function(t,e){void 0!==t?(We.Geometry.call(this),this.type="ExtrudeGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),this.computeFaceNormals()):t=[]},We.ExtrudeGeometry.prototype=Object.create(We.Geometry.prototype),We.ExtrudeGeometry.prototype.constructor=We.ExtrudeGeometry,We.ExtrudeGeometry.prototype.addShapeList=function(t,e){for(var i=t.length,n=0;n<i;n++){var o=t[n];this.addShape(o,e)}},We.ExtrudeGeometry.prototype.addShape=function(t,e){var i,n,o,r,a,s,l,c,u=void 0!==e.amount?e.amount:100,h=void 0!==e.bevelThickness?e.bevelThickness:6,d=void 0!==e.bevelSize?e.bevelSize:h-2,p=void 0!==e.bevelSegments?e.bevelSegments:3,f=void 0===e.bevelEnabled||e.bevelEnabled,m=void 0!==e.curveSegments?e.curveSegments:12,g=void 0!==e.steps?e.steps:1,v=e.extrudePath,y=!1,b=void 0!==e.UVGenerator?e.UVGenerator:We.ExtrudeGeometry.WorldUVGenerator;v&&(i=v.getSpacedPoints(g),f=!(y=!0),n=void 0!==e.frames?e.frames:new We.TubeGeometry.FrenetFrames(v,g,!1),o=new We.Vector3,r=new We.Vector3,a=new We.Vector3),f||(d=h=p=0);var w=this,x=this.vertices.length,_=t.extractPoints(m),S=_.shape,T=_.holes,M=!We.ShapeUtils.isClockWise(S);if(M){for(S=S.reverse(),l=0,c=T.length;l<c;l++)s=T[l],We.ShapeUtils.isClockWise(s)&&(T[l]=s.reverse());M=!1}var I=We.ShapeUtils.triangulateShape(S,T),P=S;for(l=0,c=T.length;l<c;l++)s=T[l],S=S.concat(s);function C(t,e,i){return e.clone().multiplyScalar(i).add(t)}var A,E,L,D,k,R,O=S.length,F=I.length;function N(t,e,i){var n,o,r=1,a=t.x-e.x,s=t.y-e.y,l=i.x-t.x,c=i.y-t.y,u=a*a+s*s,h=a*c-s*l;if(Math.abs(h)>Number.EPSILON){var d=Math.sqrt(u),p=Math.sqrt(l*l+c*c),f=e.x-s/d,m=e.y+a/d,g=((i.x-c/p-f)*c-(i.y+l/p-m)*l)/(a*c-s*l),v=(n=f+a*g-t.x)*n+(o=m+s*g-t.y)*o;if(v<=2)return new We.Vector2(n,o);r=Math.sqrt(v/2)}else{var y=!1;a>Number.EPSILON?l>Number.EPSILON&&(y=!0):a<-Number.EPSILON?l<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(c)&&(y=!0),r=y?(n=-s,o=a,Math.sqrt(u)):(n=a,o=s,Math.sqrt(u/2))}return new We.Vector2(n/r,o/r)}for(var U=[],B=0,z=P.length,V=z-1,G=B+1;B<z;B++,V++,G++)V===z&&(V=0),G===z&&(G=0),U[B]=N(P[B],P[V],P[G]);var j,H,W=[],q=U.concat();for(l=0,c=T.length;l<c;l++){for(s=T[l],j=[],B=0,V=(z=s.length)-1,G=B+1;B<z;B++,V++,G++)V===z&&(V=0),G===z&&(G=0),j[B]=N(s[B],s[V],s[G]);W.push(j),q=q.concat(j)}for(A=0;A<p;A++){for(D=h*(1-(L=A/p)),E=d*Math.sin(L*Math.PI/2),B=0,z=P.length;B<z;B++)Y((k=C(P[B],U[B],E)).x,k.y,-D);for(l=0,c=T.length;l<c;l++)for(s=T[l],j=W[l],B=0,z=s.length;B<z;B++)Y((k=C(s[B],j[B],E)).x,k.y,-D)}for(E=d,B=0;B<O;B++)k=f?C(S[B],q[B],E):S[B],y?(r.copy(n.normals[0]).multiplyScalar(k.x),o.copy(n.binormals[0]).multiplyScalar(k.y),a.copy(i[0]).add(r).add(o),Y(a.x,a.y,a.z)):Y(k.x,k.y,0);for(H=1;H<=g;H++)for(B=0;B<O;B++)k=f?C(S[B],q[B],E):S[B],y?(r.copy(n.normals[H]).multiplyScalar(k.x),o.copy(n.binormals[H]).multiplyScalar(k.y),a.copy(i[H]).add(r).add(o),Y(a.x,a.y,a.z)):Y(k.x,k.y,u/g*H);for(A=p-1;0<=A;A--){for(D=h*(1-(L=A/p)),E=d*Math.sin(L*Math.PI/2),B=0,z=P.length;B<z;B++)Y((k=C(P[B],U[B],E)).x,k.y,u+D);for(l=0,c=T.length;l<c;l++)for(s=T[l],j=W[l],B=0,z=s.length;B<z;B++)k=C(s[B],j[B],E),y?Y(k.x,k.y+i[g-1].y,i[g-1].x+D):Y(k.x,k.y,u+D)}function $(t,e){var i,n;for(B=t.length;0<=--B;){(n=(i=B)-1)<0&&(n=t.length-1);var o=0,r=g+2*p;for(o=0;o<r;o++){var a=O*o,s=O*(o+1);Q(e+i+a,e+n+a,e+n+s,e+i+s,t,o,r,i,n)}}}function Y(t,e,i){w.vertices.push(new We.Vector3(t,e,i))}function X(t,e,i){t+=x,e+=x,i+=x,w.faces.push(new We.Face3(t,e,i,null,null,0));var n=b.generateTopUV(w,t,e,i);w.faceVertexUvs[0].push(n)}function Q(t,e,i,n,o,r,a,s,l){t+=x,e+=x,i+=x,n+=x,w.faces.push(new We.Face3(t,e,n,null,null,1)),w.faces.push(new We.Face3(e,i,n,null,null,1));var c=b.generateSideWallUV(w,t,e,i,n);w.faceVertexUvs[0].push([c[0],c[1],c[3]]),w.faceVertexUvs[0].push([c[1],c[2],c[3]])}!function(){if(f){var t=0,e=O*t;for(B=0;B<F;B++)X((R=I[B])[2]+e,R[1]+e,R[0]+e);for(e=O*(t=g+2*p),B=0;B<F;B++)X((R=I[B])[0]+e,R[1]+e,R[2]+e)}else{for(B=0;B<F;B++)X((R=I[B])[2],R[1],R[0]);for(B=0;B<F;B++)X((R=I[B])[0]+O*g,R[1]+O*g,R[2]+O*g)}}(),function(){var t=0;for($(P,t),t+=P.length,l=0,c=T.length;l<c;l++)$(s=T[l],t),t+=s.length}()},We.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(t,e,i,n){var o=t.vertices,r=o[e],a=o[i],s=o[n];return[new We.Vector2(r.x,r.y),new We.Vector2(a.x,a.y),new We.Vector2(s.x,s.y)]},generateSideWallUV:function(t,e,i,n,o){var r=t.vertices,a=r[e],s=r[i],l=r[n],c=r[o];return Math.abs(a.y-s.y)<.01?[new We.Vector2(a.x,1-a.z),new We.Vector2(s.x,1-s.z),new We.Vector2(l.x,1-l.z),new We.Vector2(c.x,1-c.z)]:[new We.Vector2(a.y,1-a.z),new We.Vector2(s.y,1-s.z),new We.Vector2(l.y,1-l.z),new We.Vector2(c.y,1-c.z)]}},We.ShapeGeometry=function(t,e){We.Geometry.call(this),!(this.type="ShapeGeometry")===Array.isArray(t)&&(t=[t]),this.addShapeList(t,e),this.computeFaceNormals()},We.ShapeGeometry.prototype=Object.create(We.Geometry.prototype),We.ShapeGeometry.prototype.constructor=We.ShapeGeometry,We.ShapeGeometry.prototype.addShapeList=function(t,e){for(var i=0,n=t.length;i<n;i++)this.addShape(t[i],e);return this},We.ShapeGeometry.prototype.addShape=function(t,e){void 0===e&&(e={});var i,n,o,r=void 0!==e.curveSegments?e.curveSegments:12,a=e.material,s=void 0===e.UVGenerator?We.ExtrudeGeometry.WorldUVGenerator:e.UVGenerator,l=this.vertices.length,c=t.extractPoints(r),u=c.shape,h=c.holes,d=!We.ShapeUtils.isClockWise(u);if(d){for(u=u.reverse(),i=0,n=h.length;i<n;i++)o=h[i],We.ShapeUtils.isClockWise(o)&&(h[i]=o.reverse());d=!1}var p=We.ShapeUtils.triangulateShape(u,h);for(i=0,n=h.length;i<n;i++)o=h[i],u=u.concat(o);var f,m,g=u.length,v=p.length;for(i=0;i<g;i++)f=u[i],this.vertices.push(new We.Vector3(f.x,f.y,0));for(i=0;i<v;i++){var y=(m=p[i])[0]+l,b=m[1]+l,w=m[2]+l;this.faces.push(new We.Face3(y,b,w,null,null,a)),this.faceVertexUvs[0].push(s.generateTopUV(this,y,b,w))}},We.LatheBufferGeometry=function(t,e,i,n){We.BufferGeometry.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:n},e=Math.floor(e)||12,i=i||0,n=n||2*Math.PI,n=We.Math.clamp(n,0,2*Math.PI);var o,r,a,s=(e+1)*t.length,l=e*t.length*2*3,c=new We.BufferAttribute(new(65535<l?Uint32Array:Uint16Array)(l),1),u=new We.BufferAttribute(new Float32Array(3*s),3),h=new We.BufferAttribute(new Float32Array(2*s),2),d=0,p=0,f=(t.length,1/e),m=new We.Vector3,g=new We.Vector2;for(r=0;r<=e;r++){var v=i+r*f*n,y=Math.sin(v),b=Math.cos(v);for(a=0;a<=t.length-1;a++)m.x=t[a].x*y,m.y=t[a].y,m.z=t[a].x*b,u.setXYZ(d,m.x,m.y,m.z),g.x=r/e,g.y=a/(t.length-1),h.setXY(d,g.x,g.y),d++}for(r=0;r<e;r++)for(a=0;a<t.length-1;a++){var w=o=a+r*t.length,x=o+t.length,_=o+t.length+1,S=o+1;c.setX(p,w),p++,c.setX(p,x),p++,c.setX(p,S),p++,c.setX(p,x),p++,c.setX(p,_),p++,c.setX(p,S),p++}if(this.setIndex(c),this.addAttribute("position",u),this.addAttribute("uv",h),this.computeVertexNormals(),n===2*Math.PI){var T=this.attributes.normal.array,M=new We.Vector3,I=new We.Vector3,P=new We.Vector3;for(o=e*t.length*3,a=r=0;r<t.length;r++,a+=3)M.x=T[a+0],M.y=T[a+1],M.z=T[a+2],I.x=T[o+a+0],I.y=T[o+a+1],I.z=T[o+a+2],P.addVectors(M,I).normalize(),T[a+0]=T[o+a+0]=P.x,T[a+1]=T[o+a+1]=P.y,T[a+2]=T[o+a+2]=P.z}},We.LatheBufferGeometry.prototype=Object.create(We.BufferGeometry.prototype),We.LatheBufferGeometry.prototype.constructor=We.LatheBufferGeometry,We.LatheGeometry=function(t,e,i,n){We.Geometry.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:n},this.fromBufferGeometry(new We.LatheBufferGeometry(t,e,i,n)),this.mergeVertices()},We.LatheGeometry.prototype=Object.create(We.Geometry.prototype),We.LatheGeometry.prototype.constructor=We.LatheGeometry,We.PlaneGeometry=function(t,e,i,n){We.Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n},this.fromBufferGeometry(new We.PlaneBufferGeometry(t,e,i,n))},We.PlaneGeometry.prototype=Object.create(We.Geometry.prototype),We.PlaneGeometry.prototype.constructor=We.PlaneGeometry,We.PlaneBufferGeometry=function(t,e,i,n){We.BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n};for(var o=t/2,r=e/2,a=Math.floor(i)||1,s=Math.floor(n)||1,l=a+1,c=s+1,u=t/a,h=e/s,d=new Float32Array(l*c*3),p=new Float32Array(l*c*3),f=new Float32Array(l*c*2),m=0,g=0,v=0;v<c;v++)for(var y=v*h-r,b=0;b<l;b++){var w=b*u-o;d[m]=w,d[m+1]=-y,p[m+2]=1,f[g]=b/a,f[g+1]=1-v/s,m+=3,g+=2}m=0;var x=new(65535<d.length/3?Uint32Array:Uint16Array)(a*s*6);for(v=0;v<s;v++)for(b=0;b<a;b++){var _=b+l*v,S=b+l*(v+1),T=b+1+l*(v+1),M=b+1+l*v;x[m]=_,x[m+1]=S,x[m+2]=M,x[m+3]=S,x[m+4]=T,x[m+5]=M,m+=6}this.setIndex(new We.BufferAttribute(x,1)),this.addAttribute("position",new We.BufferAttribute(d,3)),this.addAttribute("normal",new We.BufferAttribute(p,3)),this.addAttribute("uv",new We.BufferAttribute(f,2))},We.PlaneBufferGeometry.prototype=Object.create(We.BufferGeometry.prototype),We.PlaneBufferGeometry.prototype.constructor=We.PlaneBufferGeometry,We.RingBufferGeometry=function(t,e,i,n,o,r){We.BufferGeometry.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:n,thetaStart:o,thetaLength:r},t=t||20,e=e||50,o=void 0!==o?o:0,r=void 0!==r?r:2*Math.PI;var a,s,l,c=((i=void 0!==i?Math.max(3,i):8)+1)*((n=void 0!==n?Math.max(1,n):1)+1),u=i*n*2*3,h=new We.BufferAttribute(new(65535<u?Uint32Array:Uint16Array)(u),1),d=new We.BufferAttribute(new Float32Array(3*c),3),p=new We.BufferAttribute(new Float32Array(3*c),3),f=new We.BufferAttribute(new Float32Array(2*c),2),m=0,g=0,v=t,y=(e-t)/n,b=new We.Vector3,w=new We.Vector2;for(s=0;s<=n;s++){for(l=0;l<=i;l++)a=o+l/i*r,b.x=v*Math.cos(a),b.y=v*Math.sin(a),d.setXYZ(m,b.x,b.y,b.z),p.setXYZ(m,0,0,1),w.x=(b.x/e+1)/2,w.y=(b.y/e+1)/2,f.setXY(m,w.x,w.y),m++;v+=y}for(s=0;s<n;s++){var x=s*(i+1);for(l=0;l<i;l++){var _=a=l+x,S=a+i+1,T=a+i+2,M=a+1;h.setX(g,_),g++,h.setX(g,S),g++,h.setX(g,T),g++,h.setX(g,_),g++,h.setX(g,T),g++,h.setX(g,M),g++}}this.setIndex(h),this.addAttribute("position",d),this.addAttribute("normal",p),this.addAttribute("uv",f)},We.RingBufferGeometry.prototype=Object.create(We.BufferGeometry.prototype),We.RingBufferGeometry.prototype.constructor=We.RingBufferGeometry,We.RingGeometry=function(t,e,i,n,o,r){We.Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:n,thetaStart:o,thetaLength:r},this.fromBufferGeometry(new We.RingBufferGeometry(t,e,i,n,o,r))},We.RingGeometry.prototype=Object.create(We.Geometry.prototype),We.RingGeometry.prototype.constructor=We.RingGeometry,We.SphereGeometry=function(t,e,i,n,o,r,a){We.Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:o,thetaStart:r,thetaLength:a},this.fromBufferGeometry(new We.SphereBufferGeometry(t,e,i,n,o,r,a))},We.SphereGeometry.prototype=Object.create(We.Geometry.prototype),We.SphereGeometry.prototype.constructor=We.SphereGeometry,We.SphereBufferGeometry=function(t,e,i,n,o,r,a){We.BufferGeometry.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:o,thetaStart:r,thetaLength:a},t=t||50,e=Math.max(3,Math.floor(e)||8),i=Math.max(2,Math.floor(i)||6),n=void 0!==n?n:0,o=void 0!==o?o:2*Math.PI;for(var s=(r=void 0!==r?r:0)+(a=void 0!==a?a:Math.PI),l=(e+1)*(i+1),c=new We.BufferAttribute(new Float32Array(3*l),3),u=new We.BufferAttribute(new Float32Array(3*l),3),h=new We.BufferAttribute(new Float32Array(2*l),2),d=0,p=[],f=new We.Vector3,m=0;m<=i;m++){for(var g=[],v=m/i,y=0;y<=e;y++){var b=y/e,w=-t*Math.cos(n+b*o)*Math.sin(r+v*a),x=t*Math.cos(r+v*a),_=t*Math.sin(n+b*o)*Math.sin(r+v*a);f.set(w,x,_).normalize(),c.setXYZ(d,w,x,_),u.setXYZ(d,f.x,f.y,f.z),h.setXY(d,b,1-v),g.push(d),d++}p.push(g)}var S=[];for(m=0;m<i;m++)for(y=0;y<e;y++){var T=p[m][y+1],M=p[m][y],I=p[m+1][y],P=p[m+1][y+1];(0!==m||0<r)&&S.push(T,M,P),(m!==i-1||s<Math.PI)&&S.push(M,I,P)}this.setIndex(new(65535<c.count?We.Uint32Attribute:We.Uint16Attribute)(S,1)),this.addAttribute("position",c),this.addAttribute("normal",u),this.addAttribute("uv",h),this.boundingSphere=new We.Sphere(new We.Vector3,t)},We.SphereBufferGeometry.prototype=Object.create(We.BufferGeometry.prototype),We.SphereBufferGeometry.prototype.constructor=We.SphereBufferGeometry,We.TextGeometry=function(t,e){var i=(e=e||{}).font;if(i instanceof We.Font==0)return new We.Geometry;var n=i.generateShapes(t,e.size,e.curveSegments);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),We.ExtrudeGeometry.call(this,n,e),this.type="TextGeometry"},We.TextGeometry.prototype=Object.create(We.ExtrudeGeometry.prototype),We.TextGeometry.prototype.constructor=We.TextGeometry,We.TorusBufferGeometry=function(t,e,i,n,o){We.BufferGeometry.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:n,arc:o},t=t||100,e=e||40,i=Math.floor(i)||8,n=Math.floor(n)||6,o=o||2*Math.PI;var r,a,s=(i+1)*(n+1),l=i*n*2*3,c=new(65535<l?Uint32Array:Uint16Array)(l),u=new Float32Array(3*s),h=new Float32Array(3*s),d=new Float32Array(2*s),p=0,f=0,m=0,g=new We.Vector3,v=new We.Vector3,y=new We.Vector3;for(r=0;r<=i;r++)for(a=0;a<=n;a++){var b=a/n*o,w=r/i*Math.PI*2;v.x=(t+e*Math.cos(w))*Math.cos(b),v.y=(t+e*Math.cos(w))*Math.sin(b),v.z=e*Math.sin(w),u[p]=v.x,u[p+1]=v.y,u[p+2]=v.z,g.x=t*Math.cos(b),g.y=t*Math.sin(b),y.subVectors(v,g).normalize(),h[p]=y.x,h[p+1]=y.y,h[p+2]=y.z,d[f]=a/n,d[f+1]=r/i,p+=3,f+=2}for(r=1;r<=i;r++)for(a=1;a<=n;a++){var x=(n+1)*r+a-1,_=(n+1)*(r-1)+a-1,S=(n+1)*(r-1)+a,T=(n+1)*r+a;c[m]=x,c[m+1]=_,c[m+2]=T,c[m+3]=_,c[m+4]=S,c[m+5]=T,m+=6}this.setIndex(new We.BufferAttribute(c,1)),this.addAttribute("position",new We.BufferAttribute(u,3)),this.addAttribute("normal",new We.BufferAttribute(h,3)),this.addAttribute("uv",new We.BufferAttribute(d,2))},We.TorusBufferGeometry.prototype=Object.create(We.BufferGeometry.prototype),We.TorusBufferGeometry.prototype.constructor=We.TorusBufferGeometry,We.TorusGeometry=function(t,e,i,n,o){We.Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:n,arc:o},this.fromBufferGeometry(new We.TorusBufferGeometry(t,e,i,n,o))},We.TorusGeometry.prototype=Object.create(We.Geometry.prototype),We.TorusGeometry.prototype.constructor=We.TorusGeometry,We.TorusKnotBufferGeometry=function(t,e,i,n,o,r){We.BufferGeometry.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:n,p:o,q:r},t=t||100,e=e||40,i=Math.floor(i)||64,o=o||2,r=r||3;var a,s,l=((n=Math.floor(n)||8)+1)*(i+1),c=n*i*2*3,u=new We.BufferAttribute(new(65535<c?Uint32Array:Uint16Array)(c),1),h=new We.BufferAttribute(new Float32Array(3*l),3),d=new We.BufferAttribute(new Float32Array(3*l),3),p=new We.BufferAttribute(new Float32Array(2*l),2),f=0,m=0,g=new We.Vector3,v=new We.Vector3,y=new We.Vector2,b=new We.Vector3,w=new We.Vector3,x=new We.Vector3,_=new We.Vector3,S=new We.Vector3;for(a=0;a<=i;++a){var T=a/i*o*Math.PI*2;for(D(T,o,r,t,b),D(T+.01,o,r,t,w),_.subVectors(w,b),S.addVectors(w,b),x.crossVectors(_,S),S.crossVectors(x,_),x.normalize(),S.normalize(),s=0;s<=n;++s){var M=s/n*Math.PI*2,I=-e*Math.cos(M),P=e*Math.sin(M);g.x=b.x+(I*S.x+P*x.x),g.y=b.y+(I*S.y+P*x.y),g.z=b.z+(I*S.z+P*x.z),h.setXYZ(f,g.x,g.y,g.z),v.subVectors(g,b).normalize(),d.setXYZ(f,v.x,v.y,v.z),y.x=a/i,y.y=s/n,p.setXY(f,y.x,y.y),f++}}for(s=1;s<=i;s++)for(a=1;a<=n;a++){var C=(n+1)*(s-1)+(a-1),A=(n+1)*s+(a-1),E=(n+1)*s+a,L=(n+1)*(s-1)+a;u.setX(m,C),m++,u.setX(m,A),m++,u.setX(m,L),m++,u.setX(m,A),m++,u.setX(m,E),m++,u.setX(m,L),m++}function D(t,e,i,n,o){var r=Math.cos(t),a=Math.sin(t),s=i/e*t,l=Math.cos(s);o.x=n*(2+l)*.5*r,o.y=n*(2+l)*a*.5,o.z=n*Math.sin(s)*.5}this.setIndex(u),this.addAttribute("position",h),this.addAttribute("normal",d),this.addAttribute("uv",p)},We.TorusKnotBufferGeometry.prototype=Object.create(We.BufferGeometry.prototype),We.TorusKnotBufferGeometry.prototype.constructor=We.TorusKnotBufferGeometry,We.TorusKnotGeometry=function(t,e,i,n,o,r,a){We.Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:n,p:o,q:r},this.fromBufferGeometry(new We.TorusKnotBufferGeometry(t,e,i,n,o,r)),this.mergeVertices()},We.TorusKnotGeometry.prototype=Object.create(We.Geometry.prototype),We.TorusKnotGeometry.prototype.constructor=We.TorusKnotGeometry,We.TubeGeometry=function(t,e,i,n,o,r){We.Geometry.call(this),this.type="TubeGeometry",this.parameters={path:t,segments:e,radius:i,radialSegments:n,closed:o,taper:r},e=e||64,i=i||1,n=n||8,o=o||!1,r=r||We.TubeGeometry.NoTaper;var a,s,l,c,u,h,d,p,f,m,g,v,y,b,w,x,_,S,T,M,I,P,C,A=[],E=e+1,L=new We.Vector3,D=new We.TubeGeometry.FrenetFrames(t,e,o),k=D.tangents,R=D.normals,O=D.binormals;for(this.tangents=k,this.normals=R,this.binormals=O,f=0;f<E;f++)for(A[f]=[],l=f/(E-1),p=t.getPointAt(l),k[f],a=R[f],s=O[f],u=i*r(l),m=0;m<n;m++)c=m/n*2*Math.PI,h=-u*Math.cos(c),d=u*Math.sin(c),L.copy(p),L.x+=h*a.x+d*s.x,L.y+=h*a.y+d*s.y,L.z+=h*a.z+d*s.z,A[f][m]=(I=L.x,P=L.y,C=L.z,this.vertices.push(new We.Vector3(I,P,C))-1);for(f=0;f<e;f++)for(m=0;m<n;m++)g=o?(f+1)%e:f+1,v=(m+1)%n,y=A[f][m],b=A[g][m],w=A[g][v],x=A[f][v],_=new We.Vector2(f/e,m/n),S=new We.Vector2((f+1)/e,m/n),T=new We.Vector2((f+1)/e,(m+1)/n),M=new We.Vector2(f/e,(m+1)/n),this.faces.push(new We.Face3(y,b,x)),this.faceVertexUvs[0].push([_,S,M]),this.faces.push(new We.Face3(b,w,x)),this.faceVertexUvs[0].push([S.clone(),T,M.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},We.TubeGeometry.prototype=Object.create(We.Geometry.prototype),We.TubeGeometry.prototype.constructor=We.TubeGeometry,We.TubeGeometry.NoTaper=function(t){return 1},We.TubeGeometry.SinusoidalTaper=function(t){return Math.sin(Math.PI*t)},We.TubeGeometry.FrenetFrames=function(t,e,i){var n,o,r,a,s,l,c,u=new We.Vector3,h=[],d=[],p=[],f=new We.Vector3,m=new We.Matrix4,g=e+1;for(this.tangents=h,this.normals=d,this.binormals=p,l=0;l<g;l++)c=l/(g-1),h[l]=t.getTangentAt(c),h[l].normalize();for(d[0]=new We.Vector3,p[0]=new We.Vector3,o=Number.MAX_VALUE,r=Math.abs(h[0].x),a=Math.abs(h[0].y),s=Math.abs(h[0].z),r<=o&&(o=r,u.set(1,0,0)),a<=o&&(o=a,u.set(0,1,0)),s<=o&&u.set(0,0,1),f.crossVectors(h[0],u).normalize(),d[0].crossVectors(h[0],f),p[0].crossVectors(h[0],d[0]),l=1;l<g;l++)d[l]=d[l-1].clone(),p[l]=p[l-1].clone(),f.crossVectors(h[l-1],h[l]),f.length()>Number.EPSILON&&(f.normalize(),n=Math.acos(We.Math.clamp(h[l-1].dot(h[l]),-1,1)),d[l].applyMatrix4(m.makeRotationAxis(f,n))),p[l].crossVectors(h[l],d[l]);if(i)for(n=Math.acos(We.Math.clamp(d[0].dot(d[g-1]),-1,1)),n/=g-1,0<h[0].dot(f.crossVectors(d[0],d[g-1]))&&(n=-n),l=1;l<g;l++)d[l].applyMatrix4(m.makeRotationAxis(h[l],n*l)),p[l].crossVectors(h[l],d[l])},We.PolyhedronGeometry=function(t,e,i,n){We.Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:i,detail:n},i=i||1,n=n||0;for(var o=this,r=0,a=t.length;r<a;r+=3)w(new We.Vector3(t[r],t[r+1],t[r+2]));var s=this.vertices,l=[],c=(r=0,0);for(a=e.length;r<a;r+=3,c++){var u=s[e[r]],h=s[e[r+1]],d=s[e[r+2]];l[c]=new We.Face3(u.index,h.index,d.index,[u.clone(),h.clone(),d.clone()],void 0,c)}var p=new We.Vector3;for(r=0,a=l.length;r<a;r++)_(l[r],n);for(r=0,a=this.faceVertexUvs[0].length;r<a;r++){var f=this.faceVertexUvs[0][r],m=f[0].x,g=f[1].x,v=f[2].x,y=Math.max(m,g,v),b=Math.min(m,g,v);.9<y&&b<.1&&(m<.2&&(f[0].x+=1),g<.2&&(f[1].x+=1),v<.2&&(f[2].x+=1))}for(r=0,a=this.vertices.length;r<a;r++)this.vertices[r].multiplyScalar(i);function w(t){var e=t.normalize().clone();e.index=o.vertices.push(e)-1;var i,n=S(t)/2/Math.PI+.5,r=(i=t,Math.atan2(-i.y,Math.sqrt(i.x*i.x+i.z*i.z))/Math.PI+.5);return e.uv=new We.Vector2(n,1-r),e}function x(t,e,i,n){var r=new We.Face3(t.index,e.index,i.index,[t.clone(),e.clone(),i.clone()],void 0,n);o.faces.push(r),p.copy(t).add(e).add(i).divideScalar(3);var a=S(p);o.faceVertexUvs[0].push([T(t.uv,t,a),T(e.uv,e,a),T(i.uv,i,a)])}function _(t,e){for(var i=Math.pow(2,e),n=w(o.vertices[t.a]),r=w(o.vertices[t.b]),a=w(o.vertices[t.c]),s=[],l=t.materialIndex,c=0;c<=i;c++){s[c]=[];for(var u=w(n.clone().lerp(a,c/i)),h=w(r.clone().lerp(a,c/i)),d=i-c,p=0;p<=d;p++)s[c][p]=0===p&&c===i?u:w(u.clone().lerp(h,p/d))}for(c=0;c<i;c++)for(p=0;p<2*(i-c)-1;p++){var f=Math.floor(p/2);p%2==0?x(s[c][f+1],s[c+1][f],s[c][f],l):x(s[c][f+1],s[c+1][f+1],s[c+1][f],l)}}function S(t){return Math.atan2(t.z,-t.x)}function T(t,e,i){return i<0&&1===t.x&&(t=new We.Vector2(t.x-1,t.y)),0===e.x&&0===e.z&&(t=new We.Vector2(i/2/Math.PI+.5,t.y)),t.clone()}this.mergeVertices(),this.computeFaceNormals(),this.boundingSphere=new We.Sphere(new We.Vector3,i)},We.PolyhedronGeometry.prototype=Object.create(We.Geometry.prototype),We.PolyhedronGeometry.prototype.constructor=We.PolyhedronGeometry,We.DodecahedronGeometry=function(t,e){var i=(1+Math.sqrt(5))/2,n=1/i,o=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n];We.PolyhedronGeometry.call(this,o,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}},We.DodecahedronGeometry.prototype=Object.create(We.PolyhedronGeometry.prototype),We.DodecahedronGeometry.prototype.constructor=We.DodecahedronGeometry,We.IcosahedronGeometry=function(t,e){var i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1];We.PolyhedronGeometry.call(this,n,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}},We.IcosahedronGeometry.prototype=Object.create(We.PolyhedronGeometry.prototype),We.IcosahedronGeometry.prototype.constructor=We.IcosahedronGeometry,We.OctahedronGeometry=function(t,e){We.PolyhedronGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e}},We.OctahedronGeometry.prototype=Object.create(We.PolyhedronGeometry.prototype),We.OctahedronGeometry.prototype.constructor=We.OctahedronGeometry,We.TetrahedronGeometry=function(t,e){We.PolyhedronGeometry.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e}},We.TetrahedronGeometry.prototype=Object.create(We.PolyhedronGeometry.prototype),We.TetrahedronGeometry.prototype.constructor=We.TetrahedronGeometry,We.ParametricGeometry=function(t,e,i){We.Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:i};var n,o,r,a,s,l,c,u,h,d,p,f,m=this.vertices,g=this.faces,v=this.faceVertexUvs[0],y=e+1;for(n=0;n<=i;n++)for(a=n/i,o=0;o<=e;o++)r=t(o/e,a),m.push(r);for(n=0;n<i;n++)for(o=0;o<e;o++)l=(s=n*y+o)+1,c=(n+1)*y+o+1,u=(n+1)*y+o,h=new We.Vector2(o/e,n/i),d=new We.Vector2((o+1)/e,n/i),p=new We.Vector2((o+1)/e,(n+1)/i),f=new We.Vector2(o/e,(n+1)/i),g.push(new We.Face3(s,l,u)),v.push([h,d,f]),g.push(new We.Face3(l,c,u)),v.push([d.clone(),p,f.clone()]);this.computeFaceNormals(),this.computeVertexNormals()},We.ParametricGeometry.prototype=Object.create(We.Geometry.prototype),We.ParametricGeometry.prototype.constructor=We.ParametricGeometry,We.WireframeGeometry=function(t){We.BufferGeometry.call(this);var e=[0,0],i={};function n(t,e){return t-e}var o=["a","b","c"];if(t instanceof We.Geometry){for(var r=t.vertices,a=t.faces,s=0,l=new Uint32Array(6*a.length),c=0,u=a.length;c<u;c++)for(var h=a[c],d=0;d<3;d++)e[0]=h[o[d]],e[1]=h[o[(d+1)%3]],e.sort(n),void 0===i[_=e.toString()]&&(l[2*s]=e[0],l[2*s+1]=e[1],i[_]=!0,s++);var p=new Float32Array(2*s*3);for(c=0,u=s;c<u;c++)for(d=0;d<2;d++){var f=r[l[2*c+d]];p[0+(S=6*c+3*d)]=f.x,p[S+1]=f.y,p[S+2]=f.z}this.addAttribute("position",new We.BufferAttribute(p,3))}else if(t instanceof We.BufferGeometry)if(null!==t.index){var m=t.index.array,g=(r=t.attributes.position,t.groups);s=0,0===g.length&&t.addGroup(0,m.length),l=new Uint32Array(2*m.length);for(var v=0,y=g.length;v<y;++v)for(var b=g[v],w=b.start,x=(c=w,w+b.count);c<x;c+=3)for(d=0;d<3;d++){var _;e[0]=m[c+d],e[1]=m[c+(d+1)%3],e.sort(n),void 0===i[_=e.toString()]&&(l[2*s]=e[0],l[2*s+1]=e[1],i[_]=!0,s++)}for(p=new Float32Array(2*s*3),c=0,u=s;c<u;c++)for(d=0;d<2;d++){var S=6*c+3*d,T=l[2*c+d];p[S+0]=r.getX(T),p[S+1]=r.getY(T),p[S+2]=r.getZ(T)}this.addAttribute("position",new We.BufferAttribute(p,3))}else{var M=(s=(r=t.attributes.position.array).length/3)/3;for(p=new Float32Array(2*s*3),c=0,u=M;c<u;c++)for(d=0;d<3;d++){var I=9*c+3*d;p[0+(S=18*c+6*d)]=r[I],p[S+1]=r[I+1],p[S+2]=r[I+2],T=9*c+(d+1)%3*3,p[S+3]=r[T],p[S+4]=r[T+1],p[S+5]=r[T+2]}this.addAttribute("position",new We.BufferAttribute(p,3))}},We.WireframeGeometry.prototype=Object.create(We.BufferGeometry.prototype),We.WireframeGeometry.prototype.constructor=We.WireframeGeometry,We.AxisHelper=function(t){t=t||1;var e=new Float32Array([0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t]),i=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]),n=new We.BufferGeometry;n.addAttribute("position",new We.BufferAttribute(e,3)),n.addAttribute("color",new We.BufferAttribute(i,3));var o=new We.LineBasicMaterial({vertexColors:We.VertexColors});We.LineSegments.call(this,n,o)},We.AxisHelper.prototype=Object.create(We.LineSegments.prototype),We.AxisHelper.prototype.constructor=We.AxisHelper,We.ArrowHelper=function(){var t=new We.Geometry;t.vertices.push(new We.Vector3(0,0,0),new We.Vector3(0,1,0));var e=new We.CylinderGeometry(0,.5,1,5,1);return e.translate(0,-.5,0),function(i,n,o,r,a,s){We.Object3D.call(this),void 0===r&&(r=16776960),void 0===o&&(o=1),void 0===a&&(a=.2*o),void 0===s&&(s=.2*a),this.position.copy(n),this.line=new We.Line(t,new We.LineBasicMaterial({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new We.Mesh(e,new We.MeshBasicMaterial({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(i),this.setLength(o,a,s)}}(),We.ArrowHelper.prototype=Object.create(We.Object3D.prototype),We.ArrowHelper.prototype.constructor=We.ArrowHelper,We.ArrowHelper.prototype.setDirection=(Le=new We.Vector3,function(t){.99999<t.y?this.quaternion.set(0,0,0,1):t.y<-.99999?this.quaternion.set(1,0,0,0):(Le.set(t.z,0,-t.x).normalize(),Ee=Math.acos(t.y),this.quaternion.setFromAxisAngle(Le,Ee))}),We.ArrowHelper.prototype.setLength=function(t,e,i){void 0===e&&(e=.2*t),void 0===i&&(i=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(i,e,i),this.cone.position.y=t,this.cone.updateMatrix()},We.ArrowHelper.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},We.BoxHelper=function(t){var e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),n=new We.BufferGeometry;n.setIndex(new We.BufferAttribute(e,1)),n.addAttribute("position",new We.BufferAttribute(i,3)),We.LineSegments.call(this,n,new We.LineBasicMaterial({color:16776960})),void 0!==t&&this.update(t)},We.BoxHelper.prototype=Object.create(We.LineSegments.prototype),We.BoxHelper.prototype.constructor=We.BoxHelper,We.BoxHelper.prototype.update=(De=new We.Box3,function(t){if(De.setFromObject(t),!De.isEmpty()){var e=De.min,i=De.max,n=this.geometry.attributes.position,o=n.array;o[0]=i.x,o[1]=i.y,o[2]=i.z,o[3]=e.x,o[4]=i.y,o[5]=i.z,o[6]=e.x,o[7]=e.y,o[8]=i.z,o[9]=i.x,o[10]=e.y,o[11]=i.z,o[12]=i.x,o[13]=i.y,o[14]=e.z,o[15]=e.x,o[16]=i.y,o[17]=e.z,o[18]=e.x,o[19]=e.y,o[20]=e.z,o[21]=i.x,o[22]=e.y,o[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}}),We.BoundingBoxHelper=function(t,e){var i=void 0!==e?e:8947848;this.object=t,this.box=new We.Box3,We.Mesh.call(this,new We.BoxGeometry(1,1,1),new We.MeshBasicMaterial({color:i,wireframe:!0}))},We.BoundingBoxHelper.prototype=Object.create(We.Mesh.prototype),We.BoundingBoxHelper.prototype.constructor=We.BoundingBoxHelper,We.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object),this.box.size(this.scale),this.box.center(this.position)},We.CameraHelper=function(t){var e=new We.Geometry,i=new We.LineBasicMaterial({color:16777215,vertexColors:We.FaceColors}),n={},o=16755200,r=16711680,a=3355443;function s(t,e,i){l(t,i),l(e,i)}function l(t,i){e.vertices.push(new We.Vector3),e.colors.push(new We.Color(i)),void 0===n[t]&&(n[t]=[]),n[t].push(e.vertices.length-1)}s("n1","n2",o),s("n2","n4",o),s("n4","n3",o),s("n3","n1",o),s("f1","f2",o),s("f2","f4",o),s("f4","f3",o),s("f3","f1",o),s("n1","f1",o),s("n2","f2",o),s("n3","f3",o),s("n4","f4",o),s("p","n1",r),s("p","n2",r),s("p","n3",r),s("p","n4",r),s("u1","u2",43775),s("u2","u3",43775),s("u3","u1",43775),s("c","t",16777215),s("p","c",a),s("cn1","cn2",a),s("cn3","cn4",a),s("cf1","cf2",a),s("cf3","cf4",a),We.LineSegments.call(this,e,i),this.camera=t,this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=n,this.update()},We.CameraHelper.prototype=Object.create(We.LineSegments.prototype),We.CameraHelper.prototype.constructor=We.CameraHelper,We.CameraHelper.prototype.update=function(){var t,e,i=new We.Vector3,n=new We.Camera;function o(o,r,a,s){i.set(r,a,s).unproject(n);var l=e[o];if(void 0!==l)for(var c=0,u=l.length;c<u;c++)t.vertices[l[c]].copy(i)}return function(){t=this.geometry,e=this.pointMap,n.projectionMatrix.copy(this.camera.projectionMatrix),o("c",0,0,-1),o("t",0,0,1),o("n1",-1,-1,-1),o("n2",1,-1,-1),o("n3",-1,1,-1),o("n4",1,1,-1),o("f1",-1,-1,1),o("f2",1,-1,1),o("f3",-1,1,1),o("f4",1,1,1),o("u1",.7,1.1,-1),o("u2",-.7,1.1,-1),o("u3",0,2,-1),o("cf1",-1,0,1),o("cf2",1,0,1),o("cf3",0,-1,1),o("cf4",0,1,1),o("cn1",-1,0,-1),o("cn2",1,0,-1),o("cn3",0,-1,-1),o("cn4",0,1,-1),t.verticesNeedUpdate=!0}}(),We.DirectionalLightHelper=function(t,e){We.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,e=e||1;var i=new We.Geometry;i.vertices.push(new We.Vector3(-e,e,0),new We.Vector3(e,e,0),new We.Vector3(e,-e,0),new We.Vector3(-e,-e,0),new We.Vector3(-e,e,0));var n=new We.LineBasicMaterial({fog:!1});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.lightPlane=new We.Line(i,n),this.add(this.lightPlane),(i=new We.Geometry).vertices.push(new We.Vector3,new We.Vector3),(n=new We.LineBasicMaterial({fog:!1})).color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine=new We.Line(i,n),this.add(this.targetLine),this.update()},We.DirectionalLightHelper.prototype=Object.create(We.Object3D.prototype),We.DirectionalLightHelper.prototype.constructor=We.DirectionalLightHelper,We.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},We.DirectionalLightHelper.prototype.update=(ke=new We.Vector3,Re=new We.Vector3,Oe=new We.Vector3,function(){ke.setFromMatrixPosition(this.light.matrixWorld),Re.setFromMatrixPosition(this.light.target.matrixWorld),Oe.subVectors(Re,ke),this.lightPlane.lookAt(Oe),this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity),this.targetLine.geometry.vertices[1].copy(Oe),this.targetLine.geometry.verticesNeedUpdate=!0,this.targetLine.material.color.copy(this.lightPlane.material.color)}),We.EdgesHelper=function(t,e,i){var n=void 0!==e?e:16777215;We.LineSegments.call(this,new We.EdgesGeometry(t.geometry,i),new We.LineBasicMaterial({color:n})),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1},We.EdgesHelper.prototype=Object.create(We.LineSegments.prototype),We.EdgesHelper.prototype.constructor=We.EdgesHelper,We.FaceNormalsHelper=function(t,e,i,n){this.object=t,this.size=void 0!==e?e:1;var o=void 0!==i?i:16776960,r=void 0!==n?n:1,a=0,s=this.object.geometry;s instanceof We.Geometry&&(a=s.faces.length);var l=new We.BufferGeometry,c=new We.Float32Attribute(2*a*3,3);l.addAttribute("position",c),We.LineSegments.call(this,l,new We.LineBasicMaterial({color:o,linewidth:r})),this.matrixAutoUpdate=!1,this.update()},We.FaceNormalsHelper.prototype=Object.create(We.LineSegments.prototype),We.FaceNormalsHelper.prototype.constructor=We.FaceNormalsHelper,We.FaceNormalsHelper.prototype.update=(Fe=new We.Vector3,Ne=new We.Vector3,Ue=new We.Matrix3,function(){this.object.updateMatrixWorld(!0),Ue.getNormalMatrix(this.object.matrixWorld);for(var t=this.object.matrixWorld,e=this.geometry.attributes.position,i=this.object.geometry,n=i.vertices,o=i.faces,r=0,a=0,s=o.length;a<s;a++){var l=o[a],c=l.normal;Fe.copy(n[l.a]).add(n[l.b]).add(n[l.c]).divideScalar(3).applyMatrix4(t),Ne.copy(c).applyMatrix3(Ue).normalize().multiplyScalar(this.size).add(Fe),e.setXYZ(r,Fe.x,Fe.y,Fe.z),r+=1,e.setXYZ(r,Ne.x,Ne.y,Ne.z),r+=1}return e.needsUpdate=!0,this}),We.GridHelper=function(t,e){var i=new We.Geometry,n=new We.LineBasicMaterial({vertexColors:We.VertexColors});this.color1=new We.Color(4473924),this.color2=new We.Color(8947848);for(var o=-t;o<=t;o+=e){i.vertices.push(new We.Vector3(-t,0,o),new We.Vector3(t,0,o),new We.Vector3(o,0,-t),new We.Vector3(o,0,t));var r=0===o?this.color1:this.color2;i.colors.push(r,r,r,r)}We.LineSegments.call(this,i,n)},We.GridHelper.prototype=Object.create(We.LineSegments.prototype),We.GridHelper.prototype.constructor=We.GridHelper,We.GridHelper.prototype.setColors=function(t,e){this.color1.set(t),this.color2.set(e),this.geometry.colorsNeedUpdate=!0},We.HemisphereLightHelper=function(t,e){We.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.colors=[new We.Color,new We.Color];var i=new We.SphereGeometry(e,4,2);i.rotateX(-Math.PI/2);for(var n=0;n<8;n++)i.faces[n].color=this.colors[n<4?0:1];var o=new We.MeshBasicMaterial({vertexColors:We.FaceColors,wireframe:!0});this.lightSphere=new We.Mesh(i,o),this.add(this.lightSphere),this.update()},We.HemisphereLightHelper.prototype=Object.create(We.Object3D.prototype),We.HemisphereLightHelper.prototype.constructor=We.HemisphereLightHelper,We.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose(),this.lightSphere.material.dispose()},We.HemisphereLightHelper.prototype.update=(Be=new We.Vector3,function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity),this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity),this.lightSphere.lookAt(Be.setFromMatrixPosition(this.light.matrixWorld).negate()),this.lightSphere.geometry.colorsNeedUpdate=!0}),We.PointLightHelper=function(t,e){this.light=t,this.light.updateMatrixWorld();var i=new We.SphereGeometry(e,4,2),n=new We.MeshBasicMaterial({wireframe:!0,fog:!1});n.color.copy(this.light.color).multiplyScalar(this.light.intensity),We.Mesh.call(this,i,n),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1},We.PointLightHelper.prototype=Object.create(We.Mesh.prototype),We.PointLightHelper.prototype.constructor=We.PointLightHelper,We.PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},We.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)},We.SkeletonHelper=function(t){this.bones=this.getBoneList(t);for(var e=new We.Geometry,i=0;i<this.bones.length;i++)this.bones[i].parent instanceof We.Bone&&(e.vertices.push(new We.Vector3),e.vertices.push(new We.Vector3),e.colors.push(new We.Color(0,0,1)),e.colors.push(new We.Color(0,1,0)));e.dynamic=!0;var n=new We.LineBasicMaterial({vertexColors:We.VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});We.LineSegments.call(this,e,n),this.root=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.update()},We.SkeletonHelper.prototype=Object.create(We.LineSegments.prototype),We.SkeletonHelper.prototype.constructor=We.SkeletonHelper,We.SkeletonHelper.prototype.getBoneList=function(t){var e=[];t instanceof We.Bone&&e.push(t);for(var i=0;i<t.children.length;i++)e.push.apply(e,this.getBoneList(t.children[i]));return e},We.SkeletonHelper.prototype.update=function(){for(var t=this.geometry,e=(new We.Matrix4).getInverse(this.root.matrixWorld),i=new We.Matrix4,n=0,o=0;o<this.bones.length;o++){var r=this.bones[o];r.parent instanceof We.Bone&&(i.multiplyMatrices(e,r.matrixWorld),t.vertices[n].setFromMatrixPosition(i),i.multiplyMatrices(e,r.parent.matrixWorld),t.vertices[n+1].setFromMatrixPosition(i),n+=2)}t.verticesNeedUpdate=!0,t.computeBoundingSphere()},We.SpotLightHelper=function(t){We.Object3D.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1;var e=new We.CylinderGeometry(0,1,1,8,1,!0);e.translate(0,-.5,0),e.rotateX(-Math.PI/2);var i=new We.MeshBasicMaterial({wireframe:!0,fog:!1});this.cone=new We.Mesh(e,i),this.add(this.cone),this.update()},We.SpotLightHelper.prototype=Object.create(We.Object3D.prototype),We.SpotLightHelper.prototype.constructor=We.SpotLightHelper,We.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},We.SpotLightHelper.prototype.update=(ze=new We.Vector3,Ve=new We.Vector3,function(){var t=this.light.distance?this.light.distance:1e4,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),ze.setFromMatrixPosition(this.light.matrixWorld),Ve.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Ve.sub(ze)),this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}),We.VertexNormalsHelper=function(t,e,i,n){this.object=t,this.size=void 0!==e?e:1;var o=void 0!==i?i:16711680,r=void 0!==n?n:1,a=0,s=this.object.geometry;s instanceof We.Geometry?a=3*s.faces.length:s instanceof We.BufferGeometry&&(a=s.attributes.normal.count);var l=new We.BufferGeometry,c=new We.Float32Attribute(2*a*3,3);l.addAttribute("position",c),We.LineSegments.call(this,l,new We.LineBasicMaterial({color:o,linewidth:r})),this.matrixAutoUpdate=!1,this.update()},We.VertexNormalsHelper.prototype=Object.create(We.LineSegments.prototype),We.VertexNormalsHelper.prototype.constructor=We.VertexNormalsHelper,We.VertexNormalsHelper.prototype.update=(Ge=new We.Vector3,je=new We.Vector3,He=new We.Matrix3,function(){var t=["a","b","c"];this.object.updateMatrixWorld(!0),He.getNormalMatrix(this.object.matrixWorld);var e=this.object.matrixWorld,i=this.geometry.attributes.position,n=this.object.geometry;if(n instanceof We.Geometry)for(var o=n.vertices,r=n.faces,a=0,s=0,l=r.length;s<l;s++)for(var c=r[s],u=0,h=c.vertexNormals.length;u<h;u++){var d=o[c[t[u]]],p=c.vertexNormals[u];Ge.copy(d).applyMatrix4(e),je.copy(p).applyMatrix3(He).normalize().multiplyScalar(this.size).add(Ge),i.setXYZ(a,Ge.x,Ge.y,Ge.z),a+=1,i.setXYZ(a,je.x,je.y,je.z),a+=1}else if(n instanceof We.BufferGeometry){var f=n.attributes.position,m=n.attributes.normal;for(u=a=0,h=f.count;u<h;u++)Ge.set(f.getX(u),f.getY(u),f.getZ(u)).applyMatrix4(e),je.set(m.getX(u),m.getY(u),m.getZ(u)),je.applyMatrix3(He).normalize().multiplyScalar(this.size).add(Ge),i.setXYZ(a,Ge.x,Ge.y,Ge.z),a+=1,i.setXYZ(a,je.x,je.y,je.z),a+=1}return i.needsUpdate=!0,this}),We.WireframeHelper=function(t,e){var i=void 0!==e?e:16777215;We.LineSegments.call(this,new We.WireframeGeometry(t.geometry),new We.LineBasicMaterial({color:i})),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1},We.WireframeHelper.prototype=Object.create(We.LineSegments.prototype),We.WireframeHelper.prototype.constructor=We.WireframeHelper,We.ImmediateRenderObject=function(t){We.Object3D.call(this),this.material=t,this.render=function(t){}},We.ImmediateRenderObject.prototype=Object.create(We.Object3D.prototype),We.ImmediateRenderObject.prototype.constructor=We.ImmediateRenderObject,We.MorphBlendMesh=function(t,e){We.Mesh.call(this,t,e),this.animationsMap={},this.animationsList=[];var i=this.geometry.morphTargets.length,n=i-1,o=i/1;this.createAnimation("__default",0,n,o),this.setAnimationWeight("__default",1)},We.MorphBlendMesh.prototype=Object.create(We.Mesh.prototype),We.MorphBlendMesh.prototype.constructor=We.MorphBlendMesh,We.MorphBlendMesh.prototype.createAnimation=function(t,e,i,n){var o={start:e,end:i,length:i-e+1,fps:n,duration:(i-e)/n,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[t]=o,this.animationsList.push(o)},We.MorphBlendMesh.prototype.autoCreateAnimations=function(t){for(var e,i=/([a-z]+)_?(\d+)/i,n={},o=this.geometry,r=0,a=o.morphTargets.length;r<a;r++){var s=o.morphTargets[r].name.match(i);s&&1<s.length&&(n[l=s[1]]||(n[l]={start:1/0,end:-1/0}),r<(c=n[l]).start&&(c.start=r),r>c.end&&(c.end=r),e||(e=l))}for(var l in n){var c=n[l];this.createAnimation(l,c.start,c.end,t)}this.firstAnimation=e},We.MorphBlendMesh.prototype.setAnimationDirectionForward=function(t){var e=this.animationsMap[t];e&&(e.direction=1,e.directionBackwards=!1)},We.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(t){var e=this.animationsMap[t];e&&(e.direction=-1,e.directionBackwards=!0)},We.MorphBlendMesh.prototype.setAnimationFPS=function(t,e){var i=this.animationsMap[t];i&&(i.fps=e,i.duration=(i.end-i.start)/i.fps)},We.MorphBlendMesh.prototype.setAnimationDuration=function(t,e){var i=this.animationsMap[t];i&&(i.duration=e,i.fps=(i.end-i.start)/i.duration)},We.MorphBlendMesh.prototype.setAnimationWeight=function(t,e){var i=this.animationsMap[t];i&&(i.weight=e)},We.MorphBlendMesh.prototype.setAnimationTime=function(t,e){var i=this.animationsMap[t];i&&(i.time=e)},We.MorphBlendMesh.prototype.getAnimationTime=function(t){var e=0,i=this.animationsMap[t];return i&&(e=i.time),e},We.MorphBlendMesh.prototype.getAnimationDuration=function(t){var e=-1,i=this.animationsMap[t];return i&&(e=i.duration),e},We.MorphBlendMesh.prototype.playAnimation=function(t){var e=this.animationsMap[t];e&&(e.time=0,e.active=!0)},We.MorphBlendMesh.prototype.stopAnimation=function(t){var e=this.animationsMap[t];e&&(e.active=!1)},We.MorphBlendMesh.prototype.update=function(t){for(var e=0,i=this.animationsList.length;e<i;e++){var n=this.animationsList[e];if(n.active){var o=n.duration/n.length;n.time+=n.direction*t,n.mirroredLoop?(n.time>n.duration||n.time<0)&&(n.direction*=-1,n.time>n.duration&&(n.time=n.duration,n.directionBackwards=!0),n.time<0&&(n.time=0,n.directionBackwards=!1)):(n.time=n.time%n.duration,n.time<0&&(n.time+=n.duration));var r=n.start+We.Math.clamp(Math.floor(n.time/o),0,n.length-1),a=n.weight;r!==n.currentFrame&&(this.morphTargetInfluences[n.lastFrame]=0,this.morphTargetInfluences[n.currentFrame]=1*a,this.morphTargetInfluences[r]=0,n.lastFrame=n.currentFrame,n.currentFrame=r);var s=n.time%o/o;n.directionBackwards&&(s=1-s),n.currentFrame!==n.lastFrame?(this.morphTargetInfluences[n.currentFrame]=s*a,this.morphTargetInfluences[n.lastFrame]=(1-s)*a):this.morphTargetInfluences[n.currentFrame]=a}}},t.exports&&(e=t.exports=We),e.THREE=We}),y=(v.THREE,v);!function(){if("performance"in window==0&&(window.performance={}),"now"in window.performance==0){var t=Date.now();performance.timing&&performance.timing.navigationStart&&(t=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-t}}}(),y.WebGLRenderer.prototype.paramThreeToGL=function(t){var e,i=this.extensions,n=this.context;if(t===y.RepeatWrapping)return n.REPEAT;if(t===y.ClampToEdgeWrapping)return n.CLAMP_TO_EDGE;if(t===y.MirroredRepeatWrapping)return n.MIRRORED_REPEAT;if(t===y.NearestFilter)return n.NEAREST;if(t===y.NearestMipMapNearestFilter)return n.NEAREST_MIPMAP_NEAREST;if(t===y.NearestMipMapLinearFilter)return n.NEAREST_MIPMAP_LINEAR;if(t===y.LinearFilter)return n.LINEAR;if(t===y.LinearMipMapNearestFilter)return n.LINEAR_MIPMAP_NEAREST;if(t===y.LinearMipMapLinearFilter)return n.LINEAR_MIPMAP_LINEAR;if(t===y.UnsignedByteType)return n.UNSIGNED_BYTE;if(t===y.UnsignedShort4444Type)return n.UNSIGNED_SHORT_4_4_4_4;if(t===y.UnsignedShort5551Type)return n.UNSIGNED_SHORT_5_5_5_1;if(t===y.UnsignedShort565Type)return n.UNSIGNED_SHORT_5_6_5;if(t===y.ByteType)return n.BYTE;if(t===y.ShortType)return n.SHORT;if(t===y.UnsignedShortType)return n.UNSIGNED_SHORT;if(t===y.IntType)return n.INT;if(t===y.UnsignedIntType)return n.UNSIGNED_INT;if(t===y.FloatType)return n.FLOAT;if(null!==(e=i.get("OES_texture_half_float"))&&t===y.HalfFloatType)return e.HALF_FLOAT_OES;if(t===y.AlphaFormat)return n.ALPHA;if(t===y.RGBFormat)return n.RGB;if(t===y.RGBAFormat)return n.RGBA;if(t===y.LuminanceFormat)return n.LUMINANCE;if(t===y.LuminanceAlphaFormat)return n.LUMINANCE_ALPHA;if(t===y.AddEquation)return n.FUNC_ADD;if(t===y.SubtractEquation)return n.FUNC_SUBTRACT;if(t===y.ReverseSubtractEquation)return n.FUNC_REVERSE_SUBTRACT;if(t===y.ZeroFactor)return n.ZERO;if(t===y.OneFactor)return n.ONE;if(t===y.SrcColorFactor)return n.SRC_COLOR;if(t===y.OneMinusSrcColorFactor)return n.ONE_MINUS_SRC_COLOR;if(t===y.SrcAlphaFactor)return n.SRC_ALPHA;if(t===y.OneMinusSrcAlphaFactor)return n.ONE_MINUS_SRC_ALPHA;if(t===y.DstAlphaFactor)return n.DST_ALPHA;if(t===y.OneMinusDstAlphaFactor)return n.ONE_MINUS_DST_ALPHA;if(t===y.DstColorFactor)return n.DST_COLOR;if(t===y.OneMinusDstColorFactor)return n.ONE_MINUS_DST_COLOR;if(t===y.SrcAlphaSaturateFactor)return n.SRC_ALPHA_SATURATE;if(null!==(e=i.get("WEBGL_compressed_texture_s3tc"))){if(t===y.RGB_S3TC_DXT1_Format)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(t===y.RGBA_S3TC_DXT1_Format)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(t===y.RGBA_S3TC_DXT3_Format)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(t===y.RGBA_S3TC_DXT5_Format)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(null!==(e=i.get("WEBGL_compressed_texture_pvrtc"))){if(t===y.RGB_PVRTC_4BPPV1_Format)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(t===y.RGB_PVRTC_2BPPV1_Format)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(t===y.RGBA_PVRTC_4BPPV1_Format)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(t===y.RGBA_PVRTC_2BPPV1_Format)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(null!==(e=i.get("WEBGL_compressed_texture_etc1"))&&t===y.RGB_ETC1_Format)return e.COMPRESSED_RGB_ETC1_WEBGL;if(null!==(e=i.get("EXT_blend_minmax"))){if(t===y.MinEquation)return e.MIN_EXT;if(t===y.MaxEquation)return e.MAX_EXT}return 0},y.WebGLState=function(t,e,i){var n=this,o=new y.Vector4,r=t.getParameter(t.MAX_VERTEX_ATTRIBS),a=new Uint8Array(r),s=new Uint8Array(r),l=new Uint8Array(r),c={},u=null,h=null,d=null,p=null,f=null,m=null,g=null,v=null,b=!1,w=null,x=null,_=null,S=null,T=null,M=null,I=null,P=null,C=null,A=null,E=null,L=null,D=null,k=null,R=null,O=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),F=void 0,N={},U=new y.Vector4,B=null,z=null,V=new y.Vector4,G=new y.Vector4;this.init=function(){this.clearColor(0,0,0,1),this.clearDepth(1),this.clearStencil(0),this.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.frontFace(t.CCW),t.cullFace(t.BACK),this.enable(t.CULL_FACE),this.enable(t.BLEND),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA)},this.initAttributes=function(){for(var t=0,e=a.length;t<e;t++)a[t]=0},this.enableAttribute=function(i){a[i]=1,0===s[i]&&(t.enableVertexAttribArray(i),s[i]=1),0!==l[i]&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(i,0),l[i]=0)},this.enableAttributeAndDivisor=function(e,i,n){a[e]=1,0===s[e]&&(t.enableVertexAttribArray(e),s[e]=1),l[e]!==i&&(n.vertexAttribDivisorANGLE(e,i),l[e]=i)},this.disableUnusedAttributes=function(){for(var e=0,i=s.length;e<i;e++)s[e]!==a[e]&&(t.disableVertexAttribArray(e),s[e]=0)},this.enable=function(e){!0!==c[e]&&(t.enable(e),c[e]=!0)},this.disable=function(e){!1!==c[e]&&(t.disable(e),c[e]=!1)},this.getCompressedTextureFormats=function(){if(null===u&&(u=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")))for(var i=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),n=0;n<i.length;n++)u.push(i[n]);return u},this.setBlending=function(e,n,o,r,a,s,l,c){e===y.NoBlending?this.disable(t.BLEND):this.enable(t.BLEND),e===h&&c===b||(e===y.AdditiveBlending?c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE)):e===y.SubtractiveBlending?c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR)):e===y.MultiplyBlending?c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.SRC_COLOR,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR)):c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)),h=e,b=c),e===y.CustomBlending?(a=a||n,s=s||o,l=l||r,n===d&&a===m||(t.blendEquationSeparate(i(n),i(a)),d=n,m=a),o===p&&r===f&&s===g&&l===v||(t.blendFuncSeparate(i(o),i(r),i(s),i(l)),p=o,f=r,g=s,v=l)):v=g=m=f=p=d=null},this.setDepthFunc=function(e){if(w!==e){if(e)switch(e){case y.NeverDepth:t.depthFunc(t.NEVER);break;case y.AlwaysDepth:t.depthFunc(t.ALWAYS);break;case y.LessDepth:t.depthFunc(t.LESS);break;case y.LessEqualDepth:t.depthFunc(t.LEQUAL);break;case y.EqualDepth:t.depthFunc(t.EQUAL);break;case y.GreaterEqualDepth:t.depthFunc(t.GEQUAL);break;case y.GreaterDepth:t.depthFunc(t.GREATER);break;case y.NotEqualDepth:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);w=e}},this.setDepthTest=function(e){e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)},this.setDepthWrite=function(e){x!==e&&(t.depthMask(e),x=e)},this.setColorWrite=function(e){_!==e&&(t.colorMask(e,e,e,e),_=e)},this.setStencilFunc=function(e,i,n){T===e&&M===i&&I===n||(t.stencilFunc(e,i,n),T=e,M=i,I=n)},this.setStencilOp=function(e,i,n){P===e&&C===i&&A===n||(t.stencilOp(e,i,n),P=e,C=i,A=n)},this.setStencilTest=function(e){e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)},this.setStencilWrite=function(e){S!==e&&(t.stencilMask(e),S=e)},this.setFlipSided=function(e){E!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),E=e)},this.setLineWidth=function(e){e!==L&&(t.lineWidth(e),L=e)},this.setPolygonOffset=function(e,i,n){e?this.enable(t.POLYGON_OFFSET_FILL):this.disable(t.POLYGON_OFFSET_FILL),!e||D===i&&k===n||(t.polygonOffset(i,n),D=i,k=n)},this.getScissorTest=function(){return R},this.setScissorTest=function(e){(R=e)?this.enable(t.SCISSOR_TEST):this.disable(t.SCISSOR_TEST)},this.activeTexture=function(e){void 0===e&&(e=t.TEXTURE0+O-1),F!==e&&(t.activeTexture(e),F=e)},this.bindTexture=function(e,i){void 0===F&&n.activeTexture();var o=N[F];void 0===o&&(o={type:void 0,texture:void 0},N[F]=o),o.type===e&&o.texture===i||(t.bindTexture(e,i),o.type=e,o.texture=i)},this.compressedTexImage2D=function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){}},this.texImage2D=function(){try{t.texImage2D.apply(t,arguments)}catch(t){}},this.clearColor=function(e,i,n,r){o.set(e,i,n,r),!1===U.equals(o)&&(t.clearColor(e,i,n,r),U.copy(o))},this.clearDepth=function(e){B!==e&&(t.clearDepth(e),B=e)},this.clearStencil=function(e){z!==e&&(t.clearStencil(e),z=e)},this.scissor=function(e){!1===V.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),V.copy(e))},this.viewport=function(e){!1===G.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),G.copy(e))},this.reset=function(){for(var e=0;e<s.length;e++)1===s[e]&&(t.disableVertexAttribArray(e),s[e]=0);c={},F=void 0,N={},E=S=x=_=h=u=null}},Array.prototype.findIndex||(Array.prototype.findIndex=function(t){if(null==this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,i=Object(this),n=i.length>>>0,o=arguments[1],r=0;r<n;r++)if(e=i[r],t.call(o,e,r,i))return r;return-1}),v.CopyShader={uniforms:{tDiffuse:{type:"t",value:null},opacity:{type:"f",value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")},v.HorizontalBlurShader={uniforms:{tDiffuse:{type:"t",value:null},h:{type:"f",value:1/512}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float h;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n")},v.VerticalBlurShader={uniforms:{tDiffuse:{type:"t",value:null},v:{type:"f",value:1/512}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float v;","varying vec2 vUv;","void main() {","vec4 sum = vec4( 0.0 );","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;","sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;","gl_FragColor = sum;","}"].join("\n")},v.EffectComposer=function(t,e){if(this.renderer=t,void 0===e){var i={minFilter:v.LinearFilter,magFilter:v.LinearFilter,format:v.RGBAFormat,stencilBuffer:!1},n=t.getSize();e=new v.WebGLRenderTarget(n.width,n.height,i)}this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],v.CopyShader,this.copyPass=new v.ShaderPass(v.CopyShader)},v.EffectComposer.prototype={swapBuffers:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t},addPass:function(t){this.passes.push(t)},insertPass:function(t,e){this.passes.splice(e,0,t)},render:function(t){this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2;var e,i,n=!1,o=this.passes.length;for(i=0;i<o;i++)if((e=this.passes[i]).enabled){if(e.render(this.renderer,this.writeBuffer,this.readBuffer,t,n),e.needsSwap){if(n){var r=this.renderer.context;r.stencilFunc(r.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),r.stencilFunc(r.EQUAL,1,4294967295)}this.swapBuffers()}e instanceof v.MaskPass?n=!0:e instanceof v.ClearMaskPass&&(n=!1)}},reset:function(t){if(void 0===t){var e=this.renderer.getSize();(t=this.renderTarget1.clone()).setSize(e.width,e.height)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(t,e){this.renderTarget1.setSize(t,e),this.renderTarget2.setSize(t,e)}},v.RenderPass=function(t,e,i,n,o){this.scene=t,this.camera=e,this.overrideMaterial=i,this.clearColor=n,this.clearAlpha=void 0!==o?o:1,this.oldClearColor=new v.Color,this.oldClearAlpha=1,this.enabled=!0,this.clear=!0,this.needsSwap=!1},v.RenderPass.prototype={render:function(t,e,i,n){this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(this.oldClearColor.copy(t.getClearColor()),this.oldClearAlpha=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),t.render(this.scene,this.camera,i,this.clear),this.clearColor&&t.setClearColor(this.oldClearColor,this.oldClearAlpha),this.scene.overrideMaterial=null}},v.MaskPass=function(t,e){this.scene=t,this.camera=e,this.enabled=!0,this.clear=!0,this.needsSwap=!1,this.inverse=!1},v.MaskPass.prototype={render:function(t,e,i,n){var o,r,a=t.context;a.colorMask(!1,!1,!1,!1),a.depthMask(!1),r=this.inverse?(o=0,1):(o=1,0),a.enable(a.STENCIL_TEST),a.stencilOp(a.REPLACE,a.REPLACE,a.REPLACE),a.stencilFunc(a.ALWAYS,o,4294967295),a.clearStencil(r),t.render(this.scene,this.camera,i,this.clear),t.render(this.scene,this.camera,e,this.clear),a.colorMask(!0,!0,!0,!0),a.depthMask(!0),a.stencilFunc(a.EQUAL,1,4294967295),a.stencilOp(a.KEEP,a.KEEP,a.KEEP)}},v.ClearMaskPass=function(){this.enabled=!0},v.ClearMaskPass.prototype={render:function(t,e,i,n){var o=t.context;o.disable(o.STENCIL_TEST)}},v.ShaderPass=function(t,e){this.textureID=void 0!==e?e:"tDiffuse",t instanceof v.ShaderMaterial?(this.uniforms=t.uniforms,this.material=t):t&&(this.uniforms=v.UniformsUtils.clone(t.uniforms),this.material=new v.ShaderMaterial({defines:t.defines||{},uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})),this.renderToScreen=!1,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.camera=new v.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new v.Scene,this.quad=new v.Mesh(new v.PlaneBufferGeometry(2,2),null),this.scene.add(this.quad)},v.ShaderPass.prototype={render:function(t,e,i,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i),this.quad.material=this.material,this.renderToScreen?t.render(this.scene,this.camera):t.render(this.scene,this.camera,e,this.clear)}};var b={vector:function(t,e){var i=t.clone();return e=e.clone(),function(n){t.set(i.x*(1-n)+e.x*n,i.y*(1-n)+e.y*n,i.z*(1-n)+e.z*n)}},quaternion:function(t,e){var i=t.clone();return function(n){t.copy(i).slerp(e,n)}},property:function(t,e,i,n){var o=t[e];return function(r){t[e]=o*(1-r)+i*r,n&&n(t[e])}},uniform:function(t,e,i){var n=t.material.uniforms[e].value;return function(o){t.material.uniforms[e]&&(t.material.uniforms[e].value=n*(1-o)+i*o)}},matrix4:function(t,e){var i=t.clone();return function(n){for(var o=t.elements,r=i.elements,a=e.elements,s=0;s<16;s++)o[s]=r[s]*(1-n)+a[s]*n}},allUniforms:function(t,e,i){var n=t.map(function(t){return this.uniform(t,e,i)}.bind(this));return function(t){n.forEach(function(e){e(t)})}}},w=window.Raven;function _(t){var e,i,n,r,a=t.split("/"),s="["+a[a.length-1].replace(".js","")+"]",l={};if(_.consoleEnabled){var c=function(t){o("#debug-console").append("<p>"+t+"</p>"),o("#debug-console")[0].scrollTop=o("#debug-console")[0].scrollHeight};e=function(t){c(Array.prototype.slice.call(arguments).join(" "))},i=function(t){c(Array.prototype.slice.call(arguments).join(" "))},n=function(t){c("WARN: "+Array.prototype.slice.call(arguments).join(" "))},r=function(t){c("ERROR: "+Array.prototype.slice.call(arguments).join(" "))}}else console.log?(e=console.log,i=console.info?console.info:console.log,n=console.warn?console.warn:console.log,r=console.error?console.error:console.log):e=i=n=r=function(){};var u=function(t){return[s,_.timestamp()].concat(Array.prototype.slice.call(t))};return{debug:function(){_.level>=_.levels.debug&&e.apply(console,u(arguments))},info:function(){_.level>=_.levels.info&&i.apply(console,u(arguments))},warn:function(){(function(e,i){if(w){var n=Array.prototype.slice.call(e).join(" ");w.captureMessage(n,{level:"warn",path:t,timestamp:_.timestamp()})}})(arguments),_.level>=_.levels.warn&&n.apply(console,u(arguments))},error:function(){(function(e,i){if(w){var n=Array.prototype.slice.call(e).join(" ");w.captureException(new Error(n),{level:"error",path:t,timestamp:_.timestamp()})}})(arguments),_.level>=_.levels.error&&r.apply(console,u(arguments))},v3str:function(t,e){var i=void 0===e?2:e;return"("+t.x.toPrecision(i)+", "+t.y.toPrecision(i)+", "+t.z.toPrecision(i)+")"},eulstr:function(t,e){var i=void 0===e?2:e;return"("+THREE.Math.radToDeg(t.x).toPrecision(i)+", "+THREE.Math.radToDeg(t.y).toPrecision(i)+", "+THREE.Math.radToDeg(t.z).toPrecision(i)+' "'+t.order+'")'},time:function(t){_.level>=_.levels.debug&&(l[t]=Date.now())},timeEnd:function(t){if(_.level>=_.levels.debug){var e=l[t];if(!e)return;var i=(Date.now()-e)/1e3;this.debug(t,i+"s")}}}}_.timestamp=function(){return(Date.now()-window.navigationStart)/1e3+"s"},_.level=(_.levels={debug:3,info:2,warn:1,error:0}).info;var S=_,T=new S("/js/util/ajax.js");function M(t,e,i){function n(){T.warn("Retrying ",e),M(t,e,i).done(a.resolve.bind(a)).progress(a.notify.bind(a)).fail(a.reject.bind(a))}var r=function(t,e,i){var n=new XMLHttpRequest;return"undefined"!=typeof XDomainRequest?(n=new XDomainRequest).open(t,e):n.open(t,e),n}(t,e);if((i=i||{}).retries=void 0!==i.retries?i.retries:0,i.retry=void 0!==i.retry?i.retry:"get"===t.toLowerCase(),i.responseType)if(-1<["arraybuffer","text","json"].indexOf(i.responseType))r.responseType=i.responseType;else{if("image/jpeg"!==i.responseType)throw new Error('reponseType can only be one of "arraybuffer", "text" or "json", "image/jpeg"');r.responseType="arraybuffer"}"json"===i.responseType&&r.setRequestHeader("Accept","application/json"),i.auth&&r.setRequestHeader("Authorization",i.auth),"object"==typeof i.data&&(i.data=JSON.stringify(i.data),r.setRequestHeader("Content-Type","application/json"));var a=o.Deferred();return r.onreadystatechange=function(t){if(4==this.readyState)if(500<=this.status&&this.status<=600&&i.retry&&i.retries<3)i.retries++,setTimeout(n,1e3);else if(200==this.status){var e=function(t,e){var i=t.response;if("json"===e&&"object"!=typeof i)try{i=JSON.parse(t.responseText)}catch(t){return void a.reject({error:"Failed parsing JSON"})}else if("image/jpeg"===e){var n=new Uint8Array(t.response),o=new Blob([n],{type:"image/jpeg"}),r=URL.createObjectURL(o);(i=new Image).src=r,i.crossOrigin="Anonymous",i.onload=function(){URL.revokeObjectURL(r)}}return i}(this,i.responseType);a.resolve(e)}else a.reject(this)},r.onprogress=function(t){a.notify(t)},r.send(i.data),a.promise()}window.URL=window.URL||window.webkitURL,window.REQUEST_CACHE=window.REQUEST_CACHE||{},G.basic=window.PREFETCHED_MODELDATA,window.PREFETCHED_MODELDATA=window.PREFETCHED_MODELDATA||{},setTimeout(function(){window.REQUEST_CACHE=null,window.PREFETCHED_MODELDATA={}},6e4),window.onpageshow=function(t){t.persisted&&(window.REQUEST_CACHE=null,window.PREFETCHED_MODELDATA={})};var P={get:function(t,e){var i,n;if(!0===(e=e||{}).cache||e.cache){var r=(i=t,window.REQUEST_CACHE?window.REQUEST_CACHE[i]:null);if(r)return r}var a,s,l=e.fetchNum;return n=1===e.fetchNum&&e.prefetchFrom&&window.PREFETCHED_MODELDATA[e.prefetchFrom]?o.when(window.PREFETCHED_MODELDATA[e.prefetchFrom]):2===e.fetchNum&&e.prefetchFrom&&window.PREFETCHED_MODELDATA[e.prefetchFrom][e.prefetchFrom2]?o.when(window.PREFETCHED_MODELDATA[e.prefetchFrom][e.prefetchFrom2]):3===e.fetchNum&&e.prefetchFrom&&window.PREFETCHED_MODELDATA[e.prefetchFrom][e.prefetchFrom2][e.prefetchFrom3]?o.when(window.PREFETCHED_MODELDATA[e.prefetchFrom][e.prefetchFrom2][e.prefetchFrom3]):M("GET",t,e),l&&(a=t,s=n,window.REQUEST_CACHE&&(window.REQUEST_CACHE[a]=s)),n},post:function(t,e){return M("POST",t,e)},patch:function(t,e){return M("PATCH",t,e)},getImage:function(t,e){function i(){T.warn("Retrying ",t),a.getImage(t,e-1).done(n.resolve.bind(n)).progress(n.notify.bind(n)).fail(n.reject.bind(n))}var n=o.Deferred(),r=new Image,a=this;return("number"!=typeof e||e<1)&&(e=3),r.onerror=function(){0<e?setTimeout(i,1e3):n.reject()},r.onload=function(){n.resolve(r)},r.crossOrigin="anonymous",r.src=t,n}},C=d(function(t){function e(t){p.call(this,t)}e.prototype=Object.create(p.prototype),t.exports=e}),A={PANORAMA:"panorama",DOLLHOUSE:"dollhouse",FLOORPLAN:"floorplan",MESH:"mesh",OUTDOOR:"outdoor",TRANSITIONING:"transitioning",toInt:function(t){switch(t){case this.PANORAMA:return 1;case this.DOLLHOUSE:return 2;case this.FLOORPLAN:return 3;case this.OUTDOOR:return 4;case this.TRANSITIONING:return-1}throw new C("No known conversion for Viewmode to int for mode: "+t)},fromInt:function(t){switch(t){case"1":case 1:return this.PANORAMA;case"2":case 2:return this.DOLLHOUSE;case"3":case 3:return this.FLOORPLAN;case"4":case 4:return this.OUTDOOR}throw new C("No known conversion for int to viewmode for int: "+t)},convertWorkshopModeInt:function(t){switch(t){case"0":case 0:return this.PANORAMA;case"1":case 1:return this.FLOORPLAN;case"2":case 2:return this.DOLLHOUSE;case"3":case 3:return this.MESH}throw new C("No known conversion for Workshop int to viewmode for int: "+t)}},E={newBlue:new v.Color("#28eff5"),altBlue:new v.Color(47355),classicBlue:new v.Color(53759),mpYellow:new v.Color(16502016),mpOrange:new v.Color(16428055),mpBlue:new v.Color(12096),mpLtGrey:new v.Color(13751252),mpDkGrey:new v.Color(10000019),mpRed:new v.Color(12525854),mpOrangeDesat:new v.Color(16764529),mpBlueDesat:new v.Color(4034734),mpRedDesat:new v.Color(14705505),white:new v.Color(16777215),black:new v.Color(0),_desat:function(t,e){var i=e||.3,n=(new v.Color).copy(t).getHSL({h:0,s:0,l:0});return(new v.Color).setHSL(n.h,n.s*(1-i),n.l)},_darken:function(t,e){var i=e||.2,n=(new v.Color).copy(t).getHSL({h:0,s:0,l:0});return(new v.Color).setHSL(n.h,n.s,n.l*(1-i))}},L={BLACK:"black",STD:"std",WALK:"walk"},D=d(function(t){var e={linearTween:function(t,e,i,n){return i*t/n+e},easeInQuad:function(t,e,i,n){return i*(t/=n)*t+e},easeOutQuad:function(t,e,i,n){return-i*(t/=n)*(t-2)+e},easeInOutQuad:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,i,n){return i*(t/=n)*t*t+e},easeOutCubic:function(t,e,i,n){return t/=n,i*(--t*t*t+1)+e},easeInOutCubic:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,i,n){return i*(t/=n)*t*t*t+e},easeOutQuart:function(t,e,i,n){return t/=n,-i*(--t*t*t*t-1)+e},easeInOutQuart:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,i,n){return i*(t/=n)*t*t*t*t+e},easeOutQuint:function(t,e,i,n){return t/=n,i*(--t*t*t*t*t+1)+e},easeInOutQuint:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,i,n){return-i*Math.cos(t/n*(Math.PI/2))+i+e},easeOutSine:function(t,e,i,n){return i*Math.sin(t/n*(Math.PI/2))+e},easeInOutSine:function(t,e,i,n){return-i/2*(Math.cos(Math.PI*t/n)-1)+e},easeInExpo:function(t,e,i,n){return i*Math.pow(2,10*(t/n-1))+e},easeOutExpo:function(t,e,i,n){return i*(1-Math.pow(2,-10*t/n))+e},easeInOutExpo:function(t,e,i,n){return(t/=n/2)<1?i/2*Math.pow(2,10*(t-1))+e:(t--,i/2*(2-Math.pow(2,-10*t))+e)},easeInCirc:function(t,e,i,n){return t/=n,-i*(Math.sqrt(1-t*t)-1)+e},easeOutCirc:function(t,e,i,n){return t/=n,t--,i*Math.sqrt(1-t*t)+e},easeInOutCirc:function(t,e,i,n){return(t/=n/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:(t-=2,i/2*(Math.sqrt(1-t*t)+1)+e)},easeInElastic:function(t,e,i,n){var o=1.70158,r=0,a=i;return 0===t?e:1==(t/=n)?e+i:(r||(r=.3*n),o=a<Math.abs(i)?(a=i,r/4):r/(2*Math.PI)*Math.asin(i/a),-a*Math.pow(2,10*(t-=1))*Math.sin((t*n-o)*(2*Math.PI)/r)+e)},easeOutElastic:function(t,e,i,n){var o=1.70158,r=0,a=i;return 0===t?e:1==(t/=n)?e+i:(r||(r=.3*n),o=a<Math.abs(i)?(a=i,r/4):r/(2*Math.PI)*Math.asin(i/a),a*Math.pow(2,-10*t)*Math.sin((t*n-o)*(2*Math.PI)/r)+i+e)},easeInOutElastic:function(t,e,i,n){var o=1.70158,r=0,a=i;return 0===t?e:2==(t/=n/2)?e+i:(r||(r=n*(.3*1.5)),o=a<Math.abs(i)?(a=i,r/4):r/(2*Math.PI)*Math.asin(i/a),t<1?a*Math.pow(2,10*(t-=1))*Math.sin((t*n-o)*(2*Math.PI)/r)*-.5+e:a*Math.pow(2,-10*(t-=1))*Math.sin((t*n-o)*(2*Math.PI)/r)*.5+i+e)},easeInBack:function(t,e,i,n,o){return void 0===o&&(o=1.70158),i*(t/=n)*t*((o+1)*t-o)+e},easeOutBack:function(t,e,i,n,o){return void 0===o&&(o=1.70158),i*((t=t/n-1)*t*((o+1)*t+o)+1)+e},easeInOutBack:function(t,e,i,n,o){return void 0===o&&(o=1.70158),(t/=n/2)<1?i/2*(t*t*((1+(o*=1.525))*t-o))+e:i/2*((t-=2)*t*((1+(o*=1.525))*t+o)+2)+e},easeOutBounce:function(t,e,i,n){return(t/=n)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInBounce:function(t,e,i,o){return i-n.easeOutBounce(o-t,0,i,o)+e},easeInOutBounce:function(t,e,i,o){return t<o/2?.5*n.easeInBounce(2*t,0,i,o)+e:.5*n.easeOutBounce(x,2*t-o,0,i,o)+.5*i+e}};t.exports=e}),k={normalizeUrl:function(t){return t.replace("https://","http://")},domainFromUrl:function(t){var e=/^([^:]*:\/\/)?(www\.)?([^\/]+)/.exec(t);return e?e[3]:t},average:function(t,e){if(0===t.length)return null;for(var i=0,n=0,o=0;o<t.length;o++)i+=e?t[o][e]:t[o],n++;return i/n},countUnique:function(t){for(var e={},i=0;i<t.length;i++)e[t[i]]=1+(e[t[i]]||0);return Object.keys(e).length},averageVectors:function(t,e){var i=new v.Vector3;if(0===t.length)return i;for(var n=0,o=0;o<t.length;o++){var r=e?t[o][e]:t[o];i.add(r),n++}return i.divideScalar(n)},equalLists:function(t,e){if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0},lowerMedian:function(t,e){return 0===t.length?null:(e=e||2,t.sort(function(t,e){return t-e}),t[Math.floor(t.length/e)])},stableSort:function(t,e){return t.map(function(t,e){return{value:t,index:e}}).sort(function(t,i){var n=e(t.value,i.value);return 0!==n?n:t.index-i.index}).map(function(t){return t.value})},filterAll:function(t,e){return t.filter(function(t){return e.every(function(e){return e(t)})})},formatDate:function(t){return[t.getFullYear(),t.getMonth()+1,t.getDate()].join("-")},formatDatetime:function(t){return[t.getFullYear(),t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes()].join("-")},randomString:function(t){for(var e="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<t;n++)e+=i.charAt(Math.floor(Math.random()*i.length));return e},nth:function(t){return 1==(t%=10)?t+"st":2==t?t+"nd":3==t?t+"rd":t+"th"},extendObject:function(t,e){return Object.keys(e).forEach(function(i){t[i]=e[i]}),t},deepExtend:function t(e){e=e||{};for(var i=1;i<arguments.length;i++){var n=arguments[i];if(n)for(var o in n)n.hasOwnProperty(o)&&("object"==typeof n[o]?e[o]=t(e[o],n[o]):e[o]=n[o])}return e},inherit:function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},extend:function(t,e){for(var i in e.prototype)t.prototype[i]=e.prototype[i]}};Math.sign=function(t){return t<0?-1:1};var R,O=new S("js/utils/showcase"),F={getAuthorizationHeader:function(){var t=g.valueFromHash("auth");if(t)return t.replace(","," ");var e=g.valueFromCookie("token");return e?"Token "+e:null},parseModelid:function(t){var e,i;return t=t||"",i=(e=window.location.protocol+"//"+window.location.host)+"/api/player/models/"+t,{baseurl:window.location.protocol+"//"+window.location.host,playdir:"play",dataroot:"data",modelid:t,versiondir:"",locationpics:"",urlBase:e,urlModel:i,urlFiles:i+(i.match(/\/$/)?"files":"/files"),urlThumb:i+(i.match(/\/$/)?"thumb":"/thumb")}},getModelIDFromQueryString:function(){return g.valueFromHash("model")||g.valueFromHash("m")},normalizeModeldata:function(t,e){return(t=JSON.parse(JSON.stringify(t))).scenes.forEach(function(t){if(t._camera&&"string"==typeof t._camera)try{t._camera=JSON.parse(t._camera)}catch(e){O.warn("Unable to parse scene camera"),t._camera=null}else"object"==typeof t._camera&&O.debug("scene.camera already a JSON object");t._camera&&(t._camera._rotation&&(t._camera._rotation=e.convertWorkshopQuaternion(t._camera._rotation)),t._camera._viewpoint&&(t._camera._viewpoint=e.convertWorkshopVector(t._camera._viewpoint)),t._camera._zoom=e.convertWorkshopOrthoZoom(t._camera._zoom))}),t},visionVersionToInt:(R=new RegExp(["(?:[0-9.]+\\.){1,4}","([0-9]+)","[^\\.]*$"].join("")),function(t){if(!t)throw new Error("Vision version is required");var e=R.exec(t);if(null===e)throw new Error("String is not a vision version: "+t);return parseInt(e[1])}),modelDataPromisesTiles:function(t){if(t.vision_version)try{return l.visionVersionToInt(t.vision_version)>=l.visionVersionToInt(r.visionTilingStartVersion)}catch(e){s.warn("Invalid vision version: "+t.vision_version)}var e=t.created?new Date(t.created):null;return e&&e>=r.visionTilingStartDate}},N={signedUrlDefaultExpireTime:24e4,signedUrlCheckInterval:1e4,signedUrlRefreshBuffer:15e3,dollhouseFOV:70,dollhouseNear:1,dollhouseFar:5e3,insideFOV:70,insideNear:.1,insideFar:5e3,insideLookSpeed:.12,insideLookLimitUp:50,insideLookLimitDown:-50,orthoNear:1,orthoFar:5e3,orthoBase:10,narrowLandscapeHeight:290,reallyNarrowLandscapeHeight:250,visionTilingStartDate:new Date("8/26/2016"),visionTilingStartVersion:"1.1.407.13667",windowHeightHighQualityThreshold:1200,tourStepDelayDefault:3500,tourStepDelaySlideShow:5e3,workshopApsect:9/16,highQualityMaxZoom:2,ultraHighQualityMaxZoom:1.5},U={delBK:!0,delBKEdit:!1,isNewServerPreviewVersion:!1,isNewEditVersion:!1,isCleanUI:0,jfedit:!1,screenshot:!1,unit_type:0,unit_conversion_value:1,unit_name:"m",unit_sq_name:"m²",debug:!1,isLocalVersion:!1,vrDebug:!1,fpsOn:!1,adjustCompass:!1,adjustColor:!1,newbarrage:!0,wscdn:!0,thirdCustomer:-1,version:"2.11.9-0-ga9537d5",pageTitle:"众趣科技",authorizationHeader:F.getAuthorizationHeader(),autoplay:g.valueFromHash("play",!0),logLevel:g.valueFromHash("log",2),showLog:g.valueFromHash("db",0),skyboxRadius:250,modelBoundsPadding:5,showNeighbors:!1,brand:g.valueFromHash("brand",!0),mls:g.valueFromHash("mls",0),showHighlights:g.valueFromHash("hhl",!0),startHighlights:g.valueFromHash("hl",!1),specialEdition:g.valueFromHash("bn",0),showTitleContainer:g.valueFromHash("title",!0),useWheel:g.valueFromHash("wh",!0),crossOrigin:"anonymous",fancierTransition:!0,wireframe:!0,skyboxWireframe:!0,modelAlpha:1,highlightPanoSelection:!1,showSweeps:!0,showSkyboxes:!0,showMesh:!0,showFloors:!0,showFloorDuration:300,showFloorDelay:300,hideFloorDuration:300,hideFloorDelay:0,reticuleOpacityTransitionTime:250,reticuleColor:E.white,markerOpacityTransitionTime:500,guiAnimationSpeed:250,highlightAnimationDuration:500,barfadeAnimationDuration:300,modelComponentLoadSpinnerDelay:150,captureErrors:!1,maxMobileTextures:10,startupFlyinDelay:3e3,dollhouseDefault:{minDistance:15,maxDistance:50,minPolarAngle:v.Math.degToRad(10),maxPolarAngle:v.Math.degToRad(65)},hideReticuleTimeout:1e3,titletagMaxdistance:5,analytics:{inactivityThreshold:30,sessionTrackingRate:.15,maxTrackedErrors:20,sessionDurationPingFrequency:10,sessionDurationTimeout:15},flydown:{movementEasing:"easeInOutQuad",movementDelay:.001,rotationEasing:"easeInOutQuad",rotationDelay:.5,modelTextureDelay:.75,skyboxDelay:.75},transition:{flySpeed:.01,flyTime:800,flytimeMaxDistanceThreshold:5,flytimeDistanceMultiplier:150,aimTime:1150,aimSlowFactor:1.5,blur:.2,movementEasing:"easeInOutQuad",blendEasing:"easeInOutQuad",fastForwardFactor:1},show360Views:{enabled:!0,transitionTime:1e3},quickstart:{enabled:1===g.valueFromHash("qs",0),animation:1e3,showTextDelay:500,fadeOutDelay:1e3,fovChange:10},vr:{enabled:!1,option:g.valueFromHash("vr",1)},mattertags:{enabled:!0,enableLinking:!0,enablePanoSize:!0,startup:{hideUntilStart:!1,fadeInDuration:500,fadeInDelay:100},visibility:{anyDistance:!0,visibleDistance:8,cameraClearance:.1,alphaTestLevel:.05,hideViaFloor:!0,hideOffScreenDisc:!1,hideOffScreenObject:!1},disc:{opacity:.9,disabledOpacity:.5,scale:{nearBound:1.5,farBound:4.8,linkFarBound:!1,linkPercent:40,maxSize:80,minSize:40,baseViewportSize:800,buildingViewportSize:300,responsiveness:100}},pole:{enabled:!0,height:.5,width:2,opacity:.5,color:"white"},animation:{hoverOnClosing:!1,animInDelay:100,animOutDelay:50,animInTime:200,animOutTime:100},boardScale:{billboardScale:1,scaleToDisc:!0,boardToDiscRatio:1.2},navigate:{nearestPano:!0,lineOfSight:!0,reactivate:!0,aimAt:"disc",tiltTolerance:25,rotateSpeedFactor:.6}},path:{color:E.white,colorUp:E._desat(E.white,.5),colorDown:E._darken(E.white,.35),opacity:.5,style:"ribbon",height:.025,ribbonWidth:.24,outsideHeight:.5,waypointRadius:.5,waypointIndoorRadius:.24,waypointPulse:1e3,typ:L.BLACK,meshFree:g.valueFromHash("mf",0),mapGuides:g.valueFromHash("guides",!0),fadeInTime:400,fadeOutTime:300},warp:{nearPanoDist:.1,matchCam:!1,blur:.33,fastTime:1500,teleportTime:1500,outsideTime:2e3,lookAheadMax:.3,lookAheadDist:2.5,softPushDist:.37,softPushEnd:.3,softBendAngle:8,softBendTilt:4,softBendEnd:.3,doBurns:g.valueFromHash("kb",!0),burnsAngle:15,minBurnsAngle:6,minDownAngle:-35,maxTurnPerSec:280,maxAimPerSec:45,minRotation:12,maxAimRotation:33.2,turnFriction:.2,flySpeed:.01,minWarpTime:1200,warpInterruptionRedirectTime:500,tourStepDelay:g.valueFromHash("st",5e3),walkDelay:0,walkMaxDist:50,walkSlideShowThreshhold:3e3,walkExtraPanosDistance:.4,timePerMeter:800,motionLeadTime:500,movementEasing:"easeInOutQuad",blendEasing:"easeInOutQuad",showBunny:!1,loop:g.valueFromHash("lp",!0),auto:g.valueFromHash("ts",-1),eOrder:"YXZ",stepFactor:.25,brakeStrength:2,minBrakeAngle:.1,maxBrakeAngle:1.8,climbEffort:4,waitMultiplier1:4,waitMultiplier2:4},rotationFriction:.06,rotationAccelerationInside:4.5,rotationAccelerationOutside:.15,rotationAfterMoveMultiplier:60,rotationAfterMoveHistoryCount:5,panFriction:.09,panAccelerationOutside:60,onload:g.valueFromHash("onload",A.PANORAMA),zoomNearLimit:.1,zoomFarLimit:10,navigation:{panoScores:!1,mouseDirection:!0,filterStrictness:.75,angleFactor:-30,directionFactor:10,distanceFactor:-1,optionalityFactor:3},secretPanelWord:[38,38,40,40,37,39,37,39,66,65],console:g.valueFromHash("console",!1),noMeshFloorPositionOffset:new v.Vector3(0,-1.2,0),panoramaNeighbourMaxDistance:5,panoFloorClickRadius:.7,showScreenshotLocations:!1,showAxis:!1,showNeighbourRaycasts:!1,colorMarkerOnLoad:!1,colorMarkerByFloor:!1,tiling:{panoPreRenderRepeatDelay:2500,panoPreRenderDelay:500,preRenderTourPanos:g.valueFromHash("tileprerender",0),tilingFlagNames:["usetiles","tiles"],maxNavPanoQuality:g.valueFromHash("maxtileq",null),maxZoomPanoQuality:g.valueFromHash("maxztileq",null),overlayStyle:g.valueFromHash("tileoverlay",0),uploadIntervalDelay:g.valueFromHash("tileupdelay",10),initialIntervalDelay:g.valueFromHash("itiledelay",0),maxNonBaseUploadsPerFrame:g.valueFromHash("maxnbtpf",2),maxBaseUploadsPerFrame:g.valueFromHash("maxbtpf",6),customCompression:g.valueFromHash("tilecustcomp",0),mobileHighQualityOverride:!1,allowUltraHighResolution:!1},zoom:{enabled:!0,max:g.valueFromHash("maxzoom",1.5),min:g.valueFromHash("minzoom",1),transitionStyle:g.valueFromHash("zoomtrans",1),restoreTime:500,activationThreshold:1.1},panoramaSettings:{loading_2k:!1,screenshot_2k:!1,loading_fov82:!1,screenshot_fov82:!1}};(U=k.deepExtend(U,N,{panorama:{transitionTime:1300,modelAlpha:0,modelAlphaDelay:U.flydown.modelTextureDelay,modelAlphaLength:1,skyboxOpacity:1,skyboxOpacityDelay:U.flydown.skyboxDelay,skyboxOpacityLength:.9,fovLength:1,fovDelay:0,cameraMatrixDuration:.8,cameraMatrixDelay:0,cameraMatrixEase:D.easeInCubic,reticuleOpacity:1,markerOpacity:.6,markerOpacityOnHover:1},dollhouse:{transitionTime:1200,modelAlpha:1,modelAlphaDelay:0,modelAlphaLength:1-U.flydown.modelTextureDelay,skyboxOpacity:0,skyboxOpacityDelay:0,skyboxOpacityLength:1-U.flydown.skyboxDelay,fovLength:1,fovDelay:0,cameraMatrixDuration:.8,cameraMatrixDelay:.3,cameraMatrixEase:D.easeInCubic,reticuleOpacity:1,markerOpacity:0,markerOpacityOnHover:0},floorplan:{transitionTime:1e3,modelAlpha:1,modelAlphaDelay:0,modelAlphaLength:1-U.flydown.modelTextureDelay,skyboxOpacity:0,skyboxOpacityDelay:0,skyboxOpacityLength:1-U.flydown.skyboxDelay,fovLength:1,fovDelay:0,cameraMatrixDuration:.5,cameraMatrixDelay:0,cameraMatrixEase:D.easeOutCubic,reticuleOpacity:1,markerOpacity:0,markerOpacityOnHover:0},transitioning:{reticuleOpacity:0},"floorplan-dollhouse":{rotationDelay:0,rotationDuration:1},"floorplan-panorama":{rotationDelay:.5,rotationDuration:1},"dollhouse-panorama":{rotationDelay:.6,rotationDuration:1},"dollhouse-floorplan":{rotationDelay:0,rotationDuration:1,cameraMatrixDuration:1.05,cameraMatrixDelay:.5},"panorama-dollhouse":{rotationDelay:0,rotationDuration:.4},"panorama-floorplan":{transitionTime:1500,rotationDelay:0,rotationDuration:.5}})).path.meshFree&&(U.path.typ=L.WALK);var B,z=U,V={globalDone:null,funcs:[],counter:0,uniqueID:0,start:function(t,e,i,n,o,r,a){return n=n||0,this.funcs.push({func:t,current:-n*Math.abs(e),duration:(1-Math.max(n,0))*Math.abs(e),done:i,easing:o||D.linearTween,cycling:e<0,running:!0,debug:n<0,name:r||"T"+this.counter,id:void 0===a?this.counter:a,paused:!1}),t(0,16),this.counter+=1,t},trigger:function(t){var e=void 0===t.delayRatio?0:t.delayRatio,i=t.func||function(){},n=void 0===t.duration?0:t.duration;void 0!==t.cycling&&t.cycling&&(n=-Math.abs(n));var o=t.done||null,r=t.easing||D.linearTween,a=t.name||"R"+this.counter,s=void 0===t.id?this.counter:t.id;return this.start(i,n,o,e,r,a,s)},setTimeout:function(t,e,i){var n=void 0===i?this.counter:i;return this.trigger({done:t,duration:void 0===e?0:e,name:"O"+this.counter,id:n})},pause:function(){this.paused=!0},resume:function(){this.paused=!1},update:function(t){this.funcs.forEach(function(e){if(!(e.paused||(e.current+=1e3*t,e.current<0)))if(e.current>=e.duration&&!e.cycling){var i=e.easing(1,0,1,1);e.func(i,1e3*t),e.done&&e.done(),e.running=!1}else{var n=e.easing(e.current%e.duration/e.duration,0,1,1);e.func(n,1e3*t)&&(e.done&&e.done(),e.running=!1)}});var e=this.funcs.length;this.funcs=this.funcs.filter(function(t){return t.running});var i=this.funcs.length;if(0<e&&0===i&&this.globalDone){var n=this.globalDone;this.globalDone=null,n()}},adjustSpeed:function(t,e){var i=this.get(t);i&&(i.duration/=e,i.current/=e)},getById:function(t){return this.funcs.filter(function(e){return t===e.id})},get:function(t){for(var e=0;e<this.funcs.length;e+=1)if(this.funcs[e].func==t)return this.funcs[e];return null},isRunning:function(t){var e=this.get(t);return null!==e&&e.running},countActive:function(){for(var t=0,e=0;e<this.funcs.length;e+=1)t+=this.funcs[e].running;return t},listActive:function(){for(var t=[],e=0;e<this.funcs.length;e+=1)this.funcs[e].running&&t.push(this.funcs[e].name);return t},done:function(t){this.globalDone=t},cancelById:function(t){var e=void 0===t?0:t;this.funcs=this.funcs.filter(function(t){return t.id!==e})},cancel:function(t){this.funcs=this.funcs.filter(function(e){return e.func!==t})},getUniqueId:function(){return this.uniqueID-=1,this.uniqueID}},j={},H={load:function(t,e,i){var n=j[t];return n?e&&setTimeout(function(){e(n)},1):((n=new v.Texture).sourceFile=t,j[t]=n,P.getImage(t).then(function(t){n.image=t,n.needsUpdate=!0,e&&e(n)}).fail(i)),n},loadBase64:function(t,e){e=e||"png";var i=new v.Texture;return i.image=document.createElement("img"),i.image.setAttribute("src","data:image/"+e+";base64,"+t),i.needsUpdate=!0,i},loadurl:function(t){var e=new v.TextureLoader;return e.setCrossOrigin(!0),e.load(t)},loadCanvas:function(t){(i=document.createElement("canvas").getContext("2d")).font="100px Arial";var e,i,n,o,r,a,s,l=i.measureText(t).width+60,c=l+4;(i=(e=document.createElement("canvas")).getContext("2d")).canvas.width=c,i.canvas.height=144,i.font="Bold 100px Arial",o=1,r=l+2,a=142,s=30,(n=i).beginPath(),n.moveTo(31,o),n.lineWidth=1,n.strokeStyle="rgba(0,0,0,.4)",n.fillStyle="rgba(0,0,0,.4)",n.arcTo(1+r,o,1+r,o+a,s),n.arcTo(1+r,o+a,1,o+a,s),n.arcTo(1,o+a,1,o,s),n.arcTo(1,o,1+r,o,s),n.stroke(),n.fill(),n.closePath(),i.fillStyle="rgba(255,255,255, .85)",i.fillText(t,32,102);var u=new v.Texture(e);return u.minFilter=v.LinearFilter,u.magFilter=v.LinearFilter,u.needsUpdate=!0,u},getCanvasTexture:function(t){(i=document.createElement("canvas").getContext("2d")).font="100px Arial";var e,i,n,o,r,a,s,l=i.measureText(t).width+60,c=l+4;(i=(e=document.createElement("canvas")).getContext("2d")).canvas.width=c,i.canvas.height=144,i.font="Bold 100px Arial",o=1,r=l+2,a=142,s=30,(n=i).beginPath(),n.moveTo(31,o),n.lineWidth=1,n.strokeStyle="rgba(0,0,0,0)",n.fillStyle="rgba(0,0,0,0)",n.arcTo(1+r,o,1+r,o+a,s),n.arcTo(1+r,o+a,1,o+a,s),n.arcTo(1,o+a,1,o,s),n.arcTo(1,o,1+r,o,s),n.stroke(),n.fill(),n.closePath(),i.fillStyle="rgba(255,255,255, 1)",i.fillText(t,32,102);var u=new v.Texture(e);return u.minFilter=v.LinearFilter,u.magFilter=v.LinearFilter,u.needsUpdate=!0,u},loadCanvasRe:function(t,e){t=t||"",e=e||"Center";var i=document.createElement("canvas"),n=i.getContext("2d");i.width=256,i.height=256,n.font="bold 54px Arial";var o,r,a,s,l=n.measureText(t).width;o=87,r=30,s=a="rgba(0,0,0,.4)",n.beginPath(),n.moveTo(35,o),n.lineWidth=0,n.strokeStyle=a,n.fillStyle=s,n.arcTo(251,o,251,187,r),n.arcTo(251,187,5,187,r),n.arcTo(5,187,5,o,r),n.arcTo(5,o,251,o,r),n.stroke(),n.fill(),n.closePath(),n.fillStyle="rgba(255,255,255,.85)",n.fillText(t,(i.width-l)/2,(i.height+54)/2);var c=new v.Texture(i);return c.needsUpdate=!0,c},loadCanvasRs:function(t,e){t=t||"",e=e||"Center";var i=document.createElement("canvas"),n=i.getContext("2d");i.width=512,i.height=512,n.font="bold 108px Arial";var o,r,a,s,l,c=n.measureText(t).width;o=10,r=174,a=60,l=s="rgba(0,0,0,.4)",n.beginPath(),n.moveTo(70,r),n.lineWidth=0,n.strokeStyle=s,n.fillStyle=l,n.arcTo(502,r,502,374,a),n.arcTo(502,374,o,374,a),n.arcTo(o,374,o,r,a),n.arcTo(o,r,502,r,a),n.stroke(),n.fill(),n.closePath(),n.fillStyle="rgba(255,255,255,.85)",n.fillText(t,(i.width-c)/2,(i.height+108)/2);var u=new v.Texture(i);return u.needsUpdate=!0,u},loadCanvasIn:function(t){(i=document.createElement("canvas").getContext("2d")).font="100px Arial";var e,i,n,o,r,a,s,l=i.measureText(t).width+60,c=l+4;(i=(e=document.createElement("canvas")).getContext("2d")).canvas.width=c,i.canvas.height=144,i.font="Bold 100px Arial",o=1,r=l+2,a=142,s=30,(n=i).beginPath(),n.moveTo(31,o),n.lineWidth=1,n.strokeStyle="rgba(0,0,0,.4)",n.fillStyle="rgba(0,0,0,.4)",n.arcTo(1+r,o,1+r,o+a,s),n.arcTo(1+r,o+a,1,o+a,s),n.arcTo(1,o+a,1,o,s),n.arcTo(1,o,1+r,o,s),n.stroke(),n.fill(),n.closePath(),i.fillStyle="rgba(255,255,255,0.85)",i.fillText(t,32,102);var u=new v.Texture(e);return u.minFilter=v.LinearFilter,u.magFilter=v.LinearFilter,u.needsUpdate=!0,u},isLoaded:function(t){return!!j[t]},initCanvasLabel:function(t){var e=document.createElement("canvas"),i=e.getContext("2d");i.font=t.fontSize+"px Arial";var n,o,r,a,s,l,c,u=i.measureText(t.text).width+t.fontSize,h=t.fontSize+t.fontSize,d=h/10;e.width=u,e.height=h,i.lineWidth=2,i.strokeStyle="rgba( 0, 0, 0, 1 )",i.fillStyle="rgba( 0, 0, 0, 1 )",o=2,r=u-4,a=h-4,s=d,(n=i).beginPath(),n.moveTo(2,o+s),n.lineTo(2,o+a-s),n.quadraticCurveTo(2,o+a,2+s,o+a),n.lineTo(2+r-s,o+a),n.quadraticCurveTo(2+r,o+a,2+r,o+a-s),n.lineTo(2+r,o+s),n.quadraticCurveTo(2+r,o,2+r-s,o),n.lineTo(2+s,o),n.quadraticCurveTo(2,o,2,o+s),n.stroke(),n.fill(),n.closePath(),c=t,(l=i).fillStyle="rgba( 255, 255, 255, 1 )",l.font=c.fontSize+"px "+c.fontFace,l.textAlign="center",l.textBaseline="middle",l.fillText(c.text,u/2,h/2+2);var p=new v.CanvasTexture(e);return p.minFilter=v.LinearFilter,p.magFilter=v.LinearFilter,p.needsUpdate=!0,{texture:p,canvas:e}}},W="precision highp float;\nprecision highp int;\n\nuniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n",q="precision highp float;\nprecision highp int;\n\nuniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n",$={basicTextured:{uniforms:{tDiffuse:{type:"t",value:null},alpha:{type:"f",value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:"varying vec2 vUv;\nuniform float alpha;\nuniform sampler2D tDiffuse;\nvoid main() {\n  vec4 texColor = texture2D(tDiffuse, vUv);\n  gl_FragColor = vec4(texColor.rgb, texColor.a * alpha);\n}"},copyCubeMap:{uniforms:{tDiffuse:{type:"t",value:null},alpha:{type:"f",value:1}},vertexShader:"varying vec3 vWorldPos;\nvoid main() {\n  vWorldPos = vec3(-position.x, -position.y, position.z);\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:"varying vec3 vWorldPos;\nuniform float alpha;\nuniform samplerCube tDiffuse;\nvoid main() {\n  vec4 texColor = textureCube(tDiffuse, vWorldPos);\n  gl_FragColor = vec4(texColor.rgb, texColor.a * alpha);\n}"},cube:{uniforms:{map:{type:"t",value:null},opacity:{type:"f",value:1}},vertexShader:W+"varying vec3 vWorldPosition;\n\nvoid main() {\n  vWorldPosition = position;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",fragmentShader:q+"uniform samplerCube map;\nuniform float opacity;\n\nvarying vec3 vWorldPosition;\n\nvoid main() {\n  vec4 color = textureCube( map, vec3( -vWorldPosition.x, vWorldPosition.yz ) );\n  gl_FragColor = vec4(color.rgb, opacity);\n}\n"},model:{uniforms:{map:{type:"t",value:null},modelAlpha:{type:"f",value:z.modelAlpha},opacity:{type:"f",value:1},progress:{type:"f",value:0},blackout:{type:"i",value:0},pano0Map:{type:"t",value:null},pano0Position:{type:"v3",value:new v.Vector3},pano0Matrix:{type:"m4",value:new v.Matrix4},pano1Map:{type:"t",value:null},pano1Position:{type:"v3",value:new v.Vector3},pano1Matrix:{type:"m4",value:new v.Matrix4}},vertexShader:W+"uniform vec3 pano0Position;\nuniform mat4 pano0Matrix;\n\nuniform vec3 pano1Position;\nuniform mat4 pano1Matrix;\n\nvarying vec2 vUv;\nvarying vec3 vWorldPosition0;\nvarying vec3 vWorldPosition1;\n\nvoid main() {\n\n  vUv = uv;\n  vec4 worldPosition = modelMatrix * vec4(position, 1.0);\n\n  vec3 positionLocalToPanoCenter0 = worldPosition.xyz - pano0Position;\n  vWorldPosition0 = (vec4(positionLocalToPanoCenter0, 1.0) * pano0Matrix).xyz;\n  vWorldPosition0.x *= -1.0;\n\n  vec3 positionLocalToPanoCenter1 = worldPosition.xyz - pano1Position;\n  vWorldPosition1 = (vec4(positionLocalToPanoCenter1, 1.0) * pano1Matrix).xyz;\n  vWorldPosition1.x *= -1.0;\n\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n}\n",fragmentShader:q+"uniform sampler2D map;\nuniform float modelAlpha;\nuniform float opacity;\nuniform float progress;\nuniform int blackout;\n\nuniform vec3 pano0Position;\nuniform samplerCube pano0Map;\n\nuniform vec3 pano1Position;\nuniform samplerCube pano1Map;\n\nvarying vec2 vUv;\nvarying vec3 vWorldPosition0;\nvarying vec3 vWorldPosition1;\nuniform vec2 mousePosition;\nuniform int isEditVersion;\nvoid main() {\n\tconst vec4 BLACK = vec4(0.0, 0.0, 0.0, 1.0);\n\tconst vec4 GREY  = vec4(0.5, 0.5, 0.5, 1.0);\n\n\tvec4 colorFromPanos;\n\tvec4 colorFromPano0 = textureCube( pano0Map, vWorldPosition0.xyz);\n\tvec4 colorFromPano1 = textureCube( pano1Map, vWorldPosition1.xyz);\n\n\tif (blackout == 0) {\n\t\tcolorFromPanos = mix(colorFromPano0, colorFromPano1, progress);\n\t} else if (blackout == 1) {\n\t\tcolorFromPanos = mix(colorFromPano0, BLACK, min(1.0, progress*2.0));\n\t\tcolorFromPanos = mix(colorFromPanos, colorFromPano1, max(0.0, progress * 2.0 - 1.0));\n\t} else if (blackout == 2) {\n\t\tcolorFromPanos = mix(colorFromPano0, BLACK, progress);\n\t} else if (blackout == 3) {\n\t\tcolorFromPanos = mix(BLACK, colorFromPano1, max(0.0, progress * 2.0 - 1.0));\n\t} \n\n\tvec4 colorFromTexture = texture2D( map, vUv );\n\tcolorFromPanos = mix(colorFromPanos, colorFromTexture, modelAlpha);\n\n\tfloat whiteness = 1.0 - smoothstep(0.1, 0.2, opacity);\n\tcolorFromPanos = mix(colorFromPanos, GREY, whiteness);\n\tgl_FragColor = vec4(colorFromPanos.rgb, opacity);\n}\n"},model2:{uniforms:{map:{type:"t",value:null},modelAlpha:{type:"f",value:z.modelAlpha},opacity:{type:"f",value:1},progress:{type:"f",value:0},blackout:{type:"i",value:0},pano0Map:{type:"t",value:null},pano0Position:{type:"v3",value:new v.Vector3},pano0Matrix:{type:"m4",value:new v.Matrix4},pano1Map:{type:"t",value:null},pano1Position:{type:"v3",value:new v.Vector3},pano1Matrix:{type:"m4",value:new v.Matrix4},hue0:{type:"f",value:0},saturation0:{type:"f",value:0},brightness0:{type:"f",value:0},contrast0:{type:"f",value:0},gamma0:{type:"f",value:1},vibrance0:{type:"f",value:0},balance0:{type:"v3",value:new v.Vector3},hue1:{type:"f",value:0},saturation1:{type:"f",value:0},brightness1:{type:"f",value:0},contrast1:{type:"f",value:0},gamma1:{type:"f",value:1},vibrance1:{type:"f",value:0},balance1:{type:"v3",value:new v.Vector3},base:{type:"f",value:2}},vertexShader:W+"uniform vec3 pano0Position;\nuniform mat4 pano0Matrix;\n\nuniform vec3 pano1Position;\nuniform mat4 pano1Matrix;\n\nvarying vec2 vUv;\nvarying vec3 vWorldPosition0;\nvarying vec3 vWorldPosition1;\n\nvoid main() {\n\n  vUv = uv;\n  vec4 worldPosition = modelMatrix * vec4(position, 1.0);\n\n  vec3 positionLocalToPanoCenter0 = worldPosition.xyz - pano0Position;\n  vWorldPosition0 = (vec4(positionLocalToPanoCenter0, 1.0) * pano0Matrix).xyz;\n  vWorldPosition0.x *= -1.0;\n\n  vec3 positionLocalToPanoCenter1 = worldPosition.xyz - pano1Position;\n  vWorldPosition1 = (vec4(positionLocalToPanoCenter1, 1.0) * pano1Matrix).xyz;\n  vWorldPosition1.x *= -1.0;\n\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n}\n",fragmentShader:q+"uniform sampler2D map;\nuniform float modelAlpha;\nuniform float opacity;\nuniform float progress;\nuniform int blackout;\n\nuniform vec3 pano0Position;\nuniform samplerCube pano0Map;\n\nuniform vec3 pano1Position;\nuniform samplerCube pano1Map;\n\nvarying vec2 vUv;\nvarying vec3 vWorldPosition0;\nvarying vec3 vWorldPosition1;\nuniform vec2 mousePosition;\nuniform int isEditVersion;\nuniform float hue0;\nuniform float saturation0;\nuniform float brightness0;\nuniform float contrast0;\nuniform float gamma0;\nuniform float vibrance0;\nuniform float hue1;\nuniform vec3 balance0;\nuniform float saturation1;\nuniform float brightness1;\nuniform float contrast1;\nuniform float gamma1;\nuniform float vibrance1;\nuniform vec3 balance1;\nuniform float base;\n\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n    return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\n\nfloat bcolor( in float value, in float b ) {\n\treturn max(min(value * pow(base, b), 1.0), 0.0);\n}\n\nvoid main() {\n\tconst vec4 BLACK = vec4(0.0, 0.0, 0.0, 1.0);\n\tconst vec4 GREY  = vec4(0.5, 0.5, 0.5, 1.0);\n\n\tvec4 colorFromPanos;\n\tvec4 colorFromPano0 = textureCube( pano0Map, vWorldPosition0.xyz);\n\tvec4 colorFromPano1 = textureCube( pano1Map, vWorldPosition1.xyz);\n\n\tif (blackout == 0) {\n\t\tcolorFromPanos = mix(colorFromPano0, colorFromPano1, progress);\n\t} else if (blackout == 1) {\n\t\tcolorFromPanos = mix(colorFromPano0, BLACK, min(1.0, progress*2.0));\n\t\tcolorFromPanos = mix(colorFromPanos, colorFromPano1, max(0.0, progress * 2.0 - 1.0));\n\t} else if (blackout == 2) {\n\t\tcolorFromPanos = mix(colorFromPano0, BLACK, progress);\n\t} else if (blackout == 3) {\n\t\tcolorFromPanos = mix(BLACK, colorFromPano1, max(0.0, progress * 2.0 - 1.0));\n\t}\n\n\tvec4 colorFromTexture = texture2D( map, vUv );\n\tcolorFromPanos = mix(colorFromPanos, colorFromTexture, modelAlpha);\n\n\tfloat whiteness = 1.0 - smoothstep(0.1, 0.2, opacity);\n\tcolorFromPanos = mix(colorFromPanos, GREY, whiteness);\n\tgl_FragColor = vec4(colorFromPanos.rgb, opacity);\n\tfloat hue = mix(hue0, hue1, progress);\n\tfloat gamma = mix(gamma0, gamma1, progress);\n\tfloat brightness = mix(brightness0, brightness1, progress);\n\tfloat contrast = mix(contrast0, contrast1, progress);\n\tfloat saturation = mix(saturation0, saturation1, progress);\n\tfloat vibrance = mix(vibrance0, vibrance1, progress);\n\tvec3 balance = mix(balance0, balance1, progress);\n\tgl_FragColor.r = bcolor(gl_FragColor.r, balance.x);\n\tgl_FragColor.g = bcolor(gl_FragColor.g, balance.y);\n\tgl_FragColor.b = bcolor(gl_FragColor.b, balance.z);\n\tif (hue!=0.0){\n        float angle = hue * 3.14159265;\n        float s = sin(angle), c = cos(angle);\n        vec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;\n        float len = length(gl_FragColor.rgb);\n        gl_FragColor.rgb = vec3(\n            dot(gl_FragColor.rgb, weights.xyz),\n            dot(gl_FragColor.rgb, weights.zxy),\n            dot(gl_FragColor.rgb, weights.yzx)\n        );\n    }\n    if (saturation!=0.0){\n        float average = (gl_FragColor.r + gl_FragColor.g + gl_FragColor.b) / 3.0;\n        if (saturation > 0.0) {\n            gl_FragColor.rgb += (average - gl_FragColor.rgb) * (1.0 - 1.0 / (1.001 - saturation));\n        } else {\n            gl_FragColor.rgb += (average - gl_FragColor.rgb) * (-saturation);\n        }\n\t}\n    gl_FragColor.rgb += brightness;\n    if (contrast!=0.0){\n        if (contrast > 0.0) {\n            gl_FragColor.rgb = (gl_FragColor.rgb - 0.5) / (1.0 - contrast) + 0.5;\n        } else {\n            gl_FragColor.rgb = (gl_FragColor.rgb - 0.5) * (1.0 + contrast) + 0.5;\n        }\n\t}\n    if (vibrance!=0.0){\n        float average = (gl_FragColor.r + gl_FragColor.g + gl_FragColor.b) / 3.0;\n        float mx = max(gl_FragColor.r, max(gl_FragColor.g, gl_FragColor.b));\n        float amt = (mx - average) * (-vibrance * 3.0);\n        gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(mx), amt);\n    }\n    if (gamma!=1.0){\n        gl_FragColor = LinearToGamma( gl_FragColor, float( gamma ) );\n    }\n}\n"},modelOutside:{uniforms:{map:{type:"t",value:null},opacity:{type:"f",value:1},brightness:{type:"f",value:0}},vertexShader:W+"varying vec2 vUv;\n\nvoid main() {\n\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n}\n",fragmentShader:q+"uniform sampler2D map;\nuniform float opacity;\nuniform float brightness;\nvarying vec2 vUv;\n\nvec4 white = vec4(0.5, 0.5, 0.5, 1.0);\n\nvoid main() {\n\n  vec4 colorFromTexture = texture2D( map, vUv );\n  float whiteness = 1.0 - smoothstep(0.1, 0.2, opacity);\n  colorFromTexture = mix(colorFromTexture, white, whiteness);\n  gl_FragColor = vec4(colorFromTexture.rgb, opacity);\n\n}\n"},ribbon:{uniforms:{map:{type:"t",value:null},opacity:{type:"f",value:1},color:{type:"c",value:new v.Color(z.path.color)}},vertexShader:W+"varying vec2 vUv;\nvarying vec3 vN;\nvarying vec4 vP;\n\nvoid main() {\n\n  vUv = uv;\n  vN= normalMatrix * normal;\n  vP = modelViewMatrix * vec4( position, 1.0 );\n  gl_Position = projectionMatrix * vP;\n}\n",fragmentShader:q+"uniform sampler2D map;\nuniform float opacity;\nvarying vec2 vUv;\nuniform vec3 color;\nvarying vec3 vN; // show-1182\nvarying vec4 vP; // show-1182\n\nvoid main() {\n\t// TODO add scroll-in and pulsing behaviors\n\tvec3 vNn = normalize(vN);\n\tvec3 vPn = normalize(vP.xyz);\n\tfloat f = pow(1.0-abs(dot(vNn,vPn)),0.2);\n  vec4 colorFromTexture = texture2D( map, vUv );\n  colorFromTexture.a *= f;\n  gl_FragColor = vec4((color.rgb*colorFromTexture.rgb),\n  \t\t\t\t\t\t(opacity*colorFromTexture.a));\n}\n"},waypoint:{uniforms:{map:{type:"t",value:null},opacity:{type:"f",value:1},pulse:{type:"f",value:1},nearFade:{type:"v2",value:new v.Vector2(2*z.insideNear,2*z.path.waypointIndoorRadius)},color:{type:"c",value:new v.Color(z.reticuleColor)}},vertexShader:W+"varying vec2 vUv;\nvarying vec4 vPointView;\n\nvoid main() {\n\n  vUv = uv;\n  vPointView = modelViewMatrix * vec4( position, 1.0 );\n  gl_Position = projectionMatrix * vPointView;\n\n}\n",fragmentShader:q+"uniform sampler2D map;\nuniform float opacity;\nuniform float pulse; // another opacity, with a different clock\nuniform vec2 nearFade;\nvarying vec2 vUv;\nvarying vec4 vPointView;\nuniform vec3 color;\n\nvoid main() {\n\t// TODO add scroll-in and pulsing behaviors\n\tfloat depthFade = min(1.0, (abs(vPointView.z)-nearFade.x)/(nearFade.y-nearFade.x));\n  vec4 colorFromTexture = texture2D( map, vUv );\t\t// we only use the alpha!\n  gl_FragColor = vec4(color.rgb,\n  \t\t\t\t\t\t(pulse*opacity*colorFromTexture.a * depthFade));\n}\n"},modelDebug:{uniforms:{map:{type:"t",value:null},modelAlpha:{type:"f",value:z.modelAlpha},depthmapRatio:{type:"f",value:0},opacity:{type:"f",value:1},progress:{type:"f",value:0},considerOcclusion:{type:"i",value:z.fancierTransition},highlightPanoSelection:{type:"i",value:0},useThirdPano:{type:"i",value:z.useThirdPano},pano0Map:{type:"t",value:null},pano0Depth:{type:"t",value:null},pano0Position:{type:"v3",value:new v.Vector3},pano0Matrix:{type:"m4",value:new v.Matrix4},pano0Weight:{type:"f",value:z.transition.pano0Weight},pano1Map:{type:"t",value:null},pano1Depth:{type:"t",value:null},pano1Position:{type:"v3",value:new v.Vector3},pano1Matrix:{type:"m4",value:new v.Matrix4},pano1Weight:{type:"f",value:z.transition.pano1Weight},pano2Map:{type:"t",value:null},pano2Depth:{type:"t",value:null},pano2Position:{type:"v3",value:new v.Vector3},pano2Matrix:{type:"m4",value:new v.Matrix4},pano2Weight:{type:"f",value:z.transition.pano2Weight}},vertexShader:W+"uniform vec3 pano0Position;\nuniform mat4 pano0Matrix;\n\nuniform vec3 pano1Position;\nuniform mat4 pano1Matrix;\n\nuniform vec3 pano2Position;\nuniform mat4 pano2Matrix;\n\nvarying vec2 vUv;\nvarying vec3 vWorldPosition0;\nvarying vec3 vWorldPosition1;\nvarying vec3 vWorldPosition2;\n\nvarying vec4 worldPosition;\n\nvoid main() {\n\n  vUv = uv;\n  worldPosition = modelMatrix * vec4(position, 1.0);\n\n  vec3 positionLocalToPanoCenter0 = worldPosition.xyz - pano0Position;\n  vWorldPosition0 = (vec4(positionLocalToPanoCenter0, 1.0) * pano0Matrix).xyz;\n  vWorldPosition0.x *= -1.0;\n\n  vec3 positionLocalToPanoCenter1 = worldPosition.xyz - pano1Position;\n  vWorldPosition1 = (vec4(positionLocalToPanoCenter1, 1.0) * pano1Matrix).xyz;\n  vWorldPosition1.x *= -1.0;\n\n  vec3 positionLocalToPanoCenter2 = worldPosition.xyz - pano2Position;\n  vWorldPosition2 = (vec4(positionLocalToPanoCenter2, 2.0) * pano2Matrix).xyz;\n  vWorldPosition2.x *= -1.0;\n\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n}\n",fragmentShader:q+"uniform sampler2D map;\nuniform float depthmapRatio;\nuniform float modelAlpha;\nuniform float opacity;\nuniform float progress;\nuniform int considerOcclusion;\nuniform int highlightPanoSelection;\nuniform int useThirdPano;\n\nuniform vec3 pano0Position;\nuniform samplerCube pano0Map;\nuniform samplerCube pano0Depth;\nuniform float pano0Weight;\n\nuniform vec3 pano1Position;\nuniform samplerCube pano1Map;\nuniform samplerCube pano1Depth;\nuniform float pano1Weight;\n\nuniform vec3 pano2Position;\nuniform samplerCube pano2Map;\nuniform samplerCube pano2Depth;\nuniform float pano2Weight;\n\nvarying vec2 vUv;\nvarying vec3 vWorldPosition0;\nvarying vec3 vWorldPosition1;\nvarying vec3 vWorldPosition2;\n\nvarying vec4 worldPosition;\n\nvoid main() {\n\n  vec4 depthFromPano0 = textureCube( pano0Depth, vWorldPosition0.xyz );\n  vec4 depthFromPano1 = textureCube( pano1Depth, vWorldPosition1.xyz );\n  vec4 depthFromPano2 = textureCube( pano2Depth, vWorldPosition2.xyz );\n\n  vec4 colorFromPano0 = textureCube( pano0Map, vWorldPosition0.xyz );\n  vec4 colorFromPano1 = textureCube( pano1Map, vWorldPosition1.xyz );\n  vec4 colorFromPano2 = textureCube( pano2Map, vWorldPosition2.xyz );\n\n  float distanceToPano0 = distance(worldPosition.xyz, pano0Position);\n  float distanceToPano1 = distance(worldPosition.xyz, pano1Position);\n  float distanceToPano2 = distance(worldPosition.xyz, pano2Position);\n\n  float cameraToPano0 = distance(cameraPosition.xyz, pano0Position);\n  float cameraToPano1 = distance(cameraPosition.xyz, pano1Position);\n  float cameraToPano2 = distance(cameraPosition.xyz, pano2Position);\n\n  float contributionFromPano0 = cameraToPano0 == 0.0 ? 1000.0 : pano0Weight / cameraToPano0;\n  float contributionFromPano1 = cameraToPano1 == 0.0 ? 1000.0 : pano1Weight / cameraToPano1;\n  float contributionFromPano2 = cameraToPano2 == 0.0 ? 1000.0 : pano2Weight / cameraToPano2;\n\n  contributionFromPano0 *= 1.0 / distanceToPano0;\n  contributionFromPano1 *= 1.0 / distanceToPano1;\n  contributionFromPano2 *= 1.0 / distanceToPano2;\n\n  if(considerOcclusion == 1) {\n    bool occludedFromPano0 = distanceToPano0 / 10.0 > 1.01 - depthFromPano0.x;\n    bool occludedFromPano1 = distanceToPano1 / 10.0 > 1.01 - depthFromPano1.x;\n    bool occludedFromPano2 = distanceToPano2 / 10.0 > 1.01 - depthFromPano2.x;\n\n    if(occludedFromPano0){contributionFromPano0 *= 0.1;}\n    if(occludedFromPano1){contributionFromPano1 *= 0.1;}\n    if(occludedFromPano2){contributionFromPano2 *= 0.1;}\n    //if(occludedFromPano0 && occludedFromPano1 && !occludedFromPano2) { contributionFromPano2 += 0.5; }\n  }\n\n  float contributionSum = contributionFromPano0 + contributionFromPano1 + contributionFromPano2;\n  contributionFromPano0 /= contributionSum;\n  contributionFromPano1 /= contributionSum;\n  contributionFromPano2 /= contributionSum;\n\n  vec4 colorFromPanos = colorFromPano0 * contributionFromPano0;\n  colorFromPanos += colorFromPano1 * contributionFromPano1;\n  colorFromPanos += colorFromPano2 * contributionFromPano2;\n\n  vec4 depthFromPanos = depthFromPano0 * contributionFromPano0;\n  depthFromPanos += depthFromPano1 * contributionFromPano1;\n  depthFromPanos += depthFromPano2 * contributionFromPano2;\n\n  vec4 colorFromTexture = texture2D( map, vUv );\n  colorFromPanos = mix(colorFromPanos, colorFromTexture, modelAlpha);\n\n  if(highlightPanoSelection == 1) {\n    colorFromPanos.r = contributionFromPano0;\n    colorFromPanos.g = contributionFromPano1;\n    colorFromPanos.b = contributionFromPano2;\n  }\n\n  gl_FragColor = vec4(mix(colorFromPanos, depthFromPanos, depthmapRatio).rgb, opacity);\n\n}\n"},customDepth:{uniforms:{panoPosition:{type:"v3",value:new v.Vector3}},vertexShader:W+"varying vec4 worldPosition;\n\nvoid main() {\n\n  worldPosition = modelMatrix * vec4(position, 1.0);\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n}\n",fragmentShader:q+"uniform vec3 panoPosition;\nvarying vec4 worldPosition;\n\nvoid main() {\n\n  float depth = distance(worldPosition.xyz, panoPosition);\n  float color = 1.0 - depth / 10.0;\n  gl_FragColor = vec4(color, color, color, 1.0);\n\n}\n"},skysphere:{uniforms:{radius:{type:"f",value:0}},vertexShader:W+"varying vec4 worldPosition;\n\nvoid main() {\n\n  worldPosition = modelMatrix * vec4(position, 1.0);\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n}\n",fragmentShader:q+"varying vec4 worldPosition;\nuniform float radius;\n\nvoid main() {\n\n  vec4 topColor = vec4(0.094, 0.102, 0.11, 1.0);\n  vec4 bottomColor = vec4(0.2, 0.216, 0.235, 1.0);\n  float normalizedHeight = (worldPosition.y + radius) / (radius * 2.0);\n  float ratio = smoothstep(0.0, 0.5, normalizedHeight);\n  gl_FragColor = mix(bottomColor, topColor, ratio);\n\n}\n"},tagDisc:{uniforms:{opacity:{type:"f",value:0},color:{type:"c",value:new v.Color},bg:{type:"t",value:null},mask:{type:"t",value:null}},vertexShader:W+"varying vec2 vUv;\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:q+"uniform float opacity;\nuniform vec3 color;\nuniform sampler2D bg;\nuniform sampler2D mask;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vec4 maskColor = texture2D(mask, vUv);\n  vec4 bgColor = texture2D(bg, vUv);\n  vec3 mappedColor = mix(bgColor.rgb, color, maskColor.a);\n  gl_FragColor = vec4(mappedColor, bgColor.a * opacity);\n}\n"}},Y={visibleFloor:1,ghostFloor:3,boundingSkybox:1,panoMarker:2,reticule:3,mattertagDisc:1,mattertagCutout:2,mattertagStem:3,ribbon:100},X={splitUrl:function(t){return z.isLocalVersion?window.location.origin+window.location.pathname.split("index.html")[0]+"/"+t.split("/common/")[1]:t},splitComUrl:function(t){return z.isLocalVersion?t.split("/common/")[1]:t}};function Q(t){var e=v.UniformsUtils.clone($.waypoint.uniforms);e.map.value=B,e.opacity.value=0,e.color.value.set(z.reticuleColor);var i=new v.PlaneBufferGeometry(.2,.2,1,1),n=new v.RawShaderMaterial({side:v.DoubleSide,depthWrite:!1,depthTest:!1,transparent:!0,vertexShader:$.waypoint.vertexShader,fragmentShader:$.waypoint.fragmentShader,uniforms:e,name:"waypoint",opacity:0});v.Mesh.call(this,i,n),this.renderOrder=Y.reticule,this.player=t,this.direction=new v.Vector3,this.hidden=!0,this.mouseLastMoveTime=Date.now(),this.editHidden=!1}B=G.conf.isCleanUI?H.loadurl(X.splitUrl("https://template2.3dnest.cn/common/img/nonepointer.png")):H.loadurl(X.splitUrl("https://template2.3dnest.cn/common/img/pointermain_512x512.png")),(Q.prototype=Object.create(v.Mesh.prototype)).move=function(t,e,i){this.editHidden?this.hidden=!0:(this.hidden=i,this.mouseLastMoveTime=Date.now())},Q.prototype.hide=function(){this.hidden||(this.hidden=!0,V.start(b.property(this.material.uniforms.opacity,"value",0),z.reticuleOpacityTransitionTime))},Q.prototype.show=function(){this.hidden=!1,this.material.opacity<=0&&V.start(b.property(this.material.uniforms.opacity,"value",z[this.player.mode].reticuleOpacity),z.reticuleOpacityTransitionTime)},Q.prototype.update=function(){this.editHidden||Date.now()-this.mouseLastMoveTime>z.hideReticuleTimeout&&!this.hidden&&this.hide()},Q.prototype.updatePosition=function(t,e){if(!this.hidden){if(!e)return this.hide();var i=e.point,n=t.distanceTo(i),o=1+.01*n;n<1&&(o-=1-n),this.show(),this.scale.set(o,o,o),this.direction=this.direction.multiplyScalar(.8),this.direction.add(e.face.normal.clone().multiplyScalar(.2)),this.position.copy(i).add(e.face.normal.clone().multiplyScalar(.01)),this.lookAt(this.position.clone().add(this.direction))}},Q.prototype.writeAsMattertag=function(){var t=Math.floor(4294967296*(1+Math.random())).toString(16)+Math.floor(16*(1+Math.random())).toString(16),e=new Date;this.tagCount=void 0===this.tagCount?1:this.tagCount+1;var i={enabled:!0,version:"0",created:e.toISOString(),created_by:"APITest",position:this.position.clone(),stem:{enabled:z.mattertags.pole.enabled,direction:this.direction.multiplyScalar(z.mattertags.pole.height)},label:"Mattertag "+this.tagCount,description:"Description "+t,floor:function(t){if(t.currentFloor){var e=t.floors.indexOf(t.currentFloor);return-1<e?e:void 0}}(this.player.model),type:"info",metadata:{preferred_camera:{mode:this.player.mode}}},n=this.player.model.addMattertag(t,i).build();n&&(n.disc&&this.player.mattertagDiscs.push(n.disc),n.visible||n.show(z.mattertags.startup.fadeInDuration))};var Z=Q,K=d(function(t){function e(t){var e=i.UniformsUtils.clone($.waypoint.uniforms);e.map.value=n,e.opacity.value=0,e.color.value.set(z.reticuleColor),i.Mesh.call(this,new i.PlaneBufferGeometry(.2,.2,1,1),new i.RawShaderMaterial({side:i.DoubleSide,depthWrite:!1,depthTest:!1,transparent:!0,vertexShader:$.waypoint.vertexShader,fragmentShader:$.waypoint.fragmentShader,uniforms:e,name:"waypoint",opacity:0})),this.renderOrder=Y.reticule,this.player=t,this.direction=new i.Vector3,this.hidden=!0,this.mouseLastMoveTime=Date.now(),this.lineMaterial=new i.LineBasicMaterial({linewidth:z.mattertags.pole.width,color:z.mattertags.pole.color,opacity:1,transparent:!0,alphaTest:z.mattertags.pole.opacity*z.mattertags.visibility.alphaTestLevel}),o.addAttribute("position",new i.BufferAttribute(r,3)),this.line=new i.Line(o,this.lineMaterial),this.line.renderOrder=Y.ribbon,this.pObject=new i.Object3D,this.pObject.add(this),this.pObject.add(this.line)}var i=v,n=H.loadurl(X.splitUrl("https://template2.3dnest.cn/common/img/pointermain_512x512.png")),o=new i.BufferGeometry,r=new Float32Array(6);r[0]=r[1]=r[2]=r[3]=r[4]=r[5]=0,(e.prototype=Object.create(i.Mesh.prototype)).move=function(t,e,i){this.hidden=i,this.mouseLastMoveTime=Date.now()},e.prototype.hide=function(){this.hidden||(this.hidden=!0,V.start(b.property(this.material.uniforms.opacity,"value",0),z.reticuleOpacityTransitionTime))},e.prototype.show=function(){this.hidden=!1,this.material.opacity<=0&&V.start(b.property(this.material.uniforms.opacity,"value",z[this.player.mode].reticuleOpacity),z.reticuleOpacityTransitionTime)},e.prototype.update=function(){Date.now()-this.mouseLastMoveTime>z.hideReticuleTimeout&&!this.hidden&&this.hide()},e.prototype.updatePosition=function(t,e){if(!this.hidden){if(!e)return this.hide();var i=e.point,n=t.distanceTo(i),o=1+.01*n;n<1&&(o-=1-n),this.show(),this.scale.set(o,o,o),this.direction=this.direction.multiplyScalar(.8),this.direction.add(e.face.normal.clone().multiplyScalar(.2)),this.position.copy(i).add(e.face.normal.clone().multiplyScalar(.01)),this.pObject.position.copy(this.position),this.buildPole(e),this.lookAt(this.position.clone().add(this.direction))}},e.prototype.buildPole=function(t){r[0]=r[1]=r[2]=0,r[3]=t.face.normal.x,r[4]=t.face.normal.y,r[5]=t.face.normal.z;var e=new i.Vector3(r[3],r[4],r[5]);e.normalize().multiplyScalar(.5),r[3]=e.x,r[4]=e.y,r[5]=e.z,o.addAttribute("position",new THREE.BufferAttribute(r,3))},e.prototype.writeAsMattertag=function(){var t=Math.floor(4294967296*(1+Math.random())).toString(16)+Math.floor(16*(1+Math.random())).toString(16),e=new Date;this.tagCount=void 0===this.tagCount?1:this.tagCount+1;var i={enabled:!0,version:"0",created:e.toISOString(),created_by:"APITest",position:this.position.clone(),stem:{enabled:z.mattertags.pole.enabled,direction:this.direction.multiplyScalar(z.mattertags.pole.height)},label:"Mattertag "+this.tagCount,description:"Description "+t,floor:function(t){if(t.currentFloor){var e=t.floors.indexOf(t.currentFloor);return-1<e?e:void 0}}(this.player.model),type:"info",metadata:{preferred_camera:{mode:this.player.mode}}},n=this.player.model.addMattertag(t,i).build();n&&(n.disc&&this.player.mattertagDiscs.push(n.disc),n.visible||n.show(z.mattertags.startup.fadeInDuration))},t.exports=e}),J={convertVisionVector:function(t){return new v.Vector3(t.x,t.z,-t.y)},convertVisionQuaternion:function(t){return new v.Quaternion(t.x,t.z,-t.y,t.w).multiply((new v.Quaternion).setFromAxisAngle(new v.Vector3(0,1,0),v.Math.degToRad(90)))},convertVisionQuaternionAutoScene:function(t){return new v.Quaternion(t.x,t.y,t.z,t.w).multiply((new v.Quaternion).setFromAxisAngle(new v.Vector3(0,1,0),v.Math.degToRad(-90)))},convertWorkshopVector:function(t){return new v.Vector3(-t.x,t.y,t.z)},convertWorkshopQuaternion:function(t){return new v.Quaternion(-t.x,t.y,t.z,-t.w).multiply(new v.Quaternion(Math.sqrt(2)/2,Math.sqrt(2)/2,0,0))},convertWorkshopPanoramaQuaternion:function(t){return new v.Quaternion(t.x,-t.y,-t.z,t.w).normalize().multiply((new v.Quaternion).setFromAxisAngle(new v.Vector3(0,1,0),v.Math.degToRad(270)))},convertWorkshopOrthoZoom:function(t){return-1===t?-1:t/4},toPrecision:function(t,e){var i=Math.pow(10,e);return Math.round(t*i)/i},projectPositionToCanvas:function(t,e,i,n){(n=n||new v.Vector3).copy(e);var o=.5*t.clientWidth,r=.5*t.clientHeight;return n.project(i),n.x=n.x*o+o,n.y=-n.y*r+r,n},convertScreenPositionToNDC:function(t,e,i,n){return(n=n||new v.Vector2).x=e/t.clientWidth*2-1,n.y=-i/t.clientHeight*2+1,n},constrainedTurn:function(t){var e=t%(2*Math.PI);return e>Math.PI?e-=2*Math.PI:e<-Math.PI?e+=2*Math.PI:e},getFOVDotThreshold:function(t){return Math.cos(v.Math.degToRad(t/2))},compareFloats:function(t,e){return Math.abs(t-e)<Number.EPSILON*Math.pow(2,45)}},tt={UP:new v.Vector3(0,1,0),DOWN:new v.Vector3(0,-1,0),LEFT:new v.Vector3(-1,0,0),RIGHT:new v.Vector3(1,0,0),FORWARD:new v.Vector3(0,0,-1),BACK:new v.Vector3(0,0,1)},et={ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,LEFTARROW:37,UPARROW:38,RIGHTARROW:39,DOWNARROW:40,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,SPACE:32,RETURN:13,PLUSEQUALS:187,DASHUNDERSCORE:189,OPENBRACKET:219},it={Move:"move",InteractionDirect:"interaction.direct",InteractionKey:"interaction.key",InteractionGui:"interaction.gui",FlyInDirection:"fly.direction",InputStart:"input.start",Pinch:"input.pinch",Scroll:"input.scroll",HideEvent:"panorama.move",RulersMove:"rulers.move",RulersWalk:"rulers.walk",TtagsMove:"titletag.move"};function nt(){}function ot(){ot.init.call(this)}function rt(t){return void 0===t._maxListeners?ot.defaultMaxListeners:t._maxListeners}function at(t,e,i,n){var o,r,a;if("function"!=typeof i)throw new TypeError('"listener" argument must be a function');if((r=t._events)?(r.newListener&&(t.emit("newListener",e,i.listener?i.listener:i),r=t._events),a=r[e]):(r=t._events=new nt,t._eventsCount=0),a){if("function"==typeof a?a=r[e]=n?[i,a]:[a,i]:n?a.unshift(i):a.push(i),!a.warned&&(o=rt(t))&&0<o&&a.length>o){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=t,s.type=e,s.count=a.length,s,console.warn}}else a=r[e]=i,++t._eventsCount;return t}function st(t,e,i){var n=!1;function o(){t.removeListener(e,o),n||(n=!0,i.apply(t,arguments))}return o.listener=i,o}function lt(t){var e=this._events;if(e){var i=e[t];if("function"==typeof i)return 1;if(i)return i.length}return 0}function ct(t,e){for(var i=new Array(e);e--;)i[e]=t[e];return i}nt.prototype=Object.create(null),(ot.EventEmitter=ot).usingDomains=!1,ot.prototype.domain=void 0,ot.prototype._events=void 0,ot.prototype._maxListeners=void 0,ot.defaultMaxListeners=10,ot.init=function(){this.domain=null,ot.usingDomains&&(void 0).active&&(void 0).Domain,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new nt,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ot.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},ot.prototype.getMaxListeners=function(){return rt(this)},ot.prototype.emit=function(t){var e,i,n,o,r,a,s,l="error"===t;if(a=this._events)l=l&&null==a.error;else if(!l)return!1;if(s=this.domain,l){if(e=arguments[1],s)return e||(e=new Error('Uncaught, unspecified "error" event')),e.domainEmitter=this,e.domain=s,e.domainThrown=!1,s.emit("error",e),!1;if(e instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(!(i=a[t]))return!1;var u="function"==typeof i;switch(n=arguments.length){case 1:!function(t,e,i){if(u)t.call(i);else for(var n=t.length,o=ct(t,n),r=0;r<n;++r)o[r].call(i)}(i,0,this);break;case 2:!function(t,e,i,n){if(e)t.call(i,n);else for(var o=t.length,r=ct(t,o),a=0;a<o;++a)r[a].call(i,n)}(i,u,this,arguments[1]);break;case 3:!function(t,e,i,n,o){if(e)t.call(i,n,o);else for(var r=t.length,a=ct(t,r),s=0;s<r;++s)a[s].call(i,n,o)}(i,u,this,arguments[1],arguments[2]);break;case 4:!function(t,e,i,n,o,r){if(e)t.call(i,n,o,r);else for(var a=t.length,s=ct(t,a),l=0;l<a;++l)s[l].call(i,n,o,r)}(i,u,this,arguments[1],arguments[2],arguments[3]);break;default:for(o=new Array(n-1),r=1;r<n;r++)o[r-1]=arguments[r];!function(t,e,i,n){if(u)t.apply(i,n);else for(var o=t.length,r=ct(t,o),a=0;a<o;++a)r[a].apply(i,n)}(i,0,this,o)}return!0},ot.prototype.on=ot.prototype.addListener=function(t,e){return at(this,t,e,!1)},ot.prototype.prependListener=function(t,e){return at(this,t,e,!0)},ot.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,st(this,t,e)),this},ot.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,st(this,t,e)),this},ot.prototype.removeListener=function(t,e){var i,n,o,r,a;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(i=n[t]))return this;if(i===e||i.listener&&i.listener===e)0==--this._eventsCount?this._events=new nt:(delete n[t],n.removeListener&&this.emit("removeListener",t,i.listener||e));else if("function"!=typeof i){for(o=-1,r=i.length;0<r--;)if(i[r]===e||i[r].listener&&i[r].listener===e){a=i[r].listener,o=r;break}if(o<0)return this;if(1===i.length){if(i[0]=void 0,0==--this._eventsCount)return this._events=new nt,this;delete n[t]}else!function(t,e){for(var i=e,n=i+1,o=t.length;n<o;i+=1,n+=1)t[i]=t[n];t.pop()}(i,o);n.removeListener&&this.emit("removeListener",t,a||e)}return this},ot.prototype.removeAllListeners=function(t){var e,i;if(!(i=this._events))return this;if(!i.removeListener)return 0===arguments.length?(this._events=new nt,this._eventsCount=0):i[t]&&(0==--this._eventsCount?this._events=new nt:delete i[t]),this;if(0===arguments.length){for(var n,o=Object.keys(i),r=0;r<o.length;++r)"removeListener"!==(n=o[r])&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=new nt,this._eventsCount=0,this}if("function"==typeof(e=i[t]))this.removeListener(t,e);else if(e)for(;this.removeListener(t,e[e.length-1]),e[0];);return this},ot.prototype.listeners=function(t){var e,i=this._events;return i&&(e=i[t])?"function"==typeof e?[e.listener||e]:function(t){for(var e=new Array(t.length),i=0;i<e.length;++i)e[i]=t[i].listener||t[i];return e}(e):[]},ot.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):lt.call(t,e)},ot.prototype.listenerCount=lt,ot.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]};var ut=ot.EventEmitter,ht=function(){this.instance=null;var t=this;window.updateChatStatus=function(e,i){switch(e=parseInt(e)){case 1:t.emit("calling");break;case 2:case 3:t.emit("onCall",e);break;case 4:t.emit("busy");break;case 5:t.emit("refuse");break;case 6:t.emit("timeout");break;case 7:case 8:t.emit("hangup");break;case 9:t.emit("voice_error");break;case 10:t.emit("leftTime",parseInt(i))}}};((ht.prototype=Object.create(ut.prototype)).construct=ht).prototype.init=function(){},ht.prototype.sendLog=function(){},ht.prototype.sendData=function(t){},ht.prototype.call=function(){},ht.prototype.mute=function(){},ht.prototype.unmute=function(){},ht.prototype.hangup=function(){},ht.prototype.refuse=function(){},ht.prototype.accept=function(){};var dt=ht,pt="";g.detectAndroid()?pt="android":g.detectIOS()&&(pt="ios");var ft=function(t){return window.webkit.messageHandlers&&window.webkit.messageHandlers[t]},mt=function(t){dt.call(this,t),this.deviceType=pt,this.remoteAccid=void 0!==t.remoteAccid?t.remoteAccid:"",this.userInfoCallBack=function(){};var e=this;window.onData=function(t){mt.sendLog("recive Data:"+t);try{e.emit("onData",t)}catch(t){mt.sendLog(t)}}};mt.sendLog=function(t){"ios"==pt?ft("getLog")&&window.webkit.messageHandlers.getLog.postMessage(t):"android"==pt&&window.WebBridge&&window.WebBridge.getLog&&window.WebBridge.getLog(t)},mt.getUserInfo=function(t){if(mt.sendLog("will get userInfo"),window.onReceiveUserInfo=function(e){mt.sendLog("getUserInfo callBack"+e),t(JSON.parse(e))},"ios"==pt)ft("getUserInfo")&&(window.webkit.messageHandlers.getUserInfo.postMessage(""),mt.sendLog("ios getUserInfo"));else if("android"==pt&&window.WebBridge&&window.WebBridge.getUserInfo){var e=window.WebBridge.getUserInfo();mt.sendLog("android getUserInfo"),t(JSON.parse(e))}},mt.prototype=Object.create(dt.prototype),mt.prototype.init=function(){if("android"===this.deviceType){if(!window.WebBridge)return this.emit("platform","platform-error"),"platform-error"}else if("ios"===this.deviceType&&!window.webkit)return this.emit("platform","platform-error"),"platform-error";return this},mt.prototype.sendData=function(t){"ios"==this.deviceType?ft("sendData")&&window.webkit.messageHandlers.sendData.postMessage(t):"android"==this.deviceType&&window.WebBridge.sendData&&window.WebBridge.sendData(t)},mt.prototype.call=function(){"ios"==this.deviceType?ft("call")&&window.webkit.messageHandlers.call.postMessage("makeCall"):"android"==this.deviceType&&window.WebBridge.call&&window.WebBridge.call(),mt.sendLog("has call")},mt.prototype.mute=function(){"ios"==this.deviceType?ft("mute")&&window.webkit.messageHandlers.mute.postMessage("mute"):"android"==this.deviceType&&window.WebBridge.mute&&window.WebBridge.mute()},mt.prototype.unmute=function(){"ios"==this.deviceType?ft("unmute")&&window.webkit.messageHandlers.unmute.postMessage("unMute"):"android"==this.deviceType&&window.WebBridge.unmute&&window.WebBridge.unmute()},mt.prototype.hangup=function(){"ios"==this.deviceType?ft("hangup")&&window.webkit.messageHandlers.hangup.postMessage("hangup"):"android"==this.deviceType&&window.WebBridge.hangup&&window.WebBridge.hangup()},mt.prototype.refuse=function(){"ios"==this.deviceType?ft("refuse")&&window.webkit.messageHandlers.refuse.postMessage("refuseRemote"):"android"==this.deviceType&&window.WebBridge.refuse&&window.WebBridge.refuse()},mt.prototype.accept=function(){"ios"==this.deviceType?ft("accept")&&window.webkit.messageHandlers.accept.postMessage("acceptRemote"):"android"==this.deviceType&&window.WebBridge.accept&&window.WebBridge.accept(),mt.sendLog("accept")};var gt,vt,yt,bt=mt,wt=ot.EventEmitter;function xt(){(G.connect=this).uuid="",this.sendOperationFalg=!1,this.initState=!1,this.signalState=!1,this.busyState=!1,this.busySended=!1,this.voiceFlag=!1;var t=this.sync=!1;this.remoteControl=!1,this.syncInitState=!1,this.handelCallTimeOut=null,this.hangupType="timeout",this.lookInstance=null;var e=this;Object.defineProperty(this,"busy",{get:function(){return t},set:function(i){if(i){if(e.remoteControl)return void e.emit("remote_busy");t=!0,this.sync=!1,this.sendBusy()}else t=!1,this.cancelBusy()}}),this.showTip=function(){},this.getCurrentState=function(){},this._handleMessage=this._handleMessage.bind(this),this._handleCall=this._handleCall.bind(this),this._handleHangup=this._handleHangup.bind(this),this.callTimeHandle=null,this.userInfo={identity:"1",customer:{state:!1,nickName:"客户",phoneNum:"15311496327",role:"",identity:"4",headImg:"",accid:""},bussiness:{state:!1,nickName:"经纪人",phoneNum:"18911926367",role:"",identity:"1",headImg:"",accid:""}}}((xt.prototype=Object.create(wt.prototype)).constructor=xt).prototype.init=function(){var t,e=this;if(t="4"===this.userInfo.identity?this.userInfo.bussiness.accid:this.userInfo.customer.accid,this.lookInstance=new bt({remoteAccid:t}),"platform-error"===this.lookInstance.init())throw bt.sendLog("platform-error"),new Error("platform-error");return this.lookInstance.on("onData",this._handleMessage),this.lookInstance.on("onCall",this._handleCall),this.lookInstance.on("refuse",function(){bt.sendLog("通话被拒接"),e.emit("bussiness_busy")}),this.lookInstance.on("hangup",this._handleHangup),this.lookInstance.on("busy",function(){bt.sendLog("顾问被占线"),e.lookInstance.hangup(),e.emit("connect_busyline")}),this.lookInstance.on("voice_error",this._handleHangup),this.lookInstance.on("leftTime",function(t){e.emit("calling_left_time",t)}),this.lookInstance.on("calling",function(){e.emit("calling")}),this.signalState=!0,this.emit("init_done",this.userInfo.identity),this.initState=!0,this.sendState({type:"connectState",state:"initdone"}),bt.sendLog("send init done"+JSON.stringify(this.userInfo)),"4"===this.userInfo.identity?e.userInfo.customer.state=!0:e.userInfo.bussiness.state=!0,this.emit("identity",this.userInfo),!0},xt.prototype._getUserinfoType=function(t,e){var i=t[e];return{nickName:i[e+"Nickname"],headImg:i[e+"HeadImage"],identity:i[e+"Identity"],accid:i[e+"Accid"],role:i[e+"Role"]}},xt.prototype.joinChannel=function(t,e,i){if(this.emit("init"),this.getCurrentState=e,t){try{var n=this._getUserinfoType(t,"bussiness"),o=this._getUserinfoType(t,"customer");this.userInfo.identity=t.currentIdentity,this.userInfo.bussiness=n,this.userInfo.customer=o}catch(t){bt.sendLog("set userInfo error"+JSON.stringify(t))}bt.sendLog("set user info done:"+JSON.stringify(this.userInfo))}this.init(),bt.sendLog("joinChannel done!")},xt.prototype._handleCall=function(){bt.sendLog("通话已经接通"),"4"===this.userInfo.identity?this.userInfo.bussiness.state=!0:this.userInfo.customer.state=!0,this.emit("identity",this.userInfo),this.emit("callsuccess"),this.emit("user_connected"),this.hangupType="hangup",this.voiceFlag=!0},xt.prototype._handleHangup=function(){bt.sendLog("通话被挂断"),"timeout"!==this.hangupType&&("4"===this.userInfo.identity?this.userInfo.bussiness.state=!1:this.userInfo.customer.state=!1,this.emit("close_connect",this.userInfo),this.destory())},xt.prototype._handleMessage=function(t){var e=JSON.parse(t);switch(bt.sendLog("H5 onData:"+t),e.type){case"state":this._handleState(e);break;case"operation":this._handleOpertation(e);break;case"busy":this._handleBusy(e)}},xt.prototype.setBusy=(gt=null,function(){var t=this;null!==gt?(clearTimeout(gt),gt=null):(this.sync=!1,this.sendState({type:"busyState",state:"busy"}),this.busySended=!0),gt=setTimeout(function(){t.sendState({type:"busyState",state:"nobusy"}),gt=null,t.busySended=!1},400)}),xt.prototype.sendBusy=function(){this.busySended||(this.sync=!1,this.sendState({type:"busyState",state:"busy"}),this.busySended=!0)},xt.prototype.cancelBusy=(vt=null,function(){var t=this;null!==vt&&clearTimeout(vt),vt=setTimeout(function(){t.sendState({type:"busyState",state:"nobusy"}),t.busySended=!1},2500)}),xt.prototype.getSyncState=function(){return this.remoteControl?(this.emit("remote_busy"),!1):!(this.sync=!1)},xt.prototype._handleBusy=function(t){"busy"===t.state?(this.remoteControl=!0,this.sync=!0):this.remoteControl=!1},xt.prototype._handleState=function(t){var e=t.data;switch(e.type){case"connectState":this._handleConnectState(e);break;case"busyState":this._handleBusy(e)}},xt.prototype.startVoiceLink=function(){"4"===this.userInfo.identity&&this.lookInstance.call()},xt.prototype.setStateDone=function(){bt.sendLog("同步状态:"+this.syncInitState),this.syncInitState&&(this.sendState({type:"connectState",state:"initstatedone"}),"4"!==this.userInfo.identity&&(this.userInfo.customer.state=!0,this.lookInstance.accept()),this.emit("identity",this.userInfo),this.sendOperationFalg=!0)},xt.prototype._handleConnectState=function(t){switch(t.state){case"initdone":bt.sendLog("客户端收到initdone事件");var e=this.getCurrentState();this.sendState({type:"connectState",state:"initstate",data:e});break;case"initstate":bt.sendLog("power端收到带数据的initState事件"),this.syncInitState=!0,this.emit("changestate",t.data);break;case"initstatedone":bt.sendLog("客户端收到power上线的消息"),this.sendOperationFalg=!0,"4"===this.userInfo.identity?this.userInfo.bussiness.state=!0:this.userInfo.customer.state=!0,this.emit("identity",this.userInfo)}},xt.prototype.setMute=function(t){this.sendOperationFalg&&(t?this.lookInstance.mute():this.lookInstance.unmute())},xt.prototype._handleOpertation=function(t){if(this.voiceFlag){this.sync=!0;var e=t.data;this.emit("operation",e)}},xt.prototype.sendMessage=function(t){this.signalState&&(bt.sendLog("H5 sendData:"+JSON.stringify(t)),this.lookInstance.sendData(JSON.stringify(t)))},xt.prototype.sendState=function(t){var e={type:"state",data:t};this.sendMessage(e)},xt.prototype.sendOperationasdf=(yt=null,function(t){var e=this;null!==yt&&clearTimeout(yt),yt=setTimeout(function(){e.sendOperation2remote(t)},15)}),xt.prototype.sendOperation=function(t){if((this.sendOperationFalg||this.voiceFlag)&&"uichange"!==t.type){var e={type:"operation",data:t};this.sendMessage(e)}},xt.prototype.callAgain=function(){this.lookInstance&&this.lookInstance.call()},xt.prototype.hangUp=function(){this.lookInstance&&this.lookInstance.hangup(),this.destory(),this.emit("close_connect",this.userInfo)},xt.prototype.destory=function(){this.sendOperationFalg=!1,this.initState=!1,this.signalState=!1,this.busyState=!1,this.busySended=!1,this.voiceFlag=!1,this.sync=!1,this.remoteControl=!1,this.syncInitState=!1,this.handelCallTimeOut=null,this.hangupType="timeout",this.lookInstance=null};var _t,St,Tt,Mt,It,Pt,Ct,At=(_t=null,function(t){return null===_t&&(_t=new xt(t)),_t}),Et=ot.EventEmitter,Lt=(new S("/js/controls/PanoramaControls.js"),!1),Dt=!0;function kt(t,e){this.camera=t,(this.camera.controls=this).container=e,this.target=new v.Vector3(0,0,0),this.lookVector=new v.Vector3,this.lookSpeed=.05,this.rotationAcc=new v.Vector2,this.rotationSpeed=new v.Vector2,this.lat=0,this.lon=0,this.phi=0,this.theta=0,this.enabled=!1,this.locked=!1,this.pointer=new v.Vector2(0,0),this.rotationHistory=[],this.rotationDifference=new v.Vector2,this.pointerDragStart=new v.Vector2(0,0),this.pinchDistance=0,this.moveStart=new v.Vector2,this.moveTolerance=.01,this.pointersLimit=2,this.pointers=[],this.euler=new v.Euler,this.el=new v.Euler,this.q0=new v.Quaternion,this.q1=new v.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),this.up=new v.Vector3(0,1,0),this.right=new v.Vector3(0,0,1),this.v=new v.Vector3,this.offsetLon=0,this.offsetLat=0,this.q3=new v.Quaternion,G.panoStill=!0,this.s_rotationSpeed=new v.Vector2,this.s_rotationDifference=new v.Vector3,this.s_lat=0,this.s_lon=0,this.handleOperation=this.handleOperation.bind(this),this.connect=At(),this.connect.on("operation",this.handleOperation);var i=this,n=!1;Object.defineProperty(this,"pointerDragOn",{get:function(){return n},set:function(t){n=t,i.connect.busy=t}}),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.onMouseWheel=this.onMouseWheel.bind(this)}function Rt(){G.conf.isCleanUI||(G.d.tourIsPlaying&&G.d.stopTour(),clearTimeout(St),St=null,Lt||(Lt=!0))}function Ot(){G.conf.isCleanUI}function Ft(t){var e;t&&(e=t)&&(e.preventDefault(),e.stopPropagation())}o("#player"),(kt.prototype=Object.create(Et.prototype)).bindEvents=function(t){t.addEventListener("mousemove",this.onMouseMove),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("mouseup",this.onMouseUp),t.addEventListener("mouseover",function(t){!this.pointerDragOn||0!==t.which&&0!==t.buttons||this.onMouseUp(t)}.bind(this)),t.addEventListener("touchstart",this.onTouchStart),t.addEventListener("touchmove",this.onTouchMove),t.addEventListener("touchend",this.onTouchEnd),t.addEventListener("contextmenu",function(t){t.preventDefault()}),t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointerup",this.onPointerUp),t.addEventListener("pointerout",this.onPointerUp),t.addEventListener("pointercancel",this.onPointerUp),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("keydown",this.onKeyDown),t.addEventListener("keyup",this.onKeyUp),z.useWheel&&(t.addEventListener("mousewheel",this.onMouseWheel),t.addEventListener("DOMMouseScroll",this.onMouseWheel))},kt.prototype.removeEvents=function(){this.container.removeEventListener("mousemove",this.onMouseMove),this.container.removeEventListener("mousedown",this.onMouseDown),this.container.removeEventListener("mouseup",this.onMouseUp),this.container.removeEventListener("touchstart",this.onTouchStart),this.container.removeEventListener("touchmove",this.onTouchMove),this.container.removeEventListener("touchend",this.onTouchEnd),this.container.removeEventListener("pointerdown",this.onPointerDown),this.container.removeEventListener("pointerup",this.onPointerUp),this.container.removeEventListener("pointerout",this.onPointerUp),this.container.removeEventListener("pointercancel",this.onPointerUp),this.container.removeEventListener("pointermove",this.onPointerMove),this.container.removeEventListener("keydown",this.onKeyDown),this.container.removeEventListener("keyup",this.onKeyUp),z.useWheel&&(this.container.removeEventListener("mousewheel",this.onMouseWheel),this.container.removeEventListener("DOMMouseScroll",this.onMouseWheel))},kt.prototype.usable=function(){return!G.ori.flag&&(z.quickstart.enabled?this.enabled:this.enabled&&!this.locked)},kt.prototype.lookAt=function(t){0==t.x&&-5==t.y&&0==t.z&&(t.z=-1);var e=this.camera.position.clone().sub(t),i=0;0==e.x&&0==e.y&&0==e.z&&(e.z=1),i=Math.atan(e.z/e.x),i+=e.x<0?Math.PI:0,i+=0<e.x&&e.z<0?2*Math.PI:0,this.lon=v.Math.radToDeg(i)+180;var n=Math.sqrt(e.x*e.x+e.z*e.z);i=0,i=Math.atan(e.y/n),this.lat=-v.Math.radToDeg(i)},kt.prototype.play=function(t){Dt&&(this.lon=t.lon,this.lat=t.lat)},kt.prototype.record=function(){!G.R.rtime||.15<G.R.time.getElapsedTime()-G.R.rtime?G.R.rtime=G.R.save({tap:"panorama",panoid:G.player.currentPano.id,action:"rotate",lon:parseFloat(this.lon.toFixed(5)),lat:parseFloat(this.lat.toFixed(5))}):G.R.last={tap:"panorama",panoid:G.player.currentPano.id,action:"rotate",lon:this.lon,lat:this.lat,time:G.R.time.getElapsedTime()}},kt.prototype.startRotationFrom=function(t,e){J.convertScreenPositionToNDC(this.container,t,e,this.pointer),this.pointerDragOn=!0,this.pointerDragStart.copy(this.pointer),this.moveStart.copy(this.pointer),this.rotationHistory=[],this.rotationSpeed.set(0,0),this.disableOri()},kt.prototype.disableOri=function(){G.ori.timeoutID&&clearTimeout(G.ori.timeoutID),G.ori.enable=!1},kt.prototype.onTouchStart=function(t){if(this.usable()){switch(Dt=!1,Rt(),Ft(t),t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:this.startRotationFrom(t.touches[0].clientX,t.touches[0].clientY);break;case 2:var e=(t.touches[0].clientX-t.touches[1].clientX)/this.container.clientWidth,i=(t.touches[0].clientY-t.touches[1].clientY)/this.container.clientHeight;this.pinchDistance=Math.sqrt(e*e+i*i)}this.emit(it.InputStart,"touch")}},kt.prototype.onPointerDown=function(t){this.usable()&&"touch"===t.pointerType&&(this.pointers.length<this.pointersLimit&&this.pointers.push({id:t.pointerId,clientX:t.clientX,clientY:t.clientY}),t.touches=this.pointers,this.onTouchStart(t),this.emit(it.InputStart,"pointer"))},kt.prototype.onMouseDown=function(t){if(this.usable()){switch(Dt=!1,Ft(),Rt(),t.preventDefault(),t.stopPropagation(),t.button){case 0:this.startRotationFrom(t.clientX,t.clientY)}this.emit(it.InputStart,"mouse")}},kt.prototype.updateRotation=function(){if(this.usable()&&this.pointerDragOn){this.camera.matrix.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.camera.matrixWorld.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);var t=new v.Vector3(this.pointerDragStart.x,this.pointerDragStart.y,-1).unproject(this.camera),e=new v.Vector3(this.pointer.x,this.pointer.y,-1).unproject(this.camera),i=Math.sqrt(t.x*t.x+t.z*t.z),n=Math.sqrt(e.x*e.x+e.z*e.z),o=Math.atan2(t.y,i),r=Math.atan2(e.y,n);this.rotationDifference.y=v.Math.radToDeg(o-r),t.y=0,e.y=0;var a=Math.acos(t.dot(e)/t.length()/e.length());isNaN(a)||(this.rotationDifference.x=v.Math.radToDeg(a),this.pointerDragStart.x<this.pointer.x&&(this.rotationDifference.x*=-1)),this.pointerDragStart.copy(this.pointer)}},kt.prototype.onMouseMove=function(t){this.usable()&&(J.convertScreenPositionToNDC(this.container,t.clientX,t.clientY,this.pointer),this.pointerDragOn&&(Math.abs(this.pointer.x-this.moveStart.x)>this.moveTolerance||Math.abs(this.pointer.y-this.moveStart.y)>this.moveTolerance)&&this.emit(it.Move,"mouse"))},kt.prototype.onTouchMove=function(t){if(this.usable()){switch(t.touches.length){case 1:J.convertScreenPositionToNDC(this.container,t.touches[0].clientX,t.touches[0].clientY,this.pointer),this.disableOri();break;case 2:var e=(t.touches[0].clientX-t.touches[1].clientX)/this.container.clientWidth,i=(t.touches[0].clientY-t.touches[1].clientY)/this.container.clientHeight,n=this.pinchDistance-Math.sqrt(e*e+i*i);.01<Math.abs(n)&&(this.emit(it.InteractionDirect),this.emit(it.Pinch,n),this.pinchDistance-=n)}this.emit(it.Move,"touch")}},kt.prototype.onPointerMove=function(t){this.usable()&&"touch"===t.pointerType&&(this.pointers.forEach(function(e){t.pointerId===e.id&&(e.clientX=t.clientX,e.clientY=t.clientY)}),t.touches=this.pointers,this.onTouchMove(t))},kt.prototype.endRotation=function(){this.pointerDragOn=!1;var t=k.averageVectors(this.rotationHistory);this.rotationSpeed.set(t.x*z.rotationAfterMoveMultiplier,t.y*z.rotationAfterMoveMultiplier)},kt.prototype.onTouchEnd=function(t){this.usable()&&(Ot(),Dt=!0,t.preventDefault(),t.stopPropagation(),this.endRotation())},kt.prototype.onMouseUp=function(t){this.usable()&&(Ot(),Dt=!0,t.preventDefault(),t.stopPropagation(),this.endRotation())},kt.prototype.onPointerUp=function(t){this.usable()&&"touch"===t.pointerType&&(this.pointers.forEach(function(e,i){t.pointerId===e.id&&this.pointers.splice(i,1)}.bind(this)),t.touches=this.pointers,this.onTouchEnd(t))},kt.prototype.update=function(t){if(null!=G.frameRate&&(G.frameRate<12?z.rotationFriction=.6:z.rotationFriction=.06),g.isMobile()&&(t=.016,0!=this.rotationSpeed.x&&Math.abs(this.rotationSpeed.x)<6&&(this.rotationSpeed.x=0),0!=this.rotationSpeed.y&&Math.abs(this.rotationSpeed.y)<6&&(this.rotationSpeed.y=0),0==this.rotationSpeed.x&&0==this.rotationSpeed.y?G.panoStill=!0:G.panoStill=!1),!G.R.playing)for(this.updateRotation(),this.rotationHistory.push(this.rotationDifference.clone());this.rotationHistory.length>z.rotationAfterMoveHistoryCount;)this.rotationHistory.shift();var e=this.lon,i=this.lat;if(G.ori.flag?(this.offsetLon+=this.rotationDifference.x,this.offsetLat+=this.rotationDifference.y,this.rotationSpeed.x=this.rotationSpeed.x*(1-z.rotationFriction)+this.rotationAcc.x*z.rotationAccelerationInside,this.rotationSpeed.y=this.rotationSpeed.y*(1-z.rotationFriction)+this.rotationAcc.y*z.rotationAccelerationInside,this.offsetLon+=this.rotationSpeed.x*t,this.offsetLat+=this.rotationSpeed.y*t,this.offsetLat=Math.max(z.insideLookLimitDown,Math.min(z.insideLookLimitUp,this.offsetLat)),G.ori.enable&&!G.playing&&(this.euler.set(G.ori.beta,G.ori.alpha,-G.ori.gamma,"YXZ"),this.q3=this.camera.quaternion.clone(),this.q3.setFromEuler(this.euler).multiply(this.q1),this.q3.multiply(this.q0.setFromAxisAngle(this.right,-G.ori.orient)),this.v.set(0,0,1).applyQuaternion(this.q3),this.lat=v.Math.radToDeg(this.v.angleTo(this.up)-Math.PI/2),this.v.set(1,0,0).applyQuaternion(this.q3),0<this.v.clone().cross(this.right).y?this.lon=v.Math.radToDeg(this.v.angleTo(this.right)):this.lon=360-v.Math.radToDeg(this.v.angleTo(this.right))),this.phi=v.Math.degToRad(90-(this.lat+this.offsetLat)),this.theta=v.Math.degToRad(this.lon+this.offsetLon),this.lookVector.x=Math.sin(this.phi)*Math.cos(this.theta),this.lookVector.y=Math.cos(this.phi),this.lookVector.z=Math.sin(this.phi)*Math.sin(this.theta),this.target.copy(this.lookVector).add(this.camera.position),this.camera.lookAt(this.target),G.ori.enable=!0):(t||(t=1/60),this.rotationSpeed.x=this.rotationSpeed.x*(1-z.rotationFriction)+this.rotationAcc.x*z.rotationAccelerationInside,this.rotationSpeed.y=this.rotationSpeed.y*(1-z.rotationFriction)+this.rotationAcc.y*z.rotationAccelerationInside,this.connect.remoteControl||this.connect.sync||(this.lon+=this.rotationDifference.x,this.lat+=this.rotationDifference.y,this.lon+=this.rotationSpeed.x*t,this.lat+=this.rotationSpeed.y*t,this.sendFrameData(t),this.rotationDifference.set(0,0)),this.lat=Math.max(z.insideLookLimitDown,Math.min(z.insideLookLimitUp,this.lat)),this.updateCamera(this.lon,this.lat)),this.rotationDifference.set(0,0),G.R.recording&&this.record(),J.compareFloats(e,this.lon)&&J.compareFloats(i,this.lat)||this.emit(it.RulersMove),"open"===o("#size-button").attr("openflag"))var n=this.lon,r=this.lat;o("#tag-button").children(".more-button-img").hasClass("active"),n=this.lon,r=this.lat,G.player.mattertagManager&&(!G.player.mattertagManager.ttflying&&J.compareFloats(e,n)&&J.compareFloats(i,r)||this.emit(it.TtagsMove))},kt.prototype.sendFrameData=(It=0,Pt=new v.Vector2,Ct=new v.Vector2,function(t){(It+=t)<.2||(It=0,Math.abs(Tt-this.lon)<.001&&Math.abs(Mt-this.lat)<.001||(this.connect.sendOperation({type:"pano",lon:this.lon,lat:this.lat,time:Date.now(),rotationDifference:this.rotationDifference.toArray(),rotationSpeed:this.rotationSpeed.toArray()}),Tt=this.lon,Mt=this.lat,Pt.copy(this.rotationSpeed),Ct.copy(this.rotationDifference)))}),kt.prototype.updateCamera=function(t,e){this.phi=v.Math.degToRad(90-e),this.theta=v.Math.degToRad(t),this.lookVector.x=Math.sin(this.phi)*Math.cos(this.theta),this.lookVector.y=Math.cos(this.phi),this.lookVector.z=Math.sin(this.phi)*Math.sin(this.theta),this.target.copy(this.lookVector).add(this.camera.position),this.camera.lookAt(this.target)},kt.prototype._progressNumber=function(t,e,i){return t+(e-t)*i},kt.prototype._progressRad=function(t,e,i){var n=2*Math.PI,o=Math.PI,r=function(t){return(t%n+n)%n};return t=r(t),o<(e=r(e))-t?this._progressNumber(t+n,e,i):o<t-e?this._progressNumber(t-n,e,i):this._progressNumber(t,e,i)},kt.prototype.handleOperation=function(t){var e=this;if("pano"===t.type){var i=t.lon,n=t.lat;Date.now(),t.time,this.s_lon=i,this.s_lat=n,this.lonTweenProcess=null,this.latTweenProcess=null,this.tweenProgress&&(this.tweenProgress.stop(),this.tweenProgress=null);var o=this.lon,r=this.lat;z.connectDelay,this.tweenProgress=new TWEEN.Tween({progress:0}).to({progress:1},z.animationDelay).easing(TWEEN.Easing.Linear.None).start(),this.tweenProgress.onUpdate(function(t){null===i&&0===i||(e.lon=e._progressNumber(o,i,t.progress)),null===n&&0===i||(e.lat=e._progressNumber(r,n,t.progress))}),this.tweenProgress.onComplete(function(){this.tweenProgress=null}),this.s_time=t.time,this.s_rotationDifference.fromArray(t.rotationDifference),this.s_rotationSpeed.fromArray(t.rotationSpeed),this.rotationSpeed.copy(this.s_rotationSpeed)}},kt.prototype.onMouseWheel=function(t){if(this.usable()&&!G.R.playing){var e=t.wheelDelta||-t.detail;this.emit(it.InteractionDirect),this.emit(it.Scroll,e)}},kt.prototype.onKeyDown=function(t){this.usable()&&(t.metaKey||t.ctrlKey||(t.preventDefault(),this.handleKeyDown(t.which)))},kt.prototype.handleKeyDown=function(t){var e=function(t){this.flyDirection(t)}.bind(this),i=function(t,e){this.rotationAcc[t]=e}.bind(this);this.emit(it.InteractionKey);var n=!0;switch(t){case et.UPARROW:case et.W:e(tt.FORWARD);break;case et.DOWNARROW:case et.S:e(tt.BACK);break;case et.A:e(tt.LEFT);break;case et.D:e(tt.RIGHT);break;case et.LEFTARROW:case et.J:i("x",-1);break;case et.RIGHTARROW:case et.L:i("x",1);break;case et.I:i("y",1);break;case et.K:i("y",-1);break;default:n=!1}n&&this.emit(it.Move,"key")},kt.prototype.onKeyUp=function(t){this.usable()&&(t.preventDefault(),t.stopPropagation(),this.handleKeyUp(t.which))},kt.prototype.handleKeyUp=function(t){switch(t){case et.LEFTARROW:case et.J:case et.RIGHTARROW:case et.L:this.rotationAcc.x=0;break;case et.I:case et.K:this.rotationAcc.y=0}},kt.prototype.reset=function(){this.pointerDragOn=!1,this.rotationAcc.set(0,0),this.rotationSpeed.set(0,0),this.pointers=[]},kt.prototype.flyDirection=function(t){this.emit(it.FlyInDirection,t.clone())},kt.prototype.copy=function(t){this.target.copy(t.target),this.lookVector.copy(t.lookVector),this.lookSpeed=t.lookSpeed,this.rotationAcc.copy(t.rotationAcc),this.rotationSpeed.copy(t.rotationSpeed),this.lat=t.lat,this.lon=t.lon,this.phi=t.phi,this.theta=t.theta,this.enabled=t.enabled,this.locked=t.locked,this.pointer.copy(t.pointer),this.rotationHistory=t.rotationHistory.slice(),this.rotationDifference.copy(t.rotationDifference),this.pointerDragOn=t.pointerDragOn,this.pointerDragStart.copy(t.pointerDragStart),this.pinchDistance=t.pinchDistance,this.moveStart.copy(t.moveStart),this.moveTolerance=t.moveTolerance,this.pointersLimit=t.pointersLimit,this.pointers=t.pointers.slice()},kt.prototype.toJSON=function(){return{_viewpoint:{x:J.toPrecision(this.camera.position.x,4),y:J.toPrecision(this.camera.position.y,4),z:J.toPrecision(this.camera.position.z,4)},_rotation:{x:J.toPrecision(this.camera.quaternion.x,4),y:J.toPrecision(this.camera.quaternion.y,4),z:J.toPrecision(this.camera.quaternion.z,4),w:J.toPrecision(this.camera.quaternion.w,4)}}},kt.prototype.setStateFromJSON=function(t){this.camera.position.copy(t._viewpoint),this.camera.quaternion.copy(t._rotation)};var Nt,Ut,Bt,zt,Vt,Gt,jt=kt,Ht=ot.EventEmitter,Wt=(o("#player"),{NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY_PAN:4});function qt(t,e){this.camera=t,(this.camera.controls=this).container=e,this.enabled=!1,this.target=new v.Vector3,this.targetBounds=new v.Box3,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.noRotate=!1,this.noRotateUpDown=!1,this.rotateSpeed=1,this.keyboardZoomSpeed=0,this.noPan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=v.Math.degToRad(25),this.maxPolarAngle=v.Math.degToRad(65),this.noKeys=!1,this.rotationAcceleration=new v.Vector2,this.rotationSpeed=new v.Vector2,this.panAcceleration=new v.Vector2,this.panSpeed=new v.Vector2,this.rotateStart=new v.Vector2,this.rotateEnd=new v.Vector2,this.rotateDelta=new v.Vector2,this.panStart=new v.Vector2,this.panEnd=new v.Vector2,this.panDelta=new v.Vector2,this.panOffset=new v.Vector3,this.offset=new v.Vector3,this.dollyStart=new v.Vector2,this.dollyEnd=new v.Vector2,this.dollyDelta=new v.Vector2,this.phiDelta=0,this.thetaDelta=0,this.scale=1,this.panVector=new v.Vector3,this.lastPosition=new v.Vector3,this.state=Wt.NONE,this.lastMoveTime=0,this.pointersLimit=2,this.pointers=[],this.lon=0,this.lat=0,this.on("touch-one-finger-start",qt.touch.rotate.start),this.on("touch-one-finger-move",qt.touch.rotate.move),this.on("touch-two-finger-start",qt.touch.pan.start),this.on("touch-two-finger-start",qt.touch.zoom.start),this.on("touch-two-finger-move",qt.touch.zoom.move),this.sendData=!1,this.responseMessage=this.responseMessage.bind(this),this.connect=At(),this.connect.on("operation",this.responseMessage);var i=!0,n=this;Object.defineProperty(this,"touchup",{get:function(){return i},set:function(t){i=t,n.connect.busy=!t}}),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.onMouseWheel=this.onMouseWheel.bind(this)}(qt.prototype=Object.create(Ht.prototype)).setBounds=function(t){this.targetBounds=t},qt.prototype.bindEvents=function(t){(t=t||document).addEventListener("contextmenu",function(t){t.preventDefault()}),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("mousemove",this.onMouseMove),t.addEventListener("mouseup",this.onMouseUp),t.addEventListener("mouseover",function(t){0!==t.which&&0!==t.buttons||this.onMouseUp(t)}.bind(this)),z.useWheel&&(t.addEventListener("mousewheel",this.onMouseWheel),t.addEventListener("DOMMouseScroll",this.onMouseWheel)),t.addEventListener("touchstart",this.onTouchStart),t.addEventListener("touchend",this.onTouchEnd),t.addEventListener("touchmove",this.onTouchMove),t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointerup",this.onPointerUp),t.addEventListener("pointerout",this.onPointerUp),t.addEventListener("pointercancel",this.onPointerUp),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("keydown",this.onKeyDown),t.addEventListener("keyup",this.onKeyUp)},qt.prototype.removeEvents=function(){this.container.removeEventListener("mousedown",this.onMouseDown),this.container.removeEventListener("mousemove",this.onMouseMove),this.container.removeEventListener("mouseup",this.onMouseUp),this.container.removeEventListener("touchstart",this.onTouchStart),this.container.removeEventListener("touchend",this.onTouchEnd),this.container.removeEventListener("touchmove",this.onTouchMove),this.container.removeEventListener("pointerdown",this.onPointerDown),this.container.removeEventListener("pointerup",this.onPointerUp),this.container.removeEventListener("pointerout",this.onPointerUp),this.container.removeEventListener("pointercancel",this.onPointerUp),this.container.removeEventListener("pointermove",this.onPointerMove),this.container.removeEventListener("keydown",this.onKeyDown),this.container.removeEventListener("keyup",this.onKeyUp),z.useWheel&&(this.container.removeEventListener("mousewheel",this.onMouseWheel),this.container.removeEventListener("DOMMouseScroll",this.onMouseWheel))},qt.prototype.isEngaged=function(){return this.state!==Wt.NONE},qt.prototype.rotateLeft=function(t){void 0===t&&(t=this.getAutoRotationAngle()),this.thetaDelta-=t},qt.prototype.rotateUp=function(t){this.noRotateUpDown||(void 0===t&&(t=this.getAutoRotationAngle()),this.phiDelta-=t)},qt.prototype.panLeft=function(t){var e=this.camera.matrix.elements;0==e[0]&&0==e[2]?this.panOffset.set(e[0],0,e[2]):this.panOffset.set(e[0],0,e[2]).normalize(),this.panOffset.multiplyScalar(-t),this.panVector.add(this.panOffset)},qt.prototype.panUp=function(t){var e=this.camera.matrix.elements;0==e[4]&&0==e[6]?this.panOffset.set(e[4],0,e[6]):this.panOffset.set(e[4],0,e[6]).normalize(),this.panOffset.multiplyScalar(-t),this.panVector.add(this.panOffset)},qt.prototype.dollyIn=function(t){void 0===t&&(t=this.getZoomScale()),G.R.recording&&G.R.save({tap:"zoom",type:"dollhouse",level:1/t}),this.scale/=t},qt.prototype.dollyOut=function(t){void 0===t&&(t=this.getZoomScale()),G.R.recording&&G.R.save({tap:"zoom",type:"dollhouse",level:t}),this.scale*=t},qt.prototype.lookAt=function(t,e,i){this.camera.position.copy(t),this.camera.quaternion.copy(i),this.target.copy(e),this.offset.copy(t).sub(e),this.lon=Math.atan2(this.offset.x,this.offset.z),this.lat=Math.atan2(Math.sqrt(this.offset.x*this.offset.x+this.offset.z*this.offset.z),this.offset.y),this.cameraLength=this.offset.length()},qt.prototype.update=function(t){var e,i,n,o;if(!G.measurestarted){if(e=this.camera.position,this.updateFromRecord)return this.updateFromRecord=!1,void this.updateCamera(this.lon,this.lat);this.updateFromRecord=!1,t||(t=1/60),this.rotationSpeed.multiplyScalar(1-z.rotationFriction).addScaledVector(this.rotationAcceleration,z.rotationAccelerationOutside*t),this.rotateLeft(-this.rotationSpeed.x),this.noRotateUpDown||this.rotateUp(this.rotationSpeed.y),this.panSpeed.multiplyScalar(1-z.panFriction).addScaledVector(this.panAcceleration,z.panAccelerationOutside*t),this.pan(-this.panSpeed.x,this.panSpeed.y),this.offset.copy(e).sub(this.target),i=Math.atan2(this.offset.x,this.offset.z),n=Math.atan2(Math.sqrt(this.offset.x*this.offset.x+this.offset.z*this.offset.z),this.offset.y),this.autoRotate&&this.rotateLeft(this.getAutoRotationAngle()),o=this.offset.length(),i+=this.thetaDelta,n+=this.phiDelta,i<0&&(i+=2*Math.PI),(this.connect.remoteControl||this.connect.sync)&&"floorplan"!==this.type||(this.lon=i,this.lat=n,this.cameraLength=o),G.R&&G.R.recording&&this.record(i),this.updateCamera(this.lon,this.lat),this.connect.remoteControl||this.connect.sync||this.sendFrameData(t),this.thetaDelta=0,this.phiDelta=0,this.scale=1,this.panVector.set(0,0,0),0<this.lastPosition.distanceTo(this.camera.position)&&this.lastPosition.copy(this.camera.position)}},qt.prototype.updateCamera=(Ut=new v.Vector3,function(t,e){"floorplan"===this.type&&(e=t=0),Nt=this.updateZoom(),Nt=Math.max(this.minDistance,Math.min(this.maxDistance,Nt)),isNaN(t)||isNaN(e)||(e=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,e)),e=Math.max(1e-6,Math.min(Math.PI-1e-6,e)),Ut.x=Nt*Math.sin(e)*Math.sin(t),Ut.y=Nt*Math.cos(e),Ut.z=Nt*Math.sin(e)*Math.cos(t)),this.camera.position.copy(this.target).add(Ut),this.camera.lookAt(this.target)}),qt.prototype.sendFrameData=(Gt=0,function(t){"dollhouse"===G.player.mode&&((Gt+=t)<.2||Math.abs(Bt-this.lon)<.001&&Math.abs(zt-this.lat)<.001&&Math.abs(Vt-this.cameraLength)<.001||(Gt=0,this.connect.sendOperation({type:"outside",lon:this.lon,lat:this.lat,cameraLength:this.cameraLength}),Bt=this.lon,zt=this.lat,Vt=this.cameraLength))}),qt.prototype._progressNumber=function(t,e,i){return t+(e-t)*i},qt.prototype._progressRad=function(t,e,i){var n=2*Math.PI,o=Math.PI,r=function(t){return(t%n+n)%n};return t=r(t),o<(e=r(e))-t?this._progressNumber(t+n,e,i):o<t-e?this._progressNumber(t-n,e,i):this._progressNumber(t,e,i)},qt.prototype.responseMessage=function(t){var e=this;if("outside"===t.type){var i=t.lon,n=t.lat,o=t.cameraLength;this.tweenProgress&&(this.tweenProgress.stop(),this.tweenProgress=null);var r=this.lon,a=this.lat,s=this.cameraLength;this.tweenProgress=new TWEEN.Tween({progress:0}).to({progress:1},z.animationDelay).easing(TWEEN.Easing.Linear.None).start(),this.tweenProgress.onUpdate(function(t){null===i&&0===i||(e.lon=e._progressRad(r,i,t.progress)),null===n&&0===i||(e.lat=e._progressNumber(a,n,t.progress)),e.cameraLength=e._progressNumber(s,o,t.progress)}),this.tweenProgress.onComplete(function(){this.tweenProgress=null})}},qt.prototype.getAutoRotationAngle=function(t,e){return{lon:t,lat:e}},qt.prototype.getAutoRotationAngle=function(){return 2*Math.PI/60/60*this.autoRotateSpeed},qt.prototype.getZoomScale=function(){return Math.pow(.95,this.zoomSpeed)},qt.prototype.onMouseDown=function(t){if(this.enabled){switch(this.touchup=!1,t.preventDefault(),this.mouseDown=!0,t.button){case 0:if(this.noRotate)return;this.state=Wt.ROTATE,this.rotateStart.set(t.clientX,this.noRotateUpDown?0:t.clientY),this.rotationSpeed.set(0,0);break;case 1:if(this.noZoom)return;this.state=Wt.DOLLY,this.dollyStart.set(t.clientX,t.clientY);break;case 2:if(this.noPan)return;this.state=Wt.PAN,this.panStart.set(t.clientX,t.clientY)}this.emit(it.InputStart,"mouse")}},qt.prototype.play=function(t){this.touchup&&(this.lon=t.lon,this.lat=t.lat,this.updateFromRecord=!0)},qt.prototype.record=function(t){G.player.flying||G.R.rtime&&!(.15<G.R.time.getElapsedTime()-G.R.rtime)||("dollhouse"===G.player.mode?(void 0!==G.R.lastlon&&3<Math.abs(this.lon-G.R.lastlon)&&(this.lon<G.R.lastlon?G.R.lon+=2*Math.PI:G.R.lon-=2*Math.PI),G.R.rtime=G.R.save({tap:"dollhouse",lon:parseFloat((this.lon+G.R.lon).toFixed(5)),lat:parseFloat(this.lat.toFixed(5)),action:"rotate"}),G.R.lastlon=this.lon):"floorplan"===G.player.mode&&(G.R.rtime=G.R.save({tap:"floorplan",lon:parseFloat(this.lon.toFixed(5)),lat:parseFloat(this.lat.toFixed(5)),action:"rotate"})))},qt.prototype.onMouseMove=function(t){if(this.enabled&&this.mouseDown&&0!==t.buttons){if(t.preventDefault(),z.delBK&&"floorplan"===G.player.mode)return!1;var e=t.currentTarget;switch(this.state){case Wt.ROTATE:if(this.noRotate)return;this.rotateEnd.set(t.clientX,this.noRotateUpDown?0:t.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateLeft(2*Math.PI*this.rotateDelta.x/e.clientWidth*this.rotateSpeed),this.rotateUp(2*Math.PI*this.rotateDelta.y/e.clientHeight*this.rotateSpeed),this.rotateStart.copy(this.rotateEnd);break;case Wt.DOLLY:if(this.noZoom)return;this.dollyEnd.set(t.clientX,t.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),(0<this.dollyDelta.y?this.dollyIn:this.dollyOut).call(this),this.dollyStart.copy(this.dollyEnd);break;case Wt.PAN:if(this.noPan)return;this.panEnd.set(t.clientX,t.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}this.emit(it.Move,"mouse"),this.lastMoveTime=t.timeStamp,this.update()}},qt.prototype.onMouseUp=function(t){if(!this.enabled)return!1;this.mouseDown=!1,this.touchup=!0,this.state=Wt.NONE,"mouseover"!==t.type&&(t.timeStamp>this.lastMoveTime+100?(this.rotationSpeed.set(0,0),this.rotationAcceleration.set(0,0)):this.rotationAcceleration.set(-this.rotateDelta.x,this.rotateDelta.y),this.update(),this.rotationAcceleration.set(0,0),this.rotateDelta.set(0,0))},qt.prototype.onMouseWheel=function(t){this.enabled&&!this.noZoom&&z.useWheel&&!G.R.playing&&(z.delBK&&"floorplan"===G.player.mode||(this.emit(it.Move,"wheel"),(0<(t.wheelDelta||-t.detail)?this.dollyOut:this.dollyIn).call(this),this.update()))},qt.prototype.onKeyDown=function(t){"floorplan"!==G.player.mode&&(!this.enabled||this.noKeys||t.metaKey||t.ctrlKey||(t.preventDefault(),this.handleKeyDown(t.which)))},qt.prototype.handleKeyDown=function(t){var e=function(t,e){"y"===t?this.noRotateUpDown?this.keyboardZoomSpeed=e:this.rotationAcceleration.y=e:this.rotationAcceleration.x=e}.bind(this),i=function(t,e){this.panAcceleration[t]=e}.bind(this),n=!0;switch(t){case et.UPARROW:case et.I:e("y",1);break;case et.DOWNARROW:case et.K:e("y",-1);break;case et.LEFTARROW:case et.J:e("x",-1);break;case et.RIGHTARROW:case et.L:e("x",1);break;case et.W:i("y",1);break;case et.S:i("y",-1);break;case et.A:i("x",-1);break;case et.D:i("x",1);break;default:n=!1}n&&this.emit(it.Move,"key")},qt.prototype.onKeyUp=function(t){!this.enabled||this.noKeys||(t.preventDefault(),t.stopPropagation(),this.handleKeyUp(t.which))},qt.prototype.handleKeyUp=function(t){switch(t){case et.I:case et.K:case et.UPARROW:case et.DOWNARROW:this.keyboardZoomSpeed=0,this.rotationAcceleration.y=0;break;case et.J:case et.L:case et.LEFTARROW:case et.RIGHTARROW:this.rotationAcceleration.x=0;break;case et.S:case et.W:this.panAcceleration.y=0;break;case et.A:case et.D:this.panAcceleration.x=0}},qt.prototype.onTouchStart=function(t){if(this.enabled){switch(this.touchup=!1,t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:this.emit("touch-one-finger-start",t);break;case 2:this.emit("touch-two-finger-start",t);break;default:this.state=Wt.NONE}this.rotationSpeed.set(0,0),this.emit(it.InputStart,"touch")}},qt.prototype.onTouchMove=function(t){if(this.enabled){if(z.delBK&&"floorplan"===G.player.mode)return!1;switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:this.emit("touch-one-finger-move",t),this.update();break;case 2:this.emit("touch-two-finger-move",t),this.update();break;default:this.state=Wt.NONE}this.lastMoveTime=t.timeStamp}},qt.prototype.onTouchEnd=function(t){this.enabled&&(this.emit("touch-one-finger-end",t),this.touchup=!0,this.emit("touch-two-finger-end",t),this.state=Wt.NONE,t.timeStamp>this.lastMoveTime+100?(this.rotationSpeed.set(0,0),this.rotationAcceleration.set(0,0)):this.rotationAcceleration.set(-this.rotateDelta.x,this.rotateDelta.y),this.update(),this.rotationAcceleration.set(0,0),this.rotateDelta.set(0,0))},qt.prototype._progressNumber=function(t,e,i){return t+(e-t)*i},qt.prototype._progressRad=function(t,e,i){var n=2*Math.PI,o=Math.PI,r=function(t){return(t%n+n)%n};return t=r(t),o<(e=r(e))-t?this._progressNumber(t+n,e,i):o<t-e?this._progressNumber(t-n,e,i):this._progressNumber(t,e,i)},qt.prototype.translateWithAnimation=function(t,e,i){var n=this;this.tweenProgress&&(this.tweenProgress.stop(),this.tweenProgress=null);var o=this.lon,r=this.lat;this.tweenProgress=new TWEEN.Tween({progress:0}).to({progress:1},i).easing(TWEEN.Easing.Linear.None).start(),this.tweenProgress.onUpdate(function(){null!==t&&0!==t&&(n.lon=n._progressRad(o,t,this.progress)),null!==e&&0!==e&&(n.lat=n._progressNumber(r,e,this.progress))}),this.tweenProgress.onComplete(function(){this.tweenProgress=null})},qt.prototype.onPointerDown=function(t){this.enabled&&("touch"===t.pointerType&&(this.pointers.length<this.pointersLimit&&this.pointers.push({id:t.pointerId,pageX:t.pageX,pageY:t.pageY}),t.touches=this.pointers,this.onTouchStart(t)),this.emit(it.InputStart,"pointer"))},qt.prototype.onPointerMove=function(t){this.enabled&&"touch"===t.pointerType&&(this.pointers.forEach(function(e){t.pointerId===e.id&&(e.pageX=t.pageX,e.pageY=t.pageY)}),t.touches=this.pointers,this.onTouchMove(t))},qt.prototype.onPointerUp=function(t){this.enabled&&"touch"===t.pointerType&&(this.pointers.forEach(function(e,i){t.pointerId===e.id&&this.pointers.splice(i,1)}.bind(this)),t.touches=this.pointers,this.onTouchEnd(t))},qt.prototype.reset=function(){this.state=Wt.NONE,this.rotationSpeed.set(0,0),this.rotationAcceleration.set(0,0),this.panSpeed.set(0,0),this.panAcceleration.set(0,0)},qt.prototype.toJSON=function(){return{_viewpoint:{x:J.toPrecision(this.camera.position.x,4),y:J.toPrecision(this.camera.position.y,4),z:J.toPrecision(this.camera.position.z,4)},_rotation:{x:J.toPrecision(this.camera.quaternion.x,4),y:J.toPrecision(this.camera.quaternion.y,4),z:J.toPrecision(this.camera.quaternion.z,4),w:J.toPrecision(this.camera.quaternion.w,4)}}},qt.touch={rotate:{start:function(t){this.state=Wt.TOUCH_ROTATE,this.rotateStart.set(t.touches[0].pageX,t.touches[0].pageY)},move:function(t){if(this.state===Wt.TOUCH_ROTATE){this.emit(it.Move,"touch");var e=t.currentTarget;this.rotateEnd.set(t.touches[0].pageX,t.touches[0].pageY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateLeft(2*Math.PI*this.rotateDelta.x/e.clientWidth*this.rotateSpeed),this.rotateUp(2*Math.PI*this.rotateDelta.y/e.clientHeight*this.rotateSpeed),this.rotateStart.copy(this.rotateEnd)}}},zoom:{start:function(t){this.state=Wt.TOUCH_DOLLY_PAN;var e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(e*e+i*i);this.dollyStart.set(0,n)},move:function(t){if(this.state===Wt.TOUCH_DOLLY_PAN){this.emit(it.Move,"touch");var e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(e*e+i*i);this.dollyEnd.set(0,n),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),0<this.dollyDelta.y?this.dollyOut(1-this.dollyDelta.y/500):this.dollyIn(1+this.dollyDelta.y/500),this.dollyStart.copy(this.dollyEnd)}}},pan:{start:function(t){this.state=Wt.TOUCH_DOLLY_PAN,this.panStart.set(k.average(t.touches,"pageX"),k.average(t.touches,"pageY"))},move:function(t){this.state===Wt.TOUCH_DOLLY_PAN&&(this.emit(it.Move,"touch"),this.panEnd.set(k.average(t.touches,"pageX"),k.average(t.touches,"pageY")),this.panDelta.subVectors(this.panEnd,this.panStart),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd),this.rotateDelta.set(0,0))}}};var $t=qt;function Yt(t,e){$t.call(this,t,e),this.minPolarAngle=z.dollhouseDefault.minPolarAngle,this.maxPolarAngle=z.dollhouseDefault.maxPolarAngle,this.minDistance=z.dollhouseDefault.minDistance,this.maxDistance=z.dollhouseDefault.maxDistance,this.adjustedMinDistance=this.minDistance,this.adjustedMaxDistance=this.maxDistance}(Yt.prototype=Object.create($t.prototype)).pan=function(t,e){this.camera.updateMatrix();var i=this.camera.position.clone().sub(this.target).length();i*=Math.tan(this.camera.fov/2*Math.PI/180),this.panLeft(2*t*i/this.container.clientHeight),this.panUp(-2*e*i/this.container.clientHeight)},Yt.prototype.updateZoom=function(){return this.cameraLength*=this.scale,this.cameraLength},Yt.prototype.setZoomBounds=function(t){var e=t.min.distanceTo(t.max);this.adjustedMinDistance=Math.max(Math.min(e/2,z.dollhouseDefault.minDistance),0),this.adjustedMaxDistance=Math.min(Math.max(e,z.dollhouseDefault.maxDistance),z.skyboxRadius),this.minDistance=this.adjustedMinDistance,this.maxDistance=this.adjustedMaxDistance},Yt.prototype.resetRanges=function(t,e){this.maxDistance=t?(this.minDistance=Math.min(t,this.minDistance),Math.max(t,this.maxDistance)):(this.minDistance=this.adjustedMinDistance,this.adjustedMaxDistance),this.maxPolarAngle=e?(this.minPolarAngle=v.Math.degToRad(10),v.Math.degToRad(65)):(this.minPolarAngle=z.dollhouseDefault.minPolarAngle,z.dollhouseDefault.maxPolarAngle)},Yt.prototype.toJSON=function(){return $t.prototype.toJSON.call(this)};var Xt,Qt,Zt,Kt=Yt;function Jt(t,e){$t.call(this,t,e),this.minDistance=20,this.maxDistance=50,this.noRotateUpDown=!0,this.minPolarAngle=0,this.maxPolarAngle=0,this.absoluteScale=1,this.currentScale=1,this.zoomEdgeScale=1.4}(Jt.prototype=Object.create($t.prototype)).zoomToContain=function(t){if(z.delBK){var e=Math.max(t.x,t.z,t.x*this.camera.aspect,t.z*this.camera.aspect);this.absoluteScale=e/2/z.orthoBase*this.zoomEdgeScale,this.currentScale=this.absoluteScale}else{var i=Math.max(t.x,t.z),n=Math.min(t.x,t.z),o=Math.max(i,n*this.camera.aspect),r=Math.max(n,i*this.camera.aspect);this.absoluteScale=(g.aspectRatio(this.container)<1?r:o)/2/z.orthoBase*1.2,this.currentScale=this.absoluteScale}},Jt.prototype.rotateToView=function(t,e){if(z.delBK){var i=0;this.rotateLeft(i),this.update(0)}else i=0,g.aspectRatio(this.container)<1==t.x<t.z?0<e.z&&(i=Math.PI):i=0<e.x?Math.PI/2:-Math.PI/2,this.rotateLeft(i)},Jt.prototype.pan=function(t,e){this.camera.updateMatrix(),this.panLeft(t*(this.camera.right-this.camera.left)/this.container.clientWidth),this.panUp(-e*(this.camera.top-this.camera.bottom)/this.container.clientHeight)},Jt.prototype.updateZoom=function(){return g.isMobile()?document.documentElement.clientWidth<document.documentElement.clientHeight?(this.absoluteScale*=this.scale-.03*this.keyboardZoomSpeed,this.absoluteScale=Math.max(z.zoomNearLimit,Math.min(this.absoluteScale,z.zoomFarLimit)),this.currentScale=.8*this.currentScale+.2*this.absoluteScale,this.camera.left=-z.orthoBase*this.currentScale,this.camera.right=z.orthoBase*this.currentScale,this.camera.top=z.orthoBase*this.currentScale/this.camera.aspect,this.camera.bottom=-z.orthoBase*this.currentScale/this.camera.aspect):(this.absoluteScale*=this.scale-.03*this.keyboardZoomSpeed,this.absoluteScale=Math.max(z.zoomNearLimit,Math.min(this.absoluteScale,z.zoomFarLimit)),this.currentScale=.8*this.currentScale+.2*this.absoluteScale,this.camera.left=-z.orthoBase*this.currentScale*2,this.camera.right=z.orthoBase*this.currentScale*2,this.camera.top=z.orthoBase*this.currentScale/this.camera.aspect*2,this.camera.bottom=-z.orthoBase*this.currentScale/this.camera.aspect*2):(this.absoluteScale*=this.scale-.03*this.keyboardZoomSpeed,this.absoluteScale=Math.max(z.zoomNearLimit,Math.min(this.absoluteScale,z.zoomFarLimit)),this.currentScale=.8*this.currentScale+.2*this.absoluteScale,this.camera.left=-z.orthoBase*this.currentScale*1.25,this.camera.right=z.orthoBase*this.currentScale*1.25,this.camera.top=z.orthoBase*this.currentScale/this.camera.aspect*1.25,this.camera.bottom=-z.orthoBase*this.currentScale/this.camera.aspect*1.25),this.camera.updateProjectionMatrix(),this.offset.length()},Jt.prototype.toJSON=(Xt=new v.Quaternion,Qt=(new v.Quaternion).setFromAxisAngle(new v.Vector3(0,1,0),v.Math.degToRad(90)),Zt=new v.Quaternion,function(){var t=$t.prototype.toJSON.call(this);return Xt.copy(t._rotation),Zt.copy(Qt),Zt.multiply(Xt),t._rotation.x=J.toPrecision(Zt.x,4),t._rotation.y=J.toPrecision(Zt.y,4),t._rotation.z=J.toPrecision(Zt.z,4),t._rotation.w=J.toPrecision(Zt.w,4),t._zoom=J.toPrecision(this.currentScale*this.camera.aspect,4),t});var te=Jt,ee=1,ie=2,ne={GL_TEXTURE_CUBE_MAP_POSITIVE_X:0,GL_TEXTURE_CUBE_MAP_NEGATIVE_X:1,GL_TEXTURE_CUBE_MAP_POSITIVE_Y:2,GL_TEXTURE_CUBE_MAP_NEGATIVE_Y:3,GL_TEXTURE_CUBE_MAP_POSITIVE_Z:4,GL_TEXTURE_CUBE_MAP_NEGATIVE_Z:5};function oe(t){return se[t]}var re,ae=[0,1,2,3,4,5],se={0:ne.GL_TEXTURE_CUBE_MAP_POSITIVE_Y,1:ne.GL_TEXTURE_CUBE_MAP_POSITIVE_Z,2:ne.GL_TEXTURE_CUBE_MAP_POSITIVE_X,3:ne.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z,4:ne.GL_TEXTURE_CUBE_MAP_NEGATIVE_X,5:ne.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y},le={mapFaceToCubemapFace:oe,getCubemapUrls:function(t,e,i){return ae.map(function(t,n){return G.url.model+"/locations/pc/"+i+"/"+e+"_"+oe(t)+".jpg"}.bind(this))}},ce="panorama.load.complete",ue="panorama.load.failed",he="panorama.tile.loaded",de="panorama.render.complete",pe="panorama.tile.render.success",fe="panorama.upload.attempted.all.tiles",me=d(function(t){var e,i,n={};n.RADIANS_PER_DEGREE=Math.PI/180,n.DEGREES_PER_RADIAN=180/Math.PI,n.Vector3=function(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0},n.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length},n.Matrix4.prototype={identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(t){return this.elements.set(t.elements),this},applyToVector3:function(t){var e=t.x,i=t.y,n=t.z,o=this.elements;return t.x=o[0]*e+o[4]*i+o[8]*n+o[12],t.y=o[1]*e+o[5]*i+o[9]*n+o[13],t.z=o[2]*e+o[6]*i+o[10]*n+o[14],this},getInverse:function(t,e){var i=this.elements,n=t.elements,o=n[0],r=n[1],a=n[2],s=n[3],l=n[4],c=n[5],u=n[6],h=n[7],d=n[8],p=n[9],f=n[10],m=n[11],g=n[12],v=n[13],y=n[14],b=n[15],w=p*y*h-v*f*h+v*u*m-c*y*m-p*u*b+c*f*b,x=g*f*h-d*y*h-g*u*m+l*y*m+d*u*b-l*f*b,_=d*v*h-g*p*h+g*c*m-l*v*m-d*c*b+l*p*b,S=g*p*u-d*v*u-g*c*f+l*v*f+d*c*y-l*p*y,T=o*w+r*x+a*_+s*S;if(0===T){var M="MathLight.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(e)throw new Error(M);return this.identity()}var I=1/T;return i[0]=w*I,i[1]=(v*f*s-p*y*s-v*a*m+r*y*m+p*a*b-r*f*b)*I,i[2]=(c*y*s-v*u*s+v*a*h-r*y*h-c*a*b+r*u*b)*I,i[3]=(p*u*s-c*f*s-p*a*h+r*f*h+c*a*m-r*u*m)*I,i[4]=x*I,i[5]=(d*y*s-g*f*s+g*a*m-o*y*m-d*a*b+o*f*b)*I,i[6]=(g*u*s-l*y*s-g*a*h+o*y*h+l*a*b-o*u*b)*I,i[7]=(l*f*s-d*u*s+d*a*h-o*f*h-l*a*m+o*u*m)*I,i[8]=_*I,i[9]=(g*p*s-d*v*s-g*r*m+o*v*m+d*r*b-o*p*b)*I,i[10]=(l*v*s-g*c*s+g*r*h-o*v*h-l*r*b+o*c*b)*I,i[11]=(d*c*s-l*p*s-d*r*h+o*p*h+l*r*m-o*c*m)*I,i[12]=S*I,i[13]=(d*v*a-g*p*a+g*r*f-o*v*f-d*r*y+o*p*y)*I,i[14]=(g*c*a-l*v*a-g*r*u+o*v*u+l*r*y-o*c*y)*I,i[15]=(l*p*a-d*c*a+d*r*u-o*p*u-l*r*f+o*c*f)*I,this},makeRotationFromQuaternion:function(t){var e=this.elements,i=t.x,n=t.y,o=t.z,r=t.w,a=i+i,s=n+n,l=o+o,c=i*a,u=i*s,h=i*l,d=n*s,p=n*l,f=o*l,m=r*a,g=r*s,v=r*l;return e[0]=1-(d+f),e[4]=u-v,e[8]=h+g,e[1]=u+v,e[5]=1-(c+f),e[9]=p-m,e[2]=h-g,e[6]=p+m,e[10]=1-(c+d),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}},n.Quaternion=function(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._w=void 0!==n?n:1},n.Quaternion.prototype={get x(){return this._x},set x(t){this._x=t},get y(){return this._y},set y(t){this._y=t},get z(){return this._z},set z(t){this._z=t},get w(){return this._w},set w(t){this._w=t},copy:function(t){this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w},inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return this._w=0===t?(this._x=0,this._y=0,this._z=0,1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w*t),this},setFromAxisAngle:function(t,e){var i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this},setFromUnitVectors:function(t,o){return void 0===e&&(e=new n.Vector3),(i=n.dot(t,o)+1)<1e-6?(i=0,Math.abs(t.x)>Math.abs(t.z)?n.setVector(e,-t.y,t.x,0):n.setVector(e,0,-t.z,t.y)):n.cross(t,o,e),this._x=e.x,this._y=e.y,this._z=e.z,this._w=i,this.normalize()},multiply:function(t){return this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var i=t._x,n=t._y,o=t._z,r=t._w,a=e._x,s=e._y,l=e._z,c=e._w;return this._x=i*c+r*a+n*l-o*s,this._y=n*c+r*s+o*a-i*l,this._z=o*c+r*l+i*s-n*a,this._w=r*c-i*a-n*s-o*l,this}},n.convertWorkshopVector=function(t){return new n.Vector3(-t.x,t.y,t.z)},n.convertWorkshopQuaternion=function(t){return new n.Quaternion(-t.x,t.y,t.z,-t.w).multiply(new n.Quaternion(Math.sqrt(2)/2,Math.sqrt(2)/2,0,0))},n.convertWorkshopOrthoZoom=function(t){return-1===t?-1:t/4},n.convertWorkshopPanoramaQuaternion=function(t){return new n.Quaternion(t.x,-t.y,-t.z,t.w).normalize().multiply((new n.Quaternion).setFromAxisAngle(new n.Vector3(0,1,0),270*n.RADIANS_PER_DEGREE))},n.normalize=function(t){var e=t.x*t.x+t.y*t.y+t.z*t.z,i=Math.sqrt(e);t.x/=i,t.y/=i,t.z/=i},n.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},n.cross=function(t,e,i){var n=t.x,o=t.y,r=t.z;i.x=o*e.z-r*e.y,i.y=r*e.x-n*e.z,i.z=n*e.y-o*e.x},n.setVector=function(t,e,i,n){t.x=e,t.y=i,t.z=n},n.copyVector=function(t,e){e.x=t.x,e.y=t.y,e.z=t.z},n.addVector=function(t,e){t.x+=e.x,t.y+=e.y,t.z+=e.z},n.subVector=function(t,e){t.x-=e.x,t.y-=e.y,t.z-=e.z},n.applyQuaternionToVector=function(t,e){var i=e.x,n=e.y,o=e.z,r=t.x,a=t.y,s=t.z,l=t.w,c=l*i+a*o-s*n,u=l*n+s*i-r*o,h=l*o+r*n-a*i,d=-r*i-a*n-s*o;e.x=c*l+d*-r+u*-s-h*-a,e.y=u*l+d*-a+h*-r-c*-s,e.z=h*l+d*-s+c*-a-u*-r},n.angleBetweenVectors=function(t,e){return Math.acos(n.dot(t,e))},t.exports=n}),ge=d(function(t){var e,i,n,o,r,a,s,l,c,u,h,d,p,f,m=ne,g={TILE_SIZE:512,FACES_PER_PANO:6,LocationOnTile:{Center:0,UpperLeft:1,UpperRight:2,LowerRight:3,LowerLeft:4},getTileVector:function(t,e,i,n,o,r,a,s){var l=t/e,c=e/t*2,u=c/2,h=n/l*2-1+u,d=(o=l-1-o)/l*2-1+u;switch(r=r||g.LocationOnTile.Center){case g.LocationOnTile.UpperLeft:h-=u,d+=u,h+=a*c;break;case g.LocationOnTile.UpperRight:h+=u,d+=u,d-=a*c;break;case g.LocationOnTile.LowerRight:h+=u,d-=u,h-=a*c;break;case g.LocationOnTile.LowerLeft:h-=u,d-=u,d+=a*c;break;case g.LocationOnTile.Center:}switch(i){case m.GL_TEXTURE_CUBE_MAP_POSITIVE_X:me.setVector(s,-1,d,-h);break;case m.GL_TEXTURE_CUBE_MAP_NEGATIVE_X:me.setVector(s,1,d,h);break;case m.GL_TEXTURE_CUBE_MAP_POSITIVE_Y:me.setVector(s,-h,1,-d);break;case m.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y:me.setVector(s,-h,-1,d);break;case m.GL_TEXTURE_CUBE_MAP_POSITIVE_Z:me.setVector(s,-h,d,1);break;case m.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z:me.setVector(s,h,d,-1)}me.normalize(s)},getFaceForTile:function(t,e){var i=g.TILE_SIZE;t<g.TILE_SIZE&&(i=t);var n=Math.floor(t/i),o=n*n;return Math.floor(e/o)},getTileLocation:function(t,e,i){var n=g.TILE_SIZE;t<g.TILE_SIZE&&(n=t);var o=g.getFaceForTile(t,e),r=Math.floor(t/n),a=e-o*(r*r);i.tileX=a%r,i.tileY=Math.floor(a/r),i.face=o,i.faceTileIndex=a},getTileCountForSize:function(t){if(t<=g.TILE_SIZE)return g.FACES_PER_PANO;var e=Math.floor(t/g.TILE_SIZE);return e*e*g.FACES_PER_PANO}};g.getRelativeDirection=(p=new me.Matrix4,f=new me.Quaternion,function(t,e){f.copy(t),f.inverse(),p.makeRotationFromQuaternion(f),p.applyToVector3(e),me.normalize(e)}),g.matchingTilesInDirection=(c=new me.Vector3,u=new me.Vector3(0,0,-1),h=new me.Quaternion,l={face:-1,faceTileIndex:-1,tileX:-1,tileY:-1},d=function(t,e,i){for(var n=g.getTileCountForSize(t),o=0,r=0;r<n;r++)g.getTileLocation(t,r,l),e&&!e(l)||(o++,i&&(a=l,i.push({face:a.face,faceTileIndex:a.faceTileIndex,tileX:a.tileX,tileY:a.tileY})));var a;return o},function(t,e,i,n,o,r){var a=e<g.TILE_SIZE?e:g.TILE_SIZE;if(g.getTileCountForSize(e),!n&&!o)return d(e,null,r);var s=!!o;return o=o||n,o=Math.max(0,Math.min(o,360)),n=Math.max(0,Math.min(n,360)),me.copyVector(i,c),g.getRelativeDirection(t.quaternion,c),s?(h.setFromUnitVectors(c,u),d(e,function(t){return g.isTileWithinFrustum(e,a,t.face,t.tileX,t.tileY,h,n,o)},r)):d(e,function(t){return g.isTileWithinFOV(e,a,t.face,t.tileX,t.tileY,c,n)},r)}),g.isTileWithinFrustum=(s=new me.Vector3,function(t,e,i,n,o,r,a,l){for(var c=Math.tan(.5*l*me.RADIANS_PER_DEGREE),u=-c,h=Math.tan(.5*a*me.RADIANS_PER_DEGREE),d=-h,p=g.mapFaceToCubemapFace(i),f=0,m=0,v=0,y=0,b=0,w=g.LocationOnTile.Center;w<=g.LocationOnTile.LowerLeft;w++)if(g.getTileVector(t,e,p,n,o,w,0,s),me.applyQuaternionToVector(r,s),-1e-5<=s.z);else{var x=-1/s.z,_=s.x*x,S=s.y*x;c<S?f++:S<u&&m++,h<_?v++:_<d&&y++,b++}return m!==b&&f!==b&&v!==b&&y!==b}),g.isTileWithinFOV=(o=new me.Vector3,r=new me.Vector3(0,1,0),a=new me.Vector3(1,0,0),function(t,e,i,n,s,l,c){var u=g.mapFaceToCubemapFace(i);if(me.cross(l,r,a),g.getTileVector(t,e,u,n,s,g.LocationOnTile.Center,0,o),g.isWithinFOV(o,l,c,null))return!0;for(var h=c/360,d=Math.floor(1/h),p=0,f=0;f<d;f++){for(var m=g.LocationOnTile.UpperLeft;m<=g.LocationOnTile.LowerLeft;m++)if(g.getTileVector(t,e,u,n,s,m,p,o),g.isWithinFOV(o,l,c,null))return!0;p+=h}return!1}),g.isWithinFOV=(i=new me.Vector3,n=new me.Vector3,function(t,e,o,r){if(me.copyVector(t,n),r){me.copyVector(r,i),me.normalize(i);var a=me.dot(i,t);i.x*=a,i.y*=a,i.z*=a,me.subVector(n,i)}var s=o/2*me.RADIANS_PER_DEGREE;return Math.cos(s)<=me.dot(n,e)}),g.mapFaceToCubemapFace=(e={0:m.GL_TEXTURE_CUBE_MAP_POSITIVE_Y,1:m.GL_TEXTURE_CUBE_MAP_POSITIVE_Z,2:m.GL_TEXTURE_CUBE_MAP_POSITIVE_X,3:m.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z,4:m.GL_TEXTURE_CUBE_MAP_NEGATIVE_X,5:m.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y},function(t){return e[t]}),t.exports=g}),ve=ot.EventEmitter,ye=new S("/js/objects/Panorama.js"),be=new v.SphereBufferGeometry(.1),we=new v.PlaneBufferGeometry(.2,.2,1,1),xe=H.loadurl(X.splitUrl("https://template2.3dnest.cn/common/img/location_512x512.png")),_e=H.loadurl(X.splitUrl("https://template2.3dnest.cn/common/img/disable_512x512.png")),Se=parseInt(g.getQueryString("reticule")),Te=[],Me=[];function Ie(t,e,i,n){this.model=t,this.enable=i.enable,this.id=e,this.alignmentType=i.alignmentType||ee,this.u=i.u||0,this.v=i.v||0,this.roomid=i.roomid,this.neighbourUUIDs=i.neighbours||null,this.neighbourPanos=null,this.floor=null,this.floorIndex=i.floor,this.failedLoadingAt=0,this.maxLoadRetries=4,this.adjustAngleEnable=i.angle_enable,this.adjustTAngleX=0,this.adjustTAngleY=0,this.adjustTAngleZ=0,this.adjustAngleX=i.angle_x,this.adjustAngleY=i.angle_y,this.adjustAngleZ=i.angle_z,this.color={brightness:i.color.brightness,contrast:i.color.contrast,gamma:i.color.gamma,hue:i.color.hue,saturation:i.color.saturation,vibrance:i.color.vibrance,balance:i.color.balance},this.origin=i.position.clone(),this.originPosition=i.position.clone(),this.position=this.alignmentType===ie?new v.Vector3(0,-5,0):i.position.clone(),this.quaternion=i.quaternion.clone(),this.quaternionAutoScene=i.quaternionAutoScene.clone(),this.skyboxMesh=new v.Mesh(be),this.skyboxMesh.position.copy(this.position),this.skyboxMesh.quaternion.copy(this.quaternion),this.skyboxMesh.name="skybox",this.skyboxMesh.visible=!1,this.skyboxMesh.updateMatrix(),this.marker=null,this.isAligned()&&(this.marker=new v.Mesh(we,new v.MeshBasicMaterial({map:this.enable?xe:_e,side:v.DoubleSide,opacity:1,transparent:!0,depthWrite:!1})),this.marker.renderOrder=Y.panoMarker,this.marker.name="marker",this.marker.pano=this,z.colorMarkerOnLoad&&this.on("load",function(){this.marker.material.color.set(65280)})),this.debugColor=(new v.Color).setHSL(.06+.53*Math.random(),.8+.2*Math.random(),.5+.2*Math.random()),this.floorPosition=i.puck?i.puck.clone():null,this.tiled=n,this.tiled?this.solidSkybox=null:(this.solidSkybox=new v.Texture([null,null,null,null,null,null]),this.solidSkybox.flipY=!1,z.minimalMemoryMode&&(this.solidSkybox.minFilter=v.LinearFilter,this.solidSkybox.magFilter=v.LinearFilter,this.solidSkybox.generateMipmaps=!1)),this.zoomed=!1,this.panoRenderer=null,this.qualityManager=null,this.tileDownloader=null,this.tiledPanoRenderTarget=null,this.minimumTiledPanoLoaded=!1,this.highestPartialTileRenderOpCompleted=0,this.highestFullTileRenderOpCompleted=0,this.shouldRedrawOnBaseLoaded=!1,this.lockUntilRenderingComplete=!1,z.colorMarkerOnLoad&&this.on("load",function(){this.marker.material.color.set(65280)}),1===Se&&this.marker&&this.marker.visible&&(this.marker.visible=!1);var o=new v.TextureLoader;o.setCrossOrigin(!0);var r=o.load(X.splitUrl("https://template2.3dnest.cn/common/img/texture.jpg"));if(this.vrMarker=new v.Mesh(new v.OctahedronGeometry(.1,0),new v.MeshLambertMaterial({color:16777215,transparent:!0,opacity:.75,map:r})),this.vrMarker.boluoType="vr",this.vrMarker.position.z=1,this.vrMarker.enabled=!0,this.vrMarker.visible=!1,window.vrMarkers=window.vrMarkers||[],window.vrMarkers.push(this.vrMarker),this.marker&&this.marker.add(this.vrMarker),z.showAxis&&(this.skyboxMesh.add(new v.ArrowHelper(new v.Vector3(0,1,0),new v.Vector3(0,0,0),1,65280)),this.skyboxMesh.add(new v.ArrowHelper(new v.Vector3(0,0,1),new v.Vector3(0,0,0),1,16711680)),this.skyboxMesh.add(new v.ArrowHelper(new v.Vector3(1,0,0),new v.Vector3(0,0,0),1,255))),this.adjustAngleEnable){var a=new v.Quaternion;a.setFromAxisAngle(new v.Vector3(1,0,0),this.adjustAngleX),this.skyboxMesh.quaternion.multiply(a);var s=new v.Quaternion;s.setFromAxisAngle(new v.Vector3(0,1,0),this.adjustAngleY),this.skyboxMesh.quaternion.multiply(s);var l=new v.Quaternion;l.setFromAxisAngle(new v.Vector3(0,0,1),this.adjustAngleZ),this.skyboxMesh.quaternion.multiply(l),this.skyboxMesh.updateMatrix(),this.skyboxMesh.updateMatrixWorld(),this.model.updateProjectedPanos()}if(t.rooms_real){var c=t.rooms_real.findIndex(function(t){return i.roomid==t.roomidx});-1!==c&&(c=t.rooms_real[c],this.areaName=c.roomname,this.areasPoints=JSON.parse(c.kpoints),this.areaSize=c.area)}}(Ie.prototype=Object.create(ve.prototype)).enter=function(){this.emit("enter")},Ie.prototype.exit=function(){this.tiled?(this.clearWaitDeferreds(),this.minimumTiledPanoLoaded=!1,this.tiledPanoRenderTarget=null,this.setZoomed(!1),this.panoRenderer.deactivateTiledPano(this),this.highestPartialTileRenderOpCompleted=0,this.highestFullTileRenderOpCompleted=0):(this.solidSkybox.dispose(),this.solidSkybox.loaded=!1,this.solidSkybox.version=0),this.emit("exit")},Ie.prototype.hoverOn=function(t){this.marker&&(V.start(b.property(this.marker.material,"opacity",z[t].markerOpacityOnHover),250),z.navigation.panoScores&z.navigation.mouseDirection&&this.addTextSprite("HIT",12525854))},Ie.prototype.hoverOff=function(t){this.marker&&V.start(b.property(this.marker.material,"opacity",z[t].markerOpacity),250)},Ie.prototype.build1=function(){this.floor=this.floor||this.model.floors.get(this.floorIndex)||this.raycastToFindFloor()||this.model.getFloorAtPoint(this.position),this.floor.addPano(this),this.floorPosition=this.floorPosition||this.raycastFloorPosition(),this.neighbourPanos=this.neighbourPanos||this.findNeighourPanos(),z.colorMarkerByFloor&&this.marker&&this.marker.material.color.set(this.floor.debugColor)},Ie.prototype.build2=function(){this.floorPosition=this.floorPosition||this.interpolateFloorPosition(),this.height=this.position.distanceTo(this.floorPosition),this.placeMarker()},Ie.prototype.updateAngleDisplay=function(){},Ie.prototype.updateColorDisplay=function(){},Ie.prototype.changeColor=function(t,e,i){"balance_R"===e?this.color.balance.x=i/100:"balance_G"===e?this.color.balance.y=i/100:"balance_B"===e?this.color.balance.z=i/100:this.color[e]=i/100,t.setProjectedPanos(this,this,!1)},Ie.prototype.resetColor=function(t){this.color.brightness=0,this.color.contrast=0,this.color.gamma=1,this.color.hue=0,this.color.saturation=0,this.color.vibrance=0,this.color.balance=new v.Vector3,this.updateColorDisplay(),t.setProjectedPanos(this,this,!1)},Ie.prototype.applyAllColor=function(t){for(var e=0;e<t.panos.list.length;e++)t.panos.list[e].color.brightness=this.color.brightness,t.panos.list[e].color.contrast=this.color.contrast,t.panos.list[e].color.gamma=this.color.gamma,t.panos.list[e].color.hue=this.color.hue,t.panos.list[e].color.saturation=this.color.saturation,t.panos.list[e].color.vibrance=this.color.vibrance,t.panos.list[e].color.balance.copy(this.color.balance)},Ie.prototype.updateTAngleDisplay=function(){},Ie.prototype.updateAngle=function(t,e){function i(t){var e=parseFloat(t);if(!isNaN(e))return Math.round(1e3*t)/1e3}if("x"==t){var n=new v.Vector3(1,0,0);if(0==e)(o=new v.Quaternion).setFromAxisAngle(n,-this.adjustAngleX),this.skyboxMesh.quaternion.multiply(o),this.adjustAngleX=0;else if(1==e){var o=new v.Quaternion;null==this.adjustAngleX&&(this.adjustAngleX=0),this.adjustAngleX+=.005,this.adjustAngleX=i(this.adjustAngleX),o.setFromAxisAngle(n,.005),this.skyboxMesh.quaternion.multiply(o)}else 2==e&&(o=new v.Quaternion,null==this.adjustAngleX&&(this.adjustAngleX=0),this.adjustAngleX-=.005,this.adjustAngleX=i(this.adjustAngleX),o.setFromAxisAngle(n,-.005),this.skyboxMesh.quaternion.multiply(o))}else"y"==t?(n=new v.Vector3(0,1,0),0==e?((o=new v.Quaternion).setFromAxisAngle(n,-this.adjustAngleY),this.skyboxMesh.quaternion.multiply(o),this.adjustAngleY=0):1==e?(o=new v.Quaternion,null==this.adjustAngleY&&(this.adjustAngleY=0),this.adjustAngleY+=.005,this.adjustAngleY=i(this.adjustAngleY),o.setFromAxisAngle(n,.005),this.skyboxMesh.quaternion.multiply(o)):2==e&&(o=new v.Quaternion,null==this.adjustAngleY&&(this.adjustAngleY=0),this.adjustAngleY-=.005,this.adjustAngleY=i(this.adjustAngleY),o.setFromAxisAngle(n,-.005),this.skyboxMesh.quaternion.multiply(o))):"z"==t&&(n=new v.Vector3(0,0,1),0==e?((o=new v.Quaternion).setFromAxisAngle(n,-this.adjustAngleZ),this.skyboxMesh.quaternion.multiply(o),this.adjustAngleZ=0):1==e?(o=new v.Quaternion,null==this.adjustAngleZ&&(this.adjustAngleZ=0),this.adjustAngleZ+=.005,this.adjustAngleZ=i(this.adjustAngleZ),o.setFromAxisAngle(n,.005),this.skyboxMesh.quaternion.multiply(o)):2==e&&(o=new v.Quaternion,null==this.adjustAngleZ&&(this.adjustAngleZ=0),this.adjustAngleZ-=.005,this.adjustAngleZ=i(this.adjustAngleZ),o.setFromAxisAngle(n,-.005),this.skyboxMesh.quaternion.multiply(o)));this.skyboxMesh.updateMatrix(),this.skyboxMesh.updateMatrixWorld(),this.model.updateProjectedPanos()},Ie.prototype.updateTAngle=function(t,e){function i(t){var e=parseFloat(t);if(!isNaN(e))return Math.round(1e3*t)/1e3}if(""!==e){if("y"==t){var n=new v.Vector4(0,i(e),0,0);n.applyMatrix4(this.skyboxMesh.matrix),this.adjustTAngleY=i(e),this.position.setX(this.originPosition.x+n.x),this.position.setY(this.originPosition.y+n.y),this.position.setZ(this.originPosition.z+n.z),this.skyboxMesh.position.copy(this.position)}this.skyboxMesh.updateMatrix(),this.skyboxMesh.updateMatrixWorld(),this.model.updateProjectedPanos(),this.position.setFromMatrixPosition(this.skyboxMesh.matrixWorld)}},Ie.prototype.update=function(t){this.skyboxMesh.updateMatrixWorld()},Ie.prototype.interpolateFloorPosition=function(){var t=this.model.panos.filter(Ie.filters.isNeighbourPanoTo(this)).filter(function(t){return!!t.floorPosition}).sort(function(t,e){return t.position.distanceTo(this.position)-e.position.distanceTo(this.position)}.bind(this)),e=this.position.clone();return 2<=t.length?e.y=(t[0].floorPosition.y+t[1].floorPosition.y)/2:e.add(z.noMeshFloorPositionOffset),e},Ie.prototype.raycastFloorPosition=function(){ye.warn("Performance warning: Raycasting to find floor position");var t=new v.Raycaster(this.position,new v.Vector3(0,-1,0)).intersectObjects(this.model.colliders);return t.length?t[0].point:null},Ie.prototype.raycastToFindFloor=(re=[new v.Vector3(0,-1,0),new v.Vector3(1,-1,0),new v.Vector3(0,-1,1),new v.Vector3(-1,-1,0),new v.Vector3(0,-1,-1),new v.Vector3(1,0,0),new v.Vector3(0,0,1),new v.Vector3(-1,0,0),new v.Vector3(0,0,-1)],function(){for(var t=0;t<re.length;t++){var e=new v.Raycaster(this.position.clone(),re[t].clone()).intersectObjects(this.model.colliders);if(e.length)return e[0].object.parent.parent}return null}),Ie.prototype.placeMarker=function(){this.marker&&(this.marker.position.copy(this.floorPosition),this.marker.position.y+=.05,this.marker.lookAt(new v.Vector3(0,1,0).add(this.marker.position)))},Ie.prototype.findClosestMidtpointPanoTo=function(t){return(new v.Vector3).addVectors(this.position,t.position).divideScalar(2),this.model.panos.find([Ie.filters.notIn([this,t])],[Ie.sortFunctions.distanceToPoint(point)])},Ie.prototype.attachToPanoRenderer=function(t){this.panoRenderer=t,this.panoRenderer.on(pe,this.onTileRendered.bind(this)),this.panoRenderer.on(de,this.onPanoRendered.bind(this)),this.panoRenderer.on("panorama.tile.render.failed",this.onTileRenderFail.bind(this)),this.panoRenderer.on(fe,this.onUploadAttemptedForAllTiles.bind(this))};var Pe={};Ie.prototype.getWaitDeferred=function(t){var e=Pe[this.id];e||(e={},Pe[this.id]=e);var i=e[t];return i||(i={deferred:o.Deferred(),active:!1},e[t]=i),i},Ie.prototype.resetWaitDeferred=function(t){var e=this.getWaitDeferred(t);e.active=!1,e.deferred=o.Deferred()},Ie.prototype.clearWaitDeferreds=function(){var t=Pe[this.id];for(var e in t||(t={},Pe[this.id]=t),t)if(t.hasOwnProperty(e)){var i=t[e];i.active=!1,i.deferred=o.Deferred()}},Ie.prototype.loadTiledPano=function(t,e,i,n,o,r){null!=n||(n=!0),null!=o||(o=!0);var a=this.getWaitDeferred(t),s=a.deferred,l=null,c=null;if(i&&("number"==typeof i?l=i:(l=i.hFov,c=i.vFov)),!this.isLoaded(t)){if(!a.active){if(a.active=!0,i){var u=ge.matchingTilesInDirection(this,t,e,l,c);Te[this.id+":"+t]={tileCount:0,targetTileCount:u},ye.info("Loading partial pano: "+this.id+" with "+u+" tiles")}Me[this.id]||(Me[this.id]=!0,this.on(ce,function(t,e){var i=this.getWaitDeferred(t).deferred;i&&"pending"===i.state()&&this.highestPartialTileRenderOpCompleted>=t&&(i.resolve(t,e),this.resetWaitDeferred(t))}.bind(this)),this.on(ue,function(t){var e=this.getWaitDeferred(t).deferred;e&&"pending"===e.state()&&this.highestPartialTileRenderOpCompleted>=t&&(e.reject(t),this.resetWaitDeferred(t))}.bind(this)),this.on(he,function(t,e,i){this.id==window.firstPanoId&&512==t&&window.loadingCount++;var n=this.getWaitDeferred(t).deferred;if(n&&"pending"===n.state()){n.notify(t,e,i);var o=Te[this.id+":"+t];o&&(o.tileCount++,o.tileCount===o.targetTileCount&&(this.onPanoRendered(this.id,t,i,!0),n.resolve(t,i),this.resetWaitDeferred(t)))}}.bind(this)))}this.tileDownloader.forceQueueTilesForPano(this,t,e,l,c,r),this.tiledPanoRenderTarget=this.panoRenderer.activateTiledPano(this,this.qualityManager.getMaxPanoSize(),n,o),this.panoRenderer.renderPanoTiles(this.id,e,o)}return s.promise()},Ie.prototype.onUploadAttemptedForAllTiles=function(t,e,i){g.isMobile()||t===this.id&&e===this.qualityManager.getPanoSize(1)&&this.shouldRedrawOnBaseLoaded&&(this.shouldRedrawOnBaseLoaded=!1,this.panoRenderer.resetRenderStatus(t),this.panoRenderer.renderPanoTiles(this.id,null,!0,!0))},Ie.prototype.onTileRendered=function(t,e,i,n){t===this.id&&this.emit(he,e,i,n)},Ie.prototype.onPanoRendered=function(t,e,i,n){t===this.id&&(this.minimumTiledPanoLoaded=!0,this.skybox=this.tiledPanoRenderTarget.texture,e>this.highestPartialTileRenderOpCompleted&&(this.highestPartialTileRenderOpCompleted=e),!n&&e>this.highestFullTileRenderOpCompleted&&(this.highestFullTileRenderOpCompleted=e),this.emit("load",e),this.model.emit("load",this),this.emit(ce,e,i))},Ie.prototype.onTileRenderFail=function(t,e,i){t===this.id&&this.emit(ue,e)},Ie.prototype.getSkyboxTexture=function(){return this.tiled?this.minimumTiledPanoLoaded?this.zoomed?this.panoRenderer.zoomRenderTarget.texture:this.tiledPanoRenderTarget.texture:null:this.solidSkybox},Ie.prototype.isLoaded=function(t){if(this.tiled){if(t&&"string"==typeof t)throw new p("Wrong panoSize given to Panorama.isLoaded(); a tiled pano uses PanoSizeClass");return!!this.minimumTiledPanoLoaded&&(!t||this.highestPartialTileRenderOpCompleted>=t)}if(t&&"number"==typeof t)throw new p("Wrong panoSize given to Panorama.isLoaded(); a non-tiled pano uses high/low.");return!!this.solidSkybox.high||t in this.solidSkybox},Ie.prototype.getAjustedColors=function(){return this.color},Ie.prototype.loadCube=function(t){if(this.isLoaded(t))return ye.info("Skipping load of pano, already loaded"),o.when();this.emit("loading",t),this.model.emit("loading",this);var e=le.getCubemapUrls(this.model.urls,this.id,t),i=e.filter(function(t){return!t});"low"===t&&0<i.length&&(ye.info("Pano",this.id,"not available in low res, loading high res right away"),t="high",e=le.getCubemapUrls(this.model.urls,this.id,t));var n=0,r=[0,1,2,3,4,5].map(function(t,i,n){return P.getImage(e[i])}.bind(this)),a=t;return o.when(r[0],r[1],r[2],r[3],r[4],r[5]).then(function(t,e,i,n,o,r){return this.solidSkybox[a]=[t,e,i,n,o,r],"high"!==a&&this.solidSkybox.high||(this.solidSkybox.image=this.solidSkybox[a],this.solidSkybox.low=null),this.solidSkybox.needsUpdate=!0,this.emit("load",a),this.model.emit("load",this),this}.bind(this),function(){I.error("Downloading cubemap for pano",this.id,"failed"),this.failedLoadingAt=Date.now()}.bind(this),function(){return o.when(++n,6)})},Ie.raycastsSkipped=0,Ie.raycastsDone=0,Ie.prototype.findNeighourPanos=function(){return this.model.panos.setNeighbour(this.id,this.id,!1),this.model.panos.forEach(function(t){if(t!==this&&(!this.model.panos.neighbourMap[this.id]||void 0===this.model.panos.neighbourMap[this.id][t.id])){var e=this.position.distanceTo(t.position);if(e>z.panoramaNeighbourMaxDistance)return this.model.panos.setNeighbour(this,t,!1),void Ie.raycastsSkipped++;var i=t.position.clone().sub(this.position).normalize(),n=new v.Raycaster(this.position,i.clone(),0,e).intersectObjects(this.model.colliders);Ie.raycastsDone++,this.model.panos.setNeighbour(this,t,0===n.length),z.showNeighbourRaycasts&&(n.length?this.floor.model.add(new v.ArrowHelper(i,this.position,n[0].distance,16711680)):this.floor.model.add(new v.ArrowHelper(i,this.position,e,16777215,0,0)))}}.bind(this)),this.model.panos.neighbourMap[this.id]},Ie.prototype.worldPosition=function(){return this.position},Ie.prototype.addTextSprite=function(t,e){this.removeTextSprite();var i=document.createElement("canvas"),n=i.getContext("2d");i.width=256,i.height=256,n.font="bold 60px Arial",n.fillStyle="white";var o=n.measureText(t).width;n.fillText(t,(i.width-o)/2,(i.height+60)/2);var r=new v.Texture(i);r.needsUpdate=!0;var a=new v.SpriteMaterial({map:r,color:e||16428055});this.text3d=new v.Sprite(a),this.text3d.position.copy(this.skyboxMesh.position),this.floor.add(this.text3d)},Ie.prototype.removeTextSprite=function(){this.text3d&&(this.floor.remove(this.text3d),this.text3d=null)},Ie.prototype.removeLocationTextSprite=function(){this.locationText&&(this.floor.remove(this.locationText),this.locationText=null)},Ie.prototype.isAligned=function(){return this.alignmentType===ee},Ie.filters={inDirection:function(t,e,i){return function(n){return n.position.clone().sub(t).normalize().dot(e)>i}},inFloorDirection:function(t,e,i){return function(n){return n.floorPosition.clone().sub(t).normalize().dot(e)>i}},inPanoDirection:function(t,e,i){return i=z.navigation.panoScores?z.navigation.filterStrictness:i,function(n){var o=n.floorPosition.clone().sub(t).normalize(),r=n.position.clone().sub(t).normalize();return o.dot(e)>i||r.dot(e)>i}},atFloor:function(t){return function(e){return!t||e.floor===t}},not:function(t){return function(e){return e!=t}},notIn:function(t){return function(e){return-1===t.indexOf(e)}},isLoaded:function(){return function(t){return t.isLoaded()}},isNotLoaded:function(){return function(t){return!t.isLoaded()}},isCloseEnoughTo:function(t,e){return function(i){return t.distanceTo(i.floorPosition)<e}},hasMinimumHeightDifferenceTo:function(t,e){return function(i){return Math.abs(i.position.y-t.y)>e}},isNotBehindNormal:function(t,e){var i=new v.Vector3;return e=e.clone(),function(n){return 0<i.copy(n.position).sub(t).normalize().dot(e)}},isNeighbourPanoTo:function(t){return function(e){return!t||!t.neighbourPanos||!!t.neighbourPanos[e.id]}},isNeighbourOfNeighbourTo:function(t){return function(e){return!!t.neighbourPanos[e.id]||t.neighbourUUIDs.some(function(i){var n=t.model.panos.get(i);return!!n&&n.neighbourPanos[e.id]})}},isNotRecentlyFailed:function(t){return function(e){return Date.now()-e.failedLoadingAt>t}},isOnVisibleFloor:function(){return function(t){return!t.floor.hidden}},isPanoAligned:function(){return function(t){return t.isAligned()}}},Ie.sortFunctions={distanceToPoint:function(t){return function(e,i){return e.position.distanceTo(t)-i.position.distanceTo(t)}},floorDistanceToPoint:function(t){return function(e,i){return e.floorPosition.distanceTo(t)-i.floorPosition.distanceTo(t)}},choose:function(t){return function(e,i){return t.id===e.id?-1:t.id===i.id?1:0}}},Ie.scoreFunctions={distance:function(t,e){return e=e||z.navigation.distanceFactor,function(i){return t?t.position.distanceTo(i.position)*e:0}},distanceSquared:function(t,e){return e=e||z.navigation.distanceFactor,function(i){return t?t.position.distanceToSquared(i.position)*e:0}},direction:function(t,e){return function(i){return i.position.clone().sub(t).normalize().dot(e)*z.navigation.directionFactor}},angle:function(t,e){return function(i){return i.position.clone().sub(t).normalize().angleTo(e)*z.navigation.angleFactor}},inFieldOfView:function(t,e){return function(i){return.75<i.position.clone().sub(t).normalize().dot(e)?10:-1}},optionality:function(t){return function(e){return e.neighbourUUIDs.filter(function(e){return!(e in t.neighbourUUIDs)&&e!==t.id}).length*z.navigation.optionalityFactor}},penalizeHeightDifferenceUnder:function(t,e){return function(i){return t.y-i.position.y<e?-20:0}}},Ie.prototype.setZoomed=function(t){this.zoomed=t,this.updateSkyboxForZoomLevel()},Ie.prototype.updateSkyboxForZoomLevel=function(){this.minimumTiledPanoLoaded&&this.model.updateProjectedPanos()},Ie.prototype.ensureSkyboxReadyForRender=function(){this.tiled||(this.solidSkybox.loaded||(this.solidSkybox.needsUpdate=!0),this.solidSkybox.loaded=!0)},Ie.prototype.destory=function(){Te=[],Me=[]};var Ce=Ie,Ae=d(function(t){(function(e){var i=v;function n(t){t=t||{},this.position=new i.Vector3,this.quaternion=new i.Quaternion,this.update(t)}i=v;var o=ot.EventEmitter;new S(e),(n.prototype=Object.create(o.prototype)).isValid=function(){return!!this.cameraMode},n.prototype.update=function(t){return this.cameraMode=t.cameraMode||this.cameraMode,this.pano=t.pano||this.pano,t.position&&this.position.copy(t.position),t.quaternion&&this.quaternion.copy(t.quaternion),this},t.exports=n}).call(h,"/js/objects/View.js")}),Ee=d(function(t){(function(e){function i(t){n.call(this,t),this.panoId=t.panoId,this.orthoZoom=t.orthoZoom,this.floorVisibility=t.floorVisibility,this.thumbUrl=t.thumbUrl,this.name=t.name,this.isHero=t.isHero,this.script=t.script,this.cameraType=t.cameraType}var n=Ae;new S(e),(i.prototype=Object.create(n.prototype)).isPano=function(){return this.panoId&&""!==this.panoId},t.exports=i}).call(h,"/js/objects/Snapshot.js")}),Le={Move:"move",MoveComplete:"move.complete",ModeChanged:"mode.changed",ModeChanging:"mode.changing",RulersMove:"rulers.move",PanoChosen:"pano.chosen",warpTravelBlack:"warp.travel.black",ClosestPanoChanging:"closest.pano.changing",WarpStarted:"warp.started",WarpInterrupted:"warp.interrupted",WarpEnded:"warp.ended",FlyingStarted:"flying.started",FlyingInterrupted:"flying.interrupted",FlyingEnded:"flying.ended",Ready:"ready",StartInside:"start.inside",StartOutside:"start.outside",ViewChanged:"view.changed",WarpInterruptedWithFlyTo:"warp.interrupted.flyto",InputStart:"input.start",EditAddTagHighlight:"edit.add.taghighlight"},De=d(function(t){var e=new v.ShaderPass(v.HorizontalBlurShader),i=new v.ShaderPass(v.VerticalBlurShader);i.renderToScreen=!0;var n=window.innerWidth/window.innerHeight;isNaN(n)&&(n=1);var o={currentBlur:0,aspect:n,blurStrength:1,hblurPass:e,vblurPass:i,bindEvents:function(t){t.on(Le.ModeChanged,function(t,e){t===A.PANORAMA&&(V.cancel(o.blur),V.cancel(o.addBlur),V.start(o.removeBlur,500,null,0,null,"deblur"))})},blur:function(t){var n=(o.currentBlur=t)*o.blurStrength;i.uniforms.v.value=n/512*o.aspect,e.uniforms.h.value=n/512},addBlur:function(t){t=Math.max(t,o.currentBlur),o.blur(t)},removeBlur:function(t){t=Math.min(1-t,o.currentBlur),o.blur(t)}};o.blur(0),t.exports=o}),ke={ModelAdded:"model-added",ActiveModelChanged:"active-model-changed"},Re=k,Oe=ot.EventEmitter;function Fe(){this.modelMap={},this.activeModel=null,this.modelCount=0,this.tileDownloader=null,this.panoRenderer=null}Fe.prototype.init=function(t,e,i){this.tileDownloader=t,this.panoRenderer=e,this.qualityManager=i},Fe.prototype.addModel=function(t){this.modelMap[t.modelid]=t,0===this.modelCount&&this.activateModel(t.modelid),this.modelCount++,this.emit(ke.ModelAdded)},Fe.prototype.activateModel=function(t){var e=this.modelMap[t];if(!e)throw new p("Tried to activate invalid model!");var i=this.activeModel;this.activeModel=e,this.tileDownloader.setPanoData(e.panos,e.listImagePanos(),e.modelid),this.tileDownloader.setUrls(e.urls),e.panos.forEach(function(t){t.attachToPanoRenderer(this.panoRenderer),t.tileDownloader=this.tileDownloader,t.qualityManager=this.qualityManager}.bind(this)),this.emit(ke.ActiveModelChanged,{oldModel:i,model:e})},Fe.prototype.getActiveModel=function(){return this.activeModel},Re.extend(Fe,Oe);var Ne=Fe,Ue={NONE:0,MIDDLE:1,END:2,BEGINNING:3,FADEIN:4},Be=d(function(t){(function(e){var i=X;function n(t,e){this.obj3d=null,this.nodes=[],this.colorHull=[],this.shortPaths={},this.floorHull=null,this.cameraHull=null,this.floorPathDistance=0,this.floorCurvePoints=null,this.floorCurveColors=null,this.camCurvePoints=null,this.warpDestHeroLoc=null,this.warpDestPano=null,this.warpPathPoints=null,this.warpPathLengths=[0],this.warpLength=0,this.closeWarpDistance=4,this.UP=y.UP.clone(),this.longestStep=0,this.upcomingTransType=null,this.burnsDir=1,this.prevNextDist=0,this.nextI=0,this.activeTransType=null,this.bunnyObj=null,this.director=t,this.player=e,this.modelManager=e.modelManager,this.updateModel(),this.updateDefaultsFromModelData(),this.bindEvents(),this.warping=!1,this.warpInterrupted=!1,this.warpInterruptionBlackoutStyle=null,this.warpInterruptionTravelTime=null}var o=v,r=A,a=Y,s=L,l=z,c=J,u=b,h=D,d=V,p=Ee,f=De,m=$,g=H,y=tt,w=new(w=S)(e),x=Le,_=Ue,T=ke,M={path:g.loadurl(i.splitUrl("https://template2.3dnest.cn/common/img/location_512x512.png")),pathEnd:g.loadurl(i.splitUrl("https://template2.3dnest.cn/common/img/location_512x512.png")),pathStart:g.loadBase64("iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAAXNSR0IArs4c6QAAM6VJREFUeAHtfQl0HNWZ7r3VXd2SLLEa2xgc2ySGxwOMiSRsC2IsG1vbMCGGsCYsWcibGSAhEEJeFkyIhyRAkknmvXOGJBMggQAhDAlIsjFY4NjCtqSwH55xDjYDAWN2JGvp6q77vr/UMpLcS3V3Lbeqbx3L3V1177989///uvvlTF2BRmBx96uVNbFpsyMiMpcx83Cu8UOh0FQm6FMcyuk7YwcLxivwGWOcxXEvxgSLW7/xH64E7o8I+hRshH5zJobx+R7uvc0Yf4dx8Q5+vy1M+tTeSPHUzv7EnleebJg1hPvqCigCsAV1yY7A0q6uaGVlw9EiwuZzTTueC34UnBsOz+dwzmb4Kb8QbDdk2QVZdgouXham+TxPsWeHhrpferyxMemnbIp3fgRUAMiPkacplnbtrKioObIOBbOQMz4fzjWfcX4sftMbOzAXag4jTIgXERieFUzgj20d7n+t9/HGuVSzUJckCKgA4HNBtGzsP4xVVZ4CRz9F4wyfvBYixXwWyy32CejZZwq2GXpuZoNDmzuX1LzlFjNFNz8CKgDkx8jRFLW9vfoMduKpqDq3oPregrf78Y4yCBoxIZ4HFp3AonM3e2ZTX12dETQVgiyvCgAelN6KTXtn6nH9DDg7nJ4vB8tqD9gGkcWAEOIxNB06jRHjofWnTnk9iEoESWYVAFwqreVbBqbH9djZ6LA7V3B+KoBWWBeANfoM0KcoNuG/e0eMxP2PLap+s4DsKqlNBJRR2gTKTrKm7g8OieiVn8Wb/ly86U9DHs1OPpUmLwImagZPoGZwb8oY+sO6hgPfzZtDJbCFgAoAtmDKnai5x1iqcf5lpFqFtiyNt6vLJQTQX0CjCA8gIvxybb3+uEtsyoasCgBFFvXKzf3TIrGKSzSNfQm1+3lFklHZSkJA7DBN9qtUYvj2R06p2VMSqTLNrAJAgQXftDVxYiSqXY0Zc+fhba8XmF0ldwEB1AoM9LDck0qat65bGHvGBRahJakCgM2ibe4zmiKMXYO3/ek2s6hkviAgHk0xdsvaWn2dL+wDxlQFgFwFdt99kZa5Z16IDr1r8HdCrqTqmVwIoNPwOfzd0rnzwbvYOecgJqgrEwIqAGRCZfVqrbXtW+cyrq2G4x+dKYm6FwwEEAReYsJc3dF+071s9WozGFJ7J6UKABOx5q09SfTkixswlHfcxEfqV6AREOIFIfj1HfXRB6AHphmoixBQASBtB609xgqg8WO88Rco0wgvAqgRPA33v7ajXl8fXi3ta1b2AWDFluF5uh65FSvvzrAPm0oZdASwQvEhw0hdvX5RxY6g61KK/GUbAFq2vHMAix7wXUzguRIAhnX1XSm2UQ55E5hQ9HOW/PDGzkWHflgOCk/WsSwDQOu2xKUsov0Qyk+bDIj6XX4IoENgD0uZ13WcHPtNuWlfVgGgqXv4E5FY5Da08xvLraCVvvkRQP9AVyqRumxdQ8Xf8qcOR4qyCADWllrVp34d1f3V6OirDEfRKS1cQUCwITQLVg8NbPpJOWxpFvoA0NKTOAlv/F/j7yRXDEYRDSUCqA08hb8vdtbHngqlgmmlQr1ctaUv8TXOta3K+cNswu7oRjZDtkM25A4HOaiGsgbQ9pf3DxaVU36DQvy0HDArKYKMAGoCf+JDey9t/9RB7wVZj0yyhy4AtPYmFmIK771QbHYmhdU9hUAxCGCk4BVMKT63oy62tZj8suYJVROgtdf4Ojbh+YtyflnNLbhyjdqU9pdRGwuuHpMlD0UNwNqKK151u5rNN7l41W83EKBZhKmRwUvCsDVZ4ANA81ZjcSTC78Hw3sfcKGxFUyGQEQHB/juVEuetXag/mfF5QG4GuQnAW/uMb2gRvlE5f0CsLUxi4oVDtkc2CLUC+yINpOB0fFbVAUfehSr/qjDZlNIlmAigSfDA4IevXRjEY88CFwBO7333wBiv+TOcf0kwzUVJHUYEEAQ2JkT/Pz5ad8gHQdIvUAGgqXfv4REeWwvnx6GZ6lIIyIUAgsCzKZFoXlc35Q25JMsuTWACwOi6/egjEHhOdnXUE4WAvwhgvsAuw0iuDMo+A4EIAK1bE3UsqnVA2MP8LV7FXSGQHwEEgbdY0mztWBjrzZ/a3xTSjwK09Rin86jWpZzfX0NR3O0jQLZKNku2az+XPymlDgDNPSPnMY23Axp1mq4/9qG4Fo9ANdmuZcPF03A9p7QBoK03cYWmRe4GAmq7LtfNQDFwCYEY2TDZskv0SyYrZR8AJldcj57+1SVrV2YE0PbcixN0X8IqyO3Y1OIljYm3hckGBNf6hSb6IymGT7PfNMx+QzP6d7/yaj9BNGP2rBrd1Gs0XavhplaTijB88houzBqusWqT8anYTOVorIo7BtulHw2jmVJm0JasLkYIVnfU6jeUTMhhAtIFACtacu3nDusZNnKvw9Gfg8Nv50xsT5l8OzeN7Z2Lql7zQtGWLYNHCk0/JqKJYwTjx8CIKDDQyUkzveAfWB7CvLK9LvYLmeSXKgBQe4mqTBBKKrn8LjCrV1mwLixH3WCkzA2yDjFZQ7URbRmWY+OPNaIQ1ajNOONBOQrTTF2wtj5+z7jbvn6VxtGsHtPRDj/V5mfsfVS3n4C9bMBfV0dd/HlYCewnUBdv7R05HrG8EX/L0Cw5DdIfFCgN3BE2wUzR1l6vP+oO+cKoShEAaJyfhk0gevn29gu0zzm73zTFnWvb12wM3Tl2OG+xue3bSzSNX8QFOxs1hJrCTDVUqQdE0myUYZ6A7wEgPcNvMwQpv+qiYCnBxXpmmne+Z+x58MmGWUOhMvMsyizufrXyYH3amUzTEAw4HcmGk9fL60J17i3MGDzF7+acrwFgdG5/vBtCzCmz4n9GCHYnM0fu7ji5end56T5R29ZtAzOYFr+Ac3YRmgonTnwa7l8IArtSYqTBz7UDvgWA9Kq+jWW0sMdEz/0DjIsfttfG+sJt2sVp19aXqGWCX4cRBVrmLe0cleK0y5yLFhBhFeESv1YR+hIA0uv515XDkl686ZOo4v6eJ1I3tS+Ov5jZDNTd8Qi0PTlyrIhFvoVuz/NRM4iOfxbG7wgCG7GfQJMf+wn4EQB4W6/xR0T5z4SxMMfplMD3242k8cNHFlbuHHdffbWJwMqtQ3P1qH4dkl+Cv1CPDiEIPICJQmdDT7QMvLs8DwAtPca16An+kXcqesxJsEFU9W8bMoxbNjRU/d1j7qFkt6x78IhKXb8GL43LUJuqCqWSUApB4FoEgZu91M/TAEAbeNI+aqGt1gn2h6FE4irl+O6YsBUIYrGfIgh81h0O/lKl5qKZEku83GjUswBAW3dHY1OeQuGFcPdescMU7PLOOv0Rf02oPLi39BorNc7+HaMG80KnMXYbTib2nuTVluNe9bTyCPbtD53zj54k+z3zzV0nKOf3zhUJa8IcC56+h3pzuOZO4AVp+YpHcHpSA0DEvhqryW7xSCdP2GCqbnsylbxCdfB5AndWJtRRGI1Ef4Gpxm1ZEwXwAYLbNQh0t7otuusBAKerLuJCo3a/7rYyntAX7E201b7SUR/9kyf8FBNbCLT2JD8NG/sP1DKn28ogeSLYmCG4uaSzNrbFTVFdDQDWKb1V1U+ByWw3lfCKNt76XZi9d0G5z97zCu9C+aRnFd6N2kBjoXllTI/xwFf44MBJbp5K7GofgHVEdzic3xSmuKHj4TWnK+eX0VVGZaKyoTKissIdU15J7UlGL07yIXupi0sFHu5crT2Jq7im/cQd6t5RRVVsNxbsXNhZq2NprrqCgkBLn7EMC43uQrNgRlBkzianycyr0BT4Wbbnpdx3JQA09SY+GWHaluC3+8Vjw8bIhY8tqn6zFJBVXn8QWL5lYHqFHr8Lw4XL/ZHAGa5Wf4AwF3bWx55yhuJHVBxvAizt6opGGP9VkJ0fbS9MyhLXtz+0ZqVy/o+MJWjfqOyoDKksrTINmgJpecmX0K/xa/Itp1VwvAYQ9Km+FG1NkbpIpm2bnC70cqRnbTfHI3cG+cWEzWK+2Vmv/9jJ8nM0ADR1D38iGos+i6GYSieF9JDWADqQVnXU6+s95KlYeYRAa4+xgmv8AbAL5s5TmPSUTCTnr2uo+JtTkDnaBIjEIrcF1flRRXzL2qZJOb9TtiUdHQrsVMZU1tIJZ0cgvFgtH7OT1mYaxwJAS0/iC0Edf4VB7GLJ5Kky7NFms9xUsiIRsMoYZW2VeZE0/MxGPta6LXGpUzI40gRo2fLOAVw/cAeITXNKMK/oYHLPcymWaPJzWyavdFV8PkLA2o6OxdbBoeg8g0BdCF57hPHBvM5Fh35YquDO1ACiB3w3kM7PRPdg/8AS5fylmlHw8lOZU9ljuKc7aNJbvgafc0LukmsAtKtvTI/SvvWB2rGF3vxkAI83Hvy+E0AqGsFEYGnXewdV1VRjrUrgagKJhJE8vtRdhUuuAeh6hFYsBcv5aTdWVPuV8wfTaZ2UmmyAbCGAfQKxtO+VBEdJNYD0sEqgNsFAQb812uFX8VJJyKnMoUKgdevw0Swa3QSHCNT5FBi2XlnKsHUpNQBs6sscnZTggUUNYNOl1o6Fyvk9wDpQLCybgG1A6IFACT7qg0W/yIsOAFh/vQrtpgVBAcuaT02TfBbGeoMis5LTWwTINmgiGNmKt5yL50Y+SL5YLIXiAgDOeePcWnJZLF9P86Haj3JNXVRKVclTgRUz3xAgGyFbIZvxTYgCGVu+CJ8sMJuVvKiqQ2vPyPkcx3gXw9CPPLR3HLZXutEP3opnMBHA2RXfwzbkNwRFeoFjxzvq478vVN7Co8Z992Gxn7a6UEb+pRePdT68Zo1//BXnICLQ/vCaH6AS8FhgZCefJN8s8Cq4BoApvxdpmnZHgXx8SY623O6R5PACtaQ3M/y0XyM9cXvfuczc5b9L+wnEoxVPYwVhIDYVMU3zYuwZcGchyBZcA0Dj/xuFMPAxrUk7+Sjnz14CGtO+Sn/ZU5T3E7IdsiGgEIjtxdAheE2hJVZQAGjuM5rQLjq+UCZ+pEev341qG6/syK/YtHcmakhn0R99z56yvJ+QDZEtBQEFms1o+WgBwhYUANDAKDjCFCCLY0lp996O9jXfd4xgCAnF4rF/Gd1phun0PYQqOqYS2ZK1I7RjFN0jVKiP2u4DaNqaODEa1Z52T3SHKNO+/ebwArV7b3Y86Xj2KTWzXsVErqlWKsHe3tv/6iw/jqfOLqVcT2jLca5VPA3MpD93IJk0F6xbGHvGDoK2awCRqHa1HYJ+p0GV9ivK+XOXwpTqIy7c5/yUFIHAupc7W1k/JZsi2woCCIX4qq0AQL2hmBZxnuzKo5r2sDqxJ38pCY1fOTlVpnuT05T7b7It2Fi79DjAVy2ftSGorQAQi8Qvln4zRdovLZXcz7BtYFBWSTDBpRGLOOZPVpru0bPJ99XviQjQeZCyH0hKvko+O1HyzL9sBQBNY1/KnF2eu9jY4V/VQZ35ywPzW7MO++V6lp9yeaQgGzOZuEl2be36bN4A0NxjLJX/HHaxQ+zZdbPsheK3fHSSLoaKzsgmBz2jNNmeq/tpBPbswipYsUNuPPi8Ud/NLWXeAICJP1/OTcL/p6Zgl3e2zhvxXxK5JYhGo1dAwlxlrqXTyK2Iz9KRrZHN+SxGXvZ2fDfnMGBT9weHROJTXkeieF5ufiUQ7A/tddFz/GIfFL5Lu/ZUV9Uc8hrahwfmkhk93R8M9r975OON04K1Lj6XUi49a+tN3ocRlM+6RL5ksijL4VRi7xHrGg58NxuxXG8DFolVniO58w8OJRJXZVNO3f8Igcrqgy7J5/yUmtJQ2o9yqm/ZELBsT7DBbM/9vo+yrCAfziVHzgAAc8iZORdhT54JcduGhqq/e8Ir2EzQvOdU/bd1pdPmrB3aIhTyRJbtwQblVjO3D2cNANbMJ85Pk1i5xJBh3CKxfNKI1tyTbIFTH21XIEpLeeymL+d0aRtMyIoByvI08uVs8mUNAKj/n4VM2Z9no+jRfQxZ/Ua9/e2BrXGRdegvG4Vi8mSjFeb7ZINkixLrqKV9OaOIWR2cC35uxhwS3ETnRjKZNH4kgSjSi7Cyd+R/oGG/omBBkcfKW3DG8stAtkg2KavmuXw5YwCwlopyfqqsCqHn9fdq0o+90omyyFfRmC+4PU95KK89LuWdyrJF2KSsKAj4crYl3xkDgB7XzyjGaDwCwOSJlPQzsTzCIicbOvUGrv/5nIlyPURei0auNOqZhUDaJqXcOIR8mXw6U1FlDACoMsrbASTEA+2L4y9mUkbdm4hA1QHVX0bhT5l41/4vyks07Oco35SWTcI2pUUgi0/vFwBqe3t19Bwul1WRZADmYUuBnbVBJHdgow/QKGKzSSkw8FoILn7oNUu7/Minybcnp98vAMxgJ1Lbv3pyQjl+i2fW1cX+KocsckvROnfVmXiDzy5VSqJBtEqlUw7522tjfVgjYGsjDh/wqE779gTW+wUA9GZKW/2HbHdOkF79yIoADotwrAPPSVpZBQ7JA5ltNJNv7xcAMH1QzgAgWIqZI4E5jMRPe27dlliAfpxPOSYDaFk0HSMYYkJko2SrEl6ZfHtCAGjZ2H8YDEfKXX+xPfN6tdWXPavimvY1eyntp3KDpn3uwUlpbR0GW5VSYvi25ePjhJsQAFhV5Snjnsn11TRV9d9Giazc3D9NcOe3byOaRNuGCCqJzLY6yccnBgAm5AwAgvW/Z+x5UFlWfgT0eMX/Qsed48u3iSbRzi+BSmHZKmxWTiQm+viEAKBxJmUAwNvn/icbZg3JCag8UtEwj2DcNScl2pmGkuRBQA5JyFbJZuWQZqIUk318XwCgveIxYah2YnI5fpmmUNV/G0UxwzzhXHT0HG4jaVFJiDbxKCpzmWWS12Z57aivjxbIvgBQUXNkHW7FJCyn99e2r9kooVzSiSQi2pVuC+UFD7d18IJ+2mbf94JXgTxiaV+3su0LAGjjLSyQkCfJsQ/7E2z1ainnWHsCgE0mbduMBmztXW8zedHJiAfxKppAuWSEzVq2K6G+4319XADYf694OWQXG+SQQ24pcLCHYxN/8mnqJa98ssj9XE7bHX8uxL4AgCmM82UEMynkBFEmrFq2DB4JeVZ5KNOqNE8PWQaPlby2+5GvWwFgaVdXFBOAjpUNYuy08tYj9fEXZJNLNnl4VKeTfqNeyUW8iKdX/ILKh2yXbFg6+eHrls9DMCsAVFY2HO3G2HHJigvWBRrAUF3ZEFjc/WolqnSeL9klnsQ7m1zqvoUADqyybFgqOMjXyedJKCsAiAiTsvrPhKna/3lM56D49M9h049D8yRz/jF4WrydpxwuipLa8JjPWwEA87ylnP9vpFQAyOcNmtj/pN98eZx67idvp3Rwm46sNjzm81YA0Bj/uNtAFEH/9fWLKnYUka9ssjRvM5b7ungLi0ssGcoG8cIVTdvw64XndDcHNgo9ijiMNgGEmOMuuyKoC/FcEbnKKosWyX7Sr1dAyCCDV7oWzUdKWxZzSR8rAGAK8Bx8l+pCz992qQSSTJiW3uGPoyOuzW+xSAaSxW85ZOYvpy3zOYSZZvUic5b15BBK5MfFmVABIAfwnEXynfSbI7ejj7C+xJLFUaJhIiajLWModwb5vlYTmzZbRrBTJlcBIEvBnLLprRrU2i7N8tiH2/zSUZl8YB0AlrLaMvm+FhERqy0gG47cNFQAyFIoB1YceCki+AFZHnt+m2QhmTxnHBCGstoy+T76AMzDZcMRbaa9nYuqXpNNLknkwQ7P/HJJZNknRlomvu+G+rIPAbJlsul9N6T5Yh6ucY17P4kkDwBcqPZ/Noha+5Lo+OPzsj337z6fNyqbfxJIzVmIl2STj3yfRgGmyiYYdp5R1f8shYIOJc9W/WURIettmWXLKrRnD/j/84yVfUZTNSbkqwEwCaOlfUzdS9myZeR/4u1/unscSqXMTx+VsVQ64cuPRQHyTWqD76MGIKSrAeAginfCZwKla6Tp8p/WGwQZSy+JwingTft24bncziGmYgzXh4UkefTChor9eZKU3eOm7g8Owcqyz0mvOGS0ZJVeUG8FlNGmyfexnoMd4i0UNriZmgoAk2CKxqq+jFV/VZNuy/cTMlqyyieZvxLJadMHUx+A43vIl4o0TgFSAWA8iDidFx2jgdmAw5JVnSg8vgThZvLZNMqpgkYB5AsAKdUEGG89bUetWoXJNrPG35P5O8lKMssso9eyCTltOo6VwPJtBa5FzAGvC0hmfuhBlnboLxtuQZQ5my5O3JfSpuH71Ako3VkApmGqJkDa6tr6ErWYZSfliU25HINkJtlzpSmnZzLaNPk++gDkawIYmqECQNo7BNMC9/Yfc+wgyz6mg1OfUto0fJ/6AKSrAex+5VUVAFAwy7cMTEeUDuxRXCQ76eCUEwWZjqQ2jRqAuqRFIB6J/xOEky5AFwBYLK1DAVlUUi8RoACQ8JKhHV4zZs/Cevfyvo6774UY2tGunfTrFbqkA+niFT9Z+Uhq0wkaBRiRDTTd1Ms+AHxs7rzzUDbBrz5DB0sX2YzMY3mktGn4voZ1ytLVADRdK/sAoGn+bffttG+ESZdisZHRpsn3aRRAuhoAN8s7ADT3Gqdi1V+IhtB47ahOxbpP8PNJadPwfSn7AFIRVtY1gAjzf7tvp10ujDoVgpGkNp3ARCAxXIgiXqTlJi/bALBy2yCm/PLPeIGztzz4Z0Z185arLNxktGnyfaoBvCcLSGNycGGWbQCIRvTL0fmHF2bILuhk6RYyteyqI6lNv0edgO/YVcKrdFxj1V7xkolPbe/rVVg29iWZZHJUFuhm6ego0WAQk9Gm4ftvowbApdupxGRcul2KvDCz6WLq57GSTr79GRxSnnQjHR0iFygycto0fwfzAOTbfkvj/OhAla5TwoZo6C8rJOWgYwblpbRp+D71AUhXAxBCHJMBw1Dfau0xVuCcPWz6Ge6LdCRdw63l/tpJatNva8KUrwaAI6/LrwbAwzf0t78bpO+Uk65jIEho0+T7qAFob4zJKMsnVpFNadkyeKQs8rgtR1P38CcQ9Frd5iMNfehq6SyNQO4KQrZMNu0ul2Koa29oKZ7aWUxWt/MITS+bZoAWi14JA8G/8rhIV9K5PLTFxvuS2jL5vtaf2POKjAUR0cqjH6BlyzsHoBp2iYxl4KZMpDPp7iYPWWjLasvk+9qTDbOGhGC7ZQFrTA7sWFoeNQC95gt495ffxCfSmXQvg0tGWyafJ99HIKZL7LI+JPoP1cTwB4DVqzUutMslgt1TUSzdgYGnTH1gJqctj/p8GnwuXz8A5yf4UFaesmxu+84/YHLMxz1lKhEz0p0wkEgkd0SR0pZHfd4KADi04GV3NC+J6swVW4YlPAa7JJ0mZMbrP7Abfk5QpIQfYccgbcMzS4DIlaxjPj8aAEzzeVe4lEhUj2jLSiQhbfaVPSPHY7us0OpnF3jCgLCwmz5o6WS1YZH2eSsA8BR7VkpgeXgDQJTLf9KvVzYRaiwkteExn7cCwNBQ90tYGSTdzkDoHW+EEaIPJVzX8q0fHgqlLgyXVsVrQ1gQJsVTkDYnZj5bNiyVgOTr5PMklBUAHm9sTDIhXpRKSggDwzgM1cPjZJOrVHnikcrLoFxlqXRCkx9YWJiERqFRRVp70cyDDUunFnzd8nkIZgWAUQG5lM2AaMjayUu7uqIIbf8snVH4LhD/51FsfBfEQQF4o4PEHCT1ka/vCwA4zFHKAABnWeag5r6TqpzScBaGv8pmnYNdwAkTwsZu+mCkk9N2x/v6uADAtsoIKnqJT2MhmiyiRYJ71p/b9hEqbGiSF9muhBf6APb5+r4AMNz/Wi9kle6MAMh0UHPbt5dIiGPBIjVvS9SjRrO44Ixlk4EvHsUo+AqnbfYgCTVJpH3dEm1fAHi8cS52BxZ9EgrMcLDERTLKVahMEU29/fNhFhaM5LVZ0Tfq66MlsS8A0E9TsM35CsiP51ywsxd3vxroXvOm3r2Ho+p1jh/4BYknYURYBUnmybKSrZLNTr4vw+/JPj4hAKB6KmUAwJBZzcH6tDNlALBYGaIs9k/o6NKLzV8u+QgjwirI+lq2Sqsdpbwm+vjEADA4JGcAICA1LbDNgJaOHXHB+VektAcJhSKsCDMJRbMnksy2OsnHJwSAziU1b2FCkJTrArjgK1q3DcywVwJypeLTZ5+PCSHT5JJKXmkIK8JMXgmzS0Y2SraaPYWPT+Dblo+PE2FCAKD72Cigc9xzeb7SaTla/AJ5BCpAEsHLftVfAWiNJg0qZmSjkp7slMm39wsAaIPJGQBgFpAtcM2A1m3GEowHLyjYAco8A2FG2AUNBpltNJNv7xcAdrNnNgH0ATmB5ye29SWCdWx2pIy2+3baaAKG3aht8hOdhsEhegNp355Abr8A0FdXZ+AQg8cmpJLph+DXySROLllaNw/NRnvw07nSqGfZESDsCMPsKSR7IrFtkk+Tb09GbL8AYCUQQtpmANoBq9qeHDl2siIy/hbxaDhP+vUKbLSlLQy94lcCH8smYZslkHA3axafzhgAjBHjIUzIwD8pL03EIt+SUrJxQq1ct3sKJoPLfdIvjfhIOuozBiVhSFiO/Zb1M22TGf3Jb5nJl8mnM8mRUeD1p055nQtBfQFyXoKdv3Lr0Fw5hRuVKnLoIdRhKd1ccPQEv4u//5tKmSe31+kn0B99p3v0TEJMD0pjKaFooyJZtgiblFVA8mXy6UzyZQwAlBCbBt6bKYMM99CbGdWjusx9ATgOnktz8g0cmzZ86UCd7pxXXt5+eEdd9F/WnhzrGStL+k736BmlobRWnrEEPn+mscT0ADkvskWySTmly+3LWUFdvmVgeoVeQVEja5DwWeHE0EjiqA0NVX/3WY792Df3GU0Rxtfu98DrG6jeC87uZKmR33acXF3Q4S/WpKtI/POY034R+l1837QzxUTz2lp9ndcQ5uO3rHvwiMp47GWki+VL69Nzc9gYnvnYouo3M/HP6tyUAT2HT2TKJMm9WKWuXyOJLBPEAKj+TfwR7B1hsv8jkmY9Ve87avWbC3V+UobyUF6iQbSIJmoH70xQ1MMfvmKaQ8+0Dcrq/KjMiSeyOT+plTUAWDoLeZsBlnycX0YR2PouyX+tW4ePxpSlZi/Foeo6CrrdNNlnd728fWZHffTyjoUx2t/BkYtoEU2iTTyIl/dNBN48iq0jKjlCxLI92KAjxNwikseHc7ZbUsbQHyKxKT9D+6bCLflKostZVWUs9lPQkGeZrebhSb+jPfh3jCRHfpsrypeE8bjML5xzXOIFxu7HrfutJmI0/nl8v9iLJgLaqjhJzDpR+PJxIvn61bI92KCvQuRgjiA9TD6cIwltvJv7au1N3oUAIPUcfFOIps46/ZHcmrj/9PTedw+M8wNeA6dq17hRNZyz32P3htvba2NSbOAyOgNOuwRNhPMhm5vbew+MiA+PfLTukA9cw9cm4ZZeYyWGKKXrkxgvPgLA3ejczbn9fO4mAKjBuX45nqiM3zXO/l2G5aMxVvNF4OO486er+A+jHX42VcPba6NXyOL8ZA8kC8lEspGMaCI87FIToTqNsa9mSLZGNuerEDaY2/HdvDUA4tPWZ7yEGtg8Gzx9SwJlv4dawI2+CYBNINv+4Tt/wxtwrlMywJGewySOOxLJkd95UcV3Sm6iQ02EWDT+ORjYxVjYc4JjtAXb2f7wDz6BjWJNx2gWSAhv/+/i7f/9ArN5nFzsaK/V0R+V+7IVAFp6jGuxx9mPcpPy+algQ0bKOO6RhZU7/ZCkpTd5Jt4K/1Uyb1TxYdl3m6jir6uL/bVkehIQaOpNfFJj2iWobtJS2ZKbCNjW6jOdddEH/VCNJv3oEf0F6FHpB3+7PE1TfLOzXv9xvvR5mwBEIJUYvh1Vuv0WEuQj7ulzFEg0Ev2FpzzHMdNY8Sf9WlV8Jh5iKXYWVaNh3FeGxfkJItKFdCLdSEfsS/9QKU2EUrAeV2RFfbVsTHLnJ18ln7WjoK0aABFq7UveicTU6yv1hTbomRiy+pOXQjZvGZkf0SPPFMrTOqBBsDuSI8O/e+SUmj2F5g9y+pWb+6dF4xWfw5v0YhygN79QXVJG6sS1i+KeHmbjWC2vUGULTI9m4287aqM0FT3vZTsANG1NnBiNak/npeh3AsHeFObwgmImvxQreltf8tfI+wVb+QV7G45/N9r3t3fWx56ylSfkiVp6Eiehn+ASBAJqIky1qe5/ouOROl09uaytvrSKpyHfdE8YlsAkmTQXrFsYs/VCstUEIFlGCYpHS5DLm6xUQFr8bq9OE1ra++FUVLlyDpOOVnfFn1OMrdrNnp7ZUad/VTn/R+ZAWBAmhA1hhNnrf87XRCDMCfuPqLj4jU6mIpsKgPMDu0ftOj8hZrsGQImlmeNOwuS5hClu6KjXV+dJVvLjth7j20zjP8hMSDwDOe4QQyO/m7wZY+b06u4YAi0b+w/jlRhF0PjFMNMTx+5P+DTFd9rr9TUT7rnwo7XHWA05rneBtOMkC10zUVAAIGlbe41nHR3WcRyCfQQxa1Ws6KzVN+y74/CX2t5efQZfsAtkZ+4jPVrFvwsTKG7vODkmf5Npn+DyfmndlliAIHsJmggX4pU1/q3/+m7x9JxMO904pU1Ln7EMqxHXg57t2rJTvAulQ8PGqEkV1J9SsFJgckuhgvmUXsOWUnfReLRb/KeLE84G7ZmojtI2an+i4al0Ff9ryvmdQ52whGF/jbAljAlrwpywT5eBc8zGUSLbIRvCrYL9ZBwZ774KcXOhzApWrHPng3ehADAxSP4LU5hnVOjxu1zrD9Aip2G8/ioxOHQEDPRMGpt2820kP+LuSkjYEsaENWFO2DOUgStc0e4n2yEbcoW+w0TJJzt2Pnh3oWQLbgIQg9aekfO5FimYWaHCOZZeiOuxrPX7jtFThEKPQFuv8T0scrohKIoKM3VBR30ca0QKuwquARD5jvab7sVCYywMC8aFo6ZWN/eMnBcMaZWUfiNAtkI247cctvnDFy2ftJ3ho4RF1QAoe2tP8izse3X/R6Tk/ma1GYVow8gAdeioSyGQEQH0+K/Am78dVX89YwIJb9ICLEx++2MxohUdAMCMY0TgrxgRWFAMY5/yDGB3m0YnN8vwSQ/F1gUEWrcm6nhU6wJpx1d0uiCuRRJtf+og/SR+iGJ4FNUESDPChDZ2bTFMfcxTzaJah2w7y/iIh2KdRsCyCdgGfgbG+S3RR32wKOen/KUEAEbVaVrYYQkSkP9Q5TmMRaPrmnr3Hh4QkZWYLiNg2QJswrINl3k5SZ58r9QmbUkBgJQxjNTV+Eg4qZjbtFDQcyIstm5p13sHuc1L0ZcbAbIBsgWyCbkl3U+6RNr39ntQyI2SA8D6RRU7sBnHzwthKkNams1YdUB1uwoCMpSGPzJQ2ZMNBGRm6wSQyOfI9ybcLOJHyQHA4pn88EY0QgK3nBVTSxuqaqo3quZAEZYT8CxU5lT2ZANBU8XyNficE3I7EgA6Fx36IUuZMp/UkxUriv4RHu9WHYNZIQrdAyprKvMgvvmtwoCvWT7nQMmg6ePchWHBDQC10TmK3lFCVH2LJc1WNUToHeZ+cKKhPhoJguEf5gf/Unli2K8Lw37LSqUzlt+RGsAYsVQidRmGBofGfgfpkwyCxoCtiSBBElzJahsBKlsq46A6P/mW5WO2Nc6f0NEAsK6h4m/onFidn620KappFpiaNixt+RQtmFWmKFsQCNY4/ziNybfIx8bdKvmrowGApBka2PQTVFMCu9UVTQHVsNDJWgxCO8GoK9gI0HbtWNhDZRqk6b2TQSefIt+afL/U36gNOX+N7vGmbQ0y4KOoiMeGjZELg7Ynv/MlGkyK1vFltByc8eXB1CBthdZ+E+ZCN7aRc+UNR4IKbgZtmnAGG+HL49GKp2lXmAwP1S2JEaAyo7ILuvMTxORLbjg/0XYlABDhztrYz1Bt8XR7buLr9IVazAzaEor2hXNtYxGnhS5neqjyU1lRmVHZBR0K8iHyJbf0cKUJMCZs21/eP1hUVT8FJrPH7gX5E4XRxcyRC7zccjzIeHktO23dTbv3BnUoejJeGJp+hQ8OnNT+qYPem/zMqd+uBgASsrU3sRAVjb8Evz8gDTmdOyDYV7w+fMSpAg8rHexP8WnY2H9g01DX9oD0ErvRPQ/NT3XUxba6ydf1AEDCY4LQ1xGVb3VTEa9pozbQnkwlr/DrLEKv9ZWVH53VR8d1wb7aZJWxGLlgX1djwo/jvf6TZfEkABDT1j7jz5h3fcZkAQL9GxMzsCTzX8WeXTd3ts4bCbQuAROejujm0+Z8Azb1v/HWl/qgzkKhtZb51ur/WGi+YtK71gk4WZjUyOAlmMn035PvB/o3DA9vnhu16XOew5HRKwOtS4CEJ6wJc8I+bM5PPmL5ikfl4VkNgPRp3mos1iJ8I9pqUY/085aNYH8YSiSu2tBQ9XdvGZcHt2Xdg0dUxmI/hdN/Nowao92fNFNiydqF+pNe6edpACCl0BSgalvec8u9AsBxPoINYsfk24YM4xYVCJxB13J8Xb8G07Qvg/NXOUNVPiqo+l/bUasXfLhHKZp4HgAgLEcQuB9BAIdAhvpKYBjnN8mk8SPVUVhcOVMHnx7VaZn5JfiLFUclGLng/A/A+emkKZiNd5cfAYAt7dpZUXXAkdiGiS/xTlV/OFG1Dm+t3/NE6qb2xfEX/ZEiWFzbnhw5VsQi34IrnB/a5uK4IoHzbxz88LWmxxvnDo+77clXXwIAaXZ677sHxngN7chS0GGGnqDiDhOcVSoeYFz8sL021ucOi2BTbetL1GLe63Wo6lPt0LMOaj9Rg/M/mxD9Sx6tO+QDP+TwLQCQsrQtk7UzC2Nz/FDeP544NlywOzGr8O5yn1WYnr13Ad70F6F1mPkYcP8KylXOqOvvSomRhnV1U95wlVEO4r4GAJJrxZbheboe3QxBArlDSw5s8z8SLCW4WM9M8873jD0PPtkwK5CbqeRXdGKKxd2vVh6sTzuTadpFOH0XJ/GwyMQU4f8F53/LMJKnOLGxZylo+R4ASPggnshSCugZ8wrWLzi73zTFnWvb12zEwiMzY7qg3sQinea2by/RNA6nZ2fD6WuCqooDcktzQpUUAYAAbesxTmeatWNLqHt7bRrP+5gK+gQ6hDckhdjwSH38BeTztHfYppy5kvGVPSPHRTlfhqr9MkzaOQ2J1TkMdIaGKdra6/VHc4Hn1TNpAgApTNs2WTu3wGK8AiAIfKi6CPfvYsLcYKTMDX5XG7NhZjXnItoyxumPNaIQy69Zlw0c3Ec5ChPHeK+tj9+TI5mnj6RztLbexBUwoMAdNOJpqTH2OkYUnoNBbedMbE+ZfDs3je2di6pe80KOli2DRwpNPyaiiWME48fAiI5Bz/0J4D3TC/6B5SHMK9vrYr+QSX7pAgCBg4lC12N4cLVMQAVBFgSEvVyI7XBK/IkdGhNvo1+hn5ka+hdEv0ixfi1iDpiG2W9oRv/uV17tJ71mzJ5Vo5t6jaZrNWZKq+YRVoPOuRqmmfhkNSbjU1Ee8xBsjhHccvgpQcBDKhmFuL69Tv++VDJBGCkDAIFENQHBtX+DgNLKKFthKnnkQ4Cq/VyYX5XtzT+GlNTORX0CES1yB4RVHYNjJaY+g4RAImWmLpapzT8ZPKkDAAmbHh34L3wN7H7uk0FXv8sCgQH09n9Glt7+bIhLHwBI8KAf55QNfHU/nAig2h+YY+YCEQDITNIzBh+BwHPCaTZKqzAgAOffhRl+K2Udqp2McWAWXBCgNG+aFk9MVkL9VgjIgADZJtloUJyfMAtMACBhadEErZwC0Bvpt7oUArIgQDZJtunnwp5isAhUACAFadkkrZ0G4A8Uo7DKoxBwGgGyRbJJv5b0lqJPYPoAMijJW3qwvRjna8ph04gM+qtbPiNAm71gzca3O+utbbzQ/A/eFeQAYKFNG41GIvweTBf6WPDgVxIHFgHavTclzvNyA083sApcE2AyCFQAycTek1ANe2jyM/VbIeAGAmRrZHNBd37CJvA1gHEFzLFf/NcxZ/0mNAn0cffVV4WAIwigym/A+b/VOXpiTyCr/JOBCFMAsHSzziLk2r1QbPZkZdVvhUCxCMDbX8Fi3nPdPquvWPmKzRf4JsBkxamA6ERVdM4E/mjyybqp3/4gQLZENhU25yc0Q1cDGG8irT2Jq7C3wI9Uk2A8Kuq7XQSoyo+3/jc76nEaUUivUAcAKrOWnsRJGCr8Nf5OCmkZKrVcQABv/afw98XO+thTLpCXhmTomgCTkaUCHOzfdDI22/wm9mQqi113J2OgfheAAGyEbIVsJuzOT6iEvgYwvuibuoc/EYlFbkNtoHH8ffVdIUAI4I3flUqkLlvXUPG3ckGkrALAWKGiWfAFrmk3QflpY/fUZ/kigB7+PSxlXtdxcuw35YZC6JsAmQoUVbv/FMYH80whbsHzRKY06l5ZIJAgGyBbKEfnpxIuyxrAeNMe3WcgcismEJ0x/r76Hm4EaDafYaSuDtLSXTdKpOwDwBiorT0GHVH1Y/QPLBi7pz7DhwDa+U+jM/jajnp9ffi0K1wjFQAmYsZbe5KrOBc3YJ/74yY+Ur8CjYAQLwjBr++oj9IycjT71UUIlGUfQI6iFzCQP7Y/vGa+wAkueFu8lCOtehQABKgMqSypTKlsIbJy/nHlpmoA48DY7+t990Va5p55ocb5N1AjOH6/5+qGvAgI8Tw6+G7u3PngXeycc1LyCuqvZCoA2MS/uc9owhnW16Df9HSbWVQyXxAQj8Lbb1lbq6/zhX3AmKoAUGCBNW1NnBiJalejInmeWmNQIHguJbfm7HN2Typp3rpuYewZl9iEkqwKAEUW6/ItA9NjkfjFmsa+hFrBvCLJqGwlISB2mCb7VSI1csdji6rfLIlUmWZWAcCBgm/uMZain+DLGEY8C4DGHSCpSGRBAD14I6h9/RHt+1+urdcfz5JM3baJgAoANoGyk6yp+4NDIrHKc1AjOAfzCU5DHjXKYge4/Gng7+IJdODfl0oM3beu4cB382dRKewgoAKAHZSKSNO6bWAGi8TOwjHb5+JI7VMBtMK6ABzxpsepumIT/ruXpRJ/7Di5encB2VVSmwgoo7QJVCnJVmzaO1OP62dgKLEFNYPloKUOOs0M6ADe9I9hWV6nMWI8tP7UKa9nTqbuOoWACgBOIWmTznH3vRCbc9TRp6DnGsGAtZT9/AKM1wOLTmDRuZs9s6mvrs6wCaVK5gACKgA4AGIpJFo29h/GqipPQY33FI0zfPJa0IuVQlPivFh5KfpMwTZDz81scGhz55KatySWN/SiqQAgWREv7dpZUVFzZB0KZiFWKM6Hw8xHLeFY/A7U6MJob714EY7+LFbe4Y9tHe5/rffxxrnDkkFe1uKoABCA4l/a1RWtrGw4WkTYfGxkcjw6Fo9CYJgL55qDqvMMP1VA9R2dc2IXZNmJDruXhWk+z1Ps2aGh7pceb2xM+imb4p0fARUA8mMkdYrF3a9W1sSmzY6ICAKCeTjX+KEQeCr60PEppqKA6ffBgvEKfMYxFhHDvRjG0qlGMdbUSOD+CN7SCdynDVJGOBP0pn4P996Bc7/NuMAne1uY9Km9keKpnf2JPa882TBL7bMIYIJ6/X8QmpCW0hsGOwAAAABJRU5ErkJggg==")};n.prototype.setScene=function(t){this.createCpm(t),this.createBunnyObj(t)},n.prototype.updateModel=function(){this.model=this.modelManager.getActiveModel()},n.prototype.bindEvents=function(){this.modelManager.on(T.ActiveModelChanged,this.updateModel.bind(this))},n.prototype.updateDefaultsFromModelData=function(){this.model.data},n.prototype.pointPathDistance=function(t){for(var e=0,i=1;i<t.length;i+=1)e+=t[i-1].distanceTo(t[i]);return e},n.prototype.pointPathLengths=function(t){for(var e=[0],i=1;i<t.length;i+=1)e.push(e[i-1]+t[i-1].distanceTo(t[i]));return e},n.prototype.interpAlongPath=function(t,e,i){var n,r=new o.Vector3,a=e[e.length-1];if(i<1){n=i*a;for(var s=1;s<e.length;s+=1)if(e[s]>n){var l=(n-e[s-1])/(e[s]-e[s-1]);return r.copy(t[s]),r.sub(t[s-1]),r.multiplyScalar(l),r.add(t[s-1]),r}}else r.copy(t[t.length-1]);return r},n.prototype.pathHeight=function(){return this.player.mode!==r.FLOORPLAN?l.path.height:l.path.outsideHeight},n.prototype.createBunnyObj=function(t){this.bunnyObj||(this.bunnyObj=new o.AxisHelper(.1),this.bunnyObj.visible=l.warp.showBunny),this.bunnyObj.parent&&this.bunnyObj.parent.remove(bunnyObj),t.add(this.bunnyObj)},n.prototype.createCpm=function(t){if(!this.currentPanoMarker){var e=this.makeWaypointObj(M.pathEnd,"Current");e.material.uniforms.opacity.value=0,this.currentPanoMarker={mesh:e,placed:!1}}this.currentPanoMarker.mesh.parent&&this.currentPanoMarker.mesh.parent.remove(this.currentPanoMarker.mesh),this.placeCpm(),this.currentPanoMarker.mesh.parent||t.add(this.currentPanoMarker.mesh)},n.prototype.placeCpm=function(){l.path.mapGuides&&this.player.currentPano&&this.player.currentPano.isAligned()?(this.currentPanoMarker.mesh.parent!=this.player.currentPano.floor&&(this.currentPanoMarker.mesh.parent&&this.currentPanoMarker.mesh.parent.remove(this.currentPanoMarker.mesh),this.player.currentPano.floor.add(this.currentPanoMarker.mesh)),this.currentPanoMarker.mesh.position.copy(this.player.currentPano.floorPosition).sub(this.model.position),this.currentPanoMarker.mesh.position.y+=this.pathHeight(),this.currentPanoMarker.placed=!0):this.popOutCpm()},n.prototype.fadeInCpm=function(t){this.player.mode===r.PANORAMA&&this.player.currentPano&&!this.player.currentPano.isAligned()||l.path.mapGuides&&this.currentPanoMarker.placed&&d.start(u.property(this.currentPanoMarker.mesh.material.uniforms.opacity,"value",1),t)},n.prototype.fadeOutCpm=function(t){d.start(u.property(this.currentPanoMarker.mesh.material.uniforms.opacity,"value",0),t)},n.prototype.popInCpm=function(){l.path.mapGuides&&this.currentPanoMarker.placed&&this.fadeInCpm(2)},n.prototype.popOutCpm=function(){this.fadeOutCpm(2)},n.prototype.brushPrefs={linewidth:7,strokeWidth:15,cvSegments:48,paveStep:.1,paveWidth:.2,lookBlendDist:3,maxTurn:o.Math.degToRad(2)},n.prototype.panoPathDistance=function(t){var e=this.model.panos;if(!t||t.length<2)return 0;for(var i=[],n=0;n<t.length;n+=1)i.push(e.get(t[n]).floorPosition);return this.pointPathDistance(i)},n.prototype.loadTileTexture=function(t){var e=g.load(t,function(e){e.wrapS=o.RepeatWrapping,e.wrapT=o.RepeatWrapping,e.needsUpdate=!0,w.debug('path texture "'+t+'" is ready')},function(){w.error('path texture "'+t+'" failed')});return e.mapping=o.UVMapping,e},n.prototype.buildWarpDestinationDescriptor=function(t,e,i,n,o,r){return new p({cameraMode:n,position:t,quaternion:e,panoId:i,orthoZoom:r,floorVisibility:o,thumbUrl:null,name:null,isHero:!1})},n.prototype.buildWarpDestinationDescriptorFromHero=function(t){return this.buildWarpDestinationDescriptor(t.position,t.quaternion,this.getHeroId(t),t.cameraMode,t.floorVisibility,t.orthoZoom)},n.prototype.setWarpDestination=function(t){this.warpDestHeroLoc=t},n.prototype.setWarpDestinationByHeroIndex=function(t){var e=this.getHeroDescriptorByHeroIndex(t);return null!==e&&(this.setWarpDestination(e),!0)},n.prototype.setWarpDestinationByPano=function(t,e){return!!this.model.panos.get(t.id)&&this.setWarpDestinationByPanoId(t.id,e)},n.prototype.setWarpDestinationByPanoId=function(t,e){var i=this.model.panos.get(t);if(i){e=e||new o.Quaternion;var n=this.buildWarpDestinationDescriptor(i.position,e,i.id,"panorama",[],-1);return this.setWarpDestination(n),!0}return!1},n.prototype.getHeroDescriptorByHeroIndex=function(t){var e=this.model.heroCount();if(null!==this.warpDestHeroLoc&&e<2)return w.info("ShowPath.getHeroDescriptorByHeroIndex() -> Only one hero location is available."),this.model.getHeroDescriptorByIndex(0);var i=this.model.getHeroDescriptorByIndex(t);if(i){var n=i.isPano()?i.panoId:i.cameraMode;w.debug('ShowPath.getHeroDescriptorByHeroIndex() -> New brush/warp destination: "'+n+'" out of '+e+" choices.")}return i},n.prototype.getHeroDescriptorByPano=function(t){return this.model.panos.get(t.id)?this.getHeroDescriptorByPanoId(t.id):null},n.prototype.getHeroDescriptorByPanoId=function(t){var e=this.getHeroIndexFromPanoId(t);return this.getHeroDescriptorByHeroIndex(e)},n.prototype.getHeroIndexFromPanoId=function(t){for(var e=0;e<this.model.heroLocations.length;e++){var i=this.model.heroLocations[e],n=this.getHeroId(i);if(n&&n===t)return e}return-1},n.prototype.getHeroPano=function(t){if(null===t)return w.warn("getHeroPano(): no destination"),null;var e=this.getHeroId(t),i=this.model.panos.get(e);return void 0===i&&(i=null,""!==e&&w.debug('unable to find pano "'+e+'"')),i},n.prototype.getHeroId=function(t){return t.panoId},n.prototype.setWarpDestPano=function(){return this.warpDestPano=this.getHeroPano(this.warpDestHeroLoc),this.warpDestPano},n.prototype.brushToWarpPano=function(t,e){if(this.discardPathObject(),!this.setWarpDestPano())return!1;if(this.warpDestHeroLoc.cameraMode!==r.PANORAMA&&w.warn("Can only brush from pano to pano"),!this.warpDestPano)return w.info("No brush"),!1;if(!this.player.currentPano)return w.debug("No current pano, visibility undefined"),!1;if(!this.warpDestPano)return w.info("No wPano, visibility undefined"),!1;if(!this.warpDestPano.isAligned())return w.debug("Cannot brush to unaligned pano"),!1;var i=(t===s.STD||t===s.WALK)&&l.path.mapGuides,n=!0;if(this.player.currentPano.id===this.warpDestPano.id)w.debug("Already at destination pano");else{this.nodes=this.findShortestPath(this.player.currentPano,this.warpDestPano),n=void 0===this.nodes||null===this.nodes||this.nodes.length<1,this.obj3d=new o.Object3D,w.debug('Brushing from "'+this.player.currentPano.id+'" to "'+this.warpDestPano.id+'" ('+(this.nodes?this.nodes.length:0)+")"),n?(w.info('No "walkable" route, using fall-back warp style transition'),t=e):(this.setPathHulls(this.nodes),this.setFloorCurves(),i&&("chevron"===l.path.style?this.obj3d.add(this.drawPathPavement(this.floorCurvePoints)):"ribbon"===l.path.style&&this.obj3d.add(this.drawPathRibbon(this.floorCurvePoints,this.floorCurveColors)))),this.player.currentPano.floor.add(this.obj3d);var a=this.player.mode===r.DOLLHOUSE||this.player.mode===r.FLOORPLAN;if(!n&&(i||t===s.STD)){if(a){var c=this.makeStartMarker(this.floorHull[0],this.floorCurvePoints);this.obj3d.add(c)}var u=this.makeEndMarker(this.floorHull[this.floorHull.length-1]);this.obj3d.add(u)}this.appearSlow()}return this.upcomingTransType=t,!n},n.prototype.findShortestPath=function(t,e){if(!t||!e)return null;var i=l.warp.walkExtraPanosDistance,n=t.id+":"+e.id+":"+i;if(this.shortPaths.hasOwnProperty(n))return this.shortPaths[n]?this.shortPaths[n].slice():null;var o=e.id+":"+t.id+":"+i;if(this.shortPaths.hasOwnProperty(o))return this.shortPaths[o]?this.shortPaths[o].slice().reverse():null;var r=this.model.panos.aStarSearch(t,e);return this.model.panos.includeNodesNearPath(r,i),this.shortPaths[n]=r?r.slice():null,r},n.prototype.makePathHulls=function(t){var e,i,n,o,r,a=0,s=[],c=[],u=[],h=this.model.panos;o=(e=h.get(t[0])).floor.floorIndex;for(var d=0;d<t.length;d+=1)(i=(e=h.get(t[d])).floorPosition.clone().sub(this.model.position)).y+=this.pathHeight(),s.push(i),c.push(e.position.clone()),n=e.floor.floorIndex,u.push(o<n?l.path.colorUp:n<o?l.path.colorDown:l.path.color),0<d&&a<(r=c[d].distanceTo(c[d-1]))&&(a=r);return a>this.longestStep&&(this.longestStep=a,w.debug("path contains "+a+" meter segment")),{floor:s,camera:c,color:u}},n.prototype.makeFloorCurves=function(t,e,i){var n=this.player.mode===r.PANORAMA?l.path.waypointIndoorRadius:l.path.waypointRadius,a=this.pointPathDistance(t)-2*n,s=t.slice(0),c=s[1].clone().sub(s[0]);c.y=0,c.normalize().multiplyScalar(n),s[0]=(new o.Vector3).copy(s[0]).add(c),(c=s[s.length-2].clone().sub(s[s.length-1])).y=0,c.normalize().multiplyScalar(n),s[s.length-1]=(new o.Vector3).copy(s[s.length-1]).add(c);var u=new o.CatmullRomCurve3(s),h=Math.floor(a/i);h=4*Math.floor(h/4),h=Math.max(4,h);for(var d,p,f=u.getSpacedPoints(h),m=[],g=new o.Vector3,v=0;v<f.length;v+=1){p=0,d=f[v].distanceTo(t[0]);for(var y=1;y<t.length;y+=1)g.copy(f[v]).sub(t[y]),g.y*=4,g.length()<d&&(p=y);m.push(e[p])}return{distance:a,points:f,colors:m}},n.prototype.makeCameraCurvePoints=function(t,e){var i=this.pointPathDistance(t);return new o.CatmullRomCurve3(t).getSpacedPoints(Math.max(2,Math.floor(i/e)))},n.prototype.makeCameraCurveTangents=function(t,e){var i=this.pointPathDistance(t),n=new o.CatmullRomCurve3(t),r=Math.max(2,Math.floor(i/e));r||(r=5);for(var a=[],s=0;s<=r;s++)a.push(n.getTangentAt(s/r));return a},n.prototype.setPathHulls=function(t){var e=this.makePathHulls(t);this.floorHull=e.floor,this.cameraHull=e.camera,this.colorHull=e.color},n.prototype.setFloorCurves=function(){var t=this.makeFloorCurves(this.floorHull,this.colorHull,this.brushPrefs.paveStep);this.floorPathDistance=t.distance,this.floorCurvePoints=t.points,this.floorCurveColors=t.colors},n.prototype.setCameraCurvePoints=function(){this.camCurvePoints=this.makeCameraCurvePoints(this.cameraHull,l.warp.stepFactor*this.brushPrefs.paveStep)},n.prototype.chooseWarpPath=function(t){var e,i,n,a=this.player.cameras[r.PANORAMA];if(this.player.currentPano===this.warpDestPano||!t)return this.warpPathPoints=null,this.warpLength=0,!1;this.nodes=this.findShortestPath(this.player.currentPano,this.warpDestPano),void 0===this.nodes||null===this.nodes||this.nodes.length<1?(w.debug("warp path to unreachable node"),i=(e=this.warpDestPano.position.clone().sub(a.position)).clone().negate(),e.multiplyScalar(.15).add(a.position),i.multiplyScalar(.15).add(this.warpDestPano.position),e.y=a.position.y,i.y=this.warpDestPano.position.y,n=new o.CubicBezierCurve3(a.position.clone(),e,i,this.warpDestPano.position.clone()),this.warpPathPoints=n.getSpacedPoints(this.brushPrefs.cvSegments)):(w.debug("follow warp path (path distance was "+this.nodes.length+" nodes, "+this.floorPathDistance+")"),this.setCameraCurvePoints(),this.warpPathPoints=this.camCurvePoints.slice(0)),this.warpLength=0,this.warpPathLengths=[0];for(var s=new o.Vector3,c=new o.Vector3,u=Math.cos(o.Math.degToRad(l.warp.minBrakeAngle)),h=Math.cos(o.Math.degToRad(l.warp.maxBrakeAngle)),d=1;d<this.warpPathPoints.length;d+=1){s.copy(this.warpPathPoints[d-1]).sub(this.warpPathPoints[d]);var p=s.length();s.y*=l.warp.climbEffort;var f=s.length()/p;if(1<d){s.setY(0).normalize(),c.copy(this.warpPathPoints[d-2]).sub(this.warpPathPoints[d-1]).setY(0).normalize();var m=Math.min(1,s.dot(c)),g=1+(l.warp.brakeStrength-1)*(1-o.Math.smoothstep(m,h,u));f=Math.max(g,f)}this.warpLength+=p*f,this.warpPathLengths[d]=this.warpLength}return!0},n.prototype.drawPathRibbon=function(t,e){this.bunnyObj.visible=l.warp.showBunny;for(var i=.6*l.path.ribbonWidth*.5,n=new o.Vector3,s=new o.Vector3(0,this.pathHeight(),0),c=new o.Geometry,u=new o.Vector3,h=0;h<t.length;h+=1){u.copy(t[h]),0===h?u.sub(t[h+1]):u.sub(t[h-1]).negate(),u.normalize(),n.crossVectors(u,y.UP),n.multiplyScalar(i);var d=(new o.Vector3).copy(t[h]).add(s);d.sub(n),c.vertices.push(d),(d=(new o.Vector3).copy(t[h]).add(s)).add(n),c.vertices.push(d)}var p,f,g,v=0;for(h=0;h<t.length-1;h+=1){var b=2*h,w=v,x=v+=t[h+1].distanceTo(t[h]),_=e[h],S=e[h+1];(p=new o.Face3(b,b+1,b+2)).vertexColors=[new o.Color(_),new o.Color(_),new o.Color(S)],c.faces.push(p),c.faceVertexUvs[0].push([new o.Vector2(0,w),new o.Vector2(1,w),new o.Vector2(0,x)]),(p=new o.Face3(b+2,b+1,b+3)).vertexColors=[new o.Color(S),new o.Color(_),new o.Color(S)],c.faces.push(p),c.faceVertexUvs[0].push([new o.Vector2(0,x),new o.Vector2(1,w),new o.Vector2(1,x)])}c.computeFaceNormals(),c.computeVertexNormals(),f=this.player.mode===r.PANORAMA?((g=o.UniformsUtils.clone(m.ribbon.uniforms)).map.value=M.path,g.opacity.value=0,g.color.value.set(l.path.color),new o.RawShaderMaterial({side:o.DoubleSide,depthWrite:!1,transparent:!0,vertexShader:m.ribbon.vertexShader,fragmentShader:m.ribbon.fragmentShader,uniforms:g,name:"ribbonT",opacity:0})):new o.MeshBasicMaterial({color:16777215,side:o.DoubleSide,name:"ribbonOut",vertexColors:o.VertexColors});var T=new o.Mesh(c,f);return T.name="ribbon",this.player.mode===r.PANORAMA&&(T.renderOrder=a.ribbon),T},n.prototype.drawPathPavement=function(t){for(var e,i=new o.Vector3,n=new o.Geometry,a=new o.Vector3,s=0;s<t.length;s+=1)a.copy(t[s]),0===s?a.sub(t[s+1]).negate():a.sub(t[s-1]),a.normalize(),i.crossVectors(a,y.UP),i.multiplyScalar(this.brushPrefs.paveWidth),(e=(new o.Vector3).copy(t[s])).sub(i),n.vertices.push(e),n.vertices.push((new o.Vector3).copy(t[s])),(e=(new o.Vector3).copy(t[s])).add(i),n.vertices.push(e);var c,u,h;for(s=0;s<t.length-1;s+=1)c=3*s+1,h=.25+(u=.25*s),n.faces.push(new o.Face3(c-1,c,c+3)),n.faceVertexUvs[0].push([new o.Vector2(0,u),new o.Vector2(.5,u),new o.Vector2(.5,h)]),n.faces.push(new o.Face3(c+3,c+2,c-1)),n.faceVertexUvs[0].push([new o.Vector2(.5,h),new o.Vector2(0,h),new o.Vector2(0,u)]),n.faces.push(new o.Face3(c+3,c,c+1)),n.faceVertexUvs[0].push([new o.Vector2(.5,h),new o.Vector2(.5,u),new o.Vector2(1,u)]),n.faces.push(new o.Face3(c+3,c+1,c+4)),n.faceVertexUvs[0].push([new o.Vector2(.5,h),new o.Vector2(1,u),new o.Vector2(1,h)]);var d=this.player.mode===r.PANORAMA?new o.MeshBasicMaterial({color:l.path.color,side:o.DoubleSide,transparent:!0,depthWrite:!1,opacity:0,name:"paveT",map:M.path}):new o.MeshBasicMaterial({color:l.path.color,side:o.DoubleSide,transparent:!0,depthWrite:!1,opacity:1,name:"paveO",map:M.path});return new o.Mesh(n,d)},n.prototype.hintPrefs={rad:.18,width:.0125,depth:.0625,setBack:-.04,markRad:.25,markInnerRad:.16},n.prototype.makeWaypointObj=function(t,e){var i=new o.Geometry,n=this.player.mode===r.PANORAMA?l.path.waypointIndoorRadius:l.path.waypointRadius,a=this.pathHeight();i.vertices.push(new o.Vector3(-n,a,n),new o.Vector3(-n,a,-n),new o.Vector3(n,a,-n),new o.Vector3(n,a,n)),i.faces.push(new o.Face3(0,1,2),new o.Face3(2,3,0)),i.faceVertexUvs[0].push([new o.Vector2(0,0),new o.Vector2(1,0),new o.Vector2(1,1)]),i.faceVertexUvs[0].push([new o.Vector2(1,1),new o.Vector2(0,1),new o.Vector2(0,0)]);var s=o.UniformsUtils.clone(m.waypoint.uniforms);s.map.value=t,s.opacity.value=0,s.color.value.set(l.path.color);var c={side:o.DoubleSide,depthWrite:!1,transparent:!0,vertexShader:m.waypoint.vertexShader,fragmentShader:m.waypoint.fragmentShader,uniforms:s,name:"waypoint",opacity:0};this.player.mode!==r.PANORAMA&&(c.depthTest=!1,c.name="wayPtOut");var u=new o.RawShaderMaterial(c),h=new o.Mesh(i,u);return h.name=e,h},n.prototype.makeStartMarker=function(t,e){var i=(new o.Vector3).copy(e[1]).sub(e[0]);i.y=0,i.normalize();var n=Math.acos(i.x),r=this.makeWaypointObj(M.pathStart,"Start");return r.rotateOnAxis(new o.Vector3(0,1,0),n),r.position.copy(t),r},n.prototype.makeEndMarker=function(t){var e=this.makeWaypointObj(M.pathEnd,"End"),i=this.model.panos.get(this.nodes[0]).floor.floorIndex,n=this.model.panos.get(this.nodes[this.nodes.length-1]).floor.floorIndex;return i<n?e.material.uniforms.color.value.set(l.path.colorUp):n<i&&e.material.uniforms.color.value.set(l.path.colorDown),e.position.copy(t),e},n.prototype.pathClean=function(t){if(t){for(var e in t.children)this.pathClean(t.children[e]);t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose()}},n.prototype.discardPathObject=function(){if(this.obj3d){var t=this.obj3d.parent;t&&t.remove(this.obj3d),this.pathClean(this.obj3d)}this.obj3d=null,this.popInCpm()},n.prototype.discardSlow=function(){if(this.obj3d){if(this.player.mode!==r.PANORAMA)return void this.discardPathObject();for(var t,e=0,i=function(){this.discardPathObject()}.bind(this),n=0;n<this.obj3d.children.length;n+=1)void 0!==(t=this.obj3d.children[n]).material&&!0===t.material.transparent&&(void 0!==t.material.uniforms?d.start(u.property(t.material.uniforms.opacity,"value",0),l.path.fadeOutTime,i,0,h[l.warp.blendEasing]):d.start(u.property(t.material,"opacity",0),l.path.fadeOutTime,i,0,h[l.warp.blendEasing]),e+=1,i=null);0===e&&this.discardPathObject(),this.player.mode!==r.PANORAMA&&this.fadeInCpm(l.path.fadeInTime-3)}},n.prototype.appearSlow=function(){var t;this.fadeOutCpm(l.path.fadeInTime);for(var e=this.player.mode===r.PANORAMA?l.path.opacity:1,i=0;i<this.obj3d.children.length;i+=1)void 0!==(t=this.obj3d.children[i]).material&&!0===t.material.transparent&&(void 0!==t.material.uniforms?d.start(u.property(t.material.uniforms.opacity,"value",e),l.path.fadeInTime,null,0,h[l.warp.blendEasing]):d.start(u.property(t.material,"opacity",e),l.path.fadeInTime,null,0,h[l.warp.blendEasing]))},n.prototype.update=function(){this.obj3d&&this.obj3d.updateMatrixWorld()},n.prototype.calcBurnsAmount=function(t){var e=o.Math.degToRad(l.warp.burnsAngle);if(this.player.mode===r.PANORAMA){var i=this.burnsDir*e;if(this.upcomingTransType===s.BLACK)return i;var n=t;if(null===n)return w.warn("Transition request for non-highlight"),i;var a=this.getHeroDescriptorByHeroIndex(n);if(null===a)return i;if(!a.isPano())return i;var c=this.getHeroPano(a),u=this.player.cameras[r.PANORAMA],h=y.FORWARD.clone().applyQuaternion(u.quaternion).setY(0).normalize(),d=Math.min(o.Math.degToRad(l.warp.minBurnsAngle),e),p=function(t){var i=Math.acos(Math.min(1,t.dot(h))),n=(new o.Vector3).crossVectors(h,t);return Math.max(d,Math.min(Math.abs(i),e))*Math.sign(n.y)};if(c==this.player.currentPano)return p(y.FORWARD.clone().applyQuaternion(a.quaternion).setY(0).normalize());var f=this.findShortestPath(this.player.currentPano,c);if(null==f||f.length<1)return w.debug("Empty path ahead..."),i;var m=this.makePathHulls(f),g=new o.CatmullRomCurve3(m.camera),v=Math.min(.1,l.warp.lookAheadDist/g.getLength());return p(g.getPointAt(v).clone().sub(u.position).setY(0).normalize())}if(this.player.mode!==r.DOLLHOUSE)return this.burnsDir;var b=this.player.cameras[r.DOLLHOUSE];return this.burnsDir*Math.min(b.controls.rotationAcceleration.x+.05,.02)},n.prototype.waitNextStep=function(t,e){var i=new o.Euler,n=new o.Vector3;if(w.debug("Starting wait: "+(void 0!==e)),2===this.player.currentPano.alignmentType)var a=Math.PI/8,s=l.warp.tourStepDelay*l.warp.waitMultiplier1;else a=this.calcBurnsAmount(t),s=l.warp.tourStepDelay;var c=function(){this.endWarpState(),this.player.mode===r.DOLLHOUSE&&(this.player.cameras[r.DOLLHOUSE].controls.rotationAcceleration.x=0),e&&e()}.bind(this),u=function(t,e){if(this.warpInterrupted)return c(),!0;var o=e||1e3/60;if(l.warp.doBurns)if(this.player.mode===r.PANORAMA){var s=this.player.cameras[r.PANORAMA];i.setFromQuaternion(s.quaternion,l.warp.eOrder);var u=l.warp.waitMultiplier2*o*a/l.warp.tourStepDelay;i.y+=u,n.set(0,0,-1),n.applyEuler(i),n.add(s.position),s.controls.lookAt(n),s.controls.lookVector.copy(n),s.lookAt(n)}else this.player.mode===r.DOLLHOUSE?this.player.cameras[r.DOLLHOUSE].controls.rotationAcceleration.x=a:this.player.controls[r.FLOORPLAN].absoluteScale*=.9996}.bind(this);this.startWarpState(),d.start(u,s,c,0,h.easeInOutQuad,"wait")},n.prototype.warpToNonPano=function(t){if(this.discardPathObject(),this.warpDestHeroLoc.cameraMode===r.DOLLHOUSE||this.warpDestHeroLoc.cameraMode===r.FLOORPLAN){var e=function(){t&&t()}.bind(this);this.player.flyToNewMode({mode:this.warpDestHeroLoc.cameraMode,duration:l.warp.outsideTime,warpDest:this.warpDestHeroLoc,callback:e,force:!0})}else w.warn("no warp destination!!!"),t&&t()},n.prototype._resetWarpShaderParams=function(t){this.player.mode===r.PANORAMA&&(void 0!==t.material.uniforms.blackout&&(t.material.uniforms.blackout.value=0),void 0!==t.material.uniforms.modelAlpha&&(t.material.uniforms.modelAlpha.value=0))},n.prototype._clearWarpShading=function(){for(var t=this.model.chunks,e=0;e<t.length;e+=1)this._resetWarpShaderParams(t[e]),t[e].visible=!0;this._resetWarpShaderParams(this.model.skybox)},n.prototype._warpStopFlying=function(){this.activeTransType=null,this.placeCpm()},n.prototype._wrapupTravelOnlyBits=function(){this._warpStopFlying(),this.warpPathPoints&&(this.player.currentPano.exit(),this.warpDestPano.enter(),this.player.currentPano=this.warpDestPano),this.player.spider.draw(),this.placeCpm()},n.prototype._wrapupTravel=function(t){this._wrapupTravelOnlyBits(),this.warpCameraAim(t)},n.prototype._wrapupWarpShading=function(t){this._clearWarpShading(),this._wrapupTravel(t)},n.prototype.wrapupWarpShadingOnly=function(t,e){e!==_.END&&this._clearWarpShading(),this._wrapupTravelOnlyBits(),this.upcomingTransType=null,t&&t()},n.prototype._warpCameraAim=function(t,e){var i=this.warpDestHeroLoc.quaternion,n=this.warpDestHeroLoc;n&&2==n.cameraType&&G.model.panos.forEach(function(t){t.id==n.panoId&&(i=t.quaternionAutoScene)});var a=this.player.cameras[r.PANORAMA],s=new o.Vector3(0,0,1).applyQuaternion(i).normalize(),u=new o.Vector3(0,0,1).applyQuaternion(a.quaternion).normalize().dot(s),p=o.Math.radToDeg(Math.acos(u)),f=new o.Euler(0,0,0,l.warp.eOrder).setFromQuaternion(i,l.warp.eOrder),m=(new o.Euler).setFromQuaternion(a.quaternion,l.warp.eOrder),g=new o.Euler(f.x-m.x,f.y-m.y,f.z-m.z,l.warp.eOrder);g.y=c.constrainedTurn(g.y),this.burnsDir=Math.sign(g.y);var v=new o.Euler(0,0,0,l.warp.eOrder),y=new o.Vector3,b=function(t,e){return this.warpInterrupted?void 0:(v.x=m.x+t*g.x,v.y=m.y+t*g.y,v.z=m.z+t*g.z,y.set(0,0,-1),y.applyEuler(v),y.add(a.position),a.controls.lookAt(y),a.controls.lookVector.copy(y),a.lookAt(y))}.bind(this);return p>l.warp.minRotation?d.start(b,t,e,0,h[l.warp.movementEasing]):(w.debug("Aim angle only is "+p.toPrecision(3)+" degrees, skipping explicit re-aim"),void(e&&e()))},n.prototype._warpBendAim=function(t,e,i,n){var a=n||0,s=this.player.cameras[r.PANORAMA],u=new o.Euler(0,0,0,l.warp.eOrder).setFromQuaternion(this.warpDestHeroLoc.quaternion,l.warp.eOrder),p=(new o.Euler).setFromQuaternion(s.quaternion,l.warp.eOrder),f=new o.Euler(u.x-p.x,u.y-p.y,u.z-p.z,l.warp.eOrder);f.y=c.constrainedTurn(f.y);var m=Math.min(o.Math.degToRad(l.warp.softBendTilt),Math.abs(f.x));f.x=m*Math.sign(f.x),m=Math.min(o.Math.degToRad(Math.max(0,l.warp.softBendAngle)),m),this.burnsDir=Math.sign(f.y),m*=Math.sign(f.y),f.y=m;var g=new o.Euler(0,0,0,l.warp.eOrder),v=new o.Vector3,y=function(t,e){if(t<.5)g.x=p.x+t*f.x,g.y=p.y+t*f.y,g.z=p.z+t*f.z;else{var i=(1-t)*l.warp.softBendEnd;g.x=u.x-i*f.x,g.y=u.y-i*f.y,g.z=u.z-i*f.z}v.set(0,0,-1),v.applyEuler(g),v.add(s.position),s.controls.lookAt(v),s.controls.lookVector.copy(v),s.lookAt(v)}.bind(this);return d.start(y,e,i,a,h[l.warp.movementEasing])},n.prototype._warpStepCameraAim=function(t,e,i){var n=this.player.cameras[r.PANORAMA],a=new o.Euler(0,0,0,l.warp.eOrder).setFromQuaternion(this.warpDestHeroLoc.quaternion,l.warp.eOrder),s=(new o.Euler).setFromQuaternion(n.quaternion,l.warp.eOrder),u=new o.Euler(a.x-s.x,a.y-s.y,a.z-s.z,l.warp.eOrder);u.y=c.constrainedTurn(u.y),this.burnsDir=Math.sign(u.y);var p=new o.Euler(0,0,0,l.warp.eOrder),f=new o.Vector3,m=function(t,e){t<.5?p.copy(s):p.copy(a),f.set(0,0,-1),f.applyEuler(p),f.add(n.position),n.controls.lookAt(f),n.controls.lookVector.copy(f),n.lookAt(f)}.bind(this);return d.start(m,e,i,0,h[l.warp.movementEasing])},n.prototype.setBurnsDir=function(){var t=this.player.cameras[r.PANORAMA],e=new o.Euler(0,0,0,l.warp.eOrder).setFromQuaternion(this.warpDestHeroLoc.quaternion,l.warp.eOrder),i=(new o.Euler).setFromQuaternion(t.quaternion,l.warp.eOrder),n=new o.Euler(e.x-i.x,e.y-i.y,e.z-i.z,l.warp.eOrder);n.y=c.constrainedTurn(n.y),this.burnsDir=Math.sign(n.y)},n.prototype.stepWarpPath=function(t,e){var i=this.player.cameras[r.PANORAMA];if(!this.warpPathPoints)return i.position.copy(this.warpDestPano.position),!0;var n=this.warpPathPoints[0],a=this.warpDestPano.position;if(null!==this.nodes&&1<this.cameraHull.length){var s=new o.Vector3;t<.5?s.copy(this.cameraHull[1]).sub(n).normalize().multiplyScalar(l.warp.softPushDist*t).add(n):s.copy(this.cameraHull[this.cameraHull.length-2]).sub(a).normalize().multiplyScalar(l.warp.softPushDist*l.warp.softPushEnd*(1-t)).add(a),i.position.copy(s)}else t<.5?i.position.copy(n):i.position.copy(a)},n.prototype.interruptAndFastForward=function(t,e){this.warping&&(this.warpInterrupted=!0,this.warpInterruptionBlackoutStyle=t,this.warpInterruptionTravelTime=e,null!==this.warpInterruptionBlackoutStyle&&void 0!==this.warpInterruptionBlackoutStyle||(this.warpInterruptionBlackoutStyle=_.MIDDLE),null!==this.warpInterruptionTravelTime&&void 0!==this.warpInterruptionTravelTime||(this.warpInterruptionTravelTime=l.minWarpTime))},n.prototype.warpCameraAim=function(t){var e=l.warp.minWarpTime;if(this.upcomingTransType===s.BLACK)e=l.warp.teleportTime;else{var i=this.player.cameras[r.PANORAMA],n=new o.Euler(0,0,0,l.warp.eOrder).setFromQuaternion(this.warpDestHeroLoc.quaternion,l.warp.eOrder),a=(new o.Euler).setFromQuaternion(i.quaternion,l.warp.eOrder),u=new o.Euler(n.x-a.x,n.y-a.y,n.z-a.z,l.warp.eOrder);u.y=c.constrainedTurn(u.y);var h=1e3*Math.abs(u.y)/o.Math.degToRad(l.warp.maxAimPerSec);e=Math.max(e,h)}var d=function(){this._warpStopFlying(),this.discardSlow(),t&&t()}.bind(this);this._warpCameraAim(e,d)},n.prototype.warpCommonParameters=function(t,e,i,n){this.model.skybox.material.uniforms.blackout.value=n;var o=u.uniform(this.model.skybox,"progress",1),r=u.allUniforms(this.model.chunks,"progress",1),a=!1,s=function(){if(this.warpInterrupted)return a=!0}.bind(this),c=function(t,e){return i&&a?!(this.model.skybox.material.uniforms.progress.value=0):void o(t,e)}.bind(this),p=function(t,e){return i&&a?(r(0),!0):void r(t,e)}.bind(this);d.start(s,t,null,e,null,"safeHaltWatch"),d.start(c,t,null,e,h[l.warp.blendEasing],"skyboxProgress"),d.start(p,t,null,e,h[l.warp.blendEasing],"chunkProgress")},n.prototype.warpTravel_STD=function(t){var e,i=Math.min(l.warp.lookAheadMax,l.warp.lookAheadDist/this.warpLength),n=this.player.cameras[r.PANORAMA],a=(Math.min(.25,3/this.warpLength),Math.min(.35,7/this.warpLength)),p=new o.Euler(0,0,0,l.warp.eOrder),m=new o.Vector3,g=(new o.Euler).setFromQuaternion(n.quaternion,l.warp.eOrder),v=(new o.Euler).copy(g),b=n.position.clone(),x=new o.Matrix4,S=new o.Euler,T=l.warp.minWarpTime;T+=this.warpLength*l.warp.timePerMeter,.01<l.warp.flySpeed&&(T=1e3*this.warpLength/l.warp.flySpeed);var M=!1,I=this.warpDestHeroLoc.quaternion,P=new o.Vector3(0,0,-1).applyQuaternion(I).normalize(),C=this.warpPathPoints[this.warpPathPoints.length-1].clone().sub(this.warpPathPoints[this.warpPathPoints.length-2]).normalize(),A=C.dot(P),E=o.Math.radToDeg(Math.acos(A)),L=function(t){var e=a;return o.Math.smoothstep(t,0,e)*(1-o.Math.smoothstep(t,1-e,1))},D=function(){return x.lookAt(b,e,y.UP),p.setFromRotationMatrix(x,l.warp.eOrder),g.setFromQuaternion(n.quaternion,l.warp.eOrder),S.set(p.x-g.x,p.y-g.y,p.z-g.z,l.warp.eOrder),c.constrainedTurn(S.y)}.bind(this),k=function(t,e){if(this.warpInterrupted)return M=!0}.bind(this),R=function(t,e){return M||!this.warpPathPoints?(f.blur(0),!0):void f.blur(t)}.bind(this),O=u.allUniforms(this.model.chunks,"modelAlpha",1),F=function(t,e){return M||!this.warpPathPoints?(O(0),!0):void O(t,e)}.bind(this),N=function(t,e){if(!this.warpPathPoints)return n.position.copy(this.warpDestPano.position),!0;if(M)return!0;var i=this.interpAlongPath(this.warpPathPoints,this.warpPathLengths,t);n.position.copy(i),b=this.interpAlongPath(this.warpPathPoints,this.warpPathLengths,.99*t)}.bind(this),U=function(t,n){return this.warpPathPoints?!!M||void(e=this.interpAlongPath(this.warpPathPoints,this.warpPathLengths,Math.min(t+i,1))):(w.debug("Lost bunny."),!0)}.bind(this),B=function(t,r){if(M)return w.debug(">>>> Walkthrough interupted at t="+t),!0;if(!this.warpPathPoints)return!0;var a=this.warpLength*t,s=o.Math.smoothstep(a,0,this.brushPrefs.lookBlendDist),u=o.Math.smoothstep(a,this.warpLength-this.brushPrefs.lookBlendDist,this.warpLength);l.warp.matchCam&&(s*=1-u),x.lookAt(b,e,y.UP),p.setFromRotationMatrix(x,l.warp.eOrder),g.setFromQuaternion(n.quaternion,l.warp.eOrder),S.set(p.x-g.x,p.y-g.y,p.z-g.z,l.warp.eOrder),S.y=c.constrainedTurn(S.y),p.x=g.x+s*S.x,p.y=g.y+s*S.y,p.z=g.z+s*S.z,S.set(p.x-v.x,p.y-v.y,p.z-v.z,l.warp.eOrder),S.y=c.constrainedTurn(S.y);var h=o.Math.degToRad(l.warp.maxTurnPerSec)*r/1e3;S.y=Math.sign(S.y)*Math.min(h,Math.abs(S.y)),v.x=v.x+S.x*l.warp.turnFriction,v.y=v.y+S.y*l.warp.turnFriction,v.z=v.z+S.z*l.warp.turnFriction,v.x=Math.max(o.Math.degToRad(l.warp.minDownAngle),v.x);var d=e.clone().sub(b).normalize();if(E<l.warp.maxAimRotation&&0<u){var f=1-u;d.x=d.x*f+u*C.x,d.y=d.y*f+u*C.y,d.z=d.z*f+u*C.z,d.normalize()}this.bunnyObj.position.copy(n.position).add(d),m.set(0,0,-1).applyEuler(v).normalize(),m.multiplyScalar(8),m.add(n.position),1-i<t&&l.warp.matchCam||(n.controls.lookAt(m),n.controls.lookVector.copy(m),n.lookAt(m))}.bind(this),z=function(){M?(this.discardSlow(),this.upcomingTransType=s.BLACK,this.warpTravel_BLACK(-.5,this.warpInterruptionTravelTime,_.BEGINNING,t)):this._wrapupWarpShading(t)}.bind(this);U(0);var V=l.warp.motionLeadTime+1e3*Math.abs(D())/o.Math.degToRad(l.warp.maxTurnPerSec),G=V/(T+=V);this.warpCommonParameters(T,G,!0,_.NONE),d.start(k,T,null,0,null,"_haltWatcher"),0<l.warp.blur&&(f.blurStrength=l.warp.blur,d.start(R,T,null,G,L,"blurring")),d.start(F,T,null,G,L,"modelAlpha"),d.start(N,T,null,G,h[l.warp.blendEasing],"followPath"),d.start(U,T,null,G,h[l.warp.blendEasing],"goBunny"),d.start(B,T,z,0,h[l.warp.blendEasing],"lookAtBunny")},n.prototype.warpTravel_BLACK=function(t,e,i,n){var o=t||0;null!=e||(e=l.warp.teleportTime),this.warpCommonParameters(e,o,!1,i),this.model.chunks.forEach(function(t){t.material.uniforms.blackout.value=i}),this._warpBendAim(null,e,null,o);var r=function(){this.wrapupWarpShadingOnly(n,i)}.bind(this);d.start(this.stepWarpPath.bind(this),e,r,o,h[l.warp.blendEasing],"stepMotion")},n.prototype.flightStepWalk=function(t,e,i){if(this.warpInterrupted)i&&i();else if(this.activeTransType!==s.WALK)this._clearWarpShading(),this._warpStopFlying(),this.player.spider.draw(),this.placeCpm(),i&&i();else if(this.player.currentPano!==t){var n={pano:t,lookAtPoint:e,duration:null,maxDistanceOverride:l.warp.walkMaxDist,skipWarpingCheck:!1,constantMoveSpeed:!0};this.player.nonInterruptingFlyToPano(n,i)}else i&&i()},n.prototype.makeWalkFlightFunc=function(t,e,i){return this.flightStepWalk.bind(this,t,e,i)},n.prototype.warpTravel_WALK=function(t){var e=this.nodes.length,i=this.player.model.panos,n=i.get(this.nodes[e-1]),o=n.position.clone().multiplyScalar(2).sub(i.get(this.nodes[e-2]).position),r=new Array(e+1);r[r.length-1]=function(){t&&t()}.bind(this);for(var a=e-1,s=r.length-1;0<s;s-=1){var l=this.nodes[a];n=i.get(l);var c=o.distanceTo(n.position)<.3?null:o;r[s-1]=this.makeWalkFlightFunc(n,c,r[s]),o=n.position.clone(),a--}r[0]()},n.prototype.warpCameraTravel=function(t,e,i,n){if(this.activeTransType=this.upcomingTransType,this.upcomingTransType=null,t)this.activeTransType==s.BLACK?this.warpTravel_BLACK(null,i,e,n):this.activeTransType===s.WALK?this.warpTravel_WALK(function(){this._clearWarpShading(),this._warpStopFlying(),this.player.spider.draw(),this.placeCpm(),n&&n()}.bind(this)):this.warpTravel_STD(n);else{var o=function(){this._wrapupTravel(n)}.bind(this),r={pano:this.warpDestPano,lookAtPoint:null,duration:null,maxDistanceOverride:null,skipWarpingCheck:!1};this.player.flyToPano(r,o)}},n.prototype.startWarpState=function(){this.warping=!0,this.warpInterrupted=!1,this.warpInterruptionBlackoutStyle=null,this.warpInterruptionTravelTime=null},n.prototype.endWarpState=function(){this.warping=!1},n.prototype.warpToPano=function(t,e,i,n){if(this.warping)w.warn("Cannot warp when already warping");else{if(this.upcomingTransType=t,this.activeTransType=null,!this.setWarpDestPano())return this.upcomingTransType=null,void this.warpToNonPano(n);if(this.player.mode!==r.PANORAMA)return this.upcomingTransType=null,this.discardSlow(),void this.player.flyToNewMode({mode:r.PANORAMA,pano:this.warpDestPano,duration:l.warp.outsideTime,warpDest:this.warpDestHeroLoc,callback:n,force:!0});if(!this.warpDestPano)return w.warn("no warp destination, callback dropped"),void(this.upcomingTransType=null);var o=!(this.model.panos.isNeighbour(this.player.currentPano,this.warpDestPano)&&this.warpDestPano!==this.player.currentPano&&this.warpDestPano.position.distanceTo(this.player.currentPano.position)<l.warp.nearPanoDist),a=this.chooseWarpPath(o);if(a&&this.upcomingTransType!==s.WALK){var c=function(){this.warpToPano(t,e,i,n)}.bind(this);if(this.player.checkAndWaitForPanoLoad(this.warpDestPano,"high","low",this.player.basePanoSize,c))return}this.player.currentPano||(w.warn("Arrived at a very strange spot!"),this.player.currentPano=this.warpDestPano,this.placeCpm(),this.fadeOutCpm(l.path.fadeOutTime),this.player.spider.draw()),w.debug("Warping to pano ",this.warpDestPano.position),this.upcomingTransType!==s.WALK&&this.player.emit(x.PanoChosen,this.player.currentPano,this.warpDestPano),this.player.activeTag&&this.player.dismissActiveTag(),this.startWarpState();var u=function(){this.endWarpState(),n&&n()}.bind(this);a?this.warpCameraTravel(o,e,i,u):this.warpCameraAim(u),this.player.smoothZoomToDefault(l.zoom.restoreTime)}},t.exports=n}).call(h,"/js/objects/ShowPath.js")}),ze=d(function(t){function e(t){this.player=t,this.obj3d=null,this.UP=new v.Vector3(0,1,0)}e.prototype.prefs={linewidth:3,height:.07,opacity:.45,endScale:.05},e.prototype.discard=function(){if(this.obj3d){var t=this.obj3d.parent;t&&t.remove(this.obj3d)}this.obj3d=null},e.prototype.draw=function(){if(this.discard(),z.showNeighbors){var t=this.player.currentPano.floor;this.obj3d=new v.Object3D;var e=this.player.model.panos.getNeighbours(this.player.currentPano),i=this.player.currentPano.floorPosition.clone().sub(this.player.model.position);i.y+=this.prefs.height;var n=.1525,o=new v.Matrix4;for(var r in e)if(e[r]){var a=this.player.model.panos.get(r),s=(a.position.clone().sub(this.player.model.position),a.position.clone().sub(a.floorPosition)),l=a.floorPosition.clone().sub(this.player.model.position);l.y+=this.prefs.height;var c=new v.Geometry;c.vertices.push(new v.Vector3(0,-.0127,0),new v.Vector3(-.0127,0,0),new v.Vector3(0,.0127,0),new v.Vector3(.0127,0,0),new v.Vector3(0,-.0127,0)),c.vertices.push(new v.Vector3(0,-.255,0),new v.Vector3(.255,-.255,0),new v.Vector3(.255,n,0),new v.Vector3(-n,n,0),new v.Vector3(-n,.127,0),new v.Vector3(-.19,.1,0),new v.Vector3(-.19,-.2032,0),new v.Vector3(-n,-.2286,0),new v.Vector3(-n,-.255,0),new v.Vector3(0,-.255,0)),o.identity().setPosition(s),c.applyMatrix(o),c.vertices.push(new v.Vector3(0,-this.prefs.endScale,0)),c.vertices.push(new v.Vector3(-this.prefs.endScale,-this.prefs.endScale,0),new v.Vector3(-this.prefs.endScale,this.prefs.endScale,0),new v.Vector3(this.prefs.endScale,this.prefs.endScale,0),new v.Vector3(this.prefs.endScale,-this.prefs.endScale,0)),o.lookAt(l,i,this.UP).setPosition(l),c.applyMatrix(o),c.vertices.push(l,i);var u=new v.Line(c,new v.LineBasicMaterial({color:a.debugColor.getHex(),transparent:!0,opacity:this.prefs.opacity,depthWrite:!1,name:"sLine"+r,linewidth:this.prefs.linewidth}));this.obj3d.add(u)}t.add(this.obj3d)}},e.prototype.update=function(){z.showNeighbors&&this.obj3d&&this.obj3d.updateMatrixWorld()},t.exports=e});function Ve(t){v.PerspectiveCamera.call(this,z.insideFOV,t.clientWidth/t.clientHeight,z.insideNear,z.insideFar),this.controls=null}(Ve.prototype=Object.create(v.PerspectiveCamera.prototype)).updateAspect=function(t){this.aspect=t,this.updateProjectionMatrix()};var Ge=Ve;function je(t){v.PerspectiveCamera.call(this,z.dollhouseFOV,t.clientWidth/t.clientHeight,z.dollhouseNear,z.dollhouseFar),this.controls=null}(je.prototype=Object.create(v.PerspectiveCamera.prototype)).updateAspect=function(t){this.aspect=t,this.updateProjectionMatrix()};var He=je;function We(t){var e=t.clientWidth/t.clientHeight;v.OrthographicCamera.call(this,-z.orthoBase,z.orthoBase,z.orthoBase/e,-z.orthoBase/e,z.orthoNear,z.orthoFar),this.controls=null,this.updateAspect(e)}(We.prototype=Object.create(v.OrthographicCamera.prototype)).updateAspect=function(t){this.aspect=t,this.top=z.orthoBase/t,this.bottom=-z.orthoBase/t,this.updateProjectionMatrix()};var qe=We,$e={UP:1,DOWN:-1,LEFT:"L",RIGHT:"R",FORWARD:"F",BACK:"B",reverse:{},opposite:function(t){return this.reverse[t.toString()]}};$e.reverse[$e.UP]=$e.DOWN,$e.reverse[$e.DOWN]=$e.UP,$e.reverse[$e.LEFT]=$e.RIGHT,$e.reverse[$e.RIGHT]=$e.LEFT,$e.reverse[$e.FORWARD]=$e.BACK,$e.reverse[$e.BACK]=$e.FORWARD;var Ye,Xe,Qe,Ze,Ke=$e,Je=d(function(t){function e(){this.events=[],this.valid=!1}e.prototype.push=function(t,e){this.events.push({direction:t,pano:e}),this.valid=!0},e.prototype.pop=function(t){var e=this.events.pop();return this.events.length<1&&(this.valid=!1),e},e.prototype.peek=function(){return this.events.length?this.events[this.events.length-1]:{direction:null,pano:null}},e.prototype.invalidate=function(){this.events=[],this.valid=!1},e.prototype.reversePano=function(t){if(!this.valid)return null;var e=this.peek();return Ke.opposite(t)===e.direction?(this.pop(),e.pano):null},t.exports=e}),ti=Object.freeze({Standard:0,Slow:1,Retain:2}),ei=Object.freeze({Show:0,Hide:1,Retain:2}),ii=Object.freeze({None:0,Queued:1,ForceQueued:2,Downloading:3,Downloaded:4,DownloadFailed:5}),ni=d(function(t){(function(e){function i(t,e,n,o,r){this.qualityManager=t,this.maxNavQuality=this.qualityManager.getMaxNavPanoSize(),this.maxZoomQuality=this.qualityManager.getMaxZoomPanoSize(),this.baseSize=e,this.standardSize=n,this.highSize=o,this.ultraHighSize=r,this.neighbourPanos=[],this.scoredPanos=[],this.directionStandardTiles=[],this.priorityCriteria=new i.PriorityCriteria(null,new l.Vector3(0,0,0),new l.Vector3(0,0,-1),new l.Vector3(0,0,-1))}var n,o,r,a,s,l=v,c=Ce,u=ii,h=ge,d=J,p=(new S(e),Object.freeze({None:0,DirectionalFOV:1}));i.PriorityCriteria=function(t,e,i,n,o){this.pano=t,this.cameraPosition=(new l.Vector3).copy(e),this.cameraDir=(new l.Vector3).copy(i),this.panoSpaceDir=(new l.Vector3).copy(n),this.upcomingPanos=o,this.copy=function(t){this.pano=t.pano,this.cameraPosition.copy(t.cameraPosition),this.cameraDir.copy(t.cameraDir),this.panoSpaceDir.copy(t.panoSpaceDir),this.upcomingPanos=o},this.zoomingActive=!1},i.DIRECTIONAL_FOV=60,i.DIRECTIONAL_FOV_NARROW=10,i.MAX_SCORED_PANOS_TOCONSIDER=6,i.MAX_SCORED_PANOS_TOADD=2,i.MAX_UPCOMING_PANOS_TOADD=3,i.DIRECTION_SCORE_STRICTNESS=.75,i.appendQueue=function(t,e){if(t&&e)for(var i=0;i<e.length;i++)t.push(e[i])},i.prototype.updateCriteria=function(t,e,i,n){this.priorityCriteria.pano=t,this.priorityCriteria.cameraPosition.copy(e),this.priorityCriteria.cameraDir.copy(i),this.priorityCriteria.upcomingPanos=n,this.maxNavQuality=this.qualityManager.getMaxNavPanoSize(),this.maxZoomQuality=this.qualityManager.getMaxZoomPanoSize()},i.prototype.filterAndPrioritize=function(t,e,n){this.populateNeighborPanos(this.priorityCriteria.pano,e,this.neighbourPanos),this.populateScoredPanos(this.priorityCriteria.pano,e,this.scoredPanos,this.priorityCriteria.cameraDir,i.MAX_SCORED_PANOS_TOCONSIDER);var o=this.baseSize,r=this.standardSize,a=this.highSize,s=this.ultraHighSize;this.queueTilesForPano(t,n,this.priorityCriteria.pano,o),this.priorityCriteria.upcomingPanos&&this.queueTilesForPanos(t,this.priorityCriteria.upcomingPanos,n,o,i.MAX_UPCOMING_PANOS_TOADD),this.directionStandardTiles.length=0,this.canDownloadSize(r)&&this.queueTilesInDirectionForPano(this.directionStandardTiles,n,this.priorityCriteria.pano,r,this.priorityCriteria.cameraPosition,this.priorityCriteria.cameraDir,i.DIRECTIONAL_FOV_NARROW),i.sortPanoTiles(this.directionStandardTiles,this.priorityCriteria.pano,this.priorityCriteria.cameraDir),i.appendQueue(t,this.directionStandardTiles),this.queueTilesForPanos(t,this.scoredPanos,n,o,i.MAX_SCORED_PANOS_TOADD),this.directionStandardTiles.length=0,this.canDownloadSize(a)&&this.queueTilesInDirectionForPano(this.directionStandardTiles,n,this.priorityCriteria.pano,a,this.priorityCriteria.cameraPosition,this.priorityCriteria.cameraDir,i.DIRECTIONAL_FOV_NARROW),this.canDownloadSize(s)&&this.queueTilesInDirectionForPano(this.directionStandardTiles,n,this.priorityCriteria.pano,s,this.priorityCriteria.cameraPosition,this.priorityCriteria.cameraDir,i.DIRECTIONAL_FOV_NARROW),i.sortPanoTiles(this.directionStandardTiles,this.priorityCriteria.pano,this.priorityCriteria.cameraDir),i.appendQueue(t,this.directionStandardTiles),this.directionStandardTiles.length=0,this.canDownloadSize(r)&&this.queueTilesInDirectionForPano(this.directionStandardTiles,n,this.priorityCriteria.pano,r,this.priorityCriteria.cameraPosition,this.priorityCriteria.cameraDir,i.DIRECTIONAL_FOV),this.canDownloadSize(a)&&this.queueTilesInDirectionForPano(this.directionStandardTiles,n,this.priorityCriteria.pano,a,this.priorityCriteria.cameraPosition,this.priorityCriteria.cameraDir,i.DIRECTIONAL_FOV),this.canDownloadSize(s)&&this.queueTilesInDirectionForPano(this.directionStandardTiles,n,this.priorityCriteria.pano,s,this.priorityCriteria.cameraPosition,this.priorityCriteria.cameraDir,i.DIRECTIONAL_FOV),i.sortPanoTiles(this.directionStandardTiles,this.priorityCriteria.pano,this.priorityCriteria.cameraDir),i.appendQueue(t,this.directionStandardTiles),this.queueTilesForPanos(t,this.neighbourPanos,n,o)},i.prototype.canDownloadSize=function(t){return this.maxNavQuality>=t||this.maxZoomQuality>=t&&this.zoomingActive},i.prototype.populateNeighborPanos=function(t,e,i){(i=i||[]).length=0;var n=e.getNeighbours(t),o=0;for(var r in n)if(n.hasOwnProperty(r)){var a=e.get(r);if(t.id!==a.id&&(i.push(a),1==++o))break}return i},i.prototype.populateScoredPanos=function(t,e,n,o,r){(n=n||[]).length=0;var a=[c.filters.inPanoDirection(t.position,o,i.DIRECTION_SCORE_STRICTNESS),c.filters.not(t)],s=[c.scoreFunctions.distanceSquared(t),c.scoreFunctions.direction(t.position,o)],l=e.sortByScore(a,s);if(l)for(var u=0;u<l.length&&u<r;u++){var h=l[u].pano;n.push(h)}return n},i.prototype.queueTilesForPanos=function(t,e,i,n,o){for(var r=0,a=0;a<e.length;a++){var s=e[a];if(r+=0<this.queueTilesForPano(t,i,s,n)?1:0,o&&o<=r)break}return r},i.prototype.queueTilesForPano=(s={filter:p.None},function(t,e,i,n){return this.filterAndQueueTileDownloadDescriptors(t,e,i,n,s)}),i.prototype.queueTilesForPanosInDirection=(a=new l.Vector3,function(t,e,i,n,o,r,s,l){for(var c=0,u=0;u<i.length;u++){var h=i[u];a.copy(h.position),a.sub(o),a.normalize();var p=Math.max(Math.min(r.dot(a),1),-1);if(d.getFOVDotThreshold(s)<=p&&(c+=0<this.queueTilesInDirectionForPano(t,e,h,n,o,r,s)?1:0,l&&l<=c))break}return c}),i.prototype.queueTilesInDirectionForPanos=function(t,e,i,n,o,r,a,s){for(var l=0,c=0;c<i.length;c++){var u=i[c];if(l+=0<this.queueTilesInDirectionForPano(t,e,u,n,r,a)?1:0,s&&s<=l)break}return l},i.prototype.queueTilesInDirectionForPano=(o={filter:p.DirectionalFOV,direction:new l.Vector3,fov:60},r=new l.Vector3,function(t,e,i,n,a,s,l){return r.copy(s),h.getRelativeDirection(i.quaternion,r),o.direction.copy(r),o.fov=l,this.filterAndQueueTileDownloadDescriptors(t,e,i,n,o)}),i.prototype.filterAndQueueTileDownloadDescriptors=(n=[],function(t,e,i,o,r){var a=e.getTileDownloadDescriptors(i,o);n.length=0,this.filterTileDownloadDescriptors(i,a,n,r);for(var s=0,l=0;l<n.length;l++){var c=n[l];c&&(t.push(c),s++)}return s}),i.prototype.filterTileDownloadDescriptors=(new l.Vector3,function(t,e,i,n){var o,r;switch(n.filter){case p.DirectionalFOV:for(o=0;o<e.length;o++)r=e[o],h.isTileWithinFOV(r.panoSize,r.tileSize,r.face,r.tileX,r.tileY,n.direction,n.fov)&&i.push(r);break;default:for(o=0;o<e.length;o++)r=e[o],i.push(r)}for(o=0;o<i.length;o++)r=i[o],this.canIncludeDescriptor(r)||(i[o]=null)}),i.prototype.canIncludeDescriptor=function(t){return t.status!==u.Downloading&&t.status!==u.Downloaded},i.prototype.canIncludePano=function(t,e){return!t.isLoaded(e)},i.getFOVDotThreshold=function(t){return Math.cos(l.Math.degToRad(t/2))};var f,m=((f=function t(e,i){var n=t._panoSpaceDir,o=t._fovThreshold,r=t._fovThresholdNarrow,a=Math.max(Math.min(n.dot(e.direction),1),-1),s=Math.max(Math.min(n.dot(i.direction),1),-1);return e._dot=a,i._dot=s,o<=a&&s<o?-1:a<o&&o<=s?1:r<=a&&s<r?-1:a<r&&r<=s?1:e.panoSize>i.panoSize?1:i.panoSize>e.panoSize?-1:-(a-s)})._panoSpaceDir=new l.Vector3,f._fovThreshold=-1,f._fovThresholdNarrow=-1,f);i.sortPanoTiles=function(t,e,n){m._panoSpaceDir.copy(n),h.getRelativeDirection(e.quaternion,m._panoSpaceDir),m._fovThresholdNarrow=d.getFOVDotThreshold(i.DIRECTIONAL_FOV_NARROW),m._fovThreshold=d.getFOVDotThreshold(i.DIRECTIONAL_FOV),t.sort(m)},i.insertSortedPanoTile=function(t,e,n,o){m._panoSpaceDir.copy(o),h.getRelativeDirection(n.quaternion,m._panoSpaceDir),m._fovThresholdNarrow=d.getFOVDotThreshold(i.DIRECTIONAL_FOV_NARROW),m._fovThreshold=d.getFOVDotThreshold(i.DIRECTIONAL_FOV);for(var r=-1,a=0;a<t.length;a++)if(m(e,t[a])<=0){r=a;break}if(-1===r)t[t.length]=e;else{for(var s=t.length;r<s;s--)t[s]=t[s-1];t[r]=e}},i.prototype.setZoomingActive=function(t){t!==this.zoomingActive&&(this.zoomingActive=t)},i.prototype.destory=function(){this.neighbourPanos=[],this.scoredPanos=[],this.directionStandardTiles=[]},t.exports=i}).call(h,"/js/tile/TilePrioritizer.js")});function oi(){this.actionSequence=[],this.actionSequenceInProgress=!1}oi.prototype.reset=function(t){this.actionSequenceInProgress=!1,this.actionSequence.length=0},oi.prototype.addZoomAction=(Xe=Ye=null,Qe=!1,Ze=function(){Ye=null,0<this.actionSequence.length&&(this.actionSequence[0].start,this.actionSequence[this.actionSequence.length-1].end),this.reset()},function(t,e,i){if(t!==e){Qe||(Ze=Ze.bind(this),Qe=!0),Ye&&(window.clearTimeout(Ye),Ye=null),i===Xe&&this.actionSequenceInProgress||(this.reset(),Xe=i),this.actionSequenceInProgress=!0;var n={start:t,end:e};this.actionSequence.push(n),Ye=window.setTimeout(Ze,150)}});var ri,ai,si,li,ci,ui,hi,di,pi,fi,mi=oi,gi={BuildingType:0,TextOnly:1,ImageText:2,Audio:4,OtherModel:5,TextAudio:6,ImageTextAudio:7,IFrame:8,Tag360T1:9,TagTo360:10,Video:11,Title:12,RegionalJump:13,ClassifyType:{Indoor:1,Building:2},EW:101,IKEA:102,RedStart:103,Pano:9e3},vi=ot.EventEmitter,yi=new S("/js/player.js"),bi=Object.freeze({FlyToPano:V.getUniqueId(),FlyToNewMode:V.getUniqueId(),FlyToSameMode:V.getUniqueId(),FlyToViewFloor:V.getUniqueId(),LookTransition:V.getUniqueId(),ZoomTransition:V.getUniqueId()}),wi="/pc/add_label.html?",xi="/nest/ifaddtag/?",_i="/nest/ifaddscenes/?";function Si(t){(G.player=this).currentPano=null,this.currentPanoQuaternion=null,this.nextPano=null,this.camera=null,this.paused=!1,this.flying=!1,this.sceneIntersectionPlane=null,this.target=new v.Vector3,this.mouse=new v.Vector3(1.1,1.1,.5),this.mouseAtMouseDown=new v.Vector2,this.mouseCouldBeClickToMove=!1,this.inMeasureMode=!1,this.mouseLastMoveTime=Date.now(),this.mouseDown=!1,this.mouseDownTimer=null,this.couldBeLongTap=!1,this.containsMouse=!0,this.isTouchEvent=!1,this.isPanoHover=!1,this.reticule=null,this.addTagReticule=new K(this),this.panoMarkers=[],this.spider=new ze(this),this.quaternion=new v.Quaternion,this.position=new v.Vector3(15,10,15),this.previousState=null,this.lastInsideView=new Ae,this.last360View=new Ae,this.raycaster=new v.Raycaster,this.intersect=null,this.lastChangeTime=Date.now(),this.history=new Je,this.control=null,this.controls={},this.cameras={},this.path=null,this.model=null,this.container=null,this.cachedPanoCandidates=null,this.basePanoSize=0,this.standardPanoSize=0,this.highPanoSize=0,this.ultraHighPanoSize=0,this.zoomLevel=1,this.zooming=0,this.zoomSpeed=.5,this.scrollZoomSpeed=.06,this.zoomSpeedAdjust=.05,this.defaultZoomIncrement=.2,this.speedmultiplier=1,this.baseFov=z.insideFOV,this.zoomFov=this.baseFov,this.zoomEnabled=!0,this.preRenderingEnabled=!1,this.setupCustomProperties(t),this.urlPoint=wi,this.urlPoint3=xi,this.urlHighlights=_i,this.normal_length=.1,this.zoomStats=new mi,this.clock=new v.Clock,this.walkOnPano=!1,this.isLabelEdit=!1,this.tagpictype=1,this.panoSizeLocationMap=[],this.connect=At(),this.handleOperation=this.handleOperation.bind(this),this.getCurrentState=this.getCurrentState.bind(this),this.connect.on("operation",this.handleOperation)}Si.prototype=Object.create(vi.prototype),Si.prototype.init=function(t){this.modelManager=t.modelManager,this.tileDownloader=t.tileDownloader,this.panoRenderer=t.panoRenderer,this.sRender=this.panoRenderer.sceneRenderer,this.qualityManager=t.qualityManager,this.container=t.container,this.camera=t.camera,this.mattertagManager=t.mattertagManager,this.setUpControls(this.container),this.path=new Be(t.director,this),this.basePanoSize=this.qualityManager.getPanoSize(1),this.standardPanoSize=this.qualityManager.getPanoSize(2),this.highPanoSize=this.qualityManager.getPanoSize(3),this.ultraHighPanoSize=this.qualityManager.getPanoSize(4),this.tileDownloader.processPriorityQueue=!1,this.tileDownloader.tilePrioritizer=new ni(this.qualityManager,this.basePanoSize,this.standardPanoSize,this.highPanoSize,this.ultraHighPanoSize),this.bindEvents(t.container),this.updateModel(),this.reticule=new Z(this)},Si.prototype.setupCustomProperties=function(t){var e=t||A.PANORAMA;Object.defineProperty(this,"mode",{get:function(){return e},set:function(t){var i=e;e=t,this.onModeUpdated(i,e),this.changeSteeringWheelState(e)}})},Si.prototype.isInMode=function(){for(var t=0;t<arguments.length;t++)if(this.mode===arguments[t])return!0;return!1},Si.prototype.isOutsideMode=function(t){return(t=t||this.mode)===A.DOLLHOUSE||t===A.FLOORPLAN},Si.prototype.is360View=function(t,e){return t===A.PANORAMA&&e&&!e.isAligned()},Si.prototype.setScene=function(t){this.sceneIntersectionPlane=t.plane,this.path.setScene(t),this.moveReticuleToScene(t)},Si.prototype.moveReticuleToScene=function(t){this.reticule.parent&&this.reticule.parent.remove(this.reticule),t.add(this.reticule)},Si.prototype.updateModel=function(){function t(t){var e=this.cameras[A.DOLLHOUSE],i=this.controls[A.DOLLHOUSE],n=e.position.y+(t-i.target.y),o=z.showFloorDuration+z.showFloorDelay;V.start(b.property(i.target,"y",t),o,null,z.flydown.movementDelay,D[z.flydown.movementEasing],null,bi.FlyToViewFloor),V.start(b.property(e.position,"y",n),o,null,z.flydown.movementDelay,D[z.flydown.movementEasing],null,bi.FlyToViewFloor)}this.model=this.modelManager.getActiveModel(),this.model.on("floor.changed",function(e,i,n){this.mode===A.DOLLHOUSE&&e!==n&&t.call(this,e.center.y)}.bind(this)),this.model.on("allfloors.toggled",function(e,i){if(this.mode===A.DOLLHOUSE){var n=e?this.model.center.y:Si=i.center.y;t.call(this,n)}}.bind(this)),this.on(Le.PanoChosen,this.model.setProjectedPanos.bind(this.model));var e=this;this.model.panos.list.forEach(function(t){t.vrMarker.addEventListener("click",function(){e.flyToPano({pano:t})})})},Si.prototype.updateModelDependentData=function(){this.setModelForControls(this.model),this.getPanoMarkersFromModel(this.model)},Si.prototype.onModelChanged=function(){this.updateModel(),this.updateModelDependentData()},Si.prototype.getPanoMarkersFromModel=function(t){this.panoMarkers=t.panos.list.reduce(function(t,e){return e.marker?t.concat(e.marker):t},[])},Si.prototype.setModelForControls=function(t){this.controls[A.DOLLHOUSE].setZoomBounds(t.boundingBox);var e=this.model.boundingBox.clone().expandByScalar(z.modelBoundsPadding);[A.DOLLHOUSE,A.FLOORPLAN].forEach(function(t){this.controls[t].setBounds(e)}.bind(this))},Si.prototype.updateControlsForNewMode=function(t,e){this.controls[t]&&(this.controls[t].reset(),this.controls[t].enabled=!1),this.controls[e]&&(this.controls[e].enabled=!0),this.control=this.controls[e]},Si.prototype.getCurrentState=function(){var t=this.mode,e={mode:t,location:this.currentPano.id};return"panorama"===t?(e.position={x:this.camera.position.x,y:this.camera.position.y,z:this.camera.position.z},e.rotation={x:this.camera.quaternion.x,y:this.camera.quaternion.y,z:this.camera.quaternion.z,w:this.camera.quaternion.w}):"floorplan"===t?(e.position={x:this.camera.position.x,y:this.camera.position.y,z:this.camera.position.z},e.rotation={x:this.camera.quaternion.x,y:this.camera.quaternion.y,z:this.camera.quaternion.z,w:this.camera.quaternion.w},e.zoom=3):"dollhouse"===t&&(e.position={x:this.camera.position.x,y:this.camera.position.y,z:this.camera.position.z},e.rotation={x:this.camera.quaternion.x,y:this.camera.quaternion.y,z:this.camera.quaternion.z,w:this.camera.quaternion.w}),e},Si.prototype.setUpControls=function(t){var e={};e[A.PANORAMA]=new Ge(t),e[A.DOLLHOUSE]=new He(t),e[A.FLOORPLAN]=new qe(t);var i={};i[A.PANORAMA]=new jt(e[A.PANORAMA],t),i[A.DOLLHOUSE]=new Kt(e[A.DOLLHOUSE],t),i[A.FLOORPLAN]=new te(e[A.FLOORPLAN],t);var n=this.handleControlMove.bind(this);i[A.PANORAMA].on(it.Move,n),i[A.DOLLHOUSE].on(it.Move,n),i[A.FLOORPLAN].on(it.Move,n);var o=this.handleControlInputStart.bind(this);i[A.PANORAMA].on(it.InputStart,o),i[A.DOLLHOUSE].on(it.InputStart,o),i[A.FLOORPLAN].on(it.InputStart,o),i[A.PANORAMA].on(it.Pinch,this.handleControlPinch.bind(this)),i[A.PANORAMA].on(it.Scroll,this.handleControlScroll.bind(this)),i[A.PANORAMA].on(it.RulersMove,this.handleControlRulersMove.bind(this)),i[A.PANORAMA].on(it.TtagsMove,this.handleControlTtagsMove.bind(this)),this.controls=i,this.cameras=e},Si.prototype.handleControlRulersMove=function(){this.emit(Le.RulersMove)},Si.prototype.handleControlTtagsMove=function(){this.mattertagManager.ttposition()},Si.prototype.handleControlMove=function(t){this.emit(Le.Move,t)},Si.prototype.handleControlInputStart=function(t){this.emit(Le.InputStart,t)},Si.prototype.onModeUpdated=function(t,e){this.updateControlsForNewMode(t,e),this.emit(Le.ModeChanged,t,e)},Si.prototype.isWarping=function(){return this.path.warping},Si.prototype.getLabelScaleFactor=function(){return this.isOutsideMode()?Math.sqrt(this.controls[A.FLOORPLAN].currentScale/10):.5},Si.prototype.bindEvents=function(t){for(var e in(this.playContainer=t)!==document&&t.setAttribute("tabindex",-1),this.controls[A.PANORAMA].on(it.FlyInDirection,this.flyLocalDirection.bind(this)),t.addEventListener("mousedown",this.onMouseDown.bind(this)),t.addEventListener("mousemove",this.onMouseMove.bind(this)),t.addEventListener("mouseover",this.onMouseOver.bind(this)),t.addEventListener("mouseout",this.onMouseOut.bind(this)),t.addEventListener("mouseup",this.onMouseUp.bind(this)),this.modelManager.on(ke.ActiveModelChanged,this.onModelChanged.bind(this)),t.addEventListener("touchstart",this.onTouchStart.bind(this)),t.addEventListener("touchmove",this.onTouchMove.bind(this)),t.addEventListener("touchend",this.onTouchEnd.bind(this)),t.addEventListener("pointerdown",this.onPointerDown.bind(this)),t.addEventListener("pointermove",this.onPointerMove.bind(this)),t.addEventListener("pointerup",this.onPointerUp.bind(this)),t.addEventListener("pointerout",this.onPointerOut.bind(this)),t.addEventListener("pointercancel",this.onPointerCancel.bind(this)),t.addEventListener("keydown",this.onKeyDown.bind(this)),this.controls)this.controls[e].bindEvents(t);this.on(Le.WarpEnded,this.updateWarpEnded.bind(this))},Si.prototype.removeEvents=function(){if(this.playContainer&&this.playContainer.removeEventListener)for(var t in this.playContainer.removeEventListener("mousedown",this.onMouseDown.bind(this)),this.playContainer.removeEventListener("mousemove",this.onMouseMove.bind(this)),this.playContainer.removeEventListener("mouseover",this.onMouseOver.bind(this)),this.playContainer.removeEventListener("mouseout",this.onMouseOut.bind(this)),this.playContainer.removeEventListener("mouseup",this.onMouseUp.bind(this)),this.playContainer.removeEventListener("touchstart",this.onTouchStart.bind(this)),this.playContainer.removeEventListener("touchmove",this.onTouchMove.bind(this)),this.playContainer.removeEventListener("touchend",this.onTouchEnd.bind(this)),this.playContainer.removeEventListener("pointerdown",this.onPointerDown.bind(this)),this.playContainer.removeEventListener("pointermove",this.onPointerMove.bind(this)),this.playContainer.removeEventListener("pointerup",this.onPointerUp.bind(this)),this.playContainer.removeEventListener("pointerout",this.onPointerOut.bind(this)),this.playContainer.removeEventListener("pointercancel",this.onPointerCancel.bind(this)),document.removeEventListener("keydown",this.onKeyDown.bind(this)),this.controls)this.controls[t].removeEvents()},Si.prototype.updateWarpEnded=function(){this.mattertagManager.updateRegionalJumpTags(this.currentPano),this.steeringWheelPos(this.currentPano,null,50)},Si.prototype.onMouseDown=function(t){if(this.mattertagManager.intersectTag&&(this.mattertagManager.intersectTag.type===gi.Tag360T1||1===this.mattertagManager.intersectTag.subtype))return t.preventDefault(),t.stopImmediatePropagation(),t.currentTarget!==document&&t.currentTarget.focus(),void(0===t.button&&(this.handleInputStart.call(this,t.offsetX,t.offsetY,!1),this.updateIntersect()));if(this.mattertagManager.intersectTag&&this.mattertagManager.intersectTag.type==gi.Pano){var e=this.mattertagManager.intersectTag;if(this.model.panos.index[e.locationId].enable){var i={panoramaId:e.locationId,state:!1};this.emit("panorama_enable",i)}else i={panoramaId:e.locationId,state:!0},this.emit("panorama_enable",i)}t.currentTarget!==document&&t.currentTarget.focus(),0===t.button&&(this.handleInputStart.call(this,t.offsetX,t.offsetY,!1),this.updateIntersect())},Si.prototype.onMouseMove=function(t){this.isTouchEvent=!1,this.handleInputMove.call(this,t.offsetX,t.offsetY,!1)},Si.prototype.onMouseOver=function(t){this.containsMouse=!0,!this.mouseDown||0!==t.which&&0!==t.buttons||(this.mouseDown=!1)},Si.prototype.onMouseOut=function(t){this.containsMouse=!1},Si.prototype.onMouseUp=function(t){this.handleInputEnd.call(this,t.offsetX,t.offsetY,!1,t),this.isLabelEdit&&"editor"===this.model.SDKmode&&2==t.button&&this.monitorSelect(this.intersect,t)},Si.prototype.monitorSelect=function(t,e){var i={};if(i.type=this.currentPano.alignmentType,2!=this.currentPano.alignmentType){if(!t)return;(m={}).point=t.point.clone(),m.normal=t.normal.clone();var n=m.point.x,o=m.point.y,r=m.point.z,a=m.normal.x,s=m.normal.y,l=m.normal.z;this.spot=new v.Vector3(n,o,r),this.spot.add(m.normal.clone().multiplyScalar(this.normal_length));var c=this.spot.x-n,u=this.spot.y-o,h=this.spot.z-r,d=this.currentPano.id,p=this.camera.quaternion;i.locationid=d,i.x=n,i.y=o,i.z=r,i.nx=a,i.ny=s,i.nz=l,i.dx=c,i.dy=u,i.dz=h,i.qw=p.y,i.qx=p.z,i.qy=p.w,i.qz=p.x}else{var f=this.getMouseDirection(),m=Math.sqrt(4/(f.x*f.x+f.y*f.y+f.z*f.z));f.multiplyScalar(m),i.x=f.x,i.y=f.y,i.z=f.z,i.panoid=this.currentPano.id}this.emit(Le.EditAddTagHighlight,i)},Si.prototype.onTouchStart=function(t){if(t.currentTarget!==document&&t.currentTarget.focus(),!this.mouseDown){var e=k.average(t.changedTouches,"clientX"),i=k.average(t.changedTouches,"clientY");this.handleInputStart.call(this,e,i,!0)}},Si.prototype.onTouchMove=function(t){var e=k.average(t.changedTouches,"clientX"),i=k.average(t.changedTouches,"clientY");this.handleInputMove.call(this,e,i,!0)},Si.prototype.onTouchEnd=function(t){this.updateIntersect(!0);var e=k.average(t.changedTouches,"clientX"),i=k.average(t.changedTouches,"clientY");this.handleInputEnd.call(this,e,i,!0,t)},Si.prototype.onPointerDown=function(t){},Si.prototype.onPointerMove=function(t){},Si.prototype.onPointerUp=function(t){},Si.prototype.onPointerOut=function(t){},Si.prototype.onPointerCancel=function(t){},Si.prototype.onKeyDown=function(t){if(this.mode!==A.FLOORPLAN){var e=function(){this.control&&this.control.emit(it.Move,"key")}.bind(this);switch(t.which){case et.F:e(),this.changeFloor(-1);break;case et.R:e(),this.changeFloor(1)}}},Si.prototype.handleScrollPinchZoom=function(t){var e=t,i=this.zoomLevel;this.zoomBy(e),this.currentPano&&this.zoomStats.addZoomAction(i,this.zoomLevel,this.currentPano.id)},Si.prototype.handleControlPinch=function(t){z.zoom.enabled?this.handleScrollPinchZoom(1-t):this.flyLocalDirection(new v.Vector3(0,0,t).normalize())},Si.prototype.handleControlScroll=function(t){z.zoom.enabled?(0<t?t=1+this.scrollZoomSpeed:t<0&&(t=1-this.scrollZoomSpeed),0!==t&&this.handleScrollPinchZoom(t)):this.flyLocalDirection(new v.Vector3(0,0,-t).normalize())},Si.prototype.handleInputStart=function(t,e,i){this.isTouchEvent=i,J.convertScreenPositionToNDC(this.container,t,e,this.mouse),J.convertScreenPositionToNDC(this.container,t,e,this.mouseAtMouseDown),this.mouseCouldBeClickToMove=!0,this.mouseDown=!0},Si.prototype.handleInputMove=function(t,e,i){this.isTouchEvent=i,J.convertScreenPositionToNDC(this.container,t,e,this.mouse),!this.inMeasureMode&&.02<this.mouseAtMouseDown.distanceTo(this.mouse)&&(this.mouseCouldBeClickToMove=!1),this.mouseLastMoveTime=Date.now(),this.reticule.move(t,e,i)},Si.prototype.handleInputEnd=function(t,e,i,n){if(this.inMeasureMode)this.isTouchEvent=i,this.mouseDown=!1,this.control&&this.control.emit(it.Move,this.isTouchEvent?"touch":"mouse"),this.history.invalidate();else if(this.isTouchEvent=i,this.mouseDown=!1,this.controls[A.PANORAMA].emit("interaction.direct"),this.mouseCouldBeClickToMove){if(this.checkMattertagClick(n))return this.control&&(this.control.enabled=!0,this.control.onMouseUp(n)),!0;if(this.control&&this.control.emit(it.Move,this.isTouchEvent?"touch":"mouse"),this.history.invalidate(),this.intersect)return this.flyToPanoClosestToMouse();if(this.mode===A.PANORAMA){var o=this.closestPanoInDirection(this.getMouseDirection());return o?this.flyToPano({pano:o}):this.bump(this.getMouseDirection())}}},Si.prototype.checkMattertagClick=function(t){if(this.mattertagManager.intersectTag&&"-1"!==this.mattertagManager.intersectTag.tagid){var e=this.isTouchEvent,i=this.mattertagManager.clickedOnTag(e,this,t);return e||i||V.cancelById(bi.LookTransition),!0}if(this.mattertagManager.activeTag)return!1},Si.prototype.rankedMattertagInDirection=function(t,e){return this.mattertagManager.rankedMattertagInDirection(t,this.position,this.camera,e)},Si.prototype.start=function(t){var e=t.mode,i=t.pano,n=t.position,r=t.quaternion,a=t.tag,s=t.quickstart,l=o.Deferred(),c=new v.Quaternion;c.setFromAxisAngle(new v.Vector3(0,-1,0),Math.PI/4),G.p={position:new v.Vector3(1,1,1),quaternion:c},this.updateModelDependentData(),this.updateFromControls(),this.model.has360Views&&this.findDefaultViews();var u=this.is360View(e,i);return!this.model.outsideAllowed()||u||s?this.startInside(i,n,r,a,l):this.startOutside(t,l),l.done(function(t){this.emit(Le.Ready,u,t,a)}.bind(this)),l.promise()},Si.prototype.startOutside=function(t,e){var i=t.mode,n=t.pano,o=t.position,r=t.quaternion,a=t.zoom,s=t.floorVisibility,l=t.tag;this.emit(Le.StartOutside,z[i].transitionTime),this.isOutsideMode(i)?(this.model.warpDestFloors(s,!0),V.cancelById(bi.FlyToViewFloor),i===A.FLOORPLAN?this.floorplanMode(o,r,a):this.dollhouseMode(o,r),e.resolve(!1)):this.startInsideWithFlyin(n,o,r,l,e)},Si.prototype.startInside=function(t,e,i,n,r){r=r||o.Deferred();var a=(this.currentPano=t)&&!t.isAligned();if(e=a?t.position:e||t.position,i=i||t.quaternion,t){a&&this.mattertagManager.update360Tags(t.id);var s=this.startInside.bind(this,t,e,i,n,r);if(this.checkAndWaitForPanoLoad(t,"high","low",this.basePanoSize,s))return}return this.mode=A.PANORAMA,t.floor.enter(this.mode),this.emit(Le.PanoChosen,this.currentPano,this.currentPano),this.switchCameraMode(this.mode,i),this.emit(Le.StartInside,a),r.resolve(!0),r},Si.prototype.startInsideWithFlyin=function(t,e,i,n,r){if(r=r||o.Deferred(),this.dollhouseMode(),!t)return yi.warn("Player.startInsideWithFlyin() -> targetPano is invalid."),r.resolve(!1),r;e=e||t.position;var a=i||t.quaternionAutoScene||this.control.camera.quaternion;return t.position,setTimeout(function(e){this.control&&(this.control.maxDistance=e);var i={mode:A.PANORAMA,pano:t,quaternion:a,callback:function(){r.resolve(!0)}.bind(this)};this.model.data.player_options.show3d&&1===this.model.startup_type&&""==g.valueFromHash("o","")&&""==g.valueFromHash("l","")?r.resolve(!0):this.flyToNewMode(i)}.bind(this,this.control.maxDistance),z.startupFlyinDelay),r},Si.prototype.checkAndWaitForPanoLoad=function(t,e,i,n,o,r,a,s,l,c){return null!=s||(s=!0),this.model.supportsTiles?this.checkAndWaitForTiledPanoLoad(t,n,o,r,a,s,l,c):this.checkAndWaitForWholePanoLoad(t,e,i,o,s)},Si.prototype.checkAndWaitForWholePanoLoad=function(t,e,i,n,o){if(!t)throw new p("Player.checkAndWaitForWholePanoLoad() -> Cannot load texture for null pano.");return o&&this.model.waitForLoad(t,function(){return t.isLoaded(i)}),!t.isLoaded(e)&&(t.loadCube(e).done(n),!0)},Si.prototype.checkAndWaitForTiledPanoLoad=(ri=new v.Vector3,function(t,e,i,n,o,r,a,s){if(!t)throw new p("Player.checkAndWaitForTiledPanoLoad() -> Cannot load texture for null pano.");if(ri.copy(tt.FORWARD),this.getDirection(ri),t.isLoaded(e))return!1;var l=e+":"+t.id;return this.panoSizeLocationMap[l]||(this.panoSizeLocationMap[l]=!0,r&&this.model.waitForLoad(t,function(){return t.isLoaded(e)}),t.loadTiledPano(e,ri,null,a,s).done(function(t,e){this.panoSizeLocationMap[l]=!1,i&&i(t,e)}.bind(this)).fail(function(t){this.panoSizeLocationMap[l]=!1,n&&n(t)}.bind(this)).progress(function(t,e,i){o&&o(t,e,i)}.bind(this))),!0}),Si.prototype.resetDC=function(){var t=G.p.position.clone(),e=this.model.boundingBox.min.distanceTo(this.model.boundingBox.max);t.add(new v.Vector3(.5*e,.7*e,.5*e)).add(this.getDirection(null,!0).multiplyScalar(-6)),this.controls.dollhouse.lookAt(t,new v.Vector3(0,0,0),G.p.quaternion)},Si.prototype.switchCameraMode=function(t,e){var i=this.controls[t],n=i.camera;switch(t){case A.PANORAMA:n.position.copy(this.currentPano.position);var o=e?tt.FORWARD.clone().applyQuaternion(e):this.getDirection().setY(0).normalize();i.lookAt(o.add(n.position));break;case A.DOLLHOUSE:this.resetDC();break;case A.FLOORPLAN:n.position.copy(this.model.center).setY(10),i.target.copy(this.model.center).setY(0),i.zoomToContain(this.model.size),i.rotateToView(this.model.size,this.getDirection())}i.update(0)},Si.prototype.update=(new v.Vector3,ai={},si=[],function(t){this.updatePersistentZooming(t),this.updateFromControls(t),this.getCurrentNodePanos(si),this.hasChanged(ai)&&(this.lastChangeTime=Date.now(),!this.mouseDown&&this.containsMouse&&this.updateIntersect(),this.model.supportsTiles&&this.updateTileDownloader(si),this.emit(Le.ViewChanged)),this.model.supportsTiles&&(this.updateTileDownloader(ai),this.updatePanoRenderer(ai),this.updateZoomPano()),this.updatePreRendering(si),this.reticule.update(),this.path.update(),this.spider.update(),this.cachedPanoCandidates&&z.navigation.panoScores&&this.model.panos.showPanoScores(this.cachedPanoCandidates),this.updateControlLocks()}),Si.prototype.updatePersistentZooming=function(t){1===this.zooming?this.zoomBy(1+this.zoomSpeed*t):-1===this.zooming&&this.zoomBy(1-this.zoomSpeed*t)},Si.prototype.updateControlLocks=function(){this.currentPano&&this.model.supportsTiles&&(this.controls[A.PANORAMA].locked=!this.currentPano.highestFullTileRenderOpCompleted&&this.currentPano.lockUntilRenderingComplete)},Si.prototype.updatePanoRenderer=(li=new v.Vector3,function(t){(this.nextPano||this.currentPano)&&(li.copy(tt.FORWARD),this.getDirection(li),this.panoRenderer.updateDirection(li))}),Si.prototype.cleanupInactivePanos=(ci=[],ui=[],function(){ci.length=0,ci.push(this.currentPano),this.nextPano&&ci.push(this.nextPano);for(var t=ui.length=0;t<this.panoRenderer.activePanos.length;t++)ui.push(this.panoRenderer.activePanos[t]);for(var e=0;e<ui.length;e++){for(var i=ui[e],n=!0,o=0;o<ci.length;o++)i.id===ci[o].id&&(n=!1);n&&i.exit()}}),Si.prototype.updatePreRendering=(hi={},function(t){if(1===z.tiling.preRenderTourPanos&&this.preRenderingEnabled){var e=this.nextPano||this.currentPano;if(e&&t&&1<t.length){var i=t.findIndex(function(t){if(t.id===e.id)return!0});if(0<=i&&i+1<t.length){var n=t[i+1];n.isLoaded(this.basePanoSize)||hi[n.id]||(window.setTimeout(function(t){this.checkAndWaitForPanoLoad(t,"high","low",this.basePanoSize,null,null,null,!1,!1,!1),window.setTimeout(function(t){hi[t.id]=!1}.bind(this,t),z.tiling.panoPreRenderRepeatDelay)}.bind(this,n),z.tiling.panoPreRenderDelay),hi[n.id]=!0)}}}}),Si.prototype.enablePreRendering=function(){this.preRenderingEnabled=!0},Si.prototype.disablePreRendering=function(){this.preRenderingEnabled=!1,this.cleanupInactivePanos()},Si.prototype.updateTileDownloader=(di=new v.Vector3,function(t){var e=this.nextPano||this.currentPano;e&&(di.copy(tt.FORWARD),this.getDirection(di),this.tileDownloader.tilePrioritizer.updateCriteria(e,this.position,di,0<t.length?t:null),this.tileDownloader.tilePrioritizer.zoomingActivated=1<this.zoomLevel,this.tileDownloader.processPriorityQueue=!0)}),Si.prototype.updateFromControls=function(t){null!=t||(t=0),this.control&&(this.control.update(t),this.quaternion.copy(this.control.camera.quaternion),this.position.copy(this.control.camera.position),this.target.copy(this.control.target),this.control.camera.updateProjectionMatrix(),this.camera.projectionMatrix.copy(this.control.camera.projectionMatrix)),this.camera.position.copy(this.position),this.camera.quaternion.copy(this.quaternion),this.camera.updateMatrix(),this.camera.updateMatrixWorld()},Si.prototype.hasChanged=function(t){if(!this.previousState)return this.previousState={allFloorsVisible:this.model.allFloorsVisible,position:this.position.clone(),quaternion:this.quaternion.clone(),mouse:this.mouse.clone(),zoom:this.getLabelScaleFactor(),currentFloor:this.model.currentFloor,projectionMatrix:this.camera.projectionMatrix.clone(),worldMatrix:this.camera.matrixWorld.clone(),mode:this.mode,modelPosition:this.model.position.clone(),modelCenter:this.model.center.clone(),zooming:this.zooming},!0;var e=this.model.allFloorsVisible===this.previousState.allFloorsVisible&&this.position.equals(this.previousState.position)&&this.quaternion.equals(this.previousState.quaternion)&&this.mouse.equals(this.previousState.mouse)&&this.getLabelScaleFactor()===this.previousState.zoom&&this.model.currentFloor===this.previousState.currentFloor&&this.camera.projectionMatrix.equals(this.previousState.projectionMatrix)&&this.camera.matrixWorld.equals(this.previousState.worldMatrix)&&this.mode===this.previousState.mode&&this.model.position.equals(this.previousState.modelPosition)&&this.model.center.equals(this.previousState.modelCenter)&&null!==this.nextPano&&this.zooming===this.previousState.zooming;return t.allFloorsVisible=this.model.allFloorsVisible!==this.previousState.allFloorsVisible,t.moved=!this.position.equals(this.previousState.position),t.rotated=!this.quaternion.equals(this.previousState.quaternion),t.mouseMoved=!this.mouse.equals(this.previousState.mouse),t.zoomed=this.getLabelScaleFactor()!==this.previousState.zoom,t.floorChanged=this.model.currentFloor!==this.previousState.currentFloor,t.cameraProjectionChanged=!this.camera.projectionMatrix.equals(this.previousState.projectionMatrix),t.cameraWorldMatrixChanged=!this.camera.matrixWorld.equals(this.previousState.worldMatrix),t.modeChanged=this.mode!==this.previousState.mode,t.modelPositionChanged=!this.model.position.equals(this.previousState.modelPosition),t.modelCenterChanged=!this.model.center.equals(this.previousState.modelCenter),t.nextPanoActive=null!==this.nextPano,t.zooming=this.zooming!==this.previousState.zooming,this.previousState.allFloorsVisible=this.model.allFloorsVisible,this.previousState.position.copy(this.position),this.previousState.quaternion.copy(this.quaternion),this.previousState.mouse.copy(this.mouse),this.previousState.zoom=this.getLabelScaleFactor(),this.previousState.currentFloor=this.model.currentFloor,this.previousState.projectionMatrix.copy(this.camera.projectionMatrix),this.previousState.worldMatrix.copy(this.camera.matrixWorld),this.previousState.mode=this.mode,this.previousState.modelPosition.copy(this.model.position),this.previousState.modelCenter.copy(this.model.center),this.previousState.zooming=this.zooming,!e},Si.prototype.updateIntersect=function(t){if(!g.isMobile()||t){var e=this.flying||this.isWarping(),i=this.isOutsideMode()&&this.controls[this.mode].isEngaged(),n=V.getById(bi.LookTransition),o=!(e||i||this.isTouchEvent||n.length&&n[0].running);this.mattertagManager.intersectMattertag(this.mouse,o,this.camera)||(this.intersect=this.getMouseIntersect(),this.intersect&&this.updateClosestPano(this.intersect),this.closestPano||this.closestPanoInDirection(this.getMouseDirection())?(this.reticule.updatePosition(this.position,this.intersect),z.navigation.panoScores&&!z.navigation.mouseDirection&&this.closestPanoInDirection(this.getDirection())):(this.reticule.updatePosition(this.position,this.intersect),z.isEditVersion&&this.addTagReticule.hide()))}},Si.prototype.getMouseDirection=function(t){t=t||this.mouse;var e=new v.Vector3(t.x,t.y,-1).unproject(this.camera);return new v.Vector3(t.x,t.y,1).unproject(this.camera).sub(e).normalize()},Si.prototype.getMouseOnWholeIntersect=function(t){var e=t.clientX/this.container.clientWidth*2-1,i=-t.clientY/this.container.clientHeight*2+1,n=new v.Vector3(e,i,-1);return n.unproject(this.camera),n},Si.prototype.getMouseIntersect=function(t,e){t=t||this.mouse.clone(),e=e||this.model.floors.reduce(function(t,e){return e.hidden?t:t.concat(e.collider.children)},this.mode===A.PANORAMA?this.panoMarkers:[]);var i=new v.Vector3(t.x,t.y,-1).unproject(this.camera);this.raycaster.set(i,this.getMouseDirection(t));var n=this.raycaster.intersectObjects(e);if(0===n.length)return null;var o=n[0];return o.face&&(o.normal=o.face.normal.applyQuaternion(o.object.quaternion),this.position.clone().sub(o.point).dot(o.normal)<0&&o.normal.negate(),this.currentPano?o.onFloor=o.point.y<this.position.y-.5*this.currentPano.height:o.onFloor=o.point.y<this.position.y-.5,o.horizontal=.8<o.normal.y),o},Si.prototype.updateClosestPano=function(t){if(this.currentPano){var e=[Ce.filters.isPanoAligned()];this.mode===A.PANORAMA?(e.push(Ce.filters.not(this.currentPano)),e.push(Ce.filters.inFloorDirection(this.currentPano.floorPosition,this.getDirection(),.25)),e.push(Ce.filters.isNeighbourPanoTo(this.currentPano)),e.push(Ce.filters.isCloseEnoughTo(t.point,z.panoFloorClickRadius)),e.push(Ce.filters.isNotBehindNormal(t.point,t.normal))):(e.push(Ce.filters.isOnVisibleFloor()),this.mode!==A.FLOORPLAN&&e.push(Ce.filters.inDirection(this.position,this.getDirection(),.25)));var i=this.model.panos.find(e,[Ce.sortFunctions.floorDistanceToPoint(t.point)]);i!=this.closestPano&&(this.emit(Le.ClosestPanoChanging,this.closestPano,i,this.mode),this.closestPano=i)}},Si.prototype.dollhouseMode=function(t,e){this.emit(Le.ModeChanging,this.mode,A.DOLLHOUSE),this.mode=A.DOLLHOUSE,this.controls[A.DOLLHOUSE].reset(),new v.Vector3(this.model.center.x,0,this.model.center.z),new v.Vector3(15,20,15),this.controls[A.DOLLHOUSE].resetRanges(0,!0),this.resetDC(),this.updateFromControls(),this.model.alpha=1,this.model.skybox.material.uniforms.opacity.value=0},Si.prototype.insideMode=function(t,e){var i;if((i=this.model.userData.navigator_arrow)&&(i.visible=!1),e=e||null,(i=this.model.userData.navigator_arrow)&&(i.visible=!1),this.mode!==A.PANORAMA&&this.mode!==A.TRANSITIONING){var n=[Ce.filters.isPanoAligned()];this.model.currentFloor&&n.push(Ce.filters.atFloor(this.model.currentFloor)),t=t||this.currentPano||this.model.panos.find(n,[Ce.sortFunctions.distanceToPoint(this.control.target)]);var o=null!==this.currentPanoQuaternion?this.currentPanoQuaternion:void 0;this.flyToNewMode({mode:A.PANORAMA,pano:t,callback:e,quaternion:o})}},Si.prototype.insideDollhouse=function(){var t=this.model.userData.navigator_arrow;t&&(t.visible=!0)},Si.prototype.insideFloorplan=function(){var t=this.model.userData.navigator_arrow;t&&(t.visible=!1)},Si.prototype.fitDollhouse=function(t,e,i){var n=tt.FORWARD.clone().applyQuaternion(i);this.control.target.copy(n).add(t);var o=tt.RIGHT.clone().applyQuaternion(i),r=tt.UP.clone(),a=o.clone().applyAxisAngle(r,Math.PI/2),s=this.model.boundingBox.max.clone(),l=this.model.boundingBox.min.clone(),c=0,u=0,h=0;[new v.Vector3(s.x,0,s.z).sub(t),new v.Vector3(s.x,0,l.z).sub(t),new v.Vector3(l.x,0,s.z).sub(t),new v.Vector3(l.x,0,l.z).sub(t)].forEach(function(t,e,i){var n=Math.abs(t.dot(o)),r=t.dot(a);c<n&&(c=n,u=r),h<r&&(h=r)});var d=Math.sqrt(Math.pow(s.x-l.x,2)+Math.pow(s.z-l.z,2)),p=d+1/Math.max(2*d,1);this.modellen=d;var f=Math.max(Math.abs(new v.Vector3(0,s.y,0).sub(t).dot(r)),Math.abs(new v.Vector3(0,l.y,0).sub(t).dot(r))),m=a.clone().multiplyScalar(u).add(e),g=a.clone().multiplyScalar(h).add(e);u=c/Math.tan(this.control.camera.fov/2*this.control.camera.aspect*(Math.PI/180)),h=f/Math.tan(this.control.camera.fov/2*(Math.PI/180)),u=Math.max(.5*u,p),h=Math.max(.5*h,p);var y=n.clone().multiplyScalar(-u).add(m).sub(e).length(),b=n.clone().multiplyScalar(-h).add(m).sub(e).length();this.control.maxDistance=z.skyboxRadius-1,b<=y?this.control.camera.position.set(0,6,0).add(m).add(n.multiplyScalar(1.1*-u)):this.control.camera.position.set(0,6,0).add(g).add(n.multiplyScalar(1.1*-h))},Si.prototype.floorplanMode=function(t,e,i){this.mode=A.FLOORPLAN;var n=this.controls[A.FLOORPLAN];n.reset();var o=t||this.model.center;if(n.target.copy(o).setY(0),n.camera.position.copy(o).setY(10),i?(n.currentScale=i/(this.container.clientWidth/this.container.clientHeight),n.absoluteScale=n.currentScale):n.zoomToContain(this.model.size),e){var r=tt.LEFT.clone().applyQuaternion(e);n.rotateLeft(-Math.atan2(r.x,r.z))}else n.rotateToView(this.model.size,this.getDirection());n.update(0)},Si.prototype.nonInterruptingFlyToPano=function(t,e){return t.skipWarpingCheck=!0,this.flyToPano(t,e)},Si.prototype.handleOperation=function(t){if("flytopano"===t.type){var e=t.id,i=this.model.panos.get(e);this.remoteFlyToPano({pano:i})}},Si.prototype.flyToPano=function(t,e){this.connect.getSyncState()&&(this.connect.remoteControl||this.connect.sync||this.connect.sendOperation({type:"flytopano",id:t.pano.id}),this.evalFlyToPano(t,e))},Si.prototype.remoteFlyToPano=function(t,e){this.evalFlyToPano(t,e)},Si.prototype.evalFlyToPano=function(t,e){var i=this,n=t.pano,o=t.lookAtPoint,r=t.duration,a=t.maxDistanceOverride,s=t.skipWarpingCheck,l=t.constantMoveSpeed,c=null,u=null;if(this.isWarping()&&!s){if(this.path.activeTransType===L.BLACK)return yi.warn("Player.flyToPano() -> Cannot fly when warping"),e&&e(),!1;(c=k.deepExtend(t)).skipWarpingCheck=!0;var h=this.evalFlyToPano.bind(this,c,null);return this.emit(Le.WarpInterruptedWithFlyTo,this.path.activeTransType,h),e&&e(),!1}if(this.updateLastView(),this.mode===A.PANORAMA){if(!n||(c=k.deepExtend(t),u=this.evalFlyToPano.bind(this,c,e),!this.checkAndWaitForPanoLoad(n,"high","low",this.basePanoSize,u))){var d=function(t){e&&e(t)}.bind(this);this.currentPano||(this.currentPano=n,this.path.placeCpm(),this.path.fadeOutCpm(z.path.fadeOutTime),this.spider.draw());var p=r;if("number"!=typeof r){var f=a||z.transition.flytimeMaxDistanceThreshold;p=(Math.min(this.currentPano.position.distanceTo(n.position),f)*z.transition.flytimeDistanceMultiplier+z.transition.flyTime)*this.speedmultiplier}if(.01<z.transition.flySpeed&&(p=1e3*this.currentPano.position.distanceTo(n.position)/z.transition.flySpeed),1!==this.zoomLevel)switch(z.zoom.transitionStyle){case 1:this.smoothZoomToDefault(p/2);break;case 2:return c=k.deepExtend(t),u=this.evalFlyToPano.bind(this,c,e),void this.smoothZoomToDefault(z.zoom.restoreTime*(this.zoomLevel-1),u)}if(o){V.cancelById(bi.LookTransition),p*=z.transition.aimSlowFactor;var m=this.control.camera.quaternion.clone(),g=(new v.Matrix4).lookAt(n.position,o,tt.UP),y=(new v.Quaternion).setFromRotationMatrix(g),w=m.clone(),x=new v.Vector3;if(n===this.currentPano){var _=tt.FORWARD.clone().applyQuaternion(m),S=tt.FORWARD.clone().applyQuaternion(y),T=_.angleTo(S),M=1*Math.sqrt(T)/z.mattertags.navigate.rotateSpeedFactor*1e3;return void V.start(function(t){w.copy(m),b.quaternion(w,y)(t),x.copy(tt.FORWARD).applyQuaternion(w).add(this.control.camera.position),this.control.lookAt(x)}.bind(this),M,d,0,D[z.transition.movementEasing],null,bi.LookTransition)}}if(n===this.currentPano||this.flying)return void d();this.flying=!0;var I=this.position.clone(),P=this.currentPano;yi.debug("Flying to pano ",n.position),this.emit(Le.PanoChosen,this.currentPano,n),this.emit(Le.FlyingStarted,n.position,I,n,P),o&&V.start(function(t){w.copy(m),b.quaternion(w,y)(t),x.copy(tt.FORWARD).applyQuaternion(w).add(this.control.camera.position),this.control.lookAt(x)}.bind(this),p,null,0,D[z.transition.movementEasing],null,bi.LookTransition);var C=l?null:D[z.transition.movementEasing];this.updateRulers(p),this.steeringWheelPos(n,this.currentPano,p),this.nextPano=n,this.emit("PanoAnimation",this.nextPano,p),G.R.recording&&this.record(this.currentPano,this.nextPano),V.start(b.uniform(this.model.skybox,"progress",1),p,null,0,D[z.transition.blendEasing],"skyFly",bi.FlyToPano),V.start(b.allUniforms(this.model.chunks,"progress",1),p,null,0,D[z.transition.blendEasing],"chunkFly",bi.FlyToPano),V.start(b.vector(this.cameras[A.PANORAMA].position,n.position),p,function(t){this.flying=!1,this.currentPano.exit(),n.enter(),this.currentPano=n,this.nextPano=null,this.path.placeCpm(),this.path.fadeOutCpm(z.path.fadeOutTime),this.spider.draw(),this.emit(Le.FlyingEnded,n.position,I,n,P),d(t),i.currentPano&&(this.walkOnPano||this.emit(it.MoveHighlightsBar,i.currentPano.roomid),this.mattertagManager.updateRegionalJumpTags(n))}.bind(this),0,C,"camFly",bi.FlyToPano)}}else this.flyToNewMode({mode:A.PANORAMA,pano:n,callback:e})},Si.prototype.record=function(t,e){G.R.last&&G.R.last.time+.05>parseFloat(G.R.time.getElapsedTime().toFixed(5))&&G.R.save2({tap:G.R.last.tap,panoid:G.R.last.panoid,action:G.R.last.action,lon:parseFloat(G.R.last.lon.toFixed(5)),lat:parseFloat(G.R.last.lat.toFixed(5)),time:parseFloat(G.R.last.time.toFixed(5))}),G.R.save({tap:"panorama",panoid:t.id,action:"move",destid:e.id})},Si.prototype.updateRulers=function(t){var e=0,i=Math.ceil(t/20),n=this,o=setInterval(function(){i<++e&&clearInterval(o),n.emit(it.RulersWalk)},20)},Si.prototype.steeringWheelPos=function(t,e,i){if(this.model.steeringWheel&&t.id&&t.position){var n=t.id,o=(G.model.panos.list,this),r=i||400;this.model.steeringWheel.position.copy(t.position),this.model.steeringWheel.material.opacity=0,V.start(b.property(this.model.steeringWheel.material,"opacity",.6),r),this.model.settings.locations.points.forEach(function(t,e){if(t.locationid===n)return o.model.steeringWheel.position.y=t.spot.z+.1,!1})}},Si.prototype.changeSteeringWheelState=function(t){t===A.PANORAMA?this.model.showSteeringWheel():t!==A.DOLLHOUSE&&t!==A.FLOORPLAN||this.model.hideSteeringWheel()},Si.prototype.fastForwardActivePanoFlight=function(t){t=t||z.transition.fastForwardFactor/10*4+1;for(var e=V.getById(bi.FlyToPano),i=0;i<e.length;i++)V.adjustSpeed(e[i],t)},Si.prototype.setSpeedMultiplier=function(t){var e=1,i=1200;switch(t){case"0.3×":e=3,i*=1.5,z.warp.minWarpTime=i;break;case"0.5×":e=2,i*=1.2,z.warp.minWarpTime=i;break;case"1.0×":e=1;break;case"1.5×":e=.67;break;case"2.0×":e=.5;break;default:e=1}this.speedmultiplier=e},Si.prototype.flyToPanoClosestToMouse=function(){if(50<Date.now()-this.mouseLastMoveTime&&(this.intersect=this.getMouseIntersect(),this.intersect&&this.updateClosestPano(this.intersect)),this.closestPano)return this.flyToPano({pano:this.closestPano});var t=this.getMouseDirection();this.flyDirection(t)||this.flyToPano({pano:this.currentPano})},Si.prototype.flyLocalDirection=function(t){var e=this.getDirection(t),i=1===t.z?.4:.75,n=1===Math.abs(t.x);this.flyDirection(e,i,n)},Si.prototype.flyDirection=function(t,e,i){this.history.invalidate();var n=this.closestPanoInDirection(t,e,i);return n?(this.flyToPano({pano:n}),!0):(this.bump(t),!1)},Si.prototype.closestPanoInDirection=function(t,e,i){return this.rankedPanoInDirection(0,t,e,i)},Si.prototype.rankedPanoInDirection=(pi={pano:null,candidates:[]},function(t,e,i,n){t||(t=0),i=void 0!==i?i:.75;var o=n?"angle":"direction";return this.model.panos.findRankedByScore(t,[Ce.filters.isPanoAligned(),Ce.filters.inPanoDirection(this.position,e,i),Ce.filters.isNeighbourPanoTo(this.currentPano),Ce.filters.not(this.currentPano)],[Ce.scoreFunctions.distanceSquared(this.currentPano),Ce.scoreFunctions[o](this.position,e)],pi),this.cachedPanoCandidates=pi.candidates,pi.pano}),Si.prototype.bump=function(t){if(this.mode===A.PANORAMA&&!this.flying&&!this.isWarping()){var e,i,n,o=z.transition,r=(o.flytimeMaxDistanceThreshold*o.flytimeDistanceMultiplier+o.flyTime)/8,a=this.camera.getWorldDirection(new v.Vector3).dot(t);if(.5<Math.abs(a))e=function(){V.start(b.property(this.cameras[A.PANORAMA],"zoom",0<a?1.04:.96),r,i,0,D.easeInOutSine,"bumpZStart")}.bind(this),i=function(){V.start(b.property(this.cameras[A.PANORAMA],"zoom",1),5*r,n,0,D.easeInOutSine,"bumpZRelax")}.bind(this);else{var s=this.camera.position.clone(),l=t.clone();this.raycaster.set(s,l);var c=this.model.floors.reduce(function(t,e){return t.concat(e.collider.children)},[]),u=this.raycaster.intersectObjects(c),h=0<u.length?u[0].distance/25:.04,d=s.clone().add(l.multiplyScalar(h));e=function(){V.start(b.vector(this.cameras[A.PANORAMA].position,d),r,i,0,D.easeInOutSine,"bumpTStart")}.bind(this),i=function(){V.start(b.vector(this.cameras[A.PANORAMA].position,s),5*r,n,0,D.easeInOutSine,"bumpTRelax")}.bind(this)}n=function(){this.flying=!1}.bind(this),this.flying=!0,e()}},Si.prototype.changeFloor=function(t,e){var i=this.controls[this.mode];if(i&&i.emit(it.Move,e),e&&this.controls[A.PANORAMA].emit(it.InteractionGui,"floor-control"),!this.is360View(this.mode,this.currentPano))if(this.mode===A.PANORAMA){var n=this.history.reversePano(t);n&&n.isAligned()?this.flyToPano({pano:n}):this.changeFloorByScore(t)}else this.model.setFloor(this.model.nextFloor(t)||this.model.currentFloor)},Si.prototype.changeFloorByScore=(fi={pano:null,candidates:[]},function(t){var e=this.model.nextFloor(t);return e?(this.model.panos.lowestByScore([Ce.filters.atFloor(e),Ce.filters.isPanoAligned()],[Ce.scoreFunctions.distance(this.currentPano),Ce.scoreFunctions.direction(this.position,new v.Vector3(0,t,0)),Ce.scoreFunctions.penalizeHeightDifferenceUnder(this.position,.5)],fi),void(fi.pano?(this.cachedPanoCandidates=fi.candidates,this.history.push(t,this.currentPano),this.flyToPano({pano:fi.pano})):yi.warn("No pano found on selected floor, not moving there."))):void yi.debug("player.changeFloor("+t+"): no such floor")}),Si.prototype.gotoFloor=function(t,e){var i=t-this.model.currentFloor.floorIndex;this.changeFloor(i,e)},Si.prototype.getDirection=function(t,e){return t=t||(new v.Vector3).copy(tt.FORWARD),e?t.applyQuaternion(G.p.quaternion):t.applyQuaternion(this.camera.quaternion)},Si.prototype.getHighlightDirection=function(t){return(t=t||(new v.Vector3).copy(tt.FORWARD)).applyQuaternion(this.model.heroImage._camera._rotation)},Si.prototype.flyToSameMode=function(t,e,i,n){var o=this;if(this.mode===A.TRANSITIONING)return yi.warn("should not be transitioning here"),void(n&&n(!1));var r=i||!1,a=i?i.position:this.position,s=this.position.clone(),l=this.currentPano;if(yi.debug("New pose in mode "+this.mode),t){var c=this.flyToSameMode.bind(this,t,e,i,n);if(this.checkAndWaitForPanoLoad(t,"high","low",this.basePanoSize,c))return}var u=function(){this.emit(Le.FlyingEnded,a,s,t,l),n&&n(!0),o.currentPano}.bind(this),h=z[this.mode],d=void 0!==e?e:h.transitionTime,p=new v.Vector3,f=new v.Vector3;if(this.emit(Le.FlyingStarted,a,s,t,l),this.mode===A.PANORAMA)yi.warn("we should not be here for panorama views");else if(this.mode===A.DOLLHOUSE)if(r){var m=new v.Vector3(0,1,0);this.controls[A.DOLLHOUSE].resetRanges(1,!0),this.model.warpDestFloors(i.floorVisibility),f.copy(i.position);var g=new v.Vector3(0,0,-1).applyQuaternion(i.quaternion),y=new v.Raycaster(f.clone(),g.clone(),0,1/0).intersectObjects(this.model.colliders),w=3;y.length?(p.copy(y[0].point),w=.75*f.distanceTo(p)):(p.copy(g).multiplyScalar(3).add(f),yi.debug("Tried to restore dollhouse mode that did not intersect...",i.position,i.quaternion));var x=(new v.Matrix4).lookAt(f,p,m),_=(new v.Euler).setFromRotationMatrix(x,z.warp.eOrder),S=p.distanceTo(f),T=(new v.Matrix4).lookAt(this.cameras[A.DOLLHOUSE].position,this.controls[A.DOLLHOUSE].target,m),M=(new v.Euler).setFromRotationMatrix(T,z.warp.eOrder),I=this.cameras[A.DOLLHOUSE].position.distanceTo(this.controls[A.DOLLHOUSE].target);this.controls[A.DOLLHOUSE].resetRanges(Math.min(I,w),!0);var P=new v.Euler(_.x-M.x,_.y-M.y,_.z-M.z,z.warp.eOrder);P.y>Math.PI?P.y-=2*Math.PI:P.y<-Math.PI&&(P.y+=2*Math.PI),this.path.burnsDir=Math.sign(P.y);var C=new v.Euler(0,0,0,z.warp.eOrder),E=new v.Vector3;V.start(b.vector(this.controls[A.DOLLHOUSE].target,p),d,null,z.flydown.movementDelay,D[z.flydown.movementEasing],null,bi.FlyToSameMode),V.start(function(t,e){C.x=M.x+t*P.x,C.y=M.y+t*P.y,C.z=M.z+t*P.z;var i=I+t*(S-I);E.set(0,0,i).applyEuler(C).add(this.controls[A.DOLLHOUSE].target),this.cameras[A.DOLLHOUSE].position.copy(E).add(this.model.position)}.bind(this),d,null,z.flydown.movementDelay,D[z.flydown.movementEasing],null,bi.FlyToSameMode),V.start(function(t,e){this.controls[A.DOLLHOUSE].update(),this.quaternion.copy(this.cameras[A.DOLLHOUSE].quaternion),this.position.copy(this.cameras[A.DOLLHOUSE].position)}.bind(this),d,null,z.flydown.movementDelay,D[z.flydown.movementEasing],null,bi.FlyToSameMode)}else yi.warn("invalid warp destination in flyToSameMode()? ignore it then");else if(this.path.placeCpm(),this.path.fadeInCpm(z.path.fadeInTime),i){this.model.warpDestFloors(i.floorVisibility);var L=this.cameras[A.FLOORPLAN],k=this.controls[A.FLOORPLAN],R=k.target.clone(),O=i.position.clone().sub(R),F=L.position.clone().sub(k.target).length(),N=new v.Vector3(-1,0,0).applyQuaternion(i.quaternion).normalize(),U=Math.atan2(k.offset.x,k.offset.z),B=Math.atan2(N.x,N.z),G=k.absoluteScale,j=i.orthoZoom/(this.container.clientWidth/this.container.clientHeight);V.start(function(t,e){k.target.copy(O).multiplyScalar(t).add(R);var i=U+(B-U)*t;k.offset.x=F*Math.sin(i),k.offset.z=F*Math.cos(i),L.position.copy(k.target).add(k.offset),k.absoluteScale=G+t*(j-G),k.update(),this.quaternion.copy(L.quaternion),this.position.copy(L.position),this.target.copy(k.target),this.camera.projectionMatrix.copy(L.projectionMatrix)}.bind(this),d,null,0,D[z.flydown.movementEasing],null,bi.FlyToSameMode)}else yi.info("flyToSameMode() funny floorplan view? skipping");V.setTimeout(function(t){this.mode=t,u()}.bind(this,this.mode),d,bi.FlyToSameMode),this.mode=A.TRANSITIONING},Si.prototype.ownFlyToNewMode=function(t){var e=(t=t||{}).mode,i=t.pano,n=t.duration,o=t.warpDest,r=t.callback,a=t.force;if(t.quaternion,this.isWarping())return yi.warn("Player.flyToNewMode() -> Cannot fly when warping"),void(r||r(!1));if(this.mode!==A.TRANSITIONING)if(e!==this.mode){yi.debug("Switching mode to "+e);var s=this.ownFlyToNewMode.bind(this,t);if(!i||!this.checkAndWaitForPanoLoad(i,"low","low",this.basePanoSize,s)){if(!this.model.meshTexturesLoaded&&this.isOutsideMode(e))return yi.info("Waiting for model textures to be loaded before going out to dollhouse"),this.model.waitForLoad(this.model,function(){return self.model.meshTexturesLoaded}),void this.model.loadMeshTextures().done(s);this.history.invalidate(),this.updateLastView();var l=this.mode;this.cameras[e],t=k.deepExtend({},z[e],z[l+"-"+e]),void 0!==n||t.transitionTime}}else a?this.flyToSameMode(i,n,o,r):r&&r(!1);else r&&r(!1)},Si.prototype.flyToNewMode=function(t){var e=this,i=(t=t||{}).mode,n=t.pano,o=t.duration,r=t.warpDest,a=t.callback,s=t.force,l=t.quaternion;if(this.isWarping())return yi.warn("Player.flyToNewMode() -> Cannot fly when warping"),void(a&&a(!1));if(this.mode!==A.TRANSITIONING){if(i===this.mode)return s?void this.flyToSameMode(n,o,r,a):void(a&&a(!1));var c=r||!1;yi.debug("Switching mode to "+i);var u=this.flyToNewMode.bind(this,t);if(!n||!this.checkAndWaitForPanoLoad(n,"low","low",this.basePanoSize,u)){if(!this.model.meshTexturesLoaded&&this.isOutsideMode(i))return yi.info("Waiting for model textures to be loaded before going out to dollhouse"),this.model.waitForLoad(this.model,function(){return this.model.meshTexturesLoaded}.bind(this)),void this.model.loadMeshTextures().done(u);this.history.invalidate(),this.updateLastView();var h=this.mode,d=this.cameras[i];t=k.deepExtend({},z[i],z[h+"-"+i]);var p=void 0!==o?o:t.transitionTime;this.emit(Le.ModeChanging,h,i,n),n&&(this.currentPano=n),h===A.PANORAMA&&(this.currentPanoQuaternion=this.quaternion.clone()),this.switchCameraMode(i,l),V.cancelById(bi.LookTransition);var f=(new v.Vector3).copy(this.position);if(i===A.PANORAMA)this.emit(Le.PanoChosen,n,n),setTimeout(function(){n.floor.enter(i)}.bind(this),p/2),this.path.fadeOutCpm(z.path.fadeOutTime);else if(i===A.DOLLHOUSE){if(c&&(this.model.stayPut=!0),r?(this.controls[A.DOLLHOUSE].resetRanges(1,!0),this.model.warpDestFloors(r.floorVisibility)):this.model.toggleAllFloors(!0),this.path.placeCpm(),this.path.fadeInCpm(z.path.fadeInTime),c){var m=new v.Vector3(this.model.center.x,0,this.model.center.z);f.set(15,10,15);var g=new v.Vector3(0,0,-1).applyQuaternion(r.quaternion),y=new v.Raycaster(r.position.clone(),g.clone(),0,1/0).intersectObjects([this.sceneIntersectionPlane]);y.length?(m.copy(y[0].point),f.copy(r.position),this.controls[A.DOLLHOUSE].resetRanges(.75*f.distanceTo(m),!0)):(yi.warn("Tried to restore dollhouse mode that did not intersect...",r.position,r.quaternion),this.controls[A.DOLLHOUSE].resetRanges(3,!0)),this.controls[A.DOLLHOUSE].target.copy(m),f.add(this.model.position),d.position.copy(f),this.controls[A.DOLLHOUSE].update()}}else if(this.path.placeCpm(),this.path.fadeInCpm(z.path.fadeInTime),r){this.model.warpDestFloors(r.floorVisibility);var w=this.cameras[A.FLOORPLAN],x=this.controls[A.FLOORPLAN],_=w.position.clone().sub(x.target),S=new v.Vector3(-1,0,0).applyQuaternion(r.quaternion).normalize(),T=Math.atan2(S.x,S.z);x.target.copy(r.position);var M=_.length();x.offset.x=M*Math.sin(T),x.offset.y=0,x.offset.z=M*Math.cos(T),w.position.copy(x.target).add(x.offset),x.target.clone().sub(d.position),d.quaternion.copy(r.quaternion),x.currentScale=r.orthoZoom/(this.container.clientWidth/this.container.clientHeight),x.absoluteScale=x.currentScale,x.update()}else this.model.currentFloor.enter(i);var I=this.currentPano,P=this.position.clone();this.emit(Le.FlyingStarted,f,P,n,this.currentPano),this.flying=!0,this.isOutsideMode(i)&&this.is360View(h,I)?(c||i!==A.DOLLHOUSE||(d.position.set(15,10,15),d.controls.target.set(this.model.center.x,0,this.model.center.z),d.controls.update()),t.blackoutStyle=Ue.FADEIN,p=z.show360Views.transitionTime,this.fade360View(p,d,t)):this.isOutsideMode(h)&&this.is360View(i,n)?(c&&this.switchCameraMode(i,c.quaternion),this.mode=i,this.path&&this.path.popOutCpm(),t.blackoutStyle=Ue.END,p=z.show360Views.transitionTime,this.fade360View(p,d,t)):(V.start(b.property(this.model,"alpha",t.modelAlpha,null),p*t.modelAlphaLength,null,t.modelAlphaDelay,null,bi.FlyToNewMode),V.start(b.vector(this.position,d.position),p,null,z.flydown.movementDelay,D[z.flydown.movementEasing],null,bi.FlyToNewMode),V.start(b.quaternion(this.quaternion,d.quaternion),p*t.rotationDuration,null,t.rotationDelay,D[z.flydown.rotationEasing],null,bi.FlyToNewMode),V.start(b.matrix4(this.camera.projectionMatrix,d.projectionMatrix),p*t.cameraMatrixDuration,null,t.cameraMatrixDelay,t.cameraMatrixEase,null,bi.FlyToNewMode),V.start(b.uniform(this.model.skybox,"opacity",t.skyboxOpacity),p*t.skyboxOpacityLength,null,t.skyboxOpacityDelay,null,bi.FlyToNewMode),V.start(b.property(this.reticule.material.uniforms.opacity,"value",0),p,null,bi.FlyToNewMode)),V.setTimeout(function(){this.flying=!1,h===A.PANORAMA&&i!==A.PANORAMA?this.currentPano.exit():h!==A.PANORAMA&&i===A.PANORAMA&&(this.currentPano.enter(),this.path.placeCpm(),this.path.fadeOutCpm(z.path.fadeOutTime),this.spider.draw()),h===A.DOLLHOUSE&&this.controls[A.DOLLHOUSE].resetRanges(),this.mode=i,this.emit(Le.FlyingEnded,f,P,this.currentPano,I),e.currentPano&&("panorama"===G.player.mode&&this.emit(it.MoveHighlightsBar,e.currentPano.roomid),this.steeringWheelPos(e.currentPano),this.mattertagManager.updateRegionalJumpTags(e.currentPano)),e.model.entranceMesh&&(e.isOutsideMode()?e.model.setEntranceState(!0):e.model.setEntranceState(!1)),c&&h!==A.PANORAMA&&i===A.PANORAMA?this.startWarp(ei.Retain,ti.Retain,L.BLACK,null,null,a):a&&a()}.bind(this),p,bi.FlyToNewMode),this.mode=A.TRANSITIONING}}else a&&a(!1)},Si.prototype.fade360View=function(t,e,i){this.mattertagManager.hideShowTagsForBlackoutStyle(i.blackoutStyle,t),o(this.container).fadeOut(.5*t,function(){this.model.skybox.material.uniforms.opacity.value=i.skyboxOpacity,this.model.alpha=i.modelAlpha,this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.camera.projectionMatrix.copy(e.projectionMatrix),o(this.container).fadeIn(.5*t)}.bind(this))},Si.prototype.findDefaultViews=function(){this.findDefaultView(this.lastInsideView,!0),this.findDefaultView(this.last360View,!1)},Si.prototype.findDefaultView=function(t,e){var i,n=this.model.heroLocations,o=this.model.panos,r=n.findIndex(function(t){if(t.cameraMode!==A.PANORAMA)return!1;var i=o.get(t.panoId);return i&&i.isAligned()===e});0<=r?(i=o.get(n[r].panoId),t.update({cameraMode:A.PANORAMA,pano:i,position:n[r].position,quaternion:n[r].quaternion})):0<=(r=o.list.findIndex(function(t){return t.isAligned()===e}))?(i=o.list[r],t.update({cameraMode:A.PANORAMA,pano:i,position:i.position})):yi.warn("There are no",e?"inside":"360Âº","views in this model")},Si.prototype.updateLastView=function(){this.mode===A.PANORAMA&&(this.currentPano.isAligned()?this.lastInsideView:this.last360View).update({pano:this.currentPano,position:this.position,quaternion:this.quaternion})},Si.prototype.goToLastView=function(t){var e=t?this.lastInsideView:this.last360View;this.isInMode(A.PANORAMA)&&this.currentPano.isAligned()!==t&&this.updateLastView(),this.isInMode(A.PANORAMA)?(this.path&&this.path.popOutCpm(),this.fadeToView(t,e,z.show360Views.transitionTime)):this.isOutsideMode()&&this.flyToNewMode({mode:e.cameraMode,pano:e.pano,quaternion:e.quaternion})},Si.prototype.setStateWithAnimation=function(t,e){t&&(t.mode&&t.mode!==this.mode&&this.mode!==A.TRANSITIONING?t.mode===A.PANORAMA?this.flyToNewMode({pano:this.model.panos.index[t.panoId],mode:A.PANORAMA}):(jt.prototype._progressNumber=function(t,e,i){return t+(e-t)*i},jt.prototype._progressRad=function(t,e,i){var n=2*Math.PI,o=Math.PI,r=function(t){return(t%n+n)%n};return t=r(t),o<(e=r(e))-t?this._progressNumber(t+n,e,i):o<t-e?this._progressNumber(t-n,e,i):this._progressNumber(t,e,i)}):this.mode!==A.TRANSITIONING&&this.controls[this.mode].translateWithAnimation(t.lon,t.lat,e),t.zoomLevel&&t.zoomLevel!==this.zoomLevel&&this.zoomTo(t.zoomLevel,!0))},Si.prototype.fadeToView=function(t,e,i){if(!e.isValid()||e.cameraMode===A.PANORAMA&&!e.pano)return yi.warn("Tried to fade to an illegal view",e.cameraMode),!1;var n=function(){o(this.container).fadeIn(.5*i)}.bind(this),r=t?Ue.FADEIN:Ue.END;this.mattertagManager.hideShowTagsForBlackoutStyle(r,i),o(this.container).fadeOut(.5*i,function(){this.model.fadePanoMarkers(t?z.panorama.markerOpacity:0),e.cameraMode===A.PANORAMA?this.flyToPano({pano:e.pano,lookAtPoint:tt.FORWARD.clone().applyQuaternion(e.quaternion).add(e.pano.position),duration:0},n):this.flyToNewMode({mode:e.cameraMode,quaternion:e.quaternion,duration:0,callback:n})}.bind(this))},Si.prototype.startWarp=function(t,e,i,n,o,r){if(this.control&&(this.control.enabled=!1),this.flying)return yi.warn("Player.startWarp() -> Cannot warp when flying"),r&&r(),!1;null!=t||(t=ei.Show),this.history.invalidate(),"walk"===i?this.walkOnPano=!0:(this.walkOnPano=!1,this.updateRulers(1e3)),t!=ei.Retain?this.path.brushToWarpPano(i,L.BLACK)||(i=L.BLACK):i=this.path.upcomingTransType;var a=this.path.warpDestPano&&!this.path.warpDestPano.isAligned();return this.emit(Le.WarpStarted,a,i,n,o),n=n||Ue.MIDDLE,this.path.warpToPano(i,n,o,function(){e===ti.Slow?this.path.discardSlow():e===ti.Standard&&this.path.discardPathObject(),this.emit(Le.WarpEnded,i),this.control&&(this.control.enabled=!0),r&&r()}.bind(this)),t===ei.Hide&&this.path.discardPathObject(),!0},Si.prototype.warpToPanoById=function(t,e,i,n,o,r,a,s){return this.path.setWarpDestinationByPanoId(t,e)?this.startWarp(i,n,o,r,a,s):(yi.warn("Player.warpToPanoById() -> Could not setWarpDestinationByPanoId()"),s&&s(),!1)},Si.prototype.warpToPanoByHeroIndex=function(t,e,i,n,o,r,a){if(-1!=e)return this.path.setWarpDestinationByHeroIndex(t)?this.startWarp(e,i,n,o,r,a):(a&&a(),!1);this.startWarp(e,i,n,o,r,a)},Si.prototype.warpToPano=function(t,e,i,n,o,r,a,s){return this.warpToPanoById(t.id,e,i,n,o,r,a,s)},Si.prototype.warpToNonPanoByHeroIndex=function(t,e){return this.path.setWarpDestinationByHeroIndex(t)?(this.path.warpToNonPano(e),!0):(yi.warn("Player.warpToNonPanoByHeroIndex() -> Could not setWarpDestinationByHeroIndex()"),e&&e(),!1)},Si.prototype.aimTourCamera=function(t,e,i,n){return this.warpToPanoByHeroIndex(t,e,i,null,null,null,n)},Si.prototype.showPathToHeroLocation=function(t){this.mode!==A.PANORAMA&&this.path.setWarpDestinationByHeroIndex(t)&&this.path.brushToWarpPano(L.STD,L.BLACK)},Si.prototype.tourInterlude=function(t,e){this.history.invalidate(),this.path.discardSlow(),this.path.waitNextStep(t,function(){e&&e()})},Si.prototype.stopInterlude=function(){this.interruptAndFastForward(null,0)},Si.prototype.interruptAndFastForward=function(t,e){this.isWarping()&&this.emit(Le.WarpInterrupted,this.path.activeTransType,t,e),this.flying&&this.emit(Le.FlyingInterrupted),this.path.interruptAndFastForward(t,e)},Si.prototype.setSize=function(t,e){var i=t/e;for(var n in this.cameras)this.cameras[n].updateAspect(i);this.mode===A.FLOORPLAN&&(this.control.zoomToContain(this.model.size),this.control.update(),this.emit("updateSize"))},Si.prototype.toJSON=function(){var t={};return this.control&&((t=this.control.toJSON())._type=A.toInt(this.mode),this.isOutsideMode()?this.model.allFloorsVisible?t.floor_visibility=[]:t.floor_visibility=this.model.floors.list.map(function(t){return t.hidden?0:1}):t._locationid=this.currentPano.id),t},Si.prototype.getCurrentNodePanos=function(t){if(this.model.panos.map,t.length=0,this.path.nodes)for(var e=0;e<this.path.nodes.length;e++){var i=this.path.nodes[e];t.push(this.model.panos.get(i))}},Si.prototype.zoomIncrementally=function(t){var e=this.zoomLevel;this.zoomTo(this.zoomLevel+t),e!==this.zoomLevel&&this.currentPano&&this.zoomStats.addZoomAction(e,this.zoomLevel,this.currentPano.id)},Si.prototype.zoomInIncrementally=function(t){t=t||this.defaultZoomIncrement,this.zoomIncrementally(t)},Si.prototype.zoomOutIncrementally=function(t){t=t||-this.defaultZoomIncrement,this.zoomIncrementally(t)},Si.prototype.zoomBy=function(t){this.zoomTo(this.zoomLevel*t)},Si.prototype.zoomIn=function(){this.zoomBy(1+this.zoomSpeed)},Si.prototype.zoomOut=function(){this.zoomBy(1-this.zoomSpeed)},Si.prototype.jumpTo3D=function(){z.jumpTo3D&&(G.d.changeMode(A.DOLLHOUSE),G.d.jumpingto3d=!0)},Si.prototype.zoomTo=function(t,e){if(e||z.zoom.enabled&&this.mode===A.PANORAMA&&this.zoomEnabled){if(t<z.zoom.min?this.zf?3<this.clock.getElapsedTime()-this.start?this.zf=!1:(this.len+=z.zoom.min-t,.26<this.len&&(this.jump=!0,this.zf=!1)):(this.start=this.clock.getElapsedTime(),this.zf=!0,this.len=0,this.jump=!1):(this.zf=!1,this.len=0,this.jump=!1),t<z.zoom.min){t=z.zoom.min;var i=G.model.outsideAllowed(),n=!this.isInMode(A.DOLLHOUSE,A.TRANSITIONING);if(this.jump&&i&&n)return G.R.recording&&G.R.save({tap:"dollhouse"}),void this.jumpTo3D()}if(t>z.zoom.max&&(t=z.zoom.max),t>this.zoomLevel?(this.emit("zoom.in"),t===z.zoom.max&&this.emit("zoom.max")):t<this.zoomLevel&&(this.emit("zoom.out"),t===z.zoom.min&&this.emit("zoom.min")),this.control){G.R.recording&&G.R.save({tap:"zoom",type:"panorama",level:t});var o=this.control.camera;this.zoomLevel=t,o.fov=this.baseFov*(1/this.zoomLevel),o.updateProjectionMatrix(),this.zoomFov=o.fov}}},Si.prototype.increaseZoomSpeed=function(){this.zoomSpeed=this.clampZoomSpeed(this.zoomSpeed+this.zoomSpeedAdjust)},Si.prototype.decreaseZoomSpeed=function(){this.zoomSpeed=this.clampZoomSpeed(this.zoomSpeed-this.zoomSpeedAdjust)},Si.prototype.clampZoomSpeed=function(t){return t<0?0:t},Si.prototype.activatePersistentZooming=function(t){this.zooming=t?1:-1},Si.prototype.deactivatePersistentZooming=function(){this.zooming=0},Si.prototype.zoomDefault=function(){this.zoomTo(1,!0)},Si.prototype.smoothZoomToDefault=function(t,e){var i,n=this.zoomLevel,o=function(t){1<t&&(t=1),i=n*(1-t)+t,this.zoomTo(i,!0)}.bind(this),r=function(){this.zoomDefault(),e&&window.setTimeout(e,50)}.bind(this);V.start(o,t,r,null,0,D[z.transition.blendEasing])},Si.prototype.updateZoomPano=function(){if(!this.panoRenderer.zoomPanoRenderingDisabled&&this.mode===A.PANORAMA){var t=this.currentPano;if(t){var e=this.zoomLevel>z.zoom.activationThreshold,i=!(this.flying&&this.nextPano&&this.nextPano!==this.currentPano||this.isWarping()),n=e&&i;this.tileDownloader.tilePrioritizer.setZoomingActive(n),this.panoRenderer.setZoomingActive(n,t,!0);var o=function(t,e){this.panoRenderer.resetRenderStatus(t.id,!1,!0,this.qualityManager.getMaxNavPanoSize()),this.panoRenderer.clearAllQueuedUploadsForPano(t.id),this.panoRenderer.renderPanoTiles(t.id,null,!1,!1),t.setZoomed(e)}.bind(this);n&&!t.zoomed?(o(t,!0),this.panoRenderer.enableUltraHighQualityMode(function(){this.qualityManager.useUltraHighResolutionPanos&&!z.zoom.overridemax&&(z.zoom.max=N.ultraHighQualityMaxZoom),n&&o(t,!0)}.bind(this))):!e&&t.zoomed&&o(t,!1)}}},Si.prototype.setLabelPlacing=function(t,e){if("panorama"===this.mode&&null!=this.currentPano&&null!=this.currentPano.id){this.isLabelEdit=!0,this.tagpictype=e,this.reticule.editHidden=!0,this.reticule.hide();var i={actiontype:1,base:{x:0,y:0,z:0}};i.details={tagpictype:this.tagpictype,tagpicurl:t,templatetype:103,description:"",subtype:0,time:"",title:""},i.enable=!0,i.locationid=this.currentPano.id,i.normal={x:0,y:0,z:0},i.tagid="-1",G.typeT=1,i.stem={direction:{x:0,y:0,z:0},enabled:!0},this.model.newBuildTagsForAddTag(i)}},Si.prototype.cancelLabelPlacing=function(){this.isLabelEdit=!1,this.reticule.editHidden=!1,this.reticule.show(),this.model.delTag(-1),this.mattertagManager.updateModel()},Si.prototype.setLabelIcon=function(t,e,i){var n=this.model.mattertags,o=null;for(var r in n)(o=n[r]).tagid==t&&o.updateTagMaterial(e,i)},Si.prototype.setPanoramaIcon=function(t){var e=this.panoMarkers,i=H.loadurl(t);e.forEach(function(t){t.enable&&(t.material.map=i,t.material.needUpdate=!0)})},Si.prototype.destory=function(){this.panoSizeLocationMap=[]},Si.prototype.showAxesOfScene=function(){var t=new v.AxesHelper(5);this.sRender.scene.add(t)},Si.prototype.showWireFrame=function(t){for(var e=0===t?this.model.chunks:this.model.colliders,i={},n=0;n<e.length;++n){var o,r=e[n];this.removeWireFrame(r),function t(){o=Math.random(),i["_"+o]&&t(),i["_"+o]=1}(),this.addWireFrame(r,16777215*o)}},Si.prototype.hideWireFrame=function(){for(var t=this.model.chunks,e=this.model.colliders,i=t.concat(e),n=0;n<i.length;++n){var o=i[n];this.removeWireFrame(o)}},Si.prototype.addWireFrame=function(t,e){var i=new v.WireframeGeometry(t.geometry),n=new v.LineSegments(i);n.material.color.setHex(e),n.rotation.copy(t.rotation),n.position.copy(t.position),t.userData.line_segments=n,t.add(n)},Si.prototype.removeWireFrame=function(t){if(t.userData.line_segments){var e=t.userData.line_segments;t.userData.line_segments=null,e.geometry.dispose(),e.material.dispose(),t.remove(e)}};var Ti=Si,Mi={ActionInterrupted:"action.interrupted"},Ii=0,Pi=1,Ci=2,Ai=3;function Ei(){(G.d=this).endlessLoop=z.warp.loop,this.clock=new v.Clock(!0),this.model=null,this.player=null,this.currentItem=null,this.destinationItem=null,this.tourIsPlaying=!1,this.transitionStage=ki.None,this.nextFunc=null,this.onTheBus=!1,this.reachSource=null,this.interrupted=!1,this.nItems=0,this.currentScript=1,this.walkingSectionPaused=!1,this.sLen=0,this.connect=At(),this.handleOperation=this.handleOperation.bind(this),this.connect.on("operation",this.handleOperation)}var Li=ot.EventEmitter,Di=new S("/js/director.js"),ki=Object.freeze({None:0,Moving:1,Aiming:2,Interlude:3}),Ri=Object.freeze({Forward:1,NoChange:0,Backwards:-1});(Ei.prototype=Object.create(Li.prototype)).init=function(t,e){this.player=t,this.modelManager=e,this.updateModel(),this.resetAll(),this.bindEvents()},Ei.prototype.resetAll=function(){if(this.currentItem=null,this.destinationItem=null,this.tourIsPlaying=!1,this.transitionStage=ki.None,this.nextFunc=null,this.onTheBus=!1,this.reachSource=null,this.interrupted=!1,this.model)switch(this.model.switch_scene_type){case 1:this.defaultWarpStyle=L.BLACK;break;case 2:this.defaultWarpStyle=L.WALK;break;case 3:this.defaultWarpStyle=L.STD;break;default:this.defaultWarpStyle=L.BLACK}else this.defaultWarpStyle=L.BLACK,Di.warn('No model yet, choosing "'+this.defaultWarpStyle+'" transitions');this.resetSpecialTransition()},Ei.prototype.updateModel=function(){this.model=this.modelManager.getActiveModel(),this.nItems=this.model.heroLocations.length-1},Ei.prototype.bindEvents=function(){this.modelManager.on(ke.ActiveModelChanged,this.updateModel.bind(this)),this.player.on(Le.WarpInterruptedWithFlyTo,this.handleFlyToWarpInterruption.bind(this)),this.player.on(Le.Move,this.handlePlayerMove.bind(this)),this.player.on(Le.PanoChosen,this.handlePlayerPanoChosen.bind(this)),this.player.on(Le.ModeChanged,this.handlePlayerModeChanged.bind(this)),this.player.on(Le.InputStart,this.handlePlayerInputStart.bind(this)),this.player.on(Le.FlyingStarted,this.handlePlayerFlyingStarted.bind(this))},Ei.prototype.handleFlyToWarpInterruption=function(t,e){t===L.WALK?(this.interrupt(Ue.NONE),this.pauseWalkingSection(),this.player.fastForwardActivePanoFlight()):this.transitionStage===ki.Interlude&&(this.interrupt(Ue.NONE),e&&e())},Ei.prototype.handlePlayerMove=function(t){this.transitionStage===ki.Interlude&&this.interrupt(Ue.NONE)},Ei.prototype.handlePlayerPanoChosen=function(t,e){this.intermediateState()||t.id===e.id||(this.onTheBus=!1,this.emit("update.controls"))},Ei.prototype.handlePlayerModeChanged=function(t,e){this.intermediateState()||t===e||(this.onTheBus=!1,this.emit("update.controls"))},Ei.prototype.handlePlayerInputStart=function(t){this.transitionStage===ki.Interlude&&this.interrupt(Ue.NONE)},Ei.prototype.handlePlayerFlyingStarted=function(){this.clearWalkingSectionPaused(),G.player.mattertagManager.ttflying=!0},Ei.prototype.describe=function(){return{nItems:this.nItems,currentItem:this.currentItem,destinationItem:this.destinationItem,tourIsPlaying:this.tourIsPlaying,onTheBus:this.onTheBus,endlessLoop:this.endlessLoop,viewMode:this.player.mode,inTransition:this._inTransition(),transitionStage:this.transitionStage}},Ei.prototype._inTransition=function(){return this.player.flying||this.player.isWarping()||this.player.mode===A.TRANSITIONING||this.tourIsPlaying},Ei.prototype.bounceable=function(){var t=this.clock.getDelta();return this.isInterrupted()||t<.9&&.01<t||this.player.flying&&!this.player.isWarping()},Ei.prototype.currentMoveDirection=function(){return null===this.currentItem||void 0===this.currentItem?Ri.Forward:this.destinationItem===this.currentItem?Ri.NoChange:this.destinationItem>this.currentItem?Ri.Forward:Ri.Backwards},Ei.prototype.clearPath=function(){this._inTransition()||this.player.path.discardPathObject()},Ei.prototype.allFloors=function(){G.R.recording&&G.R.save({tap:"floor",action:"all"}),this.connect.getSyncState()&&(this.connect.remoteControl||this.connect.sync||this.connect.sendOperation({type:"floorchange",floorIndex:"all"}),this.showAllFloors())},Ei.prototype.showAllFloors=function(){var t=this.player.controls[this.player.mode];t&&t.emit("move","gui"),this.player.controls[A.PANORAMA].emit(it.InteractionGui,"floor-control"),this.model.toggleAllFloors()},Ei.prototype.gotoFloor=function(t){G.R.recording&&G.R.save({tap:"floor",action:""+parseInt(t)}),this.connect.getSyncState()&&(this.connect.remoteControl||this.connect.sync||this.connect.sendOperation({type:"floorchange",floorIndex:t}),this.player.gotoFloor(t,"gui"))},Ei.prototype.openTag=function(){this.player.mattertagManager.closeTag(),null!==this.currentItem&&void 0!==this.currentItem||(this.currentItem=0),this.currentItem-this.sLen<0||G.R.recording},Ei.prototype.actionComplete=function(t){var e=this.transitionStage;if(this.interrupted=!1,this.transitionStage=ki.None,this.resetSpecialTransition(),null!==this.destinationItem&&this.setCurrentItem(this.destinationItem),this.tourIsPlaying||(this.player.disablePreRendering(),this.player.mode===A.PANORAMA&&this.player.currentPano.isAligned()&&this.model.fadePanoMarkers()),this.emit("update.controls"),this.currentScript&&(this.model.enableTagMovie&&e===ki.Interlude||this.model.enableTagMovie&&e===ki.Aiming&&null===this.nextFunc))this.emit("gotoheighlight_done"),G.R.pafter();else if(this.nextFunc){var i=this.nextFunc;this.nextFunc=null,i()}else this.emit("gotoheighlight_done"),G.R.pafter()},Ei.prototype.awaitCompletion=function(t,e){this.nextFunc=e,t()},Ei.prototype.updateSuccessFunction=function(t){this.nextFunc=t},Ei.prototype.interrupt=function(t,e){return!(!this.wouldInterrupt()||!this.canInterrupt()||(this.tourIsPlaying&&(this.player.zoomEnabled=this.wasZoomEnabled),this.tourIsPlaying=!1,this.interrupted=!0,this.nextFunc=null,this.emit(Mi.ActionInterruped),null!=t||(t=Ue.BEGINNING),this.player.interruptAndFastForward(t,e),0))},Ei.prototype.wouldInterrupt=function(){return this.transitionStage!==ki.None},Ei.prototype.intermediateState=function(){return this.transitionStage!==ki.None},Ei.prototype.isInterrupted=function(){return this.interrupted},Ei.prototype.canInterrupt=function(){return this.transitionStage!==ki.Aiming&&this.transitionStage!==ki.Moving||this.transitionStage===ki.Moving&&this.player.mode===A.PANORAMA&&this.nextWarpStyle!==L.BLACK},Ei.prototype.pauseWalkingSection=function(){this.walkingSectionPaused=!0},Ei.prototype.clearWalkingSectionPaused=function(){this.walkingSectionPaused=!1},Ei.prototype.autoTour=function(){G.settings.nestscenes&&G.settings.nestscenes.scenes&&G.settings.nestscenes.scenes.length&&!G.settings.nestscenes.scenes[0].script&&0<=z.warp.auto&&V.trigger({duration:1e3*Math.min(300,z.warp.auto),done:function(){this.playTour()}.bind(this),name:"_atr"})},Ei.prototype.atDestinationPano=function(){if(!this.player.currentPano||null===this.destinationItem)return!1;var t=this.player.currentPano.id;if(void 0===t)return!1;var e=this.model.heroLocations;return null!==this.destinationItem&&void 0!==e[this.destinationItem]&&t==e[this.destinationItem].panoId},Ei.prototype.redirectToItem=function(t,e){if(null!=t)if(this.wouldInterrupt())if(this.player.mode!==A.TRANSITIONING){Di.debug("Director.redirectToItem() -> Redirecting to "+t+" via "+e);var i=function(){V.setTimeout(function(){this.setDestinationItem(t),this.goToDestination(!0,Ue.BEGINNING,z.warp.warpInterruptionRedirectTime,!1)}.bind(this),0)}.bind(this);this.interrupt(Ue.END,0),this.updateSuccessFunction(i)}else Di.debug("Director.redirectToItem() -> Cannot redirect while transitioning.");else Di.warn("Director.redirectToItem() -> Director cannot redirect if there is nothing to interrupt.");else Di.warn("Director.redirectToItem() -> Redirecting to null item.")},Ei.prototype.useSpecialTransition=function(t){void 0!==t&&this.defaultWarpStyle!==L.BLACK&&Di.debug("useSpecialTransition(): "+t),this.nextWarpStyle=this.defaultWarpStyle},Ei.prototype.resetSpecialTransition=function(){this.nextWarpStyle=this.defaultWarpStyle},Ei.prototype.arrivedAtDestination=function(t){if(this.player.flying||this.player.isWarping())Di.warn("Cannot advance to interlude or aiming while player is flying or warping.");else{this.transitionStage=ki.Aiming;var e=this.tourIsPlaying?this.tourInterlude.bind(this,this.nextItem(this.currentItem)):null;this.player.model.fadePanoMarkers(0),this.tour360view(),this.awaitCompletion(function(){this.resetSpecialTransition(),t?this.player.aimTourCamera(this.destinationItem,ei.Hide,ti.Slow,this.actionComplete.bind(this)):this.actionComplete()}.bind(this),e)}},Ei.prototype.toast=function(t){setTimeout(function(){document.getElementsByClassName("toast-wrap")[0].getElementsByClassName("toast-msg")[0].innerHTML=t;var e=document.getElementsByClassName("toast-wrap")[0];e.className=e.className.replace("toastAnimate",""),setTimeout(function(){e.className=e.className+" toastAnimate"},10)},10)},Ei.prototype.tour360view=function(){this.model},Ei.prototype.goToDestination=function(t,e,i,n){if(this.onTheBus=!0,this.emit("update.controls"),this.player.updateLastView(),n||!this.atDestinationPano())if(this.player.flying||this.player.isWarping())Di.warn("Cannot go to new destination while player is flying or warping.");else{var o=this.model.getHeroDescriptorByIndex(this.destinationItem),r=null,a=null;if(this.player.model.scene_switch_scene_type&&1==this.player.model.scene_switch_scene_type&&(this.nextWarpStyle=L.BLACK),this.player.mattertagManager.update360Tags(o.panoId),o.isPano()){var s=0===this.destinationItem||t?L.BLACK:this.nextWarpStyle;a=this.player.warpToPanoByHeroIndex.bind(this.player,this.destinationItem,ei.Show,ti.Slow,s,e,i,this.actionComplete.bind(this)),r=this.arrivedAtDestination.bind(this,!0)}else a=this.player.warpToNonPanoByHeroIndex.bind(this.player,this.destinationItem,this.actionComplete.bind(this)),r=this.arrivedAtDestination.bind(this,!1);this.transitionStage=ki.Moving,this.model.fadePanoMarkers(0),this.awaitCompletion(function(){a()}.bind(this),r),this.emit("update.controls")}else this.arrivedAtDestination(!0)},Ei.prototype.tourInterlude=function(){if(this.model.fadePanoMarkers(0),this.emit("update.controls"),this.tourIsPlaying)return this.atEndOfTour()&&!this.endlessLoop?(this.stopTour(),void(this.player.mode===A.PANORAMA&&this.model.fadePanoMarkers(z.panorama.markerOpacity))):void this.awaitCompletion(function(){this.transitionStage=ki.Interlude,this.player.tourInterlude(this.nextItem(this.currentItem),this.actionComplete.bind(this))}.bind(this),this.goNext.bind(this))},Ei.prototype.playTour=function(t){this.bounceable()||(this.tourIsPlaying?Di.info("tour is already playing"):this.wouldInterrupt()||(this.player.emit("tour_auto",this.defaultWarpStyle),this.reachSource="play",this.tourIsPlaying=!0,this.wasZoomEnabled=this.player.zoomEnabled,this.player.zoomEnabled=!1,this.resetSpecialTransition(),this.emit("update.controls"),this.player.enablePreRendering(),this.walkingSectionPaused?(this.clearWalkingSectionPaused(),this.goToDestination()):this.goNext()))},Ei.prototype.hideTourBar=function(){},Ei.prototype.stopTour=function(){this.emit("tourStop"),this.isInterrupted()||(this.tourIsPlaying&&(this.player.zoomEnabled=this.wasZoomEnabled),this.tourIsPlaying=!1,this.interrupt(),this.clearWalkingSectionPaused(),this.resetSpecialTransition(),this.emit("update.controls")),this.hideTourBar()},Ei.prototype.goToHighlight=function(t){if(this.canInterrupt()||!this.wouldInterrupt()){if(this.wouldInterrupt()&&(t===this.destinationItem?this.interrupt():this.redirectToItem(t,"goToHighlight")),this.isInterrupted())return void(G.R.fgotoh=!1);this.clearWalkingSectionPaused(),this.setDestinationItem(t),this.useSpecialTransition("Hilight"),this.goToDestination()}},Ei.prototype.goToHighlightByLocation=function(t){var e=this.model.heroLocations.findIndex(function(e){return!(!e.panoId||e.panoId!=t)});if(this.canInterrupt()||!this.wouldInterrupt()){if(Di.debug("<tour.goto "+e+">"),this.wouldInterrupt()&&(e===this.destinationItem?this.interrupt():this.redirectToItem(e,"goToHighlight")),this.isInterrupted())return;this.clearWalkingSectionPaused(),this.setDestinationItem(e),this.useSpecialTransition("Hilight"),this.goToDestination()}},Ei.prototype.prevHighlight=function(){this.bounceable()||(this.player.emit("tour_manual","prev"),this.interrupt(Ue.BEGINNING)||this.isInterrupted()||(this.clearWalkingSectionPaused(),this.reachSource="prev",this.goPrev()))},Ei.prototype.nextHighlight=function(){this.bounceable()||(this.player.emit("tour_manual","next"),this.interrupt(Ue.BEGINNING)||this.isInterrupted()||(this.clearWalkingSectionPaused(),this.reachSource="next",this.goNext()))},Ei.prototype.handleOperation=function(t){if("changemode"===t.type){var e=t.mode;this.remoteChangeMode(e)}else if("floorchange"===t.type){var i=t.floorIndex;"all"===i?this.showAllFloors():this.player.gotoFloor(i,"remote")}},Ei.prototype.changeMode=function(t,e){this.connect.getSyncState()&&(this.connect.remoteControl||this.connect.sync||this.connect.sendOperation({type:"changemode",mode:t}),this.evalChangeMode(t,e))},Ei.prototype.remoteChangeMode=function(t){this.evalChangeMode(t)},Ei.prototype.evalChangeMode=function(t,e){var i=e||"gui";switch(this.wouldInterrupt()&&this.interrupt(),this.player.controls[t].emit("interaction."+i),this.clearWalkingSectionPaused(),t){case A.PANORAMA:this.player.insideMode();break;case A.DOLLHOUSE:this.player.insideDollhouse();break;case A.FLOORPLAN:this.player.insideFloorplan()}this.player.flyToNewMode({mode:t})},Ei.prototype.atEndOfTour=function(){return this.currentItem>=this.nItems-1},Ei.prototype.firstDestination=function(){if(this.nItems<=0)return null;for(var t=0;t<this.nItems;t++)if(this.model.images.list[t].script===this.currentScript)return t;return 0},Ei.prototype.finalDestination=function(){if(this.nItems<=0)return null;for(var t=this.nItems-1;0<=t;t--)if(this.model.images.list[t].script===this.currentScript)return t;return 0},Ei.prototype.goPrev=function(){this.tourAdvance(-1)},Ei.prototype.goNext=function(){null===this.currentItem&&(this.currentItem=this.finalDestination());for(var t,e=!1,i=this.currentItem+1;i<this.nItems;i++)if(this.model.images.list[i].script===this.currentScript){t=i-this.currentItem,e=!0;break}e||(t=this.nItems-this.currentItem),0===t&&(t=1),this.tourAdvance(t)},Ei.prototype.setDestinationItem=function(t){t>this.nItems&&(t=this.firstDestination()),this.destinationItem=t,this.emit("update.controls")},Ei.prototype.setCurrentItem=function(t){this.currentItem=t,this.emit("update.controls")},Ei.prototype.nextItem=function(t){return t?t>this.nItems&&this.endlessLoop?this.firstDestination():t<this.nItems?t+1:void 0:this.firstDestination()},Ei.prototype.prevItem=function(t){return null===t?this.firstDestination():t<0?this.endlessLoop?this.lastDestination():null:t-1},Ei.prototype.tourAdvance=function(t){Di.debug("tourAdvance("+t+")"),null===this.currentItem||void 0===this.currentItem?this.setDestinationItem(this.firstDestination()):this.setDestinationItem(this.currentItem+t),this.destinationItem<0?(this.setDestinationItem(this.finalDestination()),this.useSpecialTransition("reverse-looping to end")):this.destinationItem>=this.nItems&&(this.setDestinationItem(this.firstDestination()),this.useSpecialTransition("looping back to start")),this.goToDestination()},Ei.prototype.compassAdd=function(t){this.model.adjustCompass+=t},Ei.prototype.compassReset=function(t){this.model.adjustCompass=t};var Oi=Ei,Fi={TagActivated:"tag.activated",TagDismissed:"tag.dismissed",TagNavigation:"tag.navigation"},Ni=d(function(t){(function(e){function i(t){this.player=null,this.director=null,this.modelManager=null,this.container=null,this.mattertagManager=null,this.fadeInSpeed=t,null!==this.fadeInSpeed&&void 0!==this.fadeInSpeed||(this.fadeInSpeed=0)}var n=v,r=Le,a=Mi,s=z,l=A,c=ke,u=Fi,h=V,d=b,p=new S(e);i.prototype.init=function(t,e,i,n,o){this.player=e,this.director=t,this.modelManager=i,this.mattertagManager=n,this.container=o,this.updateModel(),this.bindEvents()},i.prototype.bindEvents=function(){this.modelManager.on(c.ActiveModelChanged,this.updateModel.bind(this)),this.player.on(r.ModeChanging,this.handlePlayerModeChanging.bind(this)),this.player.on(r.ModeChanged,this.handlePlayerModeChanged.bind(this)),this.player.on(r.ClosestPanoChanging,this.handleClosestPanoChanging.bind(this)),this.player.on(r.StartInside,this.handleStartInside.bind(this)),this.player.on(r.StartOutside,this.handleStartOutside.bind(this)),this.player.on(r.WarpStarted,this.handleWarpStarted.bind(this)),this.director.on(a.ActionInterrupted,this.handleActionInterruption.bind(this)),this.mattertagManager.on(u.TagActivated,this.onMattertagActivated.bind(this)),this.mattertagManager.on(u.TagNavigation,this.onNavigationToMattertag.bind(this))},i.prototype.updateModel=function(){this.model=this.modelManager.getActiveModel()},i.prototype.handleWarpStarted=function(){this.hidePlayerReticule()},i.prototype.onMattertagActivated=function(){this.hidePlayerReticule()},i.prototype.onNavigationToMattertag=function(){this.hidePlayerReticule()},i.prototype.handlePlayerModeChanging=function(t,e,i){var n=this.modelManager.getActiveModel(),o=this.player.is360View(e,i)||this.director.tourIsPlaying?0:s[e].markerOpacity;n.fadePanoMarkers(o),n.setMode(e)},i.prototype.handlePlayerModeChanged=function(t,e){var i=this.modelManager.getActiveModel(),o=e===l.PANORAMA?n.DoubleSide:n.FrontSide;i.setSide(o),i.setMode(e),"dollhouse"===e&&(G.R.lon=0,G.R.lastlon=void 0)},i.prototype.handleClosestPanoChanging=function(t,e,i){i!==l.TRANSITIONING&&(t&&!this.director.tourIsPlaying&&t.hoverOff(i),e&&!this.director.tourIsPlaying&&e.hoverOn(i))},i.prototype.handleActionInterruption=function(){},i.prototype.handleStartInside=function(t){var e=s[this.player.mode],i=t?0:e.transitionTime*e.skyboxOpacityLength;this.fadeIn(this.fadeInSpeed),this.model.alpha=0,this.model.skybox.material.uniforms.opacity.value=1,this.model.fadePanoMarkers(t?0:e.markerOpacity);var n=this.player.reticule;h.start(d.property(n.material,"opacity",0),i,null,0,null,"retReOpac")},i.prototype.handleStartOutside=function(t){this.fadeIn(t)},i.prototype.fadeIn=function(t){null!=t||(t=2e3,p.warn("DisplayController.fadeIn -> no transition time specified, defaulting to 2000 ms.")),o(this.container).fadeIn(t)},i.prototype.hidePlayerReticule=function(){this.player.reticule.hide()},t.exports=i}).call(h,"/js/DisplayController.js")}),Ui=2,Bi=d(function(t){(function(e){function i(t){this.cache=null,this.expires=0}function n(){this.baseUrl=null,this.cache=null,this.expires=0}function r(){this.baseUrl=null,this.expires=0}function a(t){this.initialLoadingPromise=null,this.endpoint=t+"?type=3",this.urlContainer=null,this.authorizationHeader=c.getAuthorizationHeader(),this.containerClasses=[r,n,i]}var s=P,l=N,c=F,u=new S(e);i.prototype={version:1,validate:function(t){return"catalog.json"in t&&0<Object.keys(t).length},update:function(t){return this.cache=t,this.expires=Date.now()+l.signedUrlDefaultExpireTime,o.when()},get:function(t){return this.cache[t]}},n.prototype={version:2,validate:function(t){return"catalog.json"in t&&"base.url"in t&&1<Object.keys(t).length},update:function(t){return this.baseUrl=t["base.url"],this.cache=t,this.expires=Date.now()+l.signedUrlDefaultExpireTime,o.when()},get:function(t){var e=this.cache[t];return e?this.baseUrl.replace("{{filename}}",t)+e:null}},r.prototype={version:3,validate:function(t){return!0},update:function(t){return this.baseUrl=t.locationpics,t.expires?this.expires=1e3*t.expires:this.expires=Date.now()+l.signedUrlDefaultExpireTime,o.when()},get:function(t){return this.baseUrl.replace("{{filename}}",t)}},a.prototype={init:function(){return this.initialLoadingPromise||(setInterval(function(){}.bind(this),l.signedUrlCheckInterval),this.initialLoadingPromise=this.refresh()),this.initialLoadingPromise},refresh:function(t){var e=void 0===(t=t||{}).cache||t.cache;return s.get(this.endpoint,{responseType:"json",prefetchFrom:e?"basic":null,cache:e,auth:this.authorizationHeader}).then(function(t){if(this.urlContainer&&this.urlContainer.validate(t))return this.urlContainer.update(t);for(var i=0;i<this.containerClasses.length;i++){var n=new this.containerClasses[i];if(n.validate(t))return u.info("Using urls version "+n.version),this.urlContainer=n,this.urlContainer.update(t)}return e?this.refresh({cache:!1}):o.Deferred().reject("missing-urls")}.bind(this),function(t){return"loading-failed"})},get:function(t){return G.url.model+"/"+t}},t.exports=a}).call(h,"/js/util/ModelUrls.js")}),zi=d(function(t){function e(t,e,i){var n=(t=t.clone()).size(),o=new v.BoxGeometry(n.x,n.y,n.z);o.boundingBox=t,v.Mesh.call(this,o,e),this.position.copy(t.center()),this.frustumCulled=!1,i&&this.add(new v.WireframeHelper(this))}(e.prototype=Object.create(v.Mesh.prototype)).constructor=e,t.exports=e}),Vi=d(function(t){function e(t){t=t||{},G.model.enablefilter?v.RawShaderMaterial.call(this,k.extendObject({fragmentShader:$.model2.fragmentShader,vertexShader:$.model2.vertexShader,uniforms:v.UniformsUtils.clone($.model2.uniforms),name:"ModelTextureMaterial"},t)):v.RawShaderMaterial.call(this,k.extendObject({fragmentShader:$.model.fragmentShader,vertexShader:$.model.vertexShader,uniforms:v.UniformsUtils.clone($.model.uniforms),name:"ModelTextureMaterial"},t))}((e.prototype=Object.create(v.RawShaderMaterial.prototype)).constructor=e).prototype.setProjectedPanos=function(t,e,i){if(G.model.enablefilter){var n=t.getAjustedColors(),o=e.getAjustedColors();i&&(this.uniforms.progress.value=0),t.ensureSkyboxReadyForRender(),this.uniforms.pano0Map.value=t.getSkyboxTexture(),this.uniforms.brightness0.value=n.brightness,this.uniforms.contrast0.value=n.contrast,this.uniforms.gamma0.value=n.gamma,this.uniforms.hue0.value=n.hue,this.uniforms.saturation0.value=n.saturation,this.uniforms.vibrance0.value=n.vibrance,this.uniforms.balance0.value.copy(n.balance),this.uniforms.pano0Position.value.copy(t.position),this.uniforms.pano0Matrix.value.copy(t.skyboxMesh.matrixWorld),e.ensureSkyboxReadyForRender(),this.uniforms.pano1Map.value=e.getSkyboxTexture(),this.uniforms.brightness1.value=o.brightness,this.uniforms.contrast1.value=o.contrast,this.uniforms.gamma1.value=o.gamma,this.uniforms.hue1.value=o.hue,this.uniforms.saturation1.value=o.saturation,this.uniforms.vibrance1.value=o.vibrance,this.uniforms.balance1.value.copy(o.balance),this.uniforms.pano1Position.value.copy(e.position),this.uniforms.pano1Matrix.value.copy(e.skyboxMesh.matrixWorld)}else i&&(this.uniforms.progress.value=0),t.ensureSkyboxReadyForRender(),this.uniforms.pano0Map.value=t.getSkyboxTexture(),this.uniforms.pano0Position.value.copy(t.position),this.uniforms.pano0Matrix.value.copy(t.skyboxMesh.matrixWorld),e.ensureSkyboxReadyForRender(),this.uniforms.pano1Map.value=e.getSkyboxTexture(),this.uniforms.pano1Position.value.copy(e.position),this.uniforms.pano1Matrix.value.copy(e.skyboxMesh.matrixWorld)},t.exports=e}),Gi=d(function(t){(function(e){function i(t){l.time("Computing a nice bounding cubemap");var e=new r({side:n.BackSide,transparent:!0});e.uniforms.modelAlpha.value=0,e.uniforms.opacity.value=1-a.modelAlpha,this.renderOrder=s.boundingSkybox,o.call(this,t,e),l.timeEnd("Computing a nice bounding cubemap")}var n=v,o=zi,r=Vi,a=z,s=Y,l=new S(e);(i.prototype=Object.create(o.prototype)).constructor=i,t.exports=i}).call(h,"/js/objects/BoundingTextureSkybox.js")});function ji(t){this.chunksize=t||10,this.chunks={},this.boundingBoxes={},this.children=[],this.offset=new v.Vector3(0,.5,0),this.material=new v.MeshBasicMaterial({color:16777215*Math.random(),side:v.DoubleSide})}ji.prototype.add=function(t){var e,i,n,o,r,a,s,l,c,u,h=t.attributes,d=new v.Vector3;if(h?(e=h.position.array,i=void 0!==t.index?t.index.array:void 0):(e=t.vertices,t.faces),i)for(n=0,o=i.length;n<o;n+=3){var p=3*i[n],f=3*i[n+1],m=3*i[n+2];r=(e[p]+e[f]+e[m])/3,a=(e[p+1]+e[f+1]+e[m+1])/3,s=(e[p+2]+e[f+2]+e[m+2])/3,c=(l=Math.floor(r/this.chunksize)+"."+Math.floor(a/this.chunksize)+"."+Math.floor(s/this.chunksize))in this.chunks?(u=this.chunks[l],this.boundingBoxes[l]):(u=this.chunks[l]=[],this.boundingBoxes[l]=new v.Box3),u.push(e[p],e[p+1],e[p+2],e[f],e[f+1],e[f+2],e[m],e[m+1],e[m+2]),c.expandByPoint(d.set(e[p],e[p+1],e[p+2])),c.expandByPoint(d.set(e[f],e[f+1],e[f+2])),c.expandByPoint(d.set(e[m],e[m+1],e[m+2]))}else for(n=0,o=e.length;n<o;n+=9)r=(e[n]+e[n+3]+e[n+6])/3,a=(e[n+1]+e[n+4]+e[n+7])/3,s=(e[n+2]+e[n+5]+e[n+8])/3,c=(l=Math.floor(r/this.chunksize)+"."+Math.floor(a/this.chunksize)+"."+Math.floor(s/this.chunksize))in this.chunks?(u=this.chunks[l],this.boundingBoxes[l]):(u=this.chunks[l]=[],this.boundingBoxes[l]=new v.Box3),u.push(e[n],e[n+1],e[n+2],e[n+3],e[n+4],e[n+5],e[n+6],e[n+7],e[n+8]),c.expandByPoint(d.set(e[n],e[n+1],e[n+2])),c.expandByPoint(d.set(e[n+3],e[n+4],e[n+5])),c.expandByPoint(d.set(e[n+6],e[n+7],e[n+8]))},ji.prototype.build=function(){var t=new v.Object3D;for(var e in t.material=this.material,this.chunks){var i=this.chunks[e],n=new v.BufferGeometry;n.addAttribute("position",new v.BufferAttribute(new Float32Array(i),3)),n.boundingBox=this.boundingBoxes[e];var o=new v.Mesh(n,this.material);o.material.visible=!1,t.add(o),this.chunks[e]=[]}return t};var Hi=ji;function Wi(t,e,i){v.Object3D.call(this),this.model=t,this.floorIndex=e,this.name=i||e+1,this.panos=[],this.chunks=[],this.colliderBuilder=new Hi(3),this.collider=null,this.center=null,this.boundingBox=new v.Box3,this.size=null,this.hidden=!1,this.conservativeBoundingBox=new v.Box3,this.debugColor=16777215*Math.random(),this.transition=null,this.pano360Position=null}(Wi.prototype=Object.create(v.Object3D.prototype)).enter=function(t){this.model.setFloor(this,t)},Wi.prototype.hide=function(t){if(!this.hidden||this.transition){this.chunks.forEach(function(t){t.material.transparent=!0}),V.cancel(this.transition);var e=t?0:z.hideFloorDuration+z.hideFloorDelay,i=t?0:z.hideFloorDelay/e;this.transition=V.start(b.allUniforms(this.chunks,"opacity",.08),e,function(){this.hidden=!0}.bind(this),i,D.easeInOutQuad)}},Wi.prototype.show=function(t){if(this.hidden||this.transition){this.hidden=!1,V.cancel(this.transition);var e=t?z.showFloorDuration:z.showFloorDuration+z.showFloorDelay,i=t?0:z.showFloorDelay/e;this.transition=V.start(b.allUniforms(this.chunks,"opacity",1),e,function(){this.hidden||this.chunks.forEach(function(t){t.material.transparent=!1})}.bind(this),i,D.easeInOutQuad)}},Wi.prototype.toggle=function(t,e){(t=void 0===t?this.hidden:t)?this.show(e):this.hide(e)},Wi.prototype.containsPoint=function(t){return this.collider.children.some(function(e){return e.geometry.boundingBox||e.geometry.computeBoundingBox(),e.geometry.boundingBox.containsPoint(t)})},Wi.prototype.distanceToPoint=function(t){var e=null,i=1/0;return this.collider.children.forEach(function(n){n.geometry.boundingBox||n.geometry.computeBoundingBox();var o=n.geometry.boundingBox.distanceToPoint(t);(!e||o<i)&&(i=o,e=n)}),i},Wi.prototype.addChunk=function(t){t.renderOrder=Y.ghostFloor,this.add(t),this.chunks.push(t),this.boundingBox.union(t.geometry.boundingBox),this.size=this.boundingBox.size(),this.colliderBuilder.add(t.geometry)},Wi.prototype.addPano=function(t){this.panos.push(t),this.add(t.skyboxMesh),t.marker&&this.add(t.marker);var e=new v.Vector3(1,1,1);2==t.alignmentType&&(null==this.pano360Position&&(this.pano360Position=new v.Vector3((this.boundingBox.min.x+this.boundingBox.max.x)/2,this.boundingBox.min.y-2.1,(this.boundingBox.min.z+this.boundingBox.max.z)/2)),t.position=this.pano360Position,t.skyboxMesh.position.copy(t.position),e=new v.Vector3(4,4,4));var i=(new v.Box3).setFromCenterAndSize(t.position,e);this.boundingBox.union(i)},Wi.prototype.build=function(){this.collider=this.colliderBuilder.build(!0),this.add(this.collider),this.center=this.boundingBox.center(),this.conservativeBoundingBox.copy(this.boundingBox),this.conservativeBoundingBox.min.y=k.lowerMedian(this.collider.children.map(function(t){return t.geometry.boundingBox.min.y}),5),this.conservativeBoundingBox.max.y=k.lowerMedian(this.collider.children.map(function(t){return t.geometry.boundingBox.max.y}),5),this.colliderBuilder=null},Wi.prototype.toShortString=function(){return k.nth(this.floorIndex+1)},Wi.prototype.toString=function(){return this.name};var qi=Wi;function $i(){this.list=[],this.index={},Object.defineProperty(this,"length",{get:function(){return this.list.length}})}new S("/js/util/IndexedCollection.js"),$i.prototype.forEach=function(t){this.list.forEach(t)},$i.prototype.add=function(t){this.list.push(t),this.index[this.getIndex(t)]=t},$i.prototype.getIndex=function(t){throw new Error("IndexedCollection.getIndex not implemented in subclass.")},$i.prototype.extend=function(t){for(var e=0;e<t.length;e++)this.add(t[e])},$i.prototype.get=function(t){return this.index[t]},$i.prototype.first=function(){return this.list[0]},$i.prototype.last=function(){return this.list[this.list.length-1]},$i.prototype.reIndex=function(){this.index={};var t=this;this.forEach(function(e){t.index[t.getIndex(e)]=e})},$i.prototype.filter=function(t){var e=this.list.filter(t);return this.reIndex(),e},$i.prototype.reduce=function(t,e){return this.list.reduce(t,e)},$i.prototype.sort=function(t){return this.list.sort(t)},$i.prototype.indexOf=function(t){for(var e=0;e<this.list.length;++e)if(this.list[e]===t)return e;return-1},$i.prototype.getLength=function(){return this.list.length};var Yi=$i;function Xi(t){Yi.call(this),this.model=t,this.exploded=!1}new S("/js/model/FloorCollection.js"),k.inherit(Xi,Yi),Xi.prototype.add=function(t){Yi.prototype.add.call(this,t),this.model.add(t)},Xi.prototype.getIndex=function(t){return t.floorIndex},Xi.prototype.build=function(){this.list.forEach(function(t){t.build()})},Xi.prototype.size=function(){return this.length},Xi.prototype.sort=function(){Yi.prototype.sort.call(this,function(t,e){return t.floorIndex-e.floorIndex})},Xi.prototype.nextFloor=function(t,e){return this.index[t.floorIndex+e]||null},Xi.prototype.getFloorAtPoint=function(t){for(var e=null,i=1/0,n=0;n<this.list.length;n++){var o=this.list[n],r=o.distanceToPoint(t);(!e||r<i)&&(i=r,e=o)}return e},Xi.prototype.getOrMakeFloor=function(t){var e=this.index[t];return e||(e=new qi(this.model,t),this.add(e)),e},Xi.prototype.hide=function(){this.list.forEach(function(t){t.hide()})},Xi.prototype.show=function(){this.list.forEach(function(t){t.show()})},Xi.prototype.names=function(){return this.list.reduce(function(t,e){return t.concat(e.name)},[])},Xi.prototype.toggleExplodeHorizontal=function(){function t(t,e){t.position.x=i[t.floorIndex]*e,t.position.y=1*t.floorIndex*e}var e,i=[],n=0;this.list.forEach(function(t,o,r){e=0<o?Math.max(r[o-1].boundingBox.max.x-t.boundingBox.min.x,t.boundingBox.size().x/2):0,n+=e,i[o]=n}),i=i.map(function(t){return t-n/2}),this.exploded?this.list.forEach(function(e){V.start(function(i){t(e,1-i)}.bind(this),1500,null,0,D.easeOutExpo)}.bind(this)):this.list.forEach(function(e){V.start(function(i){t(e,i)}.bind(this),1500,null,0,D.easeOutExpo)}.bind(this)),this.exploded=!this.exploded},Xi.prototype.toggleExplodeVertical=function(){function t(t,i){t.position.y=(5*t.floorIndex-e.y/2)*i,t.panos.forEach(function(e){e.position.y=e.origin.y+t.position.y,e.skyboxMesh.position.y=e.origin.y+t.position.y})}var e=this.model.size;this.exploded?this.list.forEach(function(e){V.start(function(i){t(e,1-i)},1500,null,0,D.easeOutExpo)}):this.list.forEach(function(e){V.start(function(i){t(e,i)},1500,null,0,D.easeOutExpo)}),this.exploded=!this.exploded};var Qi=Xi;function Zi(t){this.materialInside=new Vi({side:v.DoubleSide}),this.materialOutside=new v.RawShaderMaterial({fragmentShader:$.modelOutside.fragmentShader,vertexShader:$.modelOutside.vertexShader,uniforms:v.UniformsUtils.clone($.modelOutside.uniforms),side:v.FrontSide,name:"chunkOut"}),v.Mesh.call(this,t.geometry,this.materialInside),this.name=t.name||"",this.textureName=t.textureName,this.meshUrl=t.meshUrl}(Zi.prototype=Object.create(v.Mesh.prototype)).setTextureMap=function(t){this.materialInside.uniforms.map.value=t,this.materialOutside.uniforms.map.value=t},Zi.prototype.setMode=function(t){var e=t===A.DOLLHOUSE||t===A.FLOORPLAN?this.materialOutside:this.materialInside;e.side=t===A.PANORAMA?v.DoubleSide:v.FrontSide,e.transparent=this.material.transparent,e.uniforms.opacity.value=this.material.uniforms.opacity.value,this.material=e};var Ki=Zi,Ji={getSize:function(t){var e=0,i=0;if(null!=t){var n=t.substring(t.lastIndexOf("_")+1,t.lastIndexOf("."));if(null!=n){var o=n.split("x");null!=o&&1<o.length&&(e=parseInt(o[0],0),i=parseInt(o[1],0))}}return{width:e,height:i}},getWinSize:function(t){var e=this.getSize(t);if(!e.width||!e.height||e.width<=window.innerWidth&&e.height<=window.innerHeight)return e;var i=e.width/e.height;return i>=window.innerWidth/window.innerHeight?(e.width=window.innerWidth,e.height=e.width/i):(e.height=window.innerHeight,e.width=e.height*i),e}},tn="ext-link",en=(d(function(t){(function(){var e,i,n,o,r,s,l,u,h,d=function(t,i){if(!(this instanceof d))return new d(t,i);var n={direction:"horizontal",touchEventsTarget:"container",initialSlide:0,speed:300,autoplay:!1,autoplayDisableOnInteraction:!0,autoplayStopOnLast:!1,iOSEdgeSwipeDetection:!1,iOSEdgeSwipeThreshold:20,freeMode:!1,freeModeMomentum:!0,freeModeMomentumRatio:1,freeModeMomentumBounce:!0,freeModeMomentumBounceRatio:1,freeModeMomentumVelocityRatio:1,freeModeSticky:!1,freeModeMinimumVelocity:.02,autoHeight:!1,setWrapperSize:!1,virtualTranslate:!1,effect:"slide",coverflow:{rotate:50,stretch:0,depth:100,modifier:1,slideShadows:!0},flip:{slideShadows:!0,limitRotation:!0},cube:{slideShadows:!0,shadow:!0,shadowOffset:20,shadowScale:.94},fade:{crossFade:!1},parallax:!1,zoom:!1,zoomMax:3,zoomMin:1,zoomToggle:!0,scrollbar:null,scrollbarHide:!0,scrollbarDraggable:!1,scrollbarSnapOnRelease:!1,keyboardControl:!1,mousewheelControl:!1,mousewheelReleaseOnEdges:!1,mousewheelInvert:!1,mousewheelForceToAxis:!1,mousewheelSensitivity:1,mousewheelEventsTarged:"container",hashnav:!1,hashnavWatchState:!1,history:!1,replaceState:!1,breakpoints:void 0,spaceBetween:0,slidesPerView:1,slidesPerColumn:1,slidesPerColumnFill:"column",slidesPerGroup:1,centeredSlides:!1,slidesOffsetBefore:0,slidesOffsetAfter:0,roundLengths:!1,touchRatio:1,touchAngle:45,simulateTouch:!0,shortSwipes:!0,longSwipes:!0,longSwipesRatio:.5,longSwipesMs:300,followFinger:!0,onlyExternal:!1,threshold:0,touchMoveStopPropagation:!0,touchReleaseOnEdges:!1,uniqueNavElements:!0,pagination:null,paginationElement:"span",paginationClickable:!1,paginationHide:!1,paginationBulletRender:null,paginationProgressRender:null,paginationFractionRender:null,paginationCustomRender:null,paginationType:"bullets",resistance:!0,resistanceRatio:.85,nextButton:null,prevButton:null,watchSlidesProgress:!1,watchSlidesVisibility:!1,grabCursor:!1,preventClicks:!0,preventClicksPropagation:!0,slideToClickedSlide:!1,lazyLoading:!1,lazyLoadingInPrevNext:!1,lazyLoadingInPrevNextAmount:1,lazyLoadingOnTransitionStart:!1,preloadImages:!0,updateOnImagesReady:!0,loop:!1,loopAdditionalSlides:0,loopedSlides:null,control:void 0,controlInverse:!1,controlBy:"slide",normalizeSlideIndex:!0,allowSwipeToPrev:!0,allowSwipeToNext:!0,swipeHandler:null,noSwiping:!0,noSwipingClass:"swiper-no-swiping",passiveListeners:!0,containerModifierClass:"swiper-container-",slideClass:"swiper-slide",slideActiveClass:"swiper-slide-active",slideDuplicateActiveClass:"swiper-slide-duplicate-active",slideVisibleClass:"swiper-slide-visible",slideDuplicateClass:"swiper-slide-duplicate",slideNextClass:"swiper-slide-next",slideDuplicateNextClass:"swiper-slide-duplicate-next",slidePrevClass:"swiper-slide-prev",slideDuplicatePrevClass:"swiper-slide-duplicate-prev",wrapperClass:"swiper-wrapper",bulletClass:"swiper-pagination-bullet",bulletActiveClass:"swiper-pagination-bullet-active",buttonDisabledClass:"swiper-button-disabled",paginationCurrentClass:"swiper-pagination-current",paginationTotalClass:"swiper-pagination-total",paginationHiddenClass:"swiper-pagination-hidden",paginationProgressbarClass:"swiper-pagination-progressbar",paginationClickableClass:"swiper-pagination-clickable",paginationModifierClass:"swiper-pagination-",lazyLoadingClass:"swiper-lazy",lazyStatusLoadingClass:"swiper-lazy-loading",lazyStatusLoadedClass:"swiper-lazy-loaded",lazyPreloaderClass:"swiper-lazy-preloader",notificationClass:"swiper-notification",preloaderClass:"preloader",zoomContainerClass:"swiper-zoom-container",observer:!1,observeParents:!1,a11y:!1,prevSlideMessage:"Previous slide",nextSlideMessage:"Next slide",firstSlideMessage:"This is the first slide",lastSlideMessage:"This is the last slide",paginationBulletMessage:"Go to slide {{index}}",runCallbacksOnInit:!0},o=i&&i.virtualTranslate;i=i||{};var r={};for(var s in i)if("object"!=typeof i[s]||null===i[s]||i[s].nodeType||i[s]===window||i[s]===document||void 0!==g&&i[s]instanceof g||void 0!==a&&i[s]instanceof a)r[s]=i[s];else for(var l in r[s]={},i[s])r[s][l]=i[s][l];for(var u in n)if(void 0===i[u])i[u]=n[u];else if("object"==typeof i[u])for(var h in n[u])void 0===i[u][h]&&(i[u][h]=n[u][h]);var p=this;if(p.params=i,p.originalParams=r,p.classNames=[],void 0!==e&&void 0!==g&&(e=g),(void 0!==e||(e=void 0===g?window.Dom7||window.Zepto||c:g))&&(p.$=e,p.currentBreakpoint=void 0,p.getActiveBreakpoint=function(){if(!p.params.breakpoints)return!1;var t,e=!1,i=[];for(t in p.params.breakpoints)p.params.breakpoints.hasOwnProperty(t)&&i.push(t);i.sort(function(t,e){return parseInt(t,10)>parseInt(e,10)});for(var n=0;n<i.length;n++)(t=i[n])>=window.innerWidth&&!e&&(e=t);return e||"max"},p.setBreakpoint=function(){var t=p.getActiveBreakpoint();if(t&&p.currentBreakpoint!==t){var e=t in p.params.breakpoints?p.params.breakpoints[t]:p.originalParams,i=p.params.loop&&e.slidesPerView!==p.params.slidesPerView;for(var n in e)p.params[n]=e[n];p.currentBreakpoint=t,i&&p.destroyLoop&&p.reLoop(!0)}},p.params.breakpoints&&p.setBreakpoint(),p.container=e(t),0!==p.container.length)){if(1<p.container.length){var f=[];return p.container.each(function(){f.push(new d(this,i))}),f}(p.container[0].swiper=p).container.data("swiper",p),p.classNames.push(p.params.containerModifierClass+p.params.direction),p.params.freeMode&&p.classNames.push(p.params.containerModifierClass+"free-mode"),p.support.flexbox||(p.classNames.push(p.params.containerModifierClass+"no-flexbox"),p.params.slidesPerColumn=1),p.params.autoHeight&&p.classNames.push(p.params.containerModifierClass+"autoheight"),(p.params.parallax||p.params.watchSlidesVisibility)&&(p.params.watchSlidesProgress=!0),p.params.touchReleaseOnEdges&&(p.params.resistanceRatio=0),0<=["cube","coverflow","flip"].indexOf(p.params.effect)&&(p.support.transforms3d?(p.params.watchSlidesProgress=!0,p.classNames.push(p.params.containerModifierClass+"3d")):p.params.effect="slide"),"slide"!==p.params.effect&&p.classNames.push(p.params.containerModifierClass+p.params.effect),"cube"===p.params.effect&&(p.params.resistanceRatio=0,p.params.slidesPerView=1,p.params.slidesPerColumn=1,p.params.slidesPerGroup=1,p.params.centeredSlides=!1,p.params.spaceBetween=0,p.params.virtualTranslate=!0),"fade"!==p.params.effect&&"flip"!==p.params.effect||(p.params.slidesPerView=1,p.params.slidesPerColumn=1,p.params.slidesPerGroup=1,p.params.watchSlidesProgress=!0,void(p.params.spaceBetween=0)===o&&(p.params.virtualTranslate=!0)),p.params.grabCursor&&p.support.touch&&(p.params.grabCursor=!1),p.wrapper=p.container.children("."+p.params.wrapperClass),p.params.pagination&&(p.paginationContainer=e(p.params.pagination),p.params.uniqueNavElements&&"string"==typeof p.params.pagination&&1<p.paginationContainer.length&&1===p.container.find(p.params.pagination).length&&(p.paginationContainer=p.container.find(p.params.pagination)),"bullets"===p.params.paginationType&&p.params.paginationClickable?p.paginationContainer.addClass(p.params.paginationModifierClass+"clickable"):p.params.paginationClickable=!1,p.paginationContainer.addClass(p.params.paginationModifierClass+p.params.paginationType)),(p.params.nextButton||p.params.prevButton)&&(p.params.nextButton&&(p.nextButton=e(p.params.nextButton),p.params.uniqueNavElements&&"string"==typeof p.params.nextButton&&1<p.nextButton.length&&1===p.container.find(p.params.nextButton).length&&(p.nextButton=p.container.find(p.params.nextButton))),p.params.prevButton&&(p.prevButton=e(p.params.prevButton),p.params.uniqueNavElements&&"string"==typeof p.params.prevButton&&1<p.prevButton.length&&1===p.container.find(p.params.prevButton).length&&(p.prevButton=p.container.find(p.params.prevButton)))),p.isHorizontal=function(){return"horizontal"===p.params.direction},p.rtl=p.isHorizontal()&&("rtl"===p.container[0].dir.toLowerCase()||"rtl"===p.container.css("direction")),p.rtl&&p.classNames.push(p.params.containerModifierClass+"rtl"),p.rtl&&(p.wrongRTL="-webkit-box"===p.wrapper.css("display")),1<p.params.slidesPerColumn&&p.classNames.push(p.params.containerModifierClass+"multirow"),p.device.android&&p.classNames.push(p.params.containerModifierClass+"android"),p.container.addClass(p.classNames.join(" ")),p.translate=0,p.progress=0,p.velocity=0,p.lockSwipeToNext=function(){(p.params.allowSwipeToNext=!1)===p.params.allowSwipeToPrev&&p.params.grabCursor&&p.unsetGrabCursor()},p.lockSwipeToPrev=function(){(p.params.allowSwipeToPrev=!1)===p.params.allowSwipeToNext&&p.params.grabCursor&&p.unsetGrabCursor()},p.lockSwipes=function(){p.params.allowSwipeToNext=p.params.allowSwipeToPrev=!1,p.params.grabCursor&&p.unsetGrabCursor()},p.unlockSwipeToNext=function(){(p.params.allowSwipeToNext=!0)===p.params.allowSwipeToPrev&&p.params.grabCursor&&p.setGrabCursor()},p.unlockSwipeToPrev=function(){(p.params.allowSwipeToPrev=!0)===p.params.allowSwipeToNext&&p.params.grabCursor&&p.setGrabCursor()},p.unlockSwipes=function(){p.params.allowSwipeToNext=p.params.allowSwipeToPrev=!0,p.params.grabCursor&&p.setGrabCursor()},p.setGrabCursor=function(t){p.container[0].style.cursor="move",p.container[0].style.cursor=t?"-webkit-grabbing":"-webkit-grab",p.container[0].style.cursor=t?"-moz-grabbin":"-moz-grab",p.container[0].style.cursor=t?"grabbing":"grab"},p.unsetGrabCursor=function(){p.container[0].style.cursor=""},p.params.grabCursor&&p.setGrabCursor(),p.imagesToLoad=[],p.imagesLoaded=0,p.loadImage=function(t,e,i,n,o,r){var a;function s(){r&&r()}t.complete&&o?s():e?((a=new window.Image).onload=s,a.onerror=s,n&&(a.sizes=n),i&&(a.srcset=i),e&&(a.src=e)):s()},p.preloadImages=function(){function t(){null!=p&&p&&(void 0!==p.imagesLoaded&&p.imagesLoaded++,p.imagesLoaded===p.imagesToLoad.length&&(p.params.updateOnImagesReady&&p.update(),p.emit("onImagesReady",p)))}p.imagesToLoad=p.container.find("img");for(var e=0;e<p.imagesToLoad.length;e++)p.loadImage(p.imagesToLoad[e],p.imagesToLoad[e].currentSrc||p.imagesToLoad[e].getAttribute("src"),p.imagesToLoad[e].srcset||p.imagesToLoad[e].getAttribute("srcset"),p.imagesToLoad[e].sizes||p.imagesToLoad[e].getAttribute("sizes"),!0,t)},p.autoplayTimeoutId=void 0,p.autoplaying=!1,p.autoplayPaused=!1,p.startAutoplay=function(){return void 0===p.autoplayTimeoutId&&!!p.params.autoplay&&!p.autoplaying&&(p.autoplaying=!0,p.emit("onAutoplayStart",p),void R())},p.stopAutoplay=function(t){p.autoplayTimeoutId&&(p.autoplayTimeoutId&&clearTimeout(p.autoplayTimeoutId),p.autoplaying=!1,p.autoplayTimeoutId=void 0,p.emit("onAutoplayStop",p))},p.pauseAutoplay=function(t){p.autoplayPaused||(p.autoplayTimeoutId&&clearTimeout(p.autoplayTimeoutId),p.autoplayPaused=!0,0===t?(p.autoplayPaused=!1,R()):p.wrapper.transitionEnd(function(){p&&(p.autoplayPaused=!1,p.autoplaying?R():p.stopAutoplay())}))},p.minTranslate=function(){return-p.snapGrid[0]},p.maxTranslate=function(){return-p.snapGrid[p.snapGrid.length-1]},p.updateAutoHeight=function(){var t,e=[],i=0;if("auto"!==p.params.slidesPerView&&1<p.params.slidesPerView)for(t=0;t<Math.ceil(p.params.slidesPerView);t++){var n=p.activeIndex+t;if(n>p.slides.length)break;e.push(p.slides.eq(n)[0])}else e.push(p.slides.eq(p.activeIndex)[0]);for(t=0;t<e.length;t++)if(void 0!==e[t]){var o=e[t].offsetHeight;i=i<o?o:i}i&&p.wrapper.css("height",i+"px")},p.updateContainerSize=function(){var t,e;t=void 0!==p.params.width?p.params.width:p.container[0].clientWidth,e=void 0!==p.params.height?p.params.height:p.container[0].clientHeight,0===t&&p.isHorizontal()||0===e&&!p.isHorizontal()||(t=t-parseInt(p.container.css("padding-left"),10)-parseInt(p.container.css("padding-right"),10),e=e-parseInt(p.container.css("padding-top"),10)-parseInt(p.container.css("padding-bottom"),10),p.width=t,p.height=e,p.size=p.isHorizontal()?p.width:p.height)},p.updateSlidesSize=function(){p.slides=p.wrapper.children("."+p.params.slideClass),p.snapGrid=[],p.slidesGrid=[],p.slidesSizesGrid=[];var t,e=p.params.spaceBetween,i=-p.params.slidesOffsetBefore,n=0,o=0;if(void 0!==p.size){var r,a;"string"==typeof e&&0<=e.indexOf("%")&&(e=parseFloat(e.replace("%",""))/100*p.size),p.virtualSize=-e,p.rtl?p.slides.css({marginLeft:"",marginTop:""}):p.slides.css({marginRight:"",marginBottom:""}),1<p.params.slidesPerColumn&&(r=Math.floor(p.slides.length/p.params.slidesPerColumn)===p.slides.length/p.params.slidesPerColumn?p.slides.length:Math.ceil(p.slides.length/p.params.slidesPerColumn)*p.params.slidesPerColumn,"auto"!==p.params.slidesPerView&&"row"===p.params.slidesPerColumnFill&&(r=Math.max(r,p.params.slidesPerView*p.params.slidesPerColumn)));var s,l=p.params.slidesPerColumn,c=r/l,u=c-(p.params.slidesPerColumn*c-p.slides.length);for(t=0;t<p.slides.length;t++){a=0;var h,d,f,m=p.slides.eq(t);1<p.params.slidesPerColumn&&("column"===p.params.slidesPerColumnFill?(f=t-(d=Math.floor(t/l))*l,(u<d||d===u&&f===l-1)&&++f>=l&&(f=0,d++),h=d+f*r/l,m.css({"-webkit-box-ordinal-group":h,"-moz-box-ordinal-group":h,"-ms-flex-order":h,"-webkit-order":h,order:h})):d=t-(f=Math.floor(t/c))*c,m.css("margin-"+(p.isHorizontal()?"top":"left"),0!==f&&p.params.spaceBetween&&p.params.spaceBetween+"px").attr("data-swiper-column",d).attr("data-swiper-row",f)),"none"!==m.css("display")&&("auto"===p.params.slidesPerView?(a=p.isHorizontal()?m.outerWidth(!0):m.outerHeight(!0),p.params.roundLengths&&(a=k(a))):(a=(p.size-(p.params.slidesPerView-1)*e)/p.params.slidesPerView,p.params.roundLengths&&(a=k(a)),p.isHorizontal()?p.slides[t].style.width=a+"px":p.slides[t].style.height=a+"px"),p.slides[t].swiperSlideSize=a,p.slidesSizesGrid.push(a),p.params.centeredSlides?(i=i+a/2+n/2+e,0===n&&0!==t&&(i=i-p.size/2-e),0===t&&(i=i-p.size/2-e),Math.abs(i)<.001&&(i=0),o%p.params.slidesPerGroup==0&&p.snapGrid.push(i),p.slidesGrid.push(i)):(o%p.params.slidesPerGroup==0&&p.snapGrid.push(i),p.slidesGrid.push(i),i=i+a+e),p.virtualSize+=a+e,n=a,o++)}if(p.virtualSize=Math.max(p.virtualSize,p.size)+p.params.slidesOffsetAfter,p.rtl&&p.wrongRTL&&("slide"===p.params.effect||"coverflow"===p.params.effect)&&p.wrapper.css({width:p.virtualSize+p.params.spaceBetween+"px"}),p.support.flexbox&&!p.params.setWrapperSize||(p.isHorizontal()?p.wrapper.css({width:p.virtualSize+p.params.spaceBetween+"px"}):p.wrapper.css({height:p.virtualSize+p.params.spaceBetween+"px"})),1<p.params.slidesPerColumn&&(p.virtualSize=(a+p.params.spaceBetween)*r,p.virtualSize=Math.ceil(p.virtualSize/p.params.slidesPerColumn)-p.params.spaceBetween,p.isHorizontal()?p.wrapper.css({width:p.virtualSize+p.params.spaceBetween+"px"}):p.wrapper.css({height:p.virtualSize+p.params.spaceBetween+"px"}),p.params.centeredSlides)){for(s=[],t=0;t<p.snapGrid.length;t++)p.snapGrid[t]<p.virtualSize+p.snapGrid[0]&&s.push(p.snapGrid[t]);p.snapGrid=s}if(!p.params.centeredSlides){for(s=[],t=0;t<p.snapGrid.length;t++)p.snapGrid[t]<=p.virtualSize-p.size&&s.push(p.snapGrid[t]);p.snapGrid=s,1<Math.floor(p.virtualSize-p.size)-Math.floor(p.snapGrid[p.snapGrid.length-1])&&p.snapGrid.push(p.virtualSize-p.size)}0===p.snapGrid.length&&(p.snapGrid=[0]),0!==p.params.spaceBetween&&(p.isHorizontal()?p.rtl?p.slides.css({marginLeft:e+"px"}):p.slides.css({marginRight:e+"px"}):p.slides.css({marginBottom:e+"px"})),p.params.watchSlidesProgress&&p.updateSlidesOffset()}},p.updateSlidesOffset=function(){for(var t=0;t<p.slides.length;t++)p.slides[t].swiperSlideOffset=p.isHorizontal()?p.slides[t].offsetLeft:p.slides[t].offsetTop},p.currentSlidesPerView=function(){var t,e,i=1;if(p.params.centeredSlides){var n,o=p.slides[p.activeIndex].swiperSlideSize;for(t=p.activeIndex+1;t<p.slides.length;t++)p.slides[t]&&!n&&(i++,(o+=p.slides[t].swiperSlideSize)>p.size&&(n=!0));for(e=p.activeIndex-1;0<=e;e--)p.slides[e]&&!n&&(i++,(o+=p.slides[e].swiperSlideSize)>p.size&&(n=!0))}else for(t=p.activeIndex+1;t<p.slides.length;t++)p.slidesGrid[t]-p.slidesGrid[p.activeIndex]<p.size&&i++;return i},p.updateSlidesProgress=function(t){if(void 0===t&&(t=p.translate||0),0!==p.slides.length){void 0===p.slides[0].swiperSlideOffset&&p.updateSlidesOffset();var e=-t;p.rtl&&(e=t),p.slides.removeClass(p.params.slideVisibleClass);for(var i=0;i<p.slides.length;i++){var n=p.slides[i],o=(e+(p.params.centeredSlides?p.minTranslate():0)-n.swiperSlideOffset)/(n.swiperSlideSize+p.params.spaceBetween);if(p.params.watchSlidesVisibility){var r=-(e-n.swiperSlideOffset),a=r+p.slidesSizesGrid[i];(0<=r&&r<p.size||0<a&&a<=p.size||r<=0&&a>=p.size)&&p.slides.eq(i).addClass(p.params.slideVisibleClass)}n.progress=p.rtl?-o:o}}},p.updateProgress=function(t){void 0===t&&(t=p.translate||0);var e=p.maxTranslate()-p.minTranslate(),i=p.isBeginning,n=p.isEnd;0===e?(p.progress=0,p.isBeginning=p.isEnd=!0):(p.progress=(t-p.minTranslate())/e,p.isBeginning=p.progress<=0,p.isEnd=1<=p.progress),p.isBeginning&&!i&&p.emit("onReachBeginning",p),p.isEnd&&!n&&p.emit("onReachEnd",p),p.params.watchSlidesProgress&&p.updateSlidesProgress(t),p.emit("onProgress",p,p.progress)},p.updateActiveIndex=function(){var t,e,i,n=p.rtl?p.translate:-p.translate;for(e=0;e<p.slidesGrid.length;e++)void 0!==p.slidesGrid[e+1]?n>=p.slidesGrid[e]&&n<p.slidesGrid[e+1]-(p.slidesGrid[e+1]-p.slidesGrid[e])/2?t=e:n>=p.slidesGrid[e]&&n<p.slidesGrid[e+1]&&(t=e+1):n>=p.slidesGrid[e]&&(t=e);p.params.normalizeSlideIndex&&(t<0||void 0===t)&&(t=0),(i=Math.floor(t/p.params.slidesPerGroup))>=p.snapGrid.length&&(i=p.snapGrid.length-1),t!==p.activeIndex&&(p.snapIndex=i,p.previousIndex=p.activeIndex,p.activeIndex=t,p.updateClasses(),p.updateRealIndex())},p.updateRealIndex=function(){p.realIndex=parseInt(p.slides.eq(p.activeIndex).attr("data-swiper-slide-index")||p.activeIndex,10)},p.updateClasses=function(){p.slides.removeClass(p.params.slideActiveClass+" "+p.params.slideNextClass+" "+p.params.slidePrevClass+" "+p.params.slideDuplicateActiveClass+" "+p.params.slideDuplicateNextClass+" "+p.params.slideDuplicatePrevClass);var t=p.slides.eq(p.activeIndex);t.addClass(p.params.slideActiveClass),i.loop&&(t.hasClass(p.params.slideDuplicateClass)?p.wrapper.children("."+p.params.slideClass+":not(."+p.params.slideDuplicateClass+')[data-swiper-slide-index="'+p.realIndex+'"]').addClass(p.params.slideDuplicateActiveClass):p.wrapper.children("."+p.params.slideClass+"."+p.params.slideDuplicateClass+'[data-swiper-slide-index="'+p.realIndex+'"]').addClass(p.params.slideDuplicateActiveClass));var n=t.next("."+p.params.slideClass).addClass(p.params.slideNextClass);p.params.loop&&0===n.length&&(n=p.slides.eq(0)).addClass(p.params.slideNextClass);var o=t.prev("."+p.params.slideClass).addClass(p.params.slidePrevClass);if(p.params.loop&&0===o.length&&(o=p.slides.eq(-1)).addClass(p.params.slidePrevClass),i.loop&&(n.hasClass(p.params.slideDuplicateClass)?p.wrapper.children("."+p.params.slideClass+":not(."+p.params.slideDuplicateClass+')[data-swiper-slide-index="'+n.attr("data-swiper-slide-index")+'"]').addClass(p.params.slideDuplicateNextClass):p.wrapper.children("."+p.params.slideClass+"."+p.params.slideDuplicateClass+'[data-swiper-slide-index="'+n.attr("data-swiper-slide-index")+'"]').addClass(p.params.slideDuplicateNextClass),o.hasClass(p.params.slideDuplicateClass)?p.wrapper.children("."+p.params.slideClass+":not(."+p.params.slideDuplicateClass+')[data-swiper-slide-index="'+o.attr("data-swiper-slide-index")+'"]').addClass(p.params.slideDuplicatePrevClass):p.wrapper.children("."+p.params.slideClass+"."+p.params.slideDuplicateClass+'[data-swiper-slide-index="'+o.attr("data-swiper-slide-index")+'"]').addClass(p.params.slideDuplicatePrevClass)),p.paginationContainer&&0<p.paginationContainer.length){var r,a=p.params.loop?Math.ceil((p.slides.length-2*p.loopedSlides)/p.params.slidesPerGroup):p.snapGrid.length;if(p.params.loop?((r=Math.ceil((p.activeIndex-p.loopedSlides)/p.params.slidesPerGroup))>p.slides.length-1-2*p.loopedSlides&&(r-=p.slides.length-2*p.loopedSlides),a-1<r&&(r-=a),r<0&&"bullets"!==p.params.paginationType&&(r=a+r)):r=void 0!==p.snapIndex?p.snapIndex:p.activeIndex||0,"bullets"===p.params.paginationType&&p.bullets&&0<p.bullets.length&&(p.bullets.removeClass(p.params.bulletActiveClass),1<p.paginationContainer.length?p.bullets.each(function(){e(this).index()===r&&e(this).addClass(p.params.bulletActiveClass)}):p.bullets.eq(r).addClass(p.params.bulletActiveClass)),"fraction"===p.params.paginationType&&(p.paginationContainer.find("."+p.params.paginationCurrentClass).text(r+1),p.paginationContainer.find("."+p.params.paginationTotalClass).text(a)),"progress"===p.params.paginationType){var s=(r+1)/a,l=s,c=1;p.isHorizontal()||(c=s,l=1),p.paginationContainer.find("."+p.params.paginationProgressbarClass).transform("translate3d(0,0,0) scaleX("+l+") scaleY("+c+")").transition(p.params.speed)}"custom"===p.params.paginationType&&p.params.paginationCustomRender&&(p.paginationContainer.html(p.params.paginationCustomRender(p,r+1,a)),p.emit("onPaginationRendered",p,p.paginationContainer[0]))}p.params.loop||(p.params.prevButton&&p.prevButton&&0<p.prevButton.length&&(p.isBeginning?(p.prevButton.addClass(p.params.buttonDisabledClass),p.params.a11y&&p.a11y&&p.a11y.disable(p.prevButton)):(p.prevButton.removeClass(p.params.buttonDisabledClass),p.params.a11y&&p.a11y&&p.a11y.enable(p.prevButton))),p.params.nextButton&&p.nextButton&&0<p.nextButton.length&&(p.isEnd?(p.nextButton.addClass(p.params.buttonDisabledClass),p.params.a11y&&p.a11y&&p.a11y.disable(p.nextButton)):(p.nextButton.removeClass(p.params.buttonDisabledClass),p.params.a11y&&p.a11y&&p.a11y.enable(p.nextButton))))},p.updatePagination=function(){if(p.params.pagination&&p.paginationContainer&&0<p.paginationContainer.length){var t="";if("bullets"===p.params.paginationType){for(var e=p.params.loop?Math.ceil((p.slides.length-2*p.loopedSlides)/p.params.slidesPerGroup):p.snapGrid.length,i=0;i<e;i++)p.params.paginationBulletRender?t+=p.params.paginationBulletRender(p,i,p.params.bulletClass):t+="<"+p.params.paginationElement+' class="'+p.params.bulletClass+'"></'+p.params.paginationElement+">";p.paginationContainer.html(t),p.bullets=p.paginationContainer.find("."+p.params.bulletClass),p.params.paginationClickable&&p.params.a11y&&p.a11y&&p.a11y.initPagination()}"fraction"===p.params.paginationType&&(t=p.params.paginationFractionRender?p.params.paginationFractionRender(p,p.params.paginationCurrentClass,p.params.paginationTotalClass):'<span class="'+p.params.paginationCurrentClass+'"></span> / <span class="'+p.params.paginationTotalClass+'"></span>',p.paginationContainer.html(t)),"progress"===p.params.paginationType&&(t=p.params.paginationProgressRender?p.params.paginationProgressRender(p,p.params.paginationProgressbarClass):'<span class="'+p.params.paginationProgressbarClass+'"></span>',p.paginationContainer.html(t)),"custom"!==p.params.paginationType&&p.emit("onPaginationRendered",p,p.paginationContainer[0])}},p.update=function(t){var e;function i(){p.rtl,p.translate,e=Math.min(Math.max(p.translate,p.maxTranslate()),p.minTranslate()),p.setWrapperTranslate(e),p.updateActiveIndex(),p.updateClasses()}p&&(p.updateContainerSize(),p.updateSlidesSize(),p.updateProgress(),p.updatePagination(),p.updateClasses(),p.params.scrollbar&&p.scrollbar&&p.scrollbar.set(),t?(p.controller&&p.controller.spline&&(p.controller.spline=void 0),p.params.freeMode?(i(),p.params.autoHeight&&p.updateAutoHeight()):(("auto"===p.params.slidesPerView||1<p.params.slidesPerView)&&p.isEnd&&!p.params.centeredSlides?p.slideTo(p.slides.length-1,0,!1,!0):p.slideTo(p.activeIndex,0,!1,!0))||i()):p.params.autoHeight&&p.updateAutoHeight())},p.onResize=function(t){p.params.onBeforeResize&&p.params.onBeforeResize(p),p.params.breakpoints&&p.setBreakpoint();var e=p.params.allowSwipeToPrev,i=p.params.allowSwipeToNext;p.params.allowSwipeToPrev=p.params.allowSwipeToNext=!0,p.updateContainerSize(),p.updateSlidesSize(),("auto"===p.params.slidesPerView||p.params.freeMode||t)&&p.updatePagination(),p.params.scrollbar&&p.scrollbar&&p.scrollbar.set(),p.controller&&p.controller.spline&&(p.controller.spline=void 0);var n=!1;if(p.params.freeMode){var o=Math.min(Math.max(p.translate,p.maxTranslate()),p.minTranslate());p.setWrapperTranslate(o),p.updateActiveIndex(),p.updateClasses(),p.params.autoHeight&&p.updateAutoHeight()}else p.updateClasses(),n=("auto"===p.params.slidesPerView||1<p.params.slidesPerView)&&p.isEnd&&!p.params.centeredSlides?p.slideTo(p.slides.length-1,0,!1,!0):p.slideTo(p.activeIndex,0,!1,!0);p.params.lazyLoading&&!n&&p.lazy&&p.lazy.load(),p.params.allowSwipeToPrev=e,p.params.allowSwipeToNext=i,p.params.onAfterResize&&p.params.onAfterResize(p)},p.touchEventsDesktop={start:"mousedown",move:"mousemove",end:"mouseup"},window.navigator.pointerEnabled?p.touchEventsDesktop={start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled&&(p.touchEventsDesktop={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}),p.touchEvents={start:p.support.touch||!p.params.simulateTouch?"touchstart":p.touchEventsDesktop.start,move:p.support.touch||!p.params.simulateTouch?"touchmove":p.touchEventsDesktop.move,end:p.support.touch||!p.params.simulateTouch?"touchend":p.touchEventsDesktop.end},(window.navigator.pointerEnabled||window.navigator.msPointerEnabled)&&("container"===p.params.touchEventsTarget?p.container:p.wrapper).addClass("swiper-wp8-"+p.params.direction),p.initEvents=function(t){var e=t?"off":"on",n=t?"removeEventListener":"addEventListener",o="container"===p.params.touchEventsTarget?p.container[0]:p.wrapper[0],r=p.support.touch?o:document,a=!!p.params.nested;if(p.browser.ie)o[n](p.touchEvents.start,p.onTouchStart,!1),r[n](p.touchEvents.move,p.onTouchMove,a),r[n](p.touchEvents.end,p.onTouchEnd,!1);else{if(p.support.touch){var s=!("touchstart"!==p.touchEvents.start||!p.support.passiveListener||!p.params.passiveListeners)&&{passive:!0,capture:!1};o[n](p.touchEvents.start,p.onTouchStart,s),o[n](p.touchEvents.move,p.onTouchMove,a),o[n](p.touchEvents.end,p.onTouchEnd,s)}(i.simulateTouch&&!p.device.ios&&!p.device.android||i.simulateTouch&&!p.support.touch&&p.device.ios)&&(o[n]("mousedown",p.onTouchStart,!1),document[n]("mousemove",p.onTouchMove,a),document[n]("mouseup",p.onTouchEnd,!1))}window[n]("resize",p.onResize),p.params.nextButton&&p.nextButton&&0<p.nextButton.length&&(p.nextButton[e]("click",p.onClickNext),p.params.a11y&&p.a11y&&p.nextButton[e]("keydown",p.a11y.onEnterKey)),p.params.prevButton&&p.prevButton&&0<p.prevButton.length&&(p.prevButton[e]("click",p.onClickPrev),p.params.a11y&&p.a11y&&p.prevButton[e]("keydown",p.a11y.onEnterKey)),p.params.pagination&&p.params.paginationClickable&&(p.paginationContainer[e]("click","."+p.params.bulletClass,p.onClickIndex),p.params.a11y&&p.a11y&&p.paginationContainer[e]("keydown","."+p.params.bulletClass,p.a11y.onEnterKey)),(p.params.preventClicks||p.params.preventClicksPropagation)&&o[n]("click",p.preventClicks,!0)},p.attachEvents=function(){p.initEvents()},p.detachEvents=function(){p.initEvents(!0)},p.allowClick=!0,p.preventClicks=function(t){p.allowClick||(p.params.preventClicks&&t.preventDefault(),p.params.preventClicksPropagation&&p.animating&&(t.stopPropagation(),t.stopImmediatePropagation()))},p.onClickNext=function(t){t.preventDefault(),p.isEnd&&!p.params.loop||p.slideNext()},p.onClickPrev=function(t){t.preventDefault(),p.isBeginning&&!p.params.loop||p.slidePrev()},p.onClickIndex=function(t){t.preventDefault();var i=e(this).index()*p.params.slidesPerGroup;p.params.loop&&(i+=p.loopedSlides),p.slideTo(i)},p.updateClickedSlide=function(t){var i=O(t,"."+p.params.slideClass),n=!1;if(i)for(var o=0;o<p.slides.length;o++)p.slides[o]===i&&(n=!0);if(!i||!n)return p.clickedSlide=void 0,void(p.clickedIndex=void 0);if(p.clickedSlide=i,p.clickedIndex=e(i).index(),p.params.slideToClickedSlide&&void 0!==p.clickedIndex&&p.clickedIndex!==p.activeIndex){var r,a=p.clickedIndex,s="auto"===p.params.slidesPerView?p.currentSlidesPerView():p.params.slidesPerView;if(p.params.loop){if(p.animating)return;r=parseInt(e(p.clickedSlide).attr("data-swiper-slide-index"),10),p.params.centeredSlides?a<p.loopedSlides-s/2||a>p.slides.length-p.loopedSlides+s/2?(p.fixLoop(),a=p.wrapper.children("."+p.params.slideClass+'[data-swiper-slide-index="'+r+'"]:not(.'+p.params.slideDuplicateClass+")").eq(0).index(),setTimeout(function(){p.slideTo(a)},0)):p.slideTo(a):a>p.slides.length-s?(p.fixLoop(),a=p.wrapper.children("."+p.params.slideClass+'[data-swiper-slide-index="'+r+'"]:not(.'+p.params.slideDuplicateClass+")").eq(0).index(),setTimeout(function(){p.slideTo(a)},0)):p.slideTo(a)}else p.slideTo(a)}};var m,v,y,b,w,x,_,S,T,M,I,P,C="input, select, textarea, button, video",A=Date.now(),E=[];for(var L in p.animating=!1,p.touches={startX:0,startY:0,currentX:0,currentY:0,diff:0},p.onTouchStart=function(t){if(t.originalEvent&&(t=t.originalEvent),(I="touchstart"===t.type)||!("which"in t)||3!==t.which)if(p.params.noSwiping&&O(t,"."+p.params.noSwipingClass))p.allowClick=!0;else if(!p.params.swipeHandler||O(t,p.params.swipeHandler)){var i=p.touches.currentX="touchstart"===t.type?t.targetTouches[0].pageX:t.pageX,n=p.touches.currentY="touchstart"===t.type?t.targetTouches[0].pageY:t.pageY;if(!(p.device.ios&&p.params.iOSEdgeSwipeDetection&&i<=p.params.iOSEdgeSwipeThreshold)){if(y=!(v=!(m=!0)),P=w=void 0,p.touches.startX=i,p.touches.startY=n,b=Date.now(),p.allowClick=!0,p.updateContainerSize(),p.swipeDirection=void 0,0<p.params.threshold&&(S=!1),"touchstart"!==t.type){var o=!0;e(t.target).is(C)&&(o=!1),document.activeElement&&e(document.activeElement).is(C)&&document.activeElement.blur(),o&&t.preventDefault()}p.emit("onTouchStart",p,t)}}},p.onTouchMove=function(t){if(t.originalEvent&&(t=t.originalEvent),!I||"mousemove"!==t.type){if(t.preventedByNestedSwiper)return p.touches.startX="touchmove"===t.type?t.targetTouches[0].pageX:t.pageX,void(p.touches.startY="touchmove"===t.type?t.targetTouches[0].pageY:t.pageY);if(p.params.onlyExternal)return p.allowClick=!1,void(m&&(p.touches.startX=p.touches.currentX="touchmove"===t.type?t.targetTouches[0].pageX:t.pageX,p.touches.startY=p.touches.currentY="touchmove"===t.type?t.targetTouches[0].pageY:t.pageY,b=Date.now()));if(I&&p.params.touchReleaseOnEdges&&!p.params.loop)if(p.isHorizontal()){if(p.touches.currentX<p.touches.startX&&p.translate<=p.maxTranslate()||p.touches.currentX>p.touches.startX&&p.translate>=p.minTranslate())return}else if(p.touches.currentY<p.touches.startY&&p.translate<=p.maxTranslate()||p.touches.currentY>p.touches.startY&&p.translate>=p.minTranslate())return;if(I&&document.activeElement&&t.target===document.activeElement&&e(t.target).is(C))return v=!0,void(p.allowClick=!1);var n;if(y&&p.emit("onTouchMove",p,t),!(t.targetTouches&&1<t.targetTouches.length))if(p.touches.currentX="touchmove"===t.type?t.targetTouches[0].pageX:t.pageX,p.touches.currentY="touchmove"===t.type?t.targetTouches[0].pageY:t.pageY,void 0===w&&(w=!(p.isHorizontal()&&p.touches.currentY===p.touches.startY||!p.isHorizontal()&&p.touches.currentX===p.touches.startX)&&(n=180*Math.atan2(Math.abs(p.touches.currentY-p.touches.startY),Math.abs(p.touches.currentX-p.touches.startX))/Math.PI,p.isHorizontal()?n>p.params.touchAngle:90-n>p.params.touchAngle)),w&&p.emit("onTouchMoveOpposite",p,t),void 0===P&&(p.touches.currentX===p.touches.startX&&p.touches.currentY===p.touches.startY||(P=!0)),m)if(w)m=!1;else if(P){p.allowClick=!1,p.emit("onSliderMove",p,t),t.preventDefault(),p.params.touchMoveStopPropagation&&!p.params.nested&&t.stopPropagation(),v||(i.loop&&p.fixLoop(),_=p.getWrapperTranslate(),p.setWrapperTransition(0),p.animating&&p.wrapper.trigger("webkitTransitionEnd transitionend oTransitionEnd MSTransitionEnd msTransitionEnd"),p.params.autoplay&&p.autoplaying&&(p.params.autoplayDisableOnInteraction?p.stopAutoplay():p.pauseAutoplay()),M=!1,!p.params.grabCursor||!0!==p.params.allowSwipeToNext&&!0!==p.params.allowSwipeToPrev||p.setGrabCursor(!0)),v=!0;var o=p.touches.diff=p.isHorizontal()?p.touches.currentX-p.touches.startX:p.touches.currentY-p.touches.startY;o*=p.params.touchRatio,p.rtl&&(o=-o),p.swipeDirection=0<o?"prev":"next",x=o+_;var r=!0;if(0<o&&x>p.minTranslate()?(r=!1,p.params.resistance&&(x=p.minTranslate()-1+Math.pow(-p.minTranslate()+_+o,p.params.resistanceRatio))):o<0&&x<p.maxTranslate()&&(r=!1,p.params.resistance&&(x=p.maxTranslate()+1-Math.pow(p.maxTranslate()-_-o,p.params.resistanceRatio))),r&&(t.preventedByNestedSwiper=!0),!p.params.allowSwipeToNext&&"next"===p.swipeDirection&&x<_&&(x=_),!p.params.allowSwipeToPrev&&"prev"===p.swipeDirection&&_<x&&(x=_),0<p.params.threshold){if(!(Math.abs(o)>p.params.threshold||S))return void(x=_);if(!S)return S=!0,p.touches.startX=p.touches.currentX,p.touches.startY=p.touches.currentY,x=_,void(p.touches.diff=p.isHorizontal()?p.touches.currentX-p.touches.startX:p.touches.currentY-p.touches.startY)}p.params.followFinger&&((p.params.freeMode||p.params.watchSlidesProgress)&&p.updateActiveIndex(),p.params.freeMode&&(0===E.length&&E.push({position:p.touches[p.isHorizontal()?"startX":"startY"],time:b}),E.push({position:p.touches[p.isHorizontal()?"currentX":"currentY"],time:(new window.Date).getTime()})),p.updateProgress(x),p.setWrapperTranslate(x))}}},p.onTouchEnd=function(t){if(t.originalEvent&&(t=t.originalEvent),y&&p.emit("onTouchEnd",p,t),y=!1,m){p.params.grabCursor&&v&&m&&(!0===p.params.allowSwipeToNext||!0===p.params.allowSwipeToPrev)&&p.setGrabCursor(!1);var i,n=Date.now(),o=n-b;if(p.allowClick&&(p.updateClickedSlide(t),p.emit("onTap",p,t),o<300&&300<n-A&&(T&&clearTimeout(T),T=setTimeout(function(){p&&(p.params.paginationHide&&0<p.paginationContainer.length&&!e(t.target).hasClass(p.params.bulletClass)&&p.paginationContainer.toggleClass(p.params.paginationHiddenClass),p.emit("onClick",p,t))},300)),o<300&&n-A<300&&(T&&clearTimeout(T),p.emit("onDoubleTap",p,t))),A=Date.now(),setTimeout(function(){p&&(p.allowClick=!0)},0),m&&v&&p.swipeDirection&&0!==p.touches.diff&&x!==_)if(m=v=!1,i=p.params.followFinger?p.rtl?p.translate:-p.translate:-x,p.params.freeMode){if(i<-p.minTranslate())return void p.slideTo(p.activeIndex);if(i>-p.maxTranslate())return void(p.slides.length<p.snapGrid.length?p.slideTo(p.snapGrid.length-1):p.slideTo(p.slides.length-1));if(p.params.freeModeMomentum){if(1<E.length){var r=E.pop(),a=E.pop(),s=r.position-a.position,l=r.time-a.time;p.velocity=s/l,p.velocity=p.velocity/2,Math.abs(p.velocity)<p.params.freeModeMinimumVelocity&&(p.velocity=0),(150<l||300<(new window.Date).getTime()-r.time)&&(p.velocity=0)}else p.velocity=0;p.velocity=p.velocity*p.params.freeModeMomentumVelocityRatio,E.length=0;var c=1e3*p.params.freeModeMomentumRatio,u=p.velocity*c,h=p.translate+u;p.rtl&&(h=-h);var d,f=!1,g=20*Math.abs(p.velocity)*p.params.freeModeMomentumBounceRatio;if(h<p.maxTranslate())p.params.freeModeMomentumBounce?(h+p.maxTranslate()<-g&&(h=p.maxTranslate()-g),d=p.maxTranslate(),M=f=!0):h=p.maxTranslate();else if(h>p.minTranslate())p.params.freeModeMomentumBounce?(h-p.minTranslate()>g&&(h=p.minTranslate()+g),d=p.minTranslate(),M=f=!0):h=p.minTranslate();else if(p.params.freeModeSticky){var w,S=0;for(S=0;S<p.snapGrid.length;S+=1)if(p.snapGrid[S]>-h){w=S;break}h=Math.abs(p.snapGrid[w]-h)<Math.abs(p.snapGrid[w-1]-h)||"next"===p.swipeDirection?p.snapGrid[w]:p.snapGrid[w-1],p.rtl||(h=-h)}if(0!==p.velocity)c=p.rtl?Math.abs((-h-p.translate)/p.velocity):Math.abs((h-p.translate)/p.velocity);else if(p.params.freeModeSticky)return void p.slideReset();p.params.freeModeMomentumBounce&&f?(p.updateProgress(d),p.setWrapperTransition(c),p.setWrapperTranslate(h),p.onTransitionStart(),p.animating=!0,p.wrapper.transitionEnd(function(){p&&M&&(p.emit("onMomentumBounce",p),p.setWrapperTransition(p.params.speed),p.setWrapperTranslate(d),p.wrapper.transitionEnd(function(){p&&p.onTransitionEnd()}))})):p.velocity?(p.updateProgress(h),p.setWrapperTransition(c),p.setWrapperTranslate(h),p.onTransitionStart(),p.animating||(p.animating=!0,p.wrapper.transitionEnd(function(){p&&p.onTransitionEnd()}))):p.updateProgress(h),p.updateActiveIndex()}(!p.params.freeModeMomentum||o>=p.params.longSwipesMs)&&(p.updateProgress(),p.updateActiveIndex())}else{var I,P=0,C=p.slidesSizesGrid[0];for(I=0;I<p.slidesGrid.length;I+=p.params.slidesPerGroup)void 0!==p.slidesGrid[I+p.params.slidesPerGroup]?i>=p.slidesGrid[I]&&i<p.slidesGrid[I+p.params.slidesPerGroup]&&(P=I,C=p.slidesGrid[I+p.params.slidesPerGroup]-p.slidesGrid[I]):i>=p.slidesGrid[I]&&(P=I,C=p.slidesGrid[p.slidesGrid.length-1]-p.slidesGrid[p.slidesGrid.length-2]);var L=(i-p.slidesGrid[P])/C;if(o>p.params.longSwipesMs){if(!p.params.longSwipes)return void p.slideTo(p.activeIndex);"next"===p.swipeDirection&&(L>=p.params.longSwipesRatio?p.slideTo(P+p.params.slidesPerGroup):p.slideTo(P)),"prev"===p.swipeDirection&&(L>1-p.params.longSwipesRatio?p.slideTo(P+p.params.slidesPerGroup):p.slideTo(P))}else{if(!p.params.shortSwipes)return void p.slideTo(p.activeIndex);"next"===p.swipeDirection&&p.slideTo(P+p.params.slidesPerGroup),"prev"===p.swipeDirection&&p.slideTo(P)}}else m=v=!1}},p._slideTo=function(t,e){return p.slideTo(t,e,!0,!0)},p.slideTo=function(t,e,i,n){void 0===i&&(i=!0),void 0===t&&(t=0),t<0&&(t=0),p.snapIndex=Math.floor(t/p.params.slidesPerGroup),p.snapIndex>=p.snapGrid.length&&(p.snapIndex=p.snapGrid.length-1);var o=-p.snapGrid[p.snapIndex];if(p.params.autoplay&&p.autoplaying&&(n||!p.params.autoplayDisableOnInteraction?p.pauseAutoplay(e):p.stopAutoplay()),p.updateProgress(o),p.params.normalizeSlideIndex)for(var r=0;r<p.slidesGrid.length;r++)-Math.floor(100*o)>=Math.floor(100*p.slidesGrid[r])&&(t=r);return!(!p.params.allowSwipeToNext&&o<p.translate&&o<p.minTranslate()||!p.params.allowSwipeToPrev&&o>p.translate&&o>p.maxTranslate()&&(p.activeIndex||0)!==t||(void 0===e&&(e=p.params.speed),p.previousIndex=p.activeIndex||0,p.activeIndex=t,p.updateRealIndex(),p.rtl&&-o===p.translate||!p.rtl&&o===p.translate?(p.params.autoHeight&&p.updateAutoHeight(),p.updateClasses(),"slide"!==p.params.effect&&p.setWrapperTranslate(o),1):(p.updateClasses(),p.onTransitionStart(i),0===e||p.browser.lteIE9?(p.setWrapperTranslate(o),p.setWrapperTransition(0),p.onTransitionEnd(i)):(p.setWrapperTranslate(o),p.setWrapperTransition(e),p.animating||(p.animating=!0,p.wrapper.transitionEnd(function(){p&&p.onTransitionEnd(i)}))),0)))},p.onTransitionStart=function(t){void 0===t&&(t=!0),p.params.autoHeight&&p.updateAutoHeight(),p.lazy&&p.lazy.onTransitionStart(),t&&(p.emit("onTransitionStart",p),p.activeIndex!==p.previousIndex&&(p.emit("onSlideChangeStart",p),p.activeIndex>p.previousIndex?p.emit("onSlideNextStart",p):p.emit("onSlidePrevStart",p)))},p.onTransitionEnd=function(t){p.animating=!1,p.setWrapperTransition(0),void 0===t&&(t=!0),p.lazy&&p.lazy.onTransitionEnd(),t&&(p.emit("onTransitionEnd",p),p.activeIndex!==p.previousIndex&&(p.emit("onSlideChangeEnd",p),p.activeIndex>p.previousIndex?p.emit("onSlideNextEnd",p):p.emit("onSlidePrevEnd",p))),p.params.history&&p.history&&p.history.setHistory(p.params.history,p.activeIndex),p.params.hashnav&&p.hashnav&&p.hashnav.setHash()},p.slideNext=function(t,e,i){return p.params.loop?!p.animating&&(p.fixLoop(),p.container[0].clientLeft,p.slideTo(p.activeIndex+p.params.slidesPerGroup,e,t,i)):p.slideTo(p.activeIndex+p.params.slidesPerGroup,e,t,i)},p._slideNext=function(t){return p.slideNext(!0,t,!0)},p.slidePrev=function(t,e,i){return p.params.loop?!p.animating&&(p.fixLoop(),p.container[0].clientLeft,p.slideTo(p.activeIndex-1,e,t,i)):p.slideTo(p.activeIndex-1,e,t,i)},p._slidePrev=function(t){return p.slidePrev(!0,t,!0)},p.slideReset=function(t,e,i){return p.slideTo(p.activeIndex,e,t)},p.disableTouchControl=function(){return p.params.onlyExternal=!0},p.enableTouchControl=function(){return!(p.params.onlyExternal=!1)},p.setWrapperTransition=function(t,e){p.wrapper.transition(t),"slide"!==p.params.effect&&p.effects[p.params.effect]&&p.effects[p.params.effect].setTransition(t),p.params.parallax&&p.parallax&&p.parallax.setTransition(t),p.params.scrollbar&&p.scrollbar&&p.scrollbar.setTransition(t),p.params.control&&p.controller&&p.controller.setTransition(t,e),p.emit("onSetTransition",p,t)},p.setWrapperTranslate=function(t,e,i){var n=0,o=0;p.isHorizontal()?n=p.rtl?-t:t:o=t,p.params.roundLengths&&(n=k(n),o=k(o)),p.params.virtualTranslate||(p.support.transforms3d?p.wrapper.transform("translate3d("+n+"px, "+o+"px, 0px)"):p.wrapper.transform("translate("+n+"px, "+o+"px)")),p.translate=p.isHorizontal()?n:o;var r=p.maxTranslate()-p.minTranslate();(0===r?0:(t-p.minTranslate())/r)!==p.progress&&p.updateProgress(t),e&&p.updateActiveIndex(),"slide"!==p.params.effect&&p.effects[p.params.effect]&&p.effects[p.params.effect].setTranslate(p.translate),p.params.parallax&&p.parallax&&p.parallax.setTranslate(p.translate),p.params.scrollbar&&p.scrollbar&&p.scrollbar.setTranslate(p.translate),p.params.control&&p.controller&&p.controller.setTranslate(p.translate,i),p.emit("onSetTranslate",p,p.translate)},p.getTranslate=function(t,e){var i,n,o,r;return void 0===e&&(e="x"),p.params.virtualTranslate?p.rtl?-p.translate:p.translate:(o=window.getComputedStyle(t,null),window.WebKitCSSMatrix?(6<(n=o.transform||o.webkitTransform).split(",").length&&(n=n.split(", ").map(function(t){return t.replace(",",".")}).join(", ")),r=new window.WebKitCSSMatrix("none"===n?"":n)):i=(r=o.MozTransform||o.OTransform||o.MsTransform||o.msTransform||o.transform||o.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,")).toString().split(","),"x"===e&&(n=window.WebKitCSSMatrix?r.m41:16===i.length?parseFloat(i[12]):parseFloat(i[4])),"y"===e&&(n=window.WebKitCSSMatrix?r.m42:16===i.length?parseFloat(i[13]):parseFloat(i[5])),p.rtl&&n&&(n=-n),n||0)},p.getWrapperTranslate=function(t){return void 0===t&&(t=p.isHorizontal()?"x":"y"),p.getTranslate(p.wrapper[0],t)},p.observers=[],p.initObservers=function(){if(p.params.observeParents)for(var t=p.container.parents(),e=0;e<t.length;e++)F(t[e]);F(p.container[0],{childList:!1}),F(p.wrapper[0],{attributes:!1})},p.disconnectObservers=function(){for(var t=0;t<p.observers.length;t++)p.observers[t].disconnect();p.observers=[]},p.createLoop=function(){p.wrapper.children("."+p.params.slideClass+"."+p.params.slideDuplicateClass).remove();var t=p.wrapper.children("."+p.params.slideClass);"auto"!==p.params.slidesPerView||p.params.loopedSlides||(p.params.loopedSlides=t.length),p.loopedSlides=parseInt(p.params.loopedSlides||p.params.slidesPerView,10),p.loopedSlides=p.loopedSlides+p.params.loopAdditionalSlides,p.loopedSlides>t.length&&(p.loopedSlides=t.length);var i,n=[],o=[];for(t.each(function(i,r){var a=e(this);i<p.loopedSlides&&o.push(r),i<t.length&&i>=t.length-p.loopedSlides&&n.push(r),a.attr("data-swiper-slide-index",i)}),i=0;i<o.length;i++)p.wrapper.append(e(o[i].cloneNode(!0)).addClass(p.params.slideDuplicateClass));for(i=n.length-1;0<=i;i--)p.wrapper.prepend(e(n[i].cloneNode(!0)).addClass(p.params.slideDuplicateClass))},p.destroyLoop=function(){p.wrapper.children("."+p.params.slideClass+"."+p.params.slideDuplicateClass).remove(),p.slides.removeAttr("data-swiper-slide-index")},p.reLoop=function(t){var e=p.activeIndex-p.loopedSlides;p.destroyLoop(),p.createLoop(),p.updateSlidesSize(),t&&p.slideTo(e+p.loopedSlides,0,!1)},p.fixLoop=function(){var t;p.activeIndex<p.loopedSlides?(t=p.slides.length-3*p.loopedSlides+p.activeIndex,t+=p.loopedSlides,p.slideTo(t,0,!1,!0)):("auto"===p.params.slidesPerView&&p.activeIndex>=2*p.loopedSlides||p.activeIndex>p.slides.length-2*p.params.slidesPerView)&&(t=-p.slides.length+p.activeIndex+p.loopedSlides,t+=p.loopedSlides,p.slideTo(t,0,!1,!0))},p.appendSlide=function(t){if(p.params.loop&&p.destroyLoop(),"object"==typeof t&&t.length)for(var e=0;e<t.length;e++)t[e]&&p.wrapper.append(t[e]);else p.wrapper.append(t);p.params.loop&&p.createLoop(),p.params.observer&&p.support.observer||p.update(!0)},p.prependSlide=function(t){p.params.loop&&p.destroyLoop();var e=p.activeIndex+1;if("object"==typeof t&&t.length){for(var i=0;i<t.length;i++)t[i]&&p.wrapper.prepend(t[i]);e=p.activeIndex+t.length}else p.wrapper.prepend(t);p.params.loop&&p.createLoop(),p.params.observer&&p.support.observer||p.update(!0),p.slideTo(e,0,!1)},p.removeSlide=function(t){p.params.loop&&(p.destroyLoop(),p.slides=p.wrapper.children("."+p.params.slideClass));var e,i=p.activeIndex;if("object"==typeof t&&t.length){for(var n=0;n<t.length;n++)e=t[n],p.slides[e]&&p.slides.eq(e).remove(),e<i&&i--;i=Math.max(i,0)}else e=t,p.slides[e]&&p.slides.eq(e).remove(),e<i&&i--,i=Math.max(i,0);p.params.loop&&p.createLoop(),p.params.observer&&p.support.observer||p.update(!0),p.params.loop?p.slideTo(i+p.loopedSlides,0,!1):p.slideTo(i,0,!1)},p.removeAllSlides=function(){for(var t=[],e=0;e<p.slides.length;e++)t.push(e);p.removeSlide(t)},p.effects={fade:{setTranslate:function(){for(var t=0;t<p.slides.length;t++){var e=p.slides.eq(t),i=-e[0].swiperSlideOffset;p.params.virtualTranslate||(i-=p.translate);var n=0;p.isHorizontal()||(n=i,i=0);var o=p.params.fade.crossFade?Math.max(1-Math.abs(e[0].progress),0):1+Math.min(Math.max(e[0].progress,-1),0);e.css({opacity:o}).transform("translate3d("+i+"px, "+n+"px, 0px)")}},setTransition:function(t){if(p.slides.transition(t),p.params.virtualTranslate&&0!==t){var e=!1;p.slides.transitionEnd(function(){if(!e&&p){e=!0,p.animating=!1;for(var t=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"],i=0;i<t.length;i++)p.wrapper.trigger(t[i])}})}}},flip:{setTranslate:function(){for(var t=0;t<p.slides.length;t++){var i=p.slides.eq(t),n=i[0].progress;p.params.flip.limitRotation&&(n=Math.max(Math.min(i[0].progress,1),-1));var o=-180*n,r=0,a=-i[0].swiperSlideOffset,s=0;if(p.isHorizontal()?p.rtl&&(o=-o):(s=a,r=-o,o=a=0),i[0].style.zIndex=-Math.abs(Math.round(n))+p.slides.length,p.params.flip.slideShadows){var l=p.isHorizontal()?i.find(".swiper-slide-shadow-left"):i.find(".swiper-slide-shadow-top"),c=p.isHorizontal()?i.find(".swiper-slide-shadow-right"):i.find(".swiper-slide-shadow-bottom");0===l.length&&(l=e('<div class="swiper-slide-shadow-'+(p.isHorizontal()?"left":"top")+'"></div>'),i.append(l)),0===c.length&&(c=e('<div class="swiper-slide-shadow-'+(p.isHorizontal()?"right":"bottom")+'"></div>'),i.append(c)),l.length&&(l[0].style.opacity=Math.max(-n,0)),c.length&&(c[0].style.opacity=Math.max(n,0))}i.transform("translate3d("+a+"px, "+s+"px, 0px) rotateX("+r+"deg) rotateY("+o+"deg)")}},setTransition:function(t){if(p.slides.transition(t).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(t),p.params.virtualTranslate&&0!==t){var i=!1;p.slides.eq(p.activeIndex).transitionEnd(function(){if(!i&&p&&e(this).hasClass(p.params.slideActiveClass)){i=!0,p.animating=!1;for(var t=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"],n=0;n<t.length;n++)p.wrapper.trigger(t[n])}})}}},cube:{setTranslate:function(){var t,i=0;p.params.cube.shadow&&(p.isHorizontal()?(0===(t=p.wrapper.find(".swiper-cube-shadow")).length&&(t=e('<div class="swiper-cube-shadow"></div>'),p.wrapper.append(t)),t.css({height:p.width+"px"})):0===(t=p.container.find(".swiper-cube-shadow")).length&&(t=e('<div class="swiper-cube-shadow"></div>'),p.container.append(t)));for(var n=0;n<p.slides.length;n++){var o=p.slides.eq(n),r=90*n,a=Math.floor(r/360);p.rtl&&(r=-r,a=Math.floor(-r/360));var s=Math.max(Math.min(o[0].progress,1),-1),l=0,c=0,u=0;n%4==0?(l=4*-a*p.size,u=0):(n-1)%4==0?(l=0,u=4*-a*p.size):(n-2)%4==0?(l=p.size+4*a*p.size,u=p.size):(n-3)%4==0&&(l=-p.size,u=3*p.size+4*p.size*a),p.rtl&&(l=-l),p.isHorizontal()||(c=l,l=0);var h="rotateX("+(p.isHorizontal()?0:-r)+"deg) rotateY("+(p.isHorizontal()?r:0)+"deg) translate3d("+l+"px, "+c+"px, "+u+"px)";if(s<=1&&-1<s&&(i=90*n+90*s,p.rtl&&(i=90*-n-90*s)),o.transform(h),p.params.cube.slideShadows){var d=p.isHorizontal()?o.find(".swiper-slide-shadow-left"):o.find(".swiper-slide-shadow-top"),f=p.isHorizontal()?o.find(".swiper-slide-shadow-right"):o.find(".swiper-slide-shadow-bottom");0===d.length&&(d=e('<div class="swiper-slide-shadow-'+(p.isHorizontal()?"left":"top")+'"></div>'),o.append(d)),0===f.length&&(f=e('<div class="swiper-slide-shadow-'+(p.isHorizontal()?"right":"bottom")+'"></div>'),o.append(f)),d.length&&(d[0].style.opacity=Math.max(-s,0)),f.length&&(f[0].style.opacity=Math.max(s,0))}}if(p.wrapper.css({"-webkit-transform-origin":"50% 50% -"+p.size/2+"px","-moz-transform-origin":"50% 50% -"+p.size/2+"px","-ms-transform-origin":"50% 50% -"+p.size/2+"px","transform-origin":"50% 50% -"+p.size/2+"px"}),p.params.cube.shadow)if(p.isHorizontal())t.transform("translate3d(0px, "+(p.width/2+p.params.cube.shadowOffset)+"px, "+-p.width/2+"px) rotateX(90deg) rotateZ(0deg) scale("+p.params.cube.shadowScale+")");else{var m=Math.abs(i)-90*Math.floor(Math.abs(i)/90),g=1.5-(Math.sin(2*m*Math.PI/360)/2+Math.cos(2*m*Math.PI/360)/2),v=p.params.cube.shadowScale,y=p.params.cube.shadowScale/g,b=p.params.cube.shadowOffset;t.transform("scale3d("+v+", 1, "+y+") translate3d(0px, "+(p.height/2+b)+"px, "+-p.height/2/y+"px) rotateX(-90deg)")}var w=p.isSafari||p.isUiWebView?-p.size/2:0;p.wrapper.transform("translate3d(0px,0,"+w+"px) rotateX("+(p.isHorizontal()?0:i)+"deg) rotateY("+(p.isHorizontal()?-i:0)+"deg)")},setTransition:function(t){p.slides.transition(t).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(t),p.params.cube.shadow&&!p.isHorizontal()&&p.container.find(".swiper-cube-shadow").transition(t)}},coverflow:{setTranslate:function(){for(var t=p.translate,i=p.isHorizontal()?-t+p.width/2:-t+p.height/2,n=p.isHorizontal()?p.params.coverflow.rotate:-p.params.coverflow.rotate,o=p.params.coverflow.depth,r=0,a=p.slides.length;r<a;r++){var s=p.slides.eq(r),l=p.slidesSizesGrid[r],c=(i-s[0].swiperSlideOffset-l/2)/l*p.params.coverflow.modifier,u=p.isHorizontal()?n*c:0,h=p.isHorizontal()?0:n*c,d=-o*Math.abs(c),f=p.isHorizontal()?0:p.params.coverflow.stretch*c,m=p.isHorizontal()?p.params.coverflow.stretch*c:0;Math.abs(m)<.001&&(m=0),Math.abs(f)<.001&&(f=0),Math.abs(d)<.001&&(d=0),Math.abs(u)<.001&&(u=0),Math.abs(h)<.001&&(h=0);var g="translate3d("+m+"px,"+f+"px,"+d+"px)  rotateX("+h+"deg) rotateY("+u+"deg)";if(s.transform(g),s[0].style.zIndex=1-Math.abs(Math.round(c)),p.params.coverflow.slideShadows){var v=p.isHorizontal()?s.find(".swiper-slide-shadow-left"):s.find(".swiper-slide-shadow-top"),y=p.isHorizontal()?s.find(".swiper-slide-shadow-right"):s.find(".swiper-slide-shadow-bottom");0===v.length&&(v=e('<div class="swiper-slide-shadow-'+(p.isHorizontal()?"left":"top")+'"></div>'),s.append(v)),0===y.length&&(y=e('<div class="swiper-slide-shadow-'+(p.isHorizontal()?"right":"bottom")+'"></div>'),s.append(y)),v.length&&(v[0].style.opacity=0<c?c:0),y.length&&(y[0].style.opacity=0<-c?-c:0)}}p.browser.ie&&(p.wrapper[0].style.perspectiveOrigin=i+"px 50%")},setTransition:function(t){p.slides.transition(t).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(t)}}},p.lazy={initialImageLoaded:!1,loadImageInSlide:function(t,i){if(void 0!==t&&(void 0===i&&(i=!0),0!==p.slides.length)){var n=p.slides.eq(t),o=n.find("."+p.params.lazyLoadingClass+":not(."+p.params.lazyStatusLoadedClass+"):not(."+p.params.lazyStatusLoadingClass+")");!n.hasClass(p.params.lazyLoadingClass)||n.hasClass(p.params.lazyStatusLoadedClass)||n.hasClass(p.params.lazyStatusLoadingClass)||(o=o.add(n[0])),0!==o.length&&o.each(function(){var t=e(this);t.addClass(p.params.lazyStatusLoadingClass);var o=t.attr("data-background"),r=t.attr("data-src"),a=t.attr("data-srcset"),s=t.attr("data-sizes");p.loadImage(t[0],r||o,a,s,!1,function(){if(null!=p&&p){if(o?(t.css("background-image",'url("'+o+'")'),t.removeAttr("data-background")):(a&&(t.attr("srcset",a),t.removeAttr("data-srcset")),s&&(t.attr("sizes",s),t.removeAttr("data-sizes")),r&&(t.attr("src",r),t.removeAttr("data-src"))),t.addClass(p.params.lazyStatusLoadedClass).removeClass(p.params.lazyStatusLoadingClass),n.find("."+p.params.lazyPreloaderClass+", ."+p.params.preloaderClass).remove(),p.params.loop&&i){var e=n.attr("data-swiper-slide-index");if(n.hasClass(p.params.slideDuplicateClass)){var l=p.wrapper.children('[data-swiper-slide-index="'+e+'"]:not(.'+p.params.slideDuplicateClass+")");p.lazy.loadImageInSlide(l.index(),!1)}else{var c=p.wrapper.children("."+p.params.slideDuplicateClass+'[data-swiper-slide-index="'+e+'"]');p.lazy.loadImageInSlide(c.index(),!1)}}p.emit("onLazyImageReady",p,n[0],t[0])}}),p.emit("onLazyImageLoad",p,n[0],t[0])})}},load:function(){var t,i=p.params.slidesPerView;if("auto"===i&&(i=0),p.lazy.initialImageLoaded||(p.lazy.initialImageLoaded=!0),p.params.watchSlidesVisibility)p.wrapper.children("."+p.params.slideVisibleClass).each(function(){p.lazy.loadImageInSlide(e(this).index())});else if(1<i)for(t=p.activeIndex;t<p.activeIndex+i;t++)p.slides[t]&&p.lazy.loadImageInSlide(t);else p.lazy.loadImageInSlide(p.activeIndex);if(p.params.lazyLoadingInPrevNext)if(1<i||p.params.lazyLoadingInPrevNextAmount&&1<p.params.lazyLoadingInPrevNextAmount){var n=p.params.lazyLoadingInPrevNextAmount,o=i,r=Math.min(p.activeIndex+o+Math.max(n,o),p.slides.length),a=Math.max(p.activeIndex-Math.max(o,n),0);for(t=p.activeIndex+i;t<r;t++)p.slides[t]&&p.lazy.loadImageInSlide(t);for(t=a;t<p.activeIndex;t++)p.slides[t]&&p.lazy.loadImageInSlide(t)}else{var s=p.wrapper.children("."+p.params.slideNextClass);0<s.length&&p.lazy.loadImageInSlide(s.index());var l=p.wrapper.children("."+p.params.slidePrevClass);0<l.length&&p.lazy.loadImageInSlide(l.index())}},onTransitionStart:function(){p.params.lazyLoading&&(p.params.lazyLoadingOnTransitionStart||!p.params.lazyLoadingOnTransitionStart&&!p.lazy.initialImageLoaded)&&p.lazy.load()},onTransitionEnd:function(){p.params.lazyLoading&&!p.params.lazyLoadingOnTransitionStart&&p.lazy.load()}},p.scrollbar={isTouched:!1,setDragPosition:function(t){var e=p.scrollbar,i=(p.isHorizontal()?"touchstart"===t.type||"touchmove"===t.type?t.targetTouches[0].pageX:t.pageX||t.clientX:"touchstart"===t.type||"touchmove"===t.type?t.targetTouches[0].pageY:t.pageY||t.clientY)-e.track.offset()[p.isHorizontal()?"left":"top"]-e.dragSize/2,n=-p.minTranslate()*e.moveDivider,o=-p.maxTranslate()*e.moveDivider;i<n?i=n:o<i&&(i=o),i=-i/e.moveDivider,p.updateProgress(i),p.setWrapperTranslate(i,!0)},dragStart:function(t){var e=p.scrollbar;e.isTouched=!0,t.preventDefault(),t.stopPropagation(),e.setDragPosition(t),clearTimeout(e.dragTimeout),e.track.transition(0),p.params.scrollbarHide&&e.track.css("opacity",1),p.wrapper.transition(100),e.drag.transition(100),p.emit("onScrollbarDragStart",p)},dragMove:function(t){var e=p.scrollbar;e.isTouched&&(t.preventDefault?t.preventDefault():t.returnValue=!1,e.setDragPosition(t),p.wrapper.transition(0),e.track.transition(0),e.drag.transition(0),p.emit("onScrollbarDragMove",p))},dragEnd:function(t){var e=p.scrollbar;e.isTouched&&(e.isTouched=!1,p.params.scrollbarHide&&(clearTimeout(e.dragTimeout),e.dragTimeout=setTimeout(function(){e.track.css("opacity",0),e.track.transition(400)},1e3)),p.emit("onScrollbarDragEnd",p),p.params.scrollbarSnapOnRelease&&p.slideReset())},draggableEvents:!1!==p.params.simulateTouch||p.support.touch?p.touchEvents:p.touchEventsDesktop,enableDraggable:function(){var t=p.scrollbar,i=p.support.touch?t.track:document;e(t.track).on(t.draggableEvents.start,t.dragStart),e(i).on(t.draggableEvents.move,t.dragMove),e(i).on(t.draggableEvents.end,t.dragEnd)},disableDraggable:function(){var t=p.scrollbar,i=p.support.touch?t.track:document;e(t.track).off(t.draggableEvents.start,t.dragStart),e(i).off(t.draggableEvents.move,t.dragMove),e(i).off(t.draggableEvents.end,t.dragEnd)},set:function(){if(p.params.scrollbar){var t=p.scrollbar;t.track=e(p.params.scrollbar),p.params.uniqueNavElements&&"string"==typeof p.params.scrollbar&&1<t.track.length&&1===p.container.find(p.params.scrollbar).length&&(t.track=p.container.find(p.params.scrollbar)),t.drag=t.track.find(".swiper-scrollbar-drag"),0===t.drag.length&&(t.drag=e('<div class="swiper-scrollbar-drag"></div>'),t.track.append(t.drag)),t.drag[0].style.width="",t.drag[0].style.height="",t.trackSize=p.isHorizontal()?t.track[0].offsetWidth:t.track[0].offsetHeight,t.divider=p.size/p.virtualSize,t.moveDivider=t.divider*(t.trackSize/p.size),t.dragSize=t.trackSize*t.divider,p.isHorizontal()?t.drag[0].style.width=t.dragSize+"px":t.drag[0].style.height=t.dragSize+"px",1<=t.divider?t.track[0].style.display="none":t.track[0].style.display="",p.params.scrollbarHide&&(t.track[0].style.opacity=0)}},setTranslate:function(){if(p.params.scrollbar){var t,e=p.scrollbar,i=(p.translate,e.dragSize);t=(e.trackSize-e.dragSize)*p.progress,p.rtl&&p.isHorizontal()?0<(t=-t)?(i=e.dragSize-t,t=0):-t+e.dragSize>e.trackSize&&(i=e.trackSize+t):t<0?(i=e.dragSize+t,t=0):t+e.dragSize>e.trackSize&&(i=e.trackSize-t),p.isHorizontal()?(p.support.transforms3d?e.drag.transform("translate3d("+t+"px, 0, 0)"):e.drag.transform("translateX("+t+"px)"),e.drag[0].style.width=i+"px"):(p.support.transforms3d?e.drag.transform("translate3d(0px, "+t+"px, 0)"):e.drag.transform("translateY("+t+"px)"),e.drag[0].style.height=i+"px"),p.params.scrollbarHide&&(clearTimeout(e.timeout),e.track[0].style.opacity=1,e.timeout=setTimeout(function(){e.track[0].style.opacity=0,e.track.transition(400)},1e3))}},setTransition:function(t){p.params.scrollbar&&p.scrollbar.drag.transition(t)}},p.controller={LinearSpline:function(t,e){var i,n,o,r,a;this.x=t,this.y=e,this.lastIndex=t.length-1,this.x.length,this.interpolate=function(t){return t?(a=function(t,e){for(n=-1,i=t.length;1<i-n;)t[o=i+n>>1]<=e?n=o:i=o;return i}(this.x,t),r=a-1,(t-this.x[r])*(this.y[a]-this.y[r])/(this.x[a]-this.x[r])+this.y[r]):0}},getInterpolateFunction:function(t){p.controller.spline||(p.controller.spline=p.params.loop?new p.controller.LinearSpline(p.slidesGrid,t.slidesGrid):new p.controller.LinearSpline(p.snapGrid,t.snapGrid))},setTranslate:function(t,e){var i,n,o=p.params.control;function r(e){t=e.rtl&&"horizontal"===e.params.direction?-p.translate:p.translate,"slide"===p.params.controlBy&&(p.controller.getInterpolateFunction(e),n=-p.controller.spline.interpolate(-t)),n&&"container"!==p.params.controlBy||(i=(e.maxTranslate()-e.minTranslate())/(p.maxTranslate()-p.minTranslate()),n=(t-p.minTranslate())*i+e.minTranslate()),p.params.controlInverse&&(n=e.maxTranslate()-n),e.updateProgress(n),e.setWrapperTranslate(n,!1,p),e.updateActiveIndex()}if(Array.isArray(o))for(var a=0;a<o.length;a++)o[a]!==e&&o[a]instanceof d&&r(o[a]);else o instanceof d&&e!==o&&r(o)},setTransition:function(t,e){var i,n=p.params.control;function o(e){e.setWrapperTransition(t,p),0!==t&&(e.onTransitionStart(),e.wrapper.transitionEnd(function(){n&&(e.params.loop&&"slide"===p.params.controlBy&&e.fixLoop(),e.onTransitionEnd())}))}if(Array.isArray(n))for(i=0;i<n.length;i++)n[i]!==e&&n[i]instanceof d&&o(n[i]);else n instanceof d&&e!==n&&o(n)}},p.hashnav={onHashCange:function(t,e){var i=document.location.hash.replace("#","");i!==p.slides.eq(p.activeIndex).attr("data-hash")&&p.slideTo(p.wrapper.children("."+p.params.slideClass+'[data-hash="'+i+'"]').index())},attachEvents:function(t){var i=t?"off":"on";e(window)[i]("hashchange",p.hashnav.onHashCange)},setHash:function(){if(p.hashnav.initialized&&p.params.hashnav)if(p.params.replaceState&&window.history&&window.history.replaceState)window.history.replaceState(null,null,"#"+p.slides.eq(p.activeIndex).attr("data-hash")||"");else{var t=p.slides.eq(p.activeIndex),e=t.attr("data-hash")||t.attr("data-history");document.location.hash=e||""}},init:function(){if(p.params.hashnav&&!p.params.history){p.hashnav.initialized=!0;var t=document.location.hash.replace("#","");if(t)for(var e=0,i=p.slides.length;e<i;e++){var n=p.slides.eq(e);if((n.attr("data-hash")||n.attr("data-history"))===t&&!n.hasClass(p.params.slideDuplicateClass)){var o=n.index();p.slideTo(o,0,p.params.runCallbacksOnInit,!0)}}p.params.hashnavWatchState&&p.hashnav.attachEvents()}},destroy:function(){p.params.hashnavWatchState&&p.hashnav.attachEvents(!0)}},p.history={init:function(){if(p.params.history){if(!window.history||!window.history.pushState)return p.params.history=!1,void(p.params.hashnav=!0);p.history.initialized=!0,this.paths=this.getPathValues(),(this.paths.key||this.paths.value)&&(this.scrollToSlide(0,this.paths.value,p.params.runCallbacksOnInit),p.params.replaceState||window.addEventListener("popstate",this.setHistoryPopState))}},setHistoryPopState:function(){p.history.paths=p.history.getPathValues(),p.history.scrollToSlide(p.params.speed,p.history.paths.value,!1)},getPathValues:function(){var t=window.location.pathname.slice(1).split("/"),e=t.length;return{key:t[e-2],value:t[e-1]}},setHistory:function(t,e){if(p.history.initialized&&p.params.history){var i=p.slides.eq(e),n=this.slugify(i.attr("data-history"));window.location.pathname.includes(t)||(n=t+"/"+n),p.params.replaceState?window.history.replaceState(null,null,n):window.history.pushState(null,null,n)}},slugify:function(t){return t.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},scrollToSlide:function(t,e,i){if(e)for(var n=0,o=p.slides.length;n<o;n++){var r=p.slides.eq(n);if(this.slugify(r.attr("data-history"))===e&&!r.hasClass(p.params.slideDuplicateClass)){var a=r.index();p.slideTo(a,t,i)}}else p.slideTo(0,t,i)}},p.disableKeyboardControl=function(){p.params.keyboardControl=!1,e(document).off("keydown",N)},p.enableKeyboardControl=function(){p.params.keyboardControl=!0,e(document).on("keydown",N)},p.mousewheel={event:!1,lastScrollTime:(new window.Date).getTime()},p.params.mousewheelControl&&(p.mousewheel.event=-1<navigator.userAgent.indexOf("firefox")?"DOMMouseScroll":function(){var t="onwheel",e=t in document;if(!e){var i=document.createElement("div");i.setAttribute(t,"return;"),e="function"==typeof i[t]}return!e&&document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("","")&&(e=document.implementation.hasFeature("Events.wheel","3.0")),e}()?"wheel":"mousewheel"),p.disableMousewheelControl=function(){if(!p.mousewheel.event)return!1;var t=p.container;return"container"!==p.params.mousewheelEventsTarged&&(t=e(p.params.mousewheelEventsTarged)),t.off(p.mousewheel.event,U),!(p.params.mousewheelControl=!1)},p.enableMousewheelControl=function(){if(!p.mousewheel.event)return!1;var t=p.container;return"container"!==p.params.mousewheelEventsTarged&&(t=e(p.params.mousewheelEventsTarged)),t.on(p.mousewheel.event,U),p.params.mousewheelControl=!0},p.parallax={setTranslate:function(){p.container.children("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y]").each(function(){B(this,p.progress)}),p.slides.each(function(){var t=e(this);t.find("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y]").each(function(){B(this,Math.min(Math.max(t[0].progress,-1),1))})})},setTransition:function(t){void 0===t&&(t=p.params.speed),p.container.find("[data-swiper-parallax], [data-swiper-parallax-x], [data-swiper-parallax-y]").each(function(){var i=e(this),n=parseInt(i.attr("data-swiper-parallax-duration"),10)||t;0===t&&(n=0),i.transition(n)})}},p.zoom={scale:1,currentScale:1,isScaling:!1,gesture:{slide:void 0,slideWidth:void 0,slideHeight:void 0,image:void 0,imageWrap:void 0,zoomMax:p.params.zoomMax},image:{isTouched:void 0,isMoved:void 0,currentX:void 0,currentY:void 0,minX:void 0,minY:void 0,maxX:void 0,maxY:void 0,width:void 0,height:void 0,startX:void 0,startY:void 0,touchesStart:{},touchesCurrent:{}},velocity:{x:void 0,y:void 0,prevPositionX:void 0,prevPositionY:void 0,prevTime:void 0},getDistanceBetweenTouches:function(t){if(t.targetTouches.length<2)return 1;var e=t.targetTouches[0].pageX,i=t.targetTouches[0].pageY,n=t.targetTouches[1].pageX,o=t.targetTouches[1].pageY;return Math.sqrt(Math.pow(n-e,2)+Math.pow(o-i,2))},onGestureStart:function(t){var i=p.zoom;if(!p.support.gestures){if("touchstart"!==t.type||"touchstart"===t.type&&t.targetTouches.length<2)return;i.gesture.scaleStart=i.getDistanceBetweenTouches(t)}i.gesture.slide&&i.gesture.slide.length||(i.gesture.slide=e(this),0===i.gesture.slide.length&&(i.gesture.slide=p.slides.eq(p.activeIndex)),i.gesture.image=i.gesture.slide.find("img, svg, canvas"),i.gesture.imageWrap=i.gesture.image.parent("."+p.params.zoomContainerClass),i.gesture.zoomMax=i.gesture.imageWrap.attr("data-swiper-zoom")||p.params.zoomMax,0!==i.gesture.imageWrap.length)?(i.gesture.image.transition(0),i.isScaling=!0):i.gesture.image=void 0},onGestureChange:function(t){var e=p.zoom;if(!p.support.gestures){if("touchmove"!==t.type||"touchmove"===t.type&&t.targetTouches.length<2)return;e.gesture.scaleMove=e.getDistanceBetweenTouches(t)}e.gesture.image&&0!==e.gesture.image.length&&(p.support.gestures?e.scale=t.scale*e.currentScale:e.scale=e.gesture.scaleMove/e.gesture.scaleStart*e.currentScale,e.scale>e.gesture.zoomMax&&(e.scale=e.gesture.zoomMax-1+Math.pow(e.scale-e.gesture.zoomMax+1,.5)),e.scale<p.params.zoomMin&&(e.scale=p.params.zoomMin+1-Math.pow(p.params.zoomMin-e.scale+1,.5)),e.gesture.image.transform("translate3d(0,0,0) scale("+e.scale+")"))},onGestureEnd:function(t){var e=p.zoom;!p.support.gestures&&("touchend"!==t.type||"touchend"===t.type&&t.changedTouches.length<2)||e.gesture.image&&0!==e.gesture.image.length&&(e.scale=Math.max(Math.min(e.scale,e.gesture.zoomMax),p.params.zoomMin),e.gesture.image.transition(p.params.speed).transform("translate3d(0,0,0) scale("+e.scale+")"),e.currentScale=e.scale,e.isScaling=!1,1===e.scale&&(e.gesture.slide=void 0))},onTouchStart:function(t,e){var i=t.zoom;i.gesture.image&&0!==i.gesture.image.length&&(i.image.isTouched||("android"===t.device.os&&e.preventDefault(),i.image.isTouched=!0,i.image.touchesStart.x="touchstart"===e.type?e.targetTouches[0].pageX:e.pageX,i.image.touchesStart.y="touchstart"===e.type?e.targetTouches[0].pageY:e.pageY))},onTouchMove:function(t){var e=p.zoom;if(e.gesture.image&&0!==e.gesture.image.length&&(p.allowClick=!1,e.image.isTouched&&e.gesture.slide)){e.image.isMoved||(e.image.width=e.gesture.image[0].offsetWidth,e.image.height=e.gesture.image[0].offsetHeight,e.image.startX=p.getTranslate(e.gesture.imageWrap[0],"x")||0,e.image.startY=p.getTranslate(e.gesture.imageWrap[0],"y")||0,e.gesture.slideWidth=e.gesture.slide[0].offsetWidth,e.gesture.slideHeight=e.gesture.slide[0].offsetHeight,e.gesture.imageWrap.transition(0),p.rtl&&(e.image.startX=-e.image.startX),p.rtl&&(e.image.startY=-e.image.startY));var i=e.image.width*e.scale,n=e.image.height*e.scale;if(!(i<e.gesture.slideWidth&&n<e.gesture.slideHeight)){if(e.image.minX=Math.min(e.gesture.slideWidth/2-i/2,0),e.image.maxX=-e.image.minX,e.image.minY=Math.min(e.gesture.slideHeight/2-n/2,0),e.image.maxY=-e.image.minY,e.image.touchesCurrent.x="touchmove"===t.type?t.targetTouches[0].pageX:t.pageX,e.image.touchesCurrent.y="touchmove"===t.type?t.targetTouches[0].pageY:t.pageY,!e.image.isMoved&&!e.isScaling){if(p.isHorizontal()&&Math.floor(e.image.minX)===Math.floor(e.image.startX)&&e.image.touchesCurrent.x<e.image.touchesStart.x||Math.floor(e.image.maxX)===Math.floor(e.image.startX)&&e.image.touchesCurrent.x>e.image.touchesStart.x)return void(e.image.isTouched=!1);if(!p.isHorizontal()&&Math.floor(e.image.minY)===Math.floor(e.image.startY)&&e.image.touchesCurrent.y<e.image.touchesStart.y||Math.floor(e.image.maxY)===Math.floor(e.image.startY)&&e.image.touchesCurrent.y>e.image.touchesStart.y)return void(e.image.isTouched=!1)}t.preventDefault(),t.stopPropagation(),e.image.isMoved=!0,e.image.currentX=e.image.touchesCurrent.x-e.image.touchesStart.x+e.image.startX,e.image.currentY=e.image.touchesCurrent.y-e.image.touchesStart.y+e.image.startY,e.image.currentX<e.image.minX&&(e.image.currentX=e.image.minX+1-Math.pow(e.image.minX-e.image.currentX+1,.8)),e.image.currentX>e.image.maxX&&(e.image.currentX=e.image.maxX-1+Math.pow(e.image.currentX-e.image.maxX+1,.8)),e.image.currentY<e.image.minY&&(e.image.currentY=e.image.minY+1-Math.pow(e.image.minY-e.image.currentY+1,.8)),e.image.currentY>e.image.maxY&&(e.image.currentY=e.image.maxY-1+Math.pow(e.image.currentY-e.image.maxY+1,.8)),e.velocity.prevPositionX||(e.velocity.prevPositionX=e.image.touchesCurrent.x),e.velocity.prevPositionY||(e.velocity.prevPositionY=e.image.touchesCurrent.y),e.velocity.prevTime||(e.velocity.prevTime=Date.now()),e.velocity.x=(e.image.touchesCurrent.x-e.velocity.prevPositionX)/(Date.now()-e.velocity.prevTime)/2,e.velocity.y=(e.image.touchesCurrent.y-e.velocity.prevPositionY)/(Date.now()-e.velocity.prevTime)/2,Math.abs(e.image.touchesCurrent.x-e.velocity.prevPositionX)<2&&(e.velocity.x=0),Math.abs(e.image.touchesCurrent.y-e.velocity.prevPositionY)<2&&(e.velocity.y=0),e.velocity.prevPositionX=e.image.touchesCurrent.x,e.velocity.prevPositionY=e.image.touchesCurrent.y,e.velocity.prevTime=Date.now(),e.gesture.imageWrap.transform("translate3d("+e.image.currentX+"px, "+e.image.currentY+"px,0)")}}},onTouchEnd:function(t,e){var i=t.zoom;if(i.gesture.image&&0!==i.gesture.image.length){if(!i.image.isTouched||!i.image.isMoved)return i.image.isTouched=!1,void(i.image.isMoved=!1);i.image.isTouched=!1,i.image.isMoved=!1;var n=300,o=300,r=i.velocity.x*n,a=i.image.currentX+r,s=i.velocity.y*o,l=i.image.currentY+s;0!==i.velocity.x&&(n=Math.abs((a-i.image.currentX)/i.velocity.x)),0!==i.velocity.y&&(o=Math.abs((l-i.image.currentY)/i.velocity.y));var c=Math.max(n,o);i.image.currentX=a,i.image.currentY=l;var u=i.image.width*i.scale,h=i.image.height*i.scale;i.image.minX=Math.min(i.gesture.slideWidth/2-u/2,0),i.image.maxX=-i.image.minX,i.image.minY=Math.min(i.gesture.slideHeight/2-h/2,0),i.image.maxY=-i.image.minY,i.image.currentX=Math.max(Math.min(i.image.currentX,i.image.maxX),i.image.minX),i.image.currentY=Math.max(Math.min(i.image.currentY,i.image.maxY),i.image.minY),i.gesture.imageWrap.transition(c).transform("translate3d("+i.image.currentX+"px, "+i.image.currentY+"px,0)")}},onTransitionEnd:function(t){var e=t.zoom;e.gesture.slide&&t.previousIndex!==t.activeIndex&&(e.gesture.image.transform("translate3d(0,0,0) scale(1)"),e.gesture.imageWrap.transform("translate3d(0,0,0)"),e.gesture.slide=e.gesture.image=e.gesture.imageWrap=void 0,e.scale=e.currentScale=1)},toggleZoom:function(t,i){var n,o,r,a,s,l,c,u,h,d,p,f,m,g,v,y,b=t.zoom;b.gesture.slide||(b.gesture.slide=t.clickedSlide?e(t.clickedSlide):t.slides.eq(t.activeIndex),b.gesture.image=b.gesture.slide.find("img, svg, canvas"),b.gesture.imageWrap=b.gesture.image.parent("."+t.params.zoomContainerClass)),b.gesture.image&&0!==b.gesture.image.length&&(o=void 0===b.image.touchesStart.x&&i?(n="touchend"===i.type?i.changedTouches[0].pageX:i.pageX,"touchend"===i.type?i.changedTouches[0].pageY:i.pageY):(n=b.image.touchesStart.x,b.image.touchesStart.y),b.scale&&1!==b.scale?(b.scale=b.currentScale=1,b.gesture.imageWrap.transition(300).transform("translate3d(0,0,0)"),b.gesture.image.transition(300).transform("translate3d(0,0,0) scale(1)"),b.gesture.slide=void 0):(b.scale=b.currentScale=b.gesture.imageWrap.attr("data-swiper-zoom")||t.params.zoomMax,i?(v=b.gesture.slide[0].offsetWidth,y=b.gesture.slide[0].offsetHeight,r=b.gesture.slide.offset().left+v/2-n,a=b.gesture.slide.offset().top+y/2-o,c=b.gesture.image[0].offsetWidth,u=b.gesture.image[0].offsetHeight,h=c*b.scale,d=u*b.scale,m=-(p=Math.min(v/2-h/2,0)),g=-(f=Math.min(y/2-d/2,0)),(s=r*b.scale)<p&&(s=p),m<s&&(s=m),(l=a*b.scale)<f&&(l=f),g<l&&(l=g)):l=s=0,b.gesture.imageWrap.transition(300).transform("translate3d("+s+"px, "+l+"px,0)"),b.gesture.image.transition(300).transform("translate3d(0,0,0) scale("+b.scale+")")))},attachEvents:function(t){var i=t?"off":"on";if(p.params.zoom){p.slides;var n=!("touchstart"!==p.touchEvents.start||!p.support.passiveListener||!p.params.passiveListeners)&&{passive:!0,capture:!1};p.support.gestures?(p.slides[i]("gesturestart",p.zoom.onGestureStart,n),p.slides[i]("gesturechange",p.zoom.onGestureChange,n),p.slides[i]("gestureend",p.zoom.onGestureEnd,n)):"touchstart"===p.touchEvents.start&&(p.slides[i](p.touchEvents.start,p.zoom.onGestureStart,n),p.slides[i](p.touchEvents.move,p.zoom.onGestureChange,n),p.slides[i](p.touchEvents.end,p.zoom.onGestureEnd,n)),p[i]("touchStart",p.zoom.onTouchStart),p.slides.each(function(t,n){0<e(n).find("."+p.params.zoomContainerClass).length&&e(n)[i](p.touchEvents.move,p.zoom.onTouchMove)}),p[i]("touchEnd",p.zoom.onTouchEnd),p[i]("transitionEnd",p.zoom.onTransitionEnd),p.params.zoomToggle&&p.on("doubleTap",p.zoom.toggleZoom)}},init:function(){p.zoom.attachEvents()},destroy:function(){p.zoom.attachEvents(!0)}},p._plugins=[],p.plugins){var D=p.plugins[L](p,p.params[L]);D&&p._plugins.push(D)}return p.callPlugins=function(t){for(var e=0;e<p._plugins.length;e++)t in p._plugins[e]&&p._plugins[e][t](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])},p.emitterEventListeners={},p.emit=function(t){var e;if(p.params[t]&&p.params[t](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),p.emitterEventListeners[t])for(e=0;e<p.emitterEventListeners[t].length;e++)p.emitterEventListeners[t][e](arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]);p.callPlugins&&p.callPlugins(t,arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])},p.on=function(t,e){return t=z(t),p.emitterEventListeners[t]||(p.emitterEventListeners[t]=[]),p.emitterEventListeners[t].push(e),p},p.off=function(t,e){var i;if(t=z(t),void 0===e)return p.emitterEventListeners[t]=[],p;if(p.emitterEventListeners[t]&&0!==p.emitterEventListeners[t].length){for(i=0;i<p.emitterEventListeners[t].length;i++)p.emitterEventListeners[t][i]===e&&p.emitterEventListeners[t].splice(i,1);return p}},p.once=function(t,e){t=z(t);var i=function(){e(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]),p.off(t,i)};return p.on(t,i),p},p.a11y={makeFocusable:function(t){return t.attr("tabIndex","0"),t},addRole:function(t,e){return t.attr("role",e),t},addLabel:function(t,e){return t.attr("aria-label",e),t},disable:function(t){return t.attr("aria-disabled",!0),t},enable:function(t){return t.attr("aria-disabled",!1),t},onEnterKey:function(t){13===t.keyCode&&(e(t.target).is(p.params.nextButton)?(p.onClickNext(t),p.isEnd?p.a11y.notify(p.params.lastSlideMessage):p.a11y.notify(p.params.nextSlideMessage)):e(t.target).is(p.params.prevButton)&&(p.onClickPrev(t),p.isBeginning?p.a11y.notify(p.params.firstSlideMessage):p.a11y.notify(p.params.prevSlideMessage)),e(t.target).is("."+p.params.bulletClass)&&e(t.target)[0].click())},liveRegion:e('<span class="'+p.params.notificationClass+'" aria-live="assertive" aria-atomic="true"></span>'),notify:function(t){var e=p.a11y.liveRegion;0!==e.length&&(e.html(""),e.html(t))},init:function(){p.params.nextButton&&p.nextButton&&0<p.nextButton.length&&(p.a11y.makeFocusable(p.nextButton),p.a11y.addRole(p.nextButton,"button"),p.a11y.addLabel(p.nextButton,p.params.nextSlideMessage)),p.params.prevButton&&p.prevButton&&0<p.prevButton.length&&(p.a11y.makeFocusable(p.prevButton),p.a11y.addRole(p.prevButton,"button"),p.a11y.addLabel(p.prevButton,p.params.prevSlideMessage)),e(p.container).append(p.a11y.liveRegion)},initPagination:function(){p.params.pagination&&p.params.paginationClickable&&p.bullets&&p.bullets.length&&p.bullets.each(function(){var t=e(this);p.a11y.makeFocusable(t),p.a11y.addRole(t,"button"),p.a11y.addLabel(t,p.params.paginationBulletMessage.replace(/{{index}}/,t.index()+1))})},destroy:function(){p.a11y.liveRegion&&0<p.a11y.liveRegion.length&&p.a11y.liveRegion.remove()}},p.init=function(){p.params.loop&&p.createLoop(),p.updateContainerSize(),p.updateSlidesSize(),p.updatePagination(),p.params.scrollbar&&p.scrollbar&&(p.scrollbar.set(),p.params.scrollbarDraggable&&p.scrollbar.enableDraggable()),"slide"!==p.params.effect&&p.effects[p.params.effect]&&(p.params.loop||p.updateProgress(),p.effects[p.params.effect].setTranslate()),p.params.loop?p.slideTo(p.params.initialSlide+p.loopedSlides,0,p.params.runCallbacksOnInit):(p.slideTo(p.params.initialSlide,0,p.params.runCallbacksOnInit),0===p.params.initialSlide&&(p.parallax&&p.params.parallax&&p.parallax.setTranslate(),p.lazy&&p.params.lazyLoading&&(p.lazy.load(),p.lazy.initialImageLoaded=!0))),p.attachEvents(),p.params.observer&&p.support.observer&&p.initObservers(),p.params.preloadImages&&!p.params.lazyLoading&&p.preloadImages(),p.params.zoom&&p.zoom&&p.zoom.init(),p.params.autoplay&&p.startAutoplay(),p.params.keyboardControl&&p.enableKeyboardControl&&p.enableKeyboardControl(),p.params.mousewheelControl&&p.enableMousewheelControl&&p.enableMousewheelControl(),p.params.hashnavReplaceState&&(p.params.replaceState=p.params.hashnavReplaceState),p.params.history&&p.history&&p.history.init(),p.params.hashnav&&p.hashnav&&p.hashnav.init(),p.params.a11y&&p.a11y&&p.a11y.init(),p.emit("onInit",p)},p.cleanupStyles=function(){p.container.removeClass(p.classNames.join(" ")).removeAttr("style"),p.wrapper.removeAttr("style"),p.slides&&p.slides.length&&p.slides.removeClass([p.params.slideVisibleClass,p.params.slideActiveClass,p.params.slideNextClass,p.params.slidePrevClass].join(" ")).removeAttr("style").removeAttr("data-swiper-column").removeAttr("data-swiper-row"),p.paginationContainer&&p.paginationContainer.length&&p.paginationContainer.removeClass(p.params.paginationHiddenClass),p.bullets&&p.bullets.length&&p.bullets.removeClass(p.params.bulletActiveClass),p.params.prevButton&&e(p.params.prevButton).removeClass(p.params.buttonDisabledClass),p.params.nextButton&&e(p.params.nextButton).removeClass(p.params.buttonDisabledClass),p.params.scrollbar&&p.scrollbar&&(p.scrollbar.track&&p.scrollbar.track.length&&p.scrollbar.track.removeAttr("style"),p.scrollbar.drag&&p.scrollbar.drag.length&&p.scrollbar.drag.removeAttr("style"))},p.destroy=function(t,e){p.detachEvents(),p.stopAutoplay(),p.params.scrollbar&&p.scrollbar&&p.params.scrollbarDraggable&&p.scrollbar.disableDraggable(),p.params.loop&&p.destroyLoop(),e&&p.cleanupStyles(),p.disconnectObservers(),p.params.zoom&&p.zoom&&p.zoom.destroy(),p.params.keyboardControl&&p.disableKeyboardControl&&p.disableKeyboardControl(),p.params.mousewheelControl&&p.disableMousewheelControl&&p.disableMousewheelControl(),p.params.a11y&&p.a11y&&p.a11y.destroy(),p.params.history&&!p.params.replaceState&&window.removeEventListener("popstate",p.history.setHistoryPopState),p.params.hashnav&&p.hashnav&&p.hashnav.destroy(),p.emit("onDestroy"),!1!==t&&(p=null)},p.init(),p}function k(t){return Math.floor(t)}function R(){var t=p.params.autoplay,e=p.slides.eq(p.activeIndex);e.attr("data-swiper-autoplay")&&(t=e.attr("data-swiper-autoplay")||p.params.autoplay),p.autoplayTimeoutId=setTimeout(function(){p.params.loop?(p.fixLoop(),p._slideNext(),p.emit("onAutoplay",p)):p.isEnd?i.autoplayStopOnLast?p.stopAutoplay():(p._slideTo(0),p.emit("onAutoplay",p)):(p._slideNext(),p.emit("onAutoplay",p))},t)}function O(t,i){var n=e(t.target);if(!n.is(i))if("string"==typeof i)n=n.parents(i);else if(i.nodeType){var o;return n.parents().each(function(t,e){e===i&&(o=i)}),o?i:void 0}if(0!==n.length)return n[0]}function F(t,e){e=e||{};var i=new(window.MutationObserver||window.WebkitMutationObserver)(function(t){t.forEach(function(t){p.onResize(!0),p.emit("onObserverUpdate",p,t)})});i.observe(t,{attributes:void 0===e.attributes||e.attributes,childList:void 0===e.childList||e.childList,characterData:void 0===e.characterData||e.characterData}),p.observers.push(i)}function N(t){t.originalEvent&&(t=t.originalEvent);var e=t.keyCode||t.charCode;if(!p.params.allowSwipeToNext&&(p.isHorizontal()&&39===e||!p.isHorizontal()&&40===e))return!1;if(!p.params.allowSwipeToPrev&&(p.isHorizontal()&&37===e||!p.isHorizontal()&&38===e))return!1;if(!(t.shiftKey||t.altKey||t.ctrlKey||t.metaKey||document.activeElement&&document.activeElement.nodeName&&("input"===document.activeElement.nodeName.toLowerCase()||"textarea"===document.activeElement.nodeName.toLowerCase()))){if(37===e||39===e||38===e||40===e){var i=!1;if(0<p.container.parents("."+p.params.slideClass).length&&0===p.container.parents("."+p.params.slideActiveClass).length)return;var n=window.pageXOffset,o=window.pageYOffset,r=window.innerWidth,a=window.innerHeight,s=p.container.offset();p.rtl&&(s.left=s.left-p.container[0].scrollLeft);for(var l=[[s.left,s.top],[s.left+p.width,s.top],[s.left,s.top+p.height],[s.left+p.width,s.top+p.height]],c=0;c<l.length;c++){var u=l[c];u[0]>=n&&u[0]<=n+r&&u[1]>=o&&u[1]<=o+a&&(i=!0)}if(!i)return}p.isHorizontal()?(37!==e&&39!==e||(t.preventDefault?t.preventDefault():t.returnValue=!1),(39===e&&!p.rtl||37===e&&p.rtl)&&p.slideNext(),(37===e&&!p.rtl||39===e&&p.rtl)&&p.slidePrev()):(38!==e&&40!==e||(t.preventDefault?t.preventDefault():t.returnValue=!1),40===e&&p.slideNext(),38===e&&p.slidePrev()),p.emit("onKeyPress",p,e)}}function U(t){t.originalEvent&&(t=t.originalEvent);var e,i,n,o,r,a=0,s=p.rtl?-1:1,l=(r=o=n=i=0,"detail"in(e=t)&&(n=e.detail),"wheelDelta"in e&&(n=-e.wheelDelta/120),"wheelDeltaY"in e&&(n=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(i=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(i=n,n=0),o=10*i,r=10*n,"deltaY"in e&&(r=e.deltaY),"deltaX"in e&&(o=e.deltaX),(o||r)&&e.deltaMode&&(1===e.deltaMode?(o*=40,r*=40):(o*=800,r*=800)),o&&!i&&(i=o<1?-1:1),r&&!n&&(n=r<1?-1:1),{spinX:i,spinY:n,pixelX:o,pixelY:r});if(p.params.mousewheelForceToAxis)if(p.isHorizontal()){if(!(Math.abs(l.pixelX)>Math.abs(l.pixelY)))return;a=l.pixelX*s}else{if(!(Math.abs(l.pixelY)>Math.abs(l.pixelX)))return;a=l.pixelY}else a=Math.abs(l.pixelX)>Math.abs(l.pixelY)?-l.pixelX*s:-l.pixelY;if(0!==a){if(p.params.mousewheelInvert&&(a=-a),p.params.freeMode){var c=p.getWrapperTranslate()+a*p.params.mousewheelSensitivity,u=p.isBeginning,h=p.isEnd;if(c>=p.minTranslate()&&(c=p.minTranslate()),c<=p.maxTranslate()&&(c=p.maxTranslate()),p.setWrapperTransition(0),p.setWrapperTranslate(c),p.updateProgress(),p.updateActiveIndex(),(!u&&p.isBeginning||!h&&p.isEnd)&&p.updateClasses(),p.params.freeModeSticky?(clearTimeout(p.mousewheel.timeout),p.mousewheel.timeout=setTimeout(function(){p.slideReset()},300)):p.params.lazyLoading&&p.lazy&&p.lazy.load(),p.emit("onScroll",p,t),p.params.autoplay&&p.params.autoplayDisableOnInteraction&&p.stopAutoplay(),0===c||c===p.maxTranslate())return}else{if(60<(new window.Date).getTime()-p.mousewheel.lastScrollTime)if(a<0)if(p.isEnd&&!p.params.loop||p.animating){if(p.params.mousewheelReleaseOnEdges)return!0}else p.slideNext(),p.emit("onScroll",p,t);else if(p.isBeginning&&!p.params.loop||p.animating){if(p.params.mousewheelReleaseOnEdges)return!0}else p.slidePrev(),p.emit("onScroll",p,t);p.mousewheel.lastScrollTime=(new window.Date).getTime()}return t.preventDefault?t.preventDefault():t.returnValue=!1,!1}}function B(t,i){var n,o,r;t=e(t);var a=p.rtl?-1:1;n=t.attr("data-swiper-parallax")||"0",o=t.attr("data-swiper-parallax-x"),r=t.attr("data-swiper-parallax-y"),o||r?(o=o||"0",r=r||"0"):p.isHorizontal()?(o=n,r="0"):(r=n,o="0"),o=0<=o.indexOf("%")?parseInt(o,10)*i*a+"%":o*i*a+"px",r=0<=r.indexOf("%")?parseInt(r,10)*i+"%":r*i+"px",t.transform("translate3d("+o+", "+r+",0px)")}function z(t){return 0!==t.indexOf("on")&&(t=t[0]!==t[0].toUpperCase()?"on"+t[0].toUpperCase()+t.substring(1):"on"+t),t}};d.prototype={isSafari:(h=window.navigator.userAgent.toLowerCase(),0<=h.indexOf("safari")&&h.indexOf("chrome")<0&&h.indexOf("android")<0),isUiWebView:/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(window.navigator.userAgent),isArray:function(t){return"[object Array]"===Object.prototype.toString.apply(t)},browser:{ie:window.navigator.pointerEnabled||window.navigator.msPointerEnabled,ieTouch:window.navigator.msPointerEnabled&&1<window.navigator.msMaxTouchPoints||window.navigator.pointerEnabled&&1<window.navigator.maxTouchPoints,lteIE9:(u=document.createElement("div"),u.innerHTML="\x3c!--[if lte IE 9]><i></i><![endif]--\x3e",1===u.getElementsByTagName("i").length)},device:(n=window.navigator.userAgent,o=n.match(/(Android);?[\s\/]+([\d.]+)?/),r=n.match(/(iPad).*OS\s([\d_]+)/),s=n.match(/(iPod)(.*OS\s([\d_]+))?/),l=!r&&n.match(/(iPhone\sOS|iOS)\s([\d_]+)/),{ios:r||l||s,android:o}),support:{touch:window.Modernizr&&!0===Modernizr.touch||!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch),transforms3d:window.Modernizr&&!0===Modernizr.csstransforms3d||(i=document.createElement("div").style,"webkitPerspective"in i||"MozPerspective"in i||"OPerspective"in i||"MsPerspective"in i||"perspective"in i),flexbox:function(){for(var t=document.createElement("div").style,e="alignItems webkitAlignItems webkitBoxAlign msFlexAlign mozBoxAlign webkitFlexDirection msFlexDirection mozBoxDirection mozBoxOrient webkitBoxDirection webkitBoxOrient".split(" "),i=0;i<e.length;i++)if(e[i]in t)return!0}(),observer:"MutationObserver"in window||"WebkitMutationObserver"in window,passiveListener:function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveListener",null,e)}catch(t){}return t}(),gestures:"ongesturestart"in window},plugins:{}};for(var p,f,m,g=(f=function(t,e){var i=[],n=0;if(t&&!e&&t instanceof p)return t;if(t)if("string"==typeof t){var o,r,a=t.trim();if(0<=a.indexOf("<")&&0<=a.indexOf(">")){var s="div";for(0===a.indexOf("<li")&&(s="ul"),0===a.indexOf("<tr")&&(s="tbody"),0!==a.indexOf("<td")&&0!==a.indexOf("<th")||(s="tr"),0===a.indexOf("<tbody")&&(s="table"),0===a.indexOf("<option")&&(s="select"),(r=document.createElement(s)).innerHTML=t,n=0;n<r.childNodes.length;n++)i.push(r.childNodes[n])}else for(o=e||"#"!==t[0]||t.match(/[ .<>:~]/)?(e||document).querySelectorAll(t):[document.getElementById(t.split("#")[1])],n=0;n<o.length;n++)o[n]&&i.push(o[n])}else if(t.nodeType||t===window||t===document)i.push(t);else if(0<t.length&&t[0].nodeType)for(n=0;n<t.length;n++)i.push(t[n]);return new p(i)},(p=function(t){var e=0;for(e=0;e<t.length;e++)this[e]=t[e];return this.length=t.length,this}).prototype={addClass:function(t){if(void 0===t)return this;for(var e=t.split(" "),i=0;i<e.length;i++)for(var n=0;n<this.length;n++)this[n].classList.add(e[i]);return this},removeClass:function(t){for(var e=t.split(" "),i=0;i<e.length;i++)for(var n=0;n<this.length;n++)this[n].classList.remove(e[i]);return this},hasClass:function(t){return!!this[0]&&this[0].classList.contains(t)},toggleClass:function(t){for(var e=t.split(" "),i=0;i<e.length;i++)for(var n=0;n<this.length;n++)this[n].classList.toggle(e[i]);return this},attr:function(t,e){if(1===arguments.length&&"string"==typeof t)return this[0]?this[0].getAttribute(t):void 0;for(var i=0;i<this.length;i++)if(2===arguments.length)this[i].setAttribute(t,e);else for(var n in t)this[i][n]=t[n],this[i].setAttribute(n,t[n]);return this},removeAttr:function(t){for(var e=0;e<this.length;e++)this[e].removeAttribute(t);return this},data:function(t,e){if(void 0!==e){for(var i=0;i<this.length;i++){var n=this[i];n.dom7ElementDataStorage||(n.dom7ElementDataStorage={}),n.dom7ElementDataStorage[t]=e}return this}if(this[0])return this[0].getAttribute("data-"+t)||(this[0].dom7ElementDataStorage&&t in this[0].dom7ElementDataStorage?this[0].dom7ElementDataStorage[t]:void 0)},transform:function(t){for(var e=0;e<this.length;e++){var i=this[e].style;i.webkitTransform=i.MsTransform=i.msTransform=i.MozTransform=i.OTransform=i.transform=t}return this},transition:function(t){"string"!=typeof t&&(t+="ms");for(var e=0;e<this.length;e++){var i=this[e].style;i.webkitTransitionDuration=i.MsTransitionDuration=i.msTransitionDuration=i.MozTransitionDuration=i.OTransitionDuration=i.transitionDuration=t}return this},on:function(t,e,i,n){function o(t){var n=t.target;if(f(n).is(e))i.call(n,t);else for(var o=f(n).parents(),r=0;r<o.length;r++)f(o[r]).is(e)&&i.call(o[r],t)}var r,a,s=t.split(" ");for(r=0;r<this.length;r++)if("function"==typeof e||!1===e)for("function"==typeof e&&(i=e,n=arguments[2]||!1),a=0;a<s.length;a++)this[r].addEventListener(s[a],i,n);else for(a=0;a<s.length;a++)this[r].dom7LiveListeners||(this[r].dom7LiveListeners=[]),this[r].dom7LiveListeners.push({listener:i,liveListener:o}),this[r].addEventListener(s[a],o,n);return this},off:function(t,e,i,n){for(var o=t.split(" "),r=0;r<o.length;r++)for(var a=0;a<this.length;a++)if("function"==typeof e||!1===e)"function"==typeof e&&(i=e,n=arguments[2]||!1),this[a].removeEventListener(o[r],i,n);else if(this[a].dom7LiveListeners)for(var s=0;s<this[a].dom7LiveListeners.length;s++)this[a].dom7LiveListeners[s].listener===i&&this[a].removeEventListener(o[r],this[a].dom7LiveListeners[s].liveListener,n);return this},once:function(t,e,i,n){var o=this;"function"==typeof e&&(e=!1,i=arguments[1],n=arguments[2]),o.on(t,e,function r(a){i(a),o.off(t,e,r,n)},n)},trigger:function(t,e){for(var i=0;i<this.length;i++){var n;try{n=new window.CustomEvent(t,{detail:e,bubbles:!0,cancelable:!0})}catch(i){(n=document.createEvent("Event")).initEvent(t,!0,!0),n.detail=e}this[i].dispatchEvent(n)}return this},transitionEnd:function(t){var e,i=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"],n=this;function o(r){if(r.target===this)for(t.call(this,r),e=0;e<i.length;e++)n.off(i[e],o)}if(t)for(e=0;e<i.length;e++)n.on(i[e],o);return this},width:function(){return this[0]===window?window.innerWidth:0<this.length?parseFloat(this.css("width")):null},outerWidth:function(t){return 0<this.length?t?this[0].offsetWidth+parseFloat(this.css("margin-right"))+parseFloat(this.css("margin-left")):this[0].offsetWidth:null},height:function(){return this[0]===window?window.innerHeight:0<this.length?parseFloat(this.css("height")):null},outerHeight:function(t){return 0<this.length?t?this[0].offsetHeight+parseFloat(this.css("margin-top"))+parseFloat(this.css("margin-bottom")):this[0].offsetHeight:null},offset:function(){if(0<this.length){var t=this[0],e=t.getBoundingClientRect(),i=document.body,n=t.clientTop||i.clientTop||0,o=t.clientLeft||i.clientLeft||0,r=window.pageYOffset||t.scrollTop,a=window.pageXOffset||t.scrollLeft;return{top:e.top+r-n,left:e.left+a-o}}return null},css:function(t,e){var i;if(1===arguments.length){if("string"!=typeof t){for(i=0;i<this.length;i++)for(var n in t)this[i].style[n]=t[n];return this}if(this[0])return window.getComputedStyle(this[0],null).getPropertyValue(t)}if(2!==arguments.length||"string"!=typeof t)return this;for(i=0;i<this.length;i++)this[i].style[t]=e;return this},each:function(t){for(var e=0;e<this.length;e++)t.call(this[e],e,this[e]);return this},html:function(t){if(void 0===t)return this[0]?this[0].innerHTML:void 0;for(var e=0;e<this.length;e++)this[e].innerHTML=t;return this},text:function(t){if(void 0===t)return this[0]?this[0].textContent.trim():null;for(var e=0;e<this.length;e++)this[e].textContent=t;return this},is:function(t){if(!this[0])return!1;var e,i;if("string"==typeof t){var n=this[0];if(n===document)return t===document;if(n===window)return t===window;if(n.matches)return n.matches(t);if(n.webkitMatchesSelector)return n.webkitMatchesSelector(t);if(n.mozMatchesSelector)return n.mozMatchesSelector(t);if(n.msMatchesSelector)return n.msMatchesSelector(t);for(e=f(t),i=0;i<e.length;i++)if(e[i]===this[0])return!0;return!1}if(t===document)return this[0]===document;if(t===window)return this[0]===window;if(t.nodeType||t instanceof p){for(e=t.nodeType?[t]:t,i=0;i<e.length;i++)if(e[i]===this[0])return!0;return!1}return!1},index:function(){if(this[0]){for(var t=this[0],e=0;null!==(t=t.previousSibling);)1===t.nodeType&&e++;return e}},eq:function(t){if(void 0===t)return this;var e,i=this.length;return new p(i-1<t?[]:t<0?(e=i+t)<0?[]:[this[e]]:[this[t]])},append:function(t){var e,i;for(e=0;e<this.length;e++)if("string"==typeof t){var n=document.createElement("div");for(n.innerHTML=t;n.firstChild;)this[e].appendChild(n.firstChild)}else if(t instanceof p)for(i=0;i<t.length;i++)this[e].appendChild(t[i]);else this[e].appendChild(t);return this},prepend:function(t){var e,i;for(e=0;e<this.length;e++)if("string"==typeof t){var n=document.createElement("div");for(n.innerHTML=t,i=n.childNodes.length-1;0<=i;i--)this[e].insertBefore(n.childNodes[i],this[e].childNodes[0])}else if(t instanceof p)for(i=0;i<t.length;i++)this[e].insertBefore(t[i],this[e].childNodes[0]);else this[e].insertBefore(t,this[e].childNodes[0]);return this},insertBefore:function(t){for(var e=f(t),i=0;i<this.length;i++)if(1===e.length)e[0].parentNode.insertBefore(this[i],e[0]);else if(1<e.length)for(var n=0;n<e.length;n++)e[n].parentNode.insertBefore(this[i].cloneNode(!0),e[n])},insertAfter:function(t){for(var e=f(t),i=0;i<this.length;i++)if(1===e.length)e[0].parentNode.insertBefore(this[i],e[0].nextSibling);else if(1<e.length)for(var n=0;n<e.length;n++)e[n].parentNode.insertBefore(this[i].cloneNode(!0),e[n].nextSibling)},next:function(t){return 0<this.length?t?this[0].nextElementSibling&&f(this[0].nextElementSibling).is(t)?new p([this[0].nextElementSibling]):new p([]):this[0].nextElementSibling?new p([this[0].nextElementSibling]):new p([]):new p([])},nextAll:function(t){var e=[],i=this[0];if(!i)return new p([]);for(;i.nextElementSibling;){var n=i.nextElementSibling;t?f(n).is(t)&&e.push(n):e.push(n),i=n}return new p(e)},prev:function(t){return 0<this.length?t?this[0].previousElementSibling&&f(this[0].previousElementSibling).is(t)?new p([this[0].previousElementSibling]):new p([]):this[0].previousElementSibling?new p([this[0].previousElementSibling]):new p([]):new p([])},prevAll:function(t){var e=[],i=this[0];if(!i)return new p([]);for(;i.previousElementSibling;){var n=i.previousElementSibling;t?f(n).is(t)&&e.push(n):e.push(n),i=n}return new p(e)},parent:function(t){for(var e=[],i=0;i<this.length;i++)t?f(this[i].parentNode).is(t)&&e.push(this[i].parentNode):e.push(this[i].parentNode);return f(f.unique(e))},parents:function(t){for(var e=[],i=0;i<this.length;i++)for(var n=this[i].parentNode;n;)t?f(n).is(t)&&e.push(n):e.push(n),n=n.parentNode;return f(f.unique(e))},find:function(t){for(var e=[],i=0;i<this.length;i++)for(var n=this[i].querySelectorAll(t),o=0;o<n.length;o++)e.push(n[o]);return new p(e)},children:function(t){for(var e=[],i=0;i<this.length;i++)for(var n=this[i].childNodes,o=0;o<n.length;o++)t?1===n[o].nodeType&&f(n[o]).is(t)&&e.push(n[o]):1===n[o].nodeType&&e.push(n[o]);return new p(f.unique(e))},remove:function(){for(var t=0;t<this.length;t++)this[t].parentNode&&this[t].parentNode.removeChild(this[t]);return this},add:function(){var t,e;for(t=0;t<arguments.length;t++){var i=f(arguments[t]);for(e=0;e<i.length;e++)this[this.length]=i[e],this.length++}return this}},f.fn=p.prototype,f.unique=function(t){for(var e=[],i=0;i<t.length;i++)-1===e.indexOf(t[i])&&e.push(t[i]);return e},f),v=["jQuery","Zepto","Dom7"],y=0;y<v.length;y++)window[v[y]]&&b(window[v[y]]);function b(t){t.fn.swiper=function(e){var i;return t(this).each(function(){var t=new d(this,e);i||(i=t)}),i}}(m=void 0===g?window.Dom7||window.Zepto||c:g)&&("transitionEnd"in m.fn||(m.fn.transitionEnd=function(t){var e,i=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"],n=this;function o(r){if(r.target===this)for(t.call(this,r),e=0;e<i.length;e++)n.off(i[e],o)}if(t)for(e=0;e<i.length;e++)n.on(i[e],o);return this}),"transform"in m.fn||(m.fn.transform=function(t){for(var e=0;e<this.length;e++){var i=this[e].style;i.webkitTransform=i.MsTransform=i.msTransform=i.MozTransform=i.OTransform=i.transform=t}return this}),"transition"in m.fn||(m.fn.transition=function(t){"string"!=typeof t&&(t+="ms");for(var e=0;e<this.length;e++){var i=this[e].style;i.webkitTransitionDuration=i.MsTransitionDuration=i.msTransitionDuration=i.MozTransitionDuration=i.OTransitionDuration=i.transitionDuration=t}return this}),"outerWidth"in m.fn||(m.fn.outerWidth=function(t){return 0<this.length?t?this[0].offsetWidth+parseFloat(this.css("margin-right"))+parseFloat(this.css("margin-left")):this[0].offsetWidth:null})),t.exports=d}).call(h,"/js/util/Swiper.js")}),1),nn=2,on=3,rn=ot.EventEmitter,an=new S("/js/mattertag/Mattertag.js"),sn="closed",ln="opening",cn="open",un="closing",hn="active";function dn(t,e,i,n,o){this.tilesHorizontal=e,this.tilesVertical=i,this.numberOfTiles=n,t.wrapS=t.wrapT=v.RepeatWrapping,t.repeat.set(1/this.tilesHorizontal,1/this.tilesVertical),this.tileDisplayDuration=o,this.currentLoopTime=this.currentTile=this.currentDisplayTime=0,this.inStop=!1,this.totalcount=0,this.update=function(e){for(this.inStop?(this.totalcount++,800<this.totalcount&&(this.totalcount=0,this.inStop=!1)):this.currentDisplayTime+=e;this.currentDisplayTime>this.tileDisplayDuration;)this.currentDisplayTime-=this.tileDisplayDuration,this.currentTile++,t.offset.x=this.currentTile%this.tilesHorizontal/this.tilesHorizontal,t.offset.y=Math.floor(this.currentTile/this.tilesHorizontal)/this.tilesVertical}}function pn(t,e,i){var n=i.version||"0";if("0"!==n&&an.info("nesttags version: "+n),this.data=i,this.model=t,this.player=G.player,this.locationId=i.locationid,this.i=e,this.tagid=i.tagid,this.enabled=z.mattertags.enabled&&i.enable,this.label=i.details.title?i.details.title:"",this.subtype=i.details.subtype,this.tagInfoUrl=i.details.url,this.audioenable=i.details.audioenable,i.details.templatetype===gi.Audio&&(this.audioenable=!0),this.audiourl=i.details.audiourl||i.details.url,this.videourl=i.details.videourl,this.tagPicUrl=i.details.tagpicurl,this.tagPicType=i.details.tagpictype,this.parsedDescription=[],this.links=[],this.floor=null,this.floorIndex=i.flooridx||0,this.isBuilt=!1,this.des=this.data.details.description,G.player&&G.player.currentPano&&2===G.player.currentPano.alignmentType?this.rt360=!0:this.rt360=!1,i.details.templatetype===gi.ImageText&&i.details.audioenable&&i.details.audiourl&&(i.details.templatetype=gi.ImageTextAudio),i.details.templatetype===gi.TextOnly&&i.details.audioenable&&i.details.audiourl&&(i.details.templatetype=gi.TextAudio),i.actiontype==gi.ClassifyType.Building?(this.type=gi.BuildingType,this.mediatype=Ii):(this.type=i.details.templatetype,i.details.templatetype===gi.BuildingType||i.details.templatetype===gi.TextOnly||i.details.templatetype===gi.ImageText||i.details.templatetype===gi.OtherModel?this.mediatype=Ii:i.details.templatetype===gi.Audio||i.details.templatetype===gi.TextAudio||i.details.templatetype===gi.ImageTextAudio?this.mediatype=Pi:i.details.templatetype===gi.Video?this.mediatype=Ci:i.details.templatetype===gi.IFrame?this.mediatype=Ai:this.mediatype=Ii),i.details.audioenable&&i.details.audiourl&&(i.details.templatetype=gi.TextAudio),this.imgaudioControl={loop:""},this.picDescription=null,this.audioControl={loop:""},this.audioPauseTime=0,this.highlightStatus=!1,this.mode=A.PANORAMA,i.preferred_camera&&i.preferred_camera.mode&&(this.mode=i.preferred_camera.mode),this.obj3d=this.disc=this.billboard=null,this.geometry={},this.geometry.disc=new v.PlaneBufferGeometry(1,1),this.geometry.discGif=new v.PlaneBufferGeometry(2,2),this.geometry.discBuilding=new v.PlaneBufferGeometry(2,2),this.geometry.discTo360Tag=new v.PlaneBufferGeometry(1,1),this.geometry.discFrom360Tag=new v.PlaneBufferGeometry(1,.6),this.geometry.discOtherModel=new v.PlaneBufferGeometry(2,2),this.geometry.discOtherModelText=new v.PlaneBufferGeometry(2,2),this.geometry.cutout=new v.SphereBufferGeometry(.5,16,8),this.type===gi.BuildingType&&this.label){var r=G.settings.locations.points;if(r&&r.forEach(function(t,e){if(i.locationid===t.locationid)return i.base.y=t.viewpoint.z,!1}),6<this.label.length){var a=.22*this.label.length+.3;this.geometry.discBuilding=new v.PlaneBufferGeometry(a,.5)}else a=.35*this.label.length+.3,this.geometry.discBuilding=new v.PlaneBufferGeometry(a,.5)}if(this.type===gi.Audio){this.materialsAudio={};var s=X.splitUrl("https://template2.3dnest.cn/common/img/audioon_128x128.png"),l=X.splitUrl("https://template2.3dnest.cn/common/img/audiooff_128x128.png");if(this.tagPicType!=en&&this.tagPicType!=on||null==this.tagPicUrl||""==this.tagPicUrl||(s=this.tagPicUrl,l=this.tagPicUrl.replace(".png","_hover.png")),this.tagPicType===nn)this.materialsAudio.free=this.buildDiscMaterial(this.getText(this.tagPicUrl,1)),this.materialsAudio.hover=this.buildDiscMaterial(this.getText(this.tagPicUrl,1));else if(this.tagPicType===on){var c=this.getTexture(s);this.materialsAudio.free=this.buildDiscMaterial(c),this.materialsAudio.hover=this.buildDiscMaterial(c),this.clock=new v.Clock,this.gifObject=new dn(c,1,25,25,30)}else this.materialsAudio.free=this.buildDiscMaterial(this.getTexture(s)),this.materialsAudio.hover=this.buildDiscMaterial(this.getTexture(l));this.materialsAudio.disable=this.materialsAudio.free.clone(),this.materialsAudio.disable.opacity=z.mattertags.disc.disabledOpacity,this.materialsAudio.cutout=new v.MeshBasicMaterial({transparent:!0,opacity:1,colorWrite:!1}),this.materialsAudio.pole=new v.LineBasicMaterial({linewidth:z.mattertags.pole.width,color:z.mattertags.pole.color,opacity:z.mattertags.startup.hideUntilStart?0:z.mattertags.pole.opacity,transparent:!0,alphaTest:z.mattertags.pole.opacity*z.mattertags.visibility.alphaTestLevel}),this.materialsAudio={free:this.materialsAudio.free.clone(),hover:this.materialsAudio.hover.clone(),disable:this.materialsAudio.disable.clone(),pole:this.materialsAudio.pole.clone(),cutout:this.materialsAudio.cutout.clone()},this.audioControl.loop=i.details.loop,this.tagInfoUrl=i.details.url,this.materials=this.materialsAudio}else this.type===gi.OtherModel||this.type===gi.TagTo360||this.type===gi.Tag360T1||this.type===gi.TextOnly?(this.materialsOtherModel={},s=X.splitUrl("https://template2.3dnest.cn/common/img/goto_256x256.png"),l=X.splitUrl("https://template2.3dnest.cn/common/img/goto_256x256.png"),this.tagPicType!==en&&this.tagPicType!==on||null===this.tagPicUrl||""===this.tagPicUrl||(s=l=this.tagPicUrl),this.type===gi.Title?(this.geometry.disc=new v.PlaneBufferGeometry(12,3),this.materialsOtherModel.free=this.materialsOtherModel.hover=this.buildDiscMaterial()):this.tagPicType===nn?(this.materialsOtherModel.free=this.buildDiscMaterial(this.getText(this.tagPicUrl,1)),this.materialsOtherModel.hover=this.buildDiscMaterial(this.getText(this.tagPicUrl,1))):this.tagPicType===on?(c=this.getTexture(s),this.materialsOtherModel.free=this.buildDiscMaterial(c),this.materialsOtherModel.hover=this.buildDiscMaterial(c),this.clock=new v.Clock,this.gifObject=new dn(c,1,25,25,30)):(this.materialsOtherModel.free=this.buildDiscMaterial(this.getTexture(s)),this.materialsOtherModel.hover=this.buildDiscMaterial(this.getTexture(l))),this.materialsOtherModel.disable=this.materialsOtherModel.free.clone(),this.materialsOtherModel.disable.opacity=z.mattertags.disc.disabledOpacity,this.materialsOtherModel.cutout=new v.MeshBasicMaterial({transparent:!0,opacity:1,colorWrite:!1}),this.materialsOtherModel.pole=new v.LineBasicMaterial({linewidth:z.mattertags.pole.width,color:z.mattertags.pole.color,opacity:z.mattertags.startup.hideUntilStart?0:z.mattertags.pole.opacity,transparent:!0,alphaTest:z.mattertags.pole.opacity*z.mattertags.visibility.alphaTestLevel}),this.materialsOtherModel={free:this.materialsOtherModel.free.clone(),hover:this.materialsOtherModel.hover.clone(),disable:this.materialsOtherModel.disable.clone(),pole:this.materialsOtherModel.pole.clone(),cutout:this.materialsOtherModel.cutout.clone()},this.tagInfoUrl=i.details.url,this.materials=this.materialsOtherModel,this.materials.free.map.needsUpdate=!0):this.type===gi.Title?o("#viewport-tags").append('<a id="titletag'+this.i+'" href="javascript:;" class="viewport-tag js-tag visible" style="z-index:20;"><div class="viewport-tag-point"></div><div class="viewport-tag-label"><span class="viewport-tag-label-name">'+i.details.title+"</span></div></a>"):this.type===gi.ImageText||this.type===gi.ImageTextAudio||this.type===gi.IKEA||this.type===gi.Video?(this.materialsNotAudio={},s=X.splitUrl("https://template2.3dnest.cn/common/img/tagnormal_128x128.png"),l=X.splitUrl("https://template2.3dnest.cn/common/img/taghover_128x128.png"),this.tagPicType!==en&&this.tagPicType!==on||null===this.tagPicUrl||""===this.tagPicUrl||(s=l=this.tagPicUrl),this.tagPicType===nn?(this.materialsNotAudio.free=this.buildDiscMaterial(this.getText(this.tagPicUrl,1)),this.materialsNotAudio.hover=this.buildDiscMaterial(this.getText(this.tagPicUrl,1))):this.tagPicType===on?(c=this.getTexture(s),this.materialsNotAudio.free=this.buildDiscMaterial(c),this.materialsNotAudio.hover=this.buildDiscMaterial(c),this.clock=new v.Clock,this.gifObject=new dn(c,1,25,25,30)):(this.materialsNotAudio.free=this.buildDiscMaterial(this.getTexture(s)),this.materialsNotAudio.hover=this.buildDiscMaterial(this.getTexture(l))),this.materialsNotAudio.disable=this.materialsNotAudio.free.clone(),this.materialsNotAudio.disable.opacity=z.mattertags.disc.disabledOpacity,this.materialsNotAudio.cutout=new v.MeshBasicMaterial({transparent:!0,opacity:1,colorWrite:!1}),this.materialsNotAudio.pole=new v.LineBasicMaterial({linewidth:z.mattertags.pole.width,color:z.mattertags.pole.color,opacity:z.mattertags.startup.hideUntilStart?0:z.mattertags.pole.opacity,transparent:!0,alphaTest:z.mattertags.pole.opacity*z.mattertags.visibility.alphaTestLevel}),this.materialsNotAudio={free:this.materialsNotAudio.free.clone(),hover:this.materialsNotAudio.hover.clone(),disable:this.materialsNotAudio.disable.clone(),pole:this.materialsNotAudio.pole.clone(),cutout:this.materialsNotAudio.cutout.clone()},this.imgaudioControl=i.details.audioloop?i.details.audioloop:{loop:""},this.materials=this.materialsNotAudio):this.type===gi.Tag360T1?(H.loadCanvas(this.label),H.loadCanvas(this.label),this.materials360Type={},2===this.subtype?(this.tagPicType=3,s=X.splitUrl("https://template2.3dnest.cn/common/img/gif8_128x3200.png"),c=this.getTexture(s),this.materials360Type.free=this.buildDiscMaterial(c),this.materials360Type.hover=this.buildDiscMaterial(c),this.clock=new v.Clock,this.gifObject=new dn(c,1,25,25,30)):(this.materials360Type.free=this.buildDiscMaterial(this.getText(this.label,1)),this.materials360Type.hover=this.buildDiscMaterial(this.getText(this.label,1))),this.materials360Type.disable=this.materials360Type.free.clone(),this.materials360Type.disable.opacity=z.mattertags.disc.disabledOpacity,this.materials360Type.cutout=new v.MeshBasicMaterial({transparent:!0,opacity:1,colorWrite:!1}),this.materials360Type.pole=new v.LineBasicMaterial({linewidth:z.mattertags.pole.width,color:z.mattertags.pole.color,opacity:z.mattertags.startup.hideUntilStart?0:z.mattertags.pole.opacity,transparent:!0,alphaTest:z.mattertags.pole.opacity*z.mattertags.visibility.alphaTestLevel}),this.materials360Type={free:this.materials360Type.free.clone(),hover:this.materials360Type.hover.clone(),disable:this.materials360Type.disable.clone(),pole:this.materials360Type.pole.clone(),cutout:this.materials360Type.cutout.clone()},this.materials=this.materials360Type):this.type===gi.BuildingType?(H.loadCanvas(this.label),H.loadCanvas(this.label),this.materialsBuilding={},this.materialsBuilding.free=this.buildDiscMaterial(this.getText(this.label)),this.materialsBuilding.free.depthTest=!0,this.materialsBuilding.hover=this.buildDiscMaterial(this.getText(this.label)),this.materialsBuilding.hover.depthTest=!0,this.materialsBuilding.disable=this.materialsBuilding.free.clone(),this.materialsBuilding.disable.depthTest=!0,this.materialsBuilding.disable.opacity=z.mattertags.disc.disabledOpacity,this.materialsBuilding.cutout=new v.MeshBasicMaterial({transparent:!0,opacity:1,colorWrite:!1,depthTest:!0}),this.materialsBuilding.pole=new v.LineBasicMaterial({linewidth:z.mattertags.pole.width,color:z.mattertags.pole.color,opacity:z.mattertags.startup.hideUntilStart?0:z.mattertags.pole.opacity,transparent:!0,alphaTest:z.mattertags.pole.opacity*z.mattertags.visibility.alphaTestLevel,depthTest:!0}),this.materialsBuilding={free:this.materialsBuilding.free.clone(),hover:this.materialsBuilding.hover.clone(),disable:this.materialsBuilding.disable.clone(),pole:this.materialsBuilding.pole.clone(),cutout:this.materialsBuilding.cutout.clone()},this.materials=this.materialsBuilding):this.type===gi.RegionalJump?(this.materialsRegional={},this.materialsRegional.free=this.buildDiscMaterial(H.loadCanvasRe(this.label)),this.materialsRegional.free.depthTest=!0,this.materialsRegional.hover=this.buildDiscMaterial(H.loadCanvasRe(this.label)),this.materialsRegional.hover.depthTest=!0,this.materialsRegional.disable=this.materialsRegional.free.clone(),this.materialsRegional.disable.depthTest=!0,this.materialsRegional.disable.opacity=z.mattertags.disc.disabledOpacity,this.materialsRegional.cutout=new v.MeshBasicMaterial({transparent:!0,opacity:1,colorWrite:!1,depth:!0}),this.materialsRegional.pole=new v.LineBasicMaterial({linewidth:z.mattertags.pole.width,color:z.mattertags.pole.color,opacity:z.mattertags.startup.hideUntilStart?0:z.mattertags.pole.opacity,transparent:!0,alphaTest:z.mattertags.pole.opacity*z.mattertags.visibility.alphaTestLevel,depthTest:!0}),this.materialsRegional={free:this.materialsRegional.free.clone(),hover:this.materialsRegional.hover.clone(),disable:this.materialsRegional.disable.clone(),pole:this.materialsRegional.pole.clone(),cutout:this.materialsRegional.cutout.clone()},this.materials=this.materialsRegional):this.type===gi.TagTo360?(H.loadCanvas(this.label),H.loadCanvas(this.label),this.materialsTo360={},2===this.subtype?(this.tagPicType=3,s=X.splitUrl("https://template2.3dnest.cn/common/img/gif8_128x3200.png"),c=this.getTexture(s),this.materialsTo360.free=this.buildDiscMaterial(c),this.materialsTo360.hover=this.buildDiscMaterial(c),this.clock=new v.Clock,this.gifObject=new dn(c,1,25,25,30)):(this.materialsTo360.free=this.buildDiscMaterial(this.getText(this.label,1)),this.materialsTo360.hover=this.buildDiscMaterial(this.getText(this.label,1))),this.materialsTo360.disable=this.materialsTo360.free.clone(),this.materialsTo360.disable.opacity=z.mattertags.disc.disabledOpacity,this.materialsTo360.cutout=new v.MeshBasicMaterial({transparent:!0,opacity:1,colorWrite:!1}),this.materialsTo360.pole=new v.LineBasicMaterial({linewidth:z.mattertags.pole.width,color:z.mattertags.pole.color,opacity:z.mattertags.startup.hideUntilStart?0:z.mattertags.pole.opacity,transparent:!0,alphaTest:z.mattertags.pole.opacity*z.mattertags.visibility.alphaTestLevel}),this.materialsTo360={free:this.materialsTo360.free.clone(),hover:this.materialsTo360.hover.clone(),disable:this.materialsTo360.disable.clone(),pole:this.materialsTo360.pole.clone(),cutout:this.materialsTo360.cutout.clone()},this.tagInfoUrl=i.details.url,this.materials=this.materialsTo360):this.type===gi.Pano?(this.materialsNotAudio={},l=t.panos.index[this.locationId].enable?(s=X.splitUrl("https://template2.3dnest.cn/common/img/disable_on_256x256.png"),X.splitUrl("https://template2.3dnest.cn/common/img/disable_on_256x256.png")):(s=X.splitUrl("https://template2.3dnest.cn/common/img/disable_off_256x256.png"),X.splitUrl("https://template2.3dnest.cn/common/img/disable_off_256x256.png")),this.tagPicType!==en&&this.tagPicType!==on||null===this.tagPicUrl||""===this.tagPicUrl||void 0===this.tagPicUrl||(s=l=this.tagPicUrl),this.tagPicType===nn?(this.materialsNotAudio.free=this.buildDiscMaterial(this.getText(this.tagPicUrl,1)),this.materialsNotAudio.hover=this.buildDiscMaterial(this.getText(this.tagPicUrl,1))):this.tagPicType===on?(c=this.getTexture(s),this.materialsNotAudio.free=this.buildDiscMaterial(c),this.materialsNotAudio.hover=this.buildDiscMaterial(c),this.clock=new v.Clock,this.gifObject=new dn(c,1,25,25,30)):(this.materialsNotAudio.free=this.buildDiscMaterial(this.getTexture(s)),this.materialsNotAudio.hover=this.buildDiscMaterial(this.getTexture(l))),this.materialsNotAudio.disable=this.materialsNotAudio.free.clone(),this.materialsNotAudio.disable.opacity=z.mattertags.disc.disabledOpacity,this.materialsNotAudio.cutout=new v.MeshBasicMaterial({transparent:!0,opacity:1,colorWrite:!1}),this.materialsNotAudio.pole=new v.LineBasicMaterial({linewidth:z.mattertags.pole.width,color:z.mattertags.pole.color,opacity:z.mattertags.startup.hideUntilStart?0:z.mattertags.pole.opacity,transparent:!0,alphaTest:z.mattertags.pole.opacity*z.mattertags.visibility.alphaTestLevel}),this.materialsNotAudio={free:this.materialsNotAudio.free.clone(),hover:this.materialsNotAudio.hover.clone(),disable:this.materialsNotAudio.disable.clone(),pole:this.materialsNotAudio.pole.clone(),cutout:this.materialsNotAudio.cutout.clone()},this.materials=this.materialsNotAudio):this.type===gi.RedStart?(this.materialsRedStart={},t.panos.index[this.locationId].enable&&(s=X.splitUrl("https://template2.3dnest.cn/common/img/goto_256x256.png"),l=X.splitUrl("https://template2.3dnest.cn/common/img/goto_256x256.png")),this.tagPicType===nn?(this.materialsRedStart.free=this.buildDiscMaterial(this.getText(this.tagPicUrl,1)),this.materialsRedStart.hover=this.buildDiscMaterial(this.getText(this.tagPicUrl,1))):this.tagPicType===on?(c=this.getTexture(s),this.materialsRedStart.free=this.buildDiscMaterial(c),this.materialsRedStart.hover=this.buildDiscMaterial(c),this.clock=new v.Clock,this.gifObject=new dn(c,1,25,25,60)):(this.materialsRedStart.free=this.buildDiscMaterial(this.getTexture(s)),this.materialsRedStart.hover=this.buildDiscMaterial(this.getTexture(l))),this.materialsRedStart.disable=this.materialsRedStart.free.clone(),this.materialsRedStart.disable.opacity=z.mattertags.disc.disabledOpacity,this.materialsRedStart.cutout=new v.MeshBasicMaterial({transparent:!0,opacity:1,colorWrite:!1}),this.materialsRedStart.pole=new v.LineBasicMaterial({linewidth:z.mattertags.pole.width,color:z.mattertags.pole.color,opacity:z.mattertags.startup.hideUntilStart?0:z.mattertags.pole.opacity,transparent:!0,alphaTest:z.mattertags.pole.opacity*z.mattertags.visibility.alphaTestLevel}),this.materialsRedStart={free:this.materialsRedStart.free.clone(),hover:this.materialsRedStart.hover.clone(),disable:this.materialsRedStart.disable.clone(),pole:this.materialsRedStart.pole.clone(),cutout:this.materialsRedStart.cutout.clone()},this.materials=this.materialsRedStart):(this.materialsNotAudio={},s=X.splitUrl("https://template2.3dnest.cn/common/img/tagnormal_128x128.png"),l=X.splitUrl("https://template2.3dnest.cn/common/img/taghover_128x128.png"),this.tagPicType!==en&&this.tagPicType!==on||null===this.tagPicUrl||""===this.tagPicUrl||(s=l=this.tagPicUrl),this.tagPicType===nn?(this.materialsNotAudio.free=this.buildDiscMaterial(this.getText(this.tagPicUrl,1)),this.materialsNotAudio.hover=this.buildDiscMaterial(this.getText(this.tagPicUrl,1))):this.tagPicType===on?(c=this.getTexture(s),this.materialsNotAudio.free=this.buildDiscMaterial(c),this.materialsNotAudio.hover=this.buildDiscMaterial(c),this.clock=new v.Clock,this.gifObject=new dn(c,1,25,25,30)):(this.materialsNotAudio.free=this.buildDiscMaterial(this.getTexture(s)),this.materialsNotAudio.hover=this.buildDiscMaterial(this.getTexture(l))),this.materialsNotAudio.disable=this.materialsNotAudio.free.clone(),this.materialsNotAudio.disable.opacity=z.mattertags.disc.disabledOpacity,this.materialsNotAudio.cutout=new v.MeshBasicMaterial({transparent:!0,opacity:1,colorWrite:!1}),this.materialsNotAudio.pole=new v.LineBasicMaterial({linewidth:z.mattertags.pole.width,color:z.mattertags.pole.color,opacity:z.mattertags.startup.hideUntilStart?0:z.mattertags.pole.opacity,transparent:!0,alphaTest:z.mattertags.pole.opacity*z.mattertags.visibility.alphaTestLevel}),this.materialsNotAudio={free:this.materialsNotAudio.free.clone(),hover:this.materialsNotAudio.hover.clone(),disable:this.materialsNotAudio.disable.clone(),pole:this.materialsNotAudio.pole.clone(),cutout:this.materialsNotAudio.cutout.clone()},this.materials=this.materialsNotAudio);this.position=(new v.Vector3).copy(i.base);var u=(new v.Vector3).copy(i.stem.direction);if(this.type,this.discPosition=u,this.basepos=this.position.clone(),this.discpos2=this.discPosition.clone(),this.discPosition.y+=.03,this.discScale=.05,this.poleEnabled=i.stem.enabled,this.boardOrientation="",this.boardState=sn,this.hoveringBillboard=!1,this.animationScale=0,this.visibleTransition=null,this.boardTransition=null,this.fadeInTimer=void 0,this.fadeOutTimer=void 0,z.mattertags.enableLinking&&(this.type===gi.TextOnly||this.type===gi.TextAudio)){var h=this.parseLinks(i.details.description,t.modelid);this.links=h.links,this.parsedDescription=h.description}}var fn=document.getElementById("tag-billboards"),mn=(document.getElementById("audio-tag"),document.getElementById("audio-tag"));document.getElementById("video-tag"),pn.prototype=Object.create(rn.prototype),pn.raycaster=new v.Raycaster,pn.prototype.build=function(){return this.enabled&&!this.isBuilt&&z.mattertags.enablePanoSize?(this.floor=this.model.floors.get(this.floorIndex)||this.model.floors.first(),this.floor&&(this.obj3d=this.buildObject3D(),this.floor.add(this.obj3d)),this.isBuilt=!0,this):null},pn.prototype.buildObject3D=function(){var t=new v.Object3D;t.position.copy(this.position);var e=1;if(window.self===window.top&&g.isMobile()?3===window.devicePixelRatio?e=2:2===window.devicePixelRatio&&(e=1.5):e=1,t.scale.set(e,e,e),this.tagPicType===nn)if(this.tagPicUrl){var i=.35*this.tagPicUrl.length+.2;this.geometry.discOtherModelText=new v.PlaneBufferGeometry(i,.5),this.disc=new v.Mesh(this.geometry.discOtherModelText,this.materials.free)}else this.disc=new v.Mesh(this.geometry.discOtherModelText,this.materials.free);else this.type===gi.BuildingType?this.disc=new v.Mesh(this.geometry.discBuilding,this.materials.free):this.type===gi.OtherModel?this.disc=new v.Mesh(this.geometry.discOtherModel,this.materials.free):this.type===gi.Tag360T1?this.disc=new v.Mesh(this.geometry.discFrom360Tag,this.materials.free):this.type===gi.TagTo360?this.disc=new v.Mesh(this.geometry.discTo360Tag,this.materials.free):this.tagPicType===nn?this.disc=new v.Mesh(this.geometry.discGif,this.materials.free):this.disc=new v.Mesh(this.geometry.disc,this.materials.free);2e4===this.i&&(this.geometry.disc=new v.PlaneBufferGeometry(1e-4,1e-4),this.disc=new v.Mesh(this.geometry.disc,this.materials.free)),this.type!=gi.Tag360T1&&this.disc.position.copy(this.discPosition),this.disc.renderOrder=Y.mattertagDisc,this.disc.tag=this;var n=new v.Mesh(this.geometry.cutout,this.materials.cutout);if(n.renderOrder=Y.mattertagCutout,this.disc.add(n),this.poleEnabled){var o=this.buildPole();o.renderOrder=Y.mattertagStem,t.add(o)}return t.add(this.disc)},pn.prototype.updateTagMaterial=function(t,e){this.getTexture(t,function(t){this.clock=null,this.gifObject=null;var i=t;this.materials.free=this.buildDiscMaterial(i),this.materials.hover=this.buildDiscMaterial(i),this.disc.material=this.materials.free,this.disc.material.needUpdate=!0,3===e&&(this.clock=new v.Clock,this.gifObject=new dn(i,1,25,25,30))}.bind(this))},pn.prototype.buildTextObject3D=function(t){var e=Object.create(t);e.type=-1;var i=new v.Object3D;e.position.y+=.05,i.position.copy(e.position),e.disc=new v.Mesh(e.geometry.discOtherModel,e.materials.free),e.discPosition.y+=.05,e.disc.position.copy(e.discPosition),e.disc.renderOrder=Y.mattertagDisc,e.disc.tag=this;var n=new v.Mesh(e.geometry.cutout,e.materials.cutout);if(n.renderOrder=Y.mattertagCutout,e.disc.add(n),e.poleEnabled){var o=e.buildPole();o.renderOrder=Y.mattertagStem,i.add(o)}return i.add(e.disc)},pn.prototype.buildDiscMaterial=function(t,e){if(this.type===gi.Title){var i=document.createElement("canvas");i.width=1024,i.height=256;var n=i.getContext("2d");return this.dc=i,this.ctx=n,new v.MeshBasicMaterial({map:new v.Texture(i),transparent:!0,opacity:1,alphaTest:z.mattertags.visibility.alphaTestLevel,depthTest:!1})}if(1!=e)return new v.MeshBasicMaterial({map:t,transparent:!0,opacity:z.mattertags.startup.hideUntilStart?0:z.mattertags.disc.opacity,alphaTest:z.mattertags.visibility.alphaTestLevel});var o=new v.SpriteMaterial({opacity:z.mattertags.startup.hideUntilStart?0:z.mattertags.disc.opacity,transparent:!0,map:t});return o.map.offset=new v.Vector2(0,0),o.map.repeat=new v.Vector2(1/17,1),o.depthTest=!1,o.blending=v.AdditiveBlending,o},pn.prototype.initAnimation=function(){var t=this.disc.material.map.offset;this.cursorAnimate=new TWEEN.Tween(t).to({x:1},1e3).onStart(function(){}).onStop(function(){t.x=0}).onUpdate(function(){}).onComplete(function(){t.x=0,setTimeout(function(){},1500)}),this.cursorAnimate.easing(function(t){return Math.floor(17*t)/17}),this.cursorAnimate.repeat(Number.POSITIVE_INFINITY),this.cursorAnimate.start()},pn.prototype.getTexture=function(t,e){return H.loadurl(t,e)},pn.prototype.getText=function(t,e){return e?H.loadCanvasIn(t):H.loadCanvas(t)},pn.prototype.buildPole=function(){return this.geom=new v.BufferGeometry,this.ar=new Float32Array(6),this.ar[0]=this.ar[1]=this.ar[2]=0,this.ar[3]=this.discPosition.x,this.ar[4]=this.discPosition.y,this.ar[5]=this.discPosition.z,this.geom.addAttribute("position",new v.BufferAttribute(this.ar,3)),this.line=new v.Line(this.geom,this.materials.pole),this.line},pn.prototype.parseLinks=function(t,e){var i=/\[([^\]]*)\]\((.*?)(?:\)(?:\s|$))/,n=[],o=[],r=[];for(t=t.slice();;){var a=t.match(i);if(!a)break;o.push(t.slice(0,a.index)),t=t.slice(a.index+a[0].length),-1===a[2].indexOf("javascript:")&&n.push(a)}return o.push(t),z.mls||(r=this.buildLinks(n,e)),{links:r,description:o}},pn.prototype.buildLinks=function(t,e){return t.map(function(t){var i=tn,n=t[1],o=t[2];return-1===o.indexOf("://")&&(o="https://"+o),-1===o.indexOf("matterport.com/show")&&-1===o.indexOf(window.location.host+"/show")||(-1!==o.indexOf(e)&&-1!==o.indexOf("start=")?i="navigation":(i="model",o+="&play=1")),{label:n,URL:o,type:i}})},pn.prototype.buildBillboard=function(){var t,e;if(this.type===gi.Audio){(e=document.createElement("div")).className="c_circleProgress_wrapper",fn.appendChild(e);var i=document.createElement("div");i.className="c_wrapper c_right",e.appendChild(i);var n=document.createElement("div");n.className="c_circleProgress c_rightcircle",i.appendChild(n);var r=document.createElement("div");r.className="c_wrapper c_left",e.appendChild(r);var a=document.createElement("div");a.className="c_circleProgress c_leftcircle",r.appendChild(a)}else{(e=document.createElement("div")).className="tag-container has-hotzone",fn.appendChild(e),(t=document.createElement("div")).className="tag-body",e.appendChild(t);var s=document.createElement("p");s.className="tag-label",s.textContent=this.label,o(".tag-label").css("line-height",1.5),o(".tag-label").css("letter-spacing","1px"),t.appendChild(s),this.buildContents(t),t.addEventListener("mouseover",function(t){this.boardState===cn&&e.classList.remove("has-hotzone")}.bind(this)),t.addEventListener("mousedown",function(t){t.stopPropagation()}),t.addEventListener("mouseup",function(t){t.stopPropagation()}),e.addEventListener("mousedown",l("mousedown")),e.addEventListener("mouseup",l("mouseup")),e.addEventListener("mouseenter",function(t){(z.mattertags.animation.hoverOnClosing||this.boardState!==un)&&(this.hoveringBillboard=!0,this.emit("enter",this),this.setHoverState())}.bind(this)),e.addEventListener("mouseleave",function(t){this.hoveringBillboard=!1,this.emit("leave",this),this.boardState!==hn&&this.setFreeState()}.bind(this))}function l(t){return function(e){var i,n=document.getElementById("player");try{i=new MouseEvent(t,e)}catch(n){(i=document.createEvent("MouseEvents")).initMouseEvent(t,e.bubbles,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget)}n.dispatchEvent(i)}}return e},pn.prototype.buildContents=function(t){function e(t){var e=document.createElement("span");return e.className="tag-desc",o(".tag-desc").css("line-height",1.6),o(e).html(null!=t?t:""),e}this.links.forEach(function(i,n){var o=e(this.parsedDescription[n]);t.appendChild(o);var r=document.createElement("a");if(r.classList.add("tag-link"),r.setAttribute("data-linktype",i.type),r.setAttribute("data-tagID",this.i),r.href=i.URL,r.textContent=i.label+" ",i.type===tn){o.textContent+="→ ";var a=document.createElement("i");a.classList.add("icon-ext-link"),a.title="Link to external web site",r.appendChild(a)}t.appendChild(r)}.bind(this));var i=e(this.parsedDescription[this.parsedDescription.length-1]);t.appendChild(i)},pn.prototype.scrollAll=function(t){},pn.prototype.setFreeState=function(t,e){this.type===gi.ImageText||this.type===gi.ImageTextAudio||this.type===gi.IKEA||this.type===gi.Video?this.setClosedState():this.type===gi.Audio?e&&this.setClosedState():!t&&this.hoveringBillboard||(this.fadeOutTimer||(this.fadeOutTimer=V.setTimeout(function(){this.disc.material=this.materials.free,this.boardState!==sn&&(this.boardState=un,this.animateBoard())}.bind(this),z.mattertags.animation.animOutDelay)),V.cancel(this.fadeInTimer),this.fadeInTimer=void 0)},pn.prototype.startAudio=function(){this.played||(this.played=!0)},pn.prototype.stopAudio=function(){},pn.prototype.setHoverState=function(t,e){if(this.model,this.boardState!==hn)if(this.type===gi.ImageText||this.type===gi.ImageTextAudio||this.type===gi.IKEA||this.type===gi.Video){if(this.audioenable&&this.audiourl,this.type,o.isArray(this.data.details.imageurl));else{var i=Ji.getSize(this.data.details.imageurl);i.width&&i.height&&(i.width,i.height),Ji.getWinSize(this.data.details.imageurl)}this.data.details.isNew,this.data.details.price&&this.data.details.price,g.isMobile(),this.type,void 0!==this.tagInfoUrl&&this.tagInfoUrl,g.isMobile()&&(o(window).width()<=375||o(window).height()),!this.label&&!this.data.details.description&&this.tagInfoUrl}else this.type===gi.Audio?0==e?1===!this.subtype&&(this.disc.material=this.materials.hover):1==e&&1===!this.subtype&&(this.disc.material=this.materials.hover):8===this.type?(this.hoveringBillboard||this.fadeInTimer&&t&&this.setActiveState(),V.cancel(this.fadeOutTimer),this.fadeOutTimer=void 0):this.type===gi.OtherModel?0===e&&this.tagInfoUrl&&window.open(this.tagInfoUrl):this.type===gi.Video||((this.type===gi.TextOnly||this.type===gi.TextAudio)&&this.audioenable&&this.audiourl&&0===e&&(mn.loop="",mn.src=this.audiourl,mn.currentTime=0,mn.play()),this.hoveringBillboard,this.fadeInTimer?t&&this.setActiveState():this.type===gi.TextOnly&&(this.fadeInTimer=V.setTimeout(function(){1===!this.subtype&&(this.disc.material=this.materials.hover),this.boardState!==cn&&(this.boardState=ln)}.bind(this),z.mattertags.animation.animInDelay)),V.cancel(this.fadeOutTimer),this.fadeOutTimer=void 0)},pn.prototype.setClosedState=function(){this.disc.material=this.materials.free,this.emit("tag.closed"),this.boardState=sn,this.type},pn.prototype.setActiveState=function(){this.type!==gi.OtherModel&&this.type!==gi.IFrame&&this.type!==gi.Audio&&(this.boardState=hn)},pn.prototype.hide=function(t,e){var i=o.Deferred();if(0===this.materials.free.opacity&&!V.isRunning(this.visibleTransition))return i.resolve().promise();t=t||0,e=e||0,V.cancel(this.visibleTransition),this.type;var n=this.materials.free.opacity/z.mattertags.disc.opacity,r=e+t,a=e/r;return this.visibleTransition=V.start(function(t){b.property(this.materials.free,"opacity",0)(t),b.property(this.materials.hover,"opacity",0)(t),b.property(this.materials.pole,"opacity",0)(t)}.bind(this),r*n,function(){i.resolve()},a,D[z.warp.blendEasing]),i.promise()},pn.prototype.show=function(t,e){var i=o.Deferred();if(this.materials.free.opacity===z.mattertags.disc.opacity&&!V.isRunning(this.visibleTransition))return i.resolve().promise();t=t||0,e=e||0,V.cancel(this.visibleTransition);var n=(z.mattertags.disc.opacity-this.materials.free.opacity)/z.mattertags.disc.opacity,r=e+t,a=e/r;return this.type===gi.Audio&&this.intvl,this.visibleTransition=V.start(function(t){b.property(this.materials.free,"opacity",z.mattertags.disc.opacity)(t),b.property(this.materials.hover,"opacity",z.mattertags.disc.opacity)(t),b.property(this.materials.pole,"opacity",z.mattertags.pole.opacity)(t)}.bind(this),r*n,function(){i.resolve()},a,D[z.warp.blendEasing]),i.promise()},pn.prototype.closestPanoTowardTag=function(t,e){var i=[],n=[],o=this.disc.getWorldPosition(new v.Vector3);if(t===A.PANORAMA){var r=e.position.clone().sub(o).normalize();i.push(Ce.filters.isPanoAligned()),i.push(Ce.filters.inPanoDirection(o,r,.5)),i.push(Ce.filters.isNeighbourPanoTo(e)),n.push(Ce.scoreFunctions.direction(o,r))}var a=new v.Vector3;i.push(function(t){return Math.abs(t.position.x-o.x)>z.mattertags.visibility.cameraClearance||Math.abs(t.position.z-o.z)>z.mattertags.visibility.cameraClearance},function(t){a.copy(o).sub(t.position);var e=-v.Math.radToDeg(Math.atan(a.y/Math.sqrt(a.x*a.x+a.z*a.z))),i=z.mattertags.navigate.tiltTolerance;return z.insideLookLimitDown-i<e&&e<z.insideLookLimitUp+i}),n.push(Ce.scoreFunctions.distanceSquared(this,-2));var s=this.model.panos.sortByScore(i,n);if(z.mattertags.navigate.lineOfSight){for(var l=0;l<s.length;l++){var c=s[l].pano,u=c.position.distanceTo(o);if(!z.mattertags.visibility.anyDistance&&u>z.mattertags.visibility.visibleDistance)return null;pn.raycaster.set(c.position,o.clone().sub(c.position).normalize());var h=pn.raycaster.intersectObjects(this.model.colliders);if(0===h.length||h[0].distance>u)return c}return null}return 0<s.length?s[0].pano:null},pn.prototype.examineMattertag=function(t,e){var i,n,o,r=t.mode;if(z.mattertags.navigate.nearestPano&&1!==this.subtype&&(i=this.closestPanoTowardTag(r,t.currentPano)),i||(i=t.currentPano),n="disc"===z.mattertags.navigate.aimAt?this.disc.getWorldPosition(new v.Vector3):"object"===z.mattertags.navigate.aimAt?this.obj3d.getWorldPosition(new v.Vector3):"nothing"===z.mattertags.navigate.aimAt?null:this.obj3d.getWorldPosition(new v.Vector3).add(this.discPosition.clone().multiplyScalar(.5)),o=z.mattertags.navigate.reactivate?function(){e(this),this.setActiveState()}.bind(this):null,r===A.PANORAMA)t.flyToPano({pano:i,lookAtPoint:n,duration:null,maxDistanceOverride:null,skipWarpingCheck:!1},o);else{var a={pano:i};if(n){var s=(new v.Matrix4).lookAt(i.position,n,new v.Vector3(0,1,0));a.quaternion=(new v.Quaternion).setFromRotationMatrix(s)}z.mattertags.navigate.reactivate&&(a.callback=o),a.duration=1500,a.mode=A.PANORAMA,t.flyToNewMode(a)}},pn.prototype.update=function(t,e,i,n,o){var r=this.model;if(this.type!==gi.Title){if(1e4<=this.i&&this.disc&&this.disc.position&&e&&e.position){var a=this.basepos.distanceTo(e.position);if(G&&G.P){var s=Math.max(a*G.P.a-G.P.b,G.P.c);this.disc.position.y=this.discpos2.y-s}}this.type===gi.BuildingType?t===A.DOLLHOUSE?this.enabled=!0:(this.enabled=!1,this.obj3d.visible=!1,this.hideDisc(t,e,i,n)):this.type===gi.RegionalJump?t===A.PANORAMA?this.enabled=!0:(this.enabled=!1,this.obj3d.visible=!1,this.hideDisc(t,e,i,n)):this.type===gi.Tag360T1||1===this.subtype?t!==A.PANORAMA?(this.enabled=!1,this.obj3d.visible=!1,this.hideDisc(t,e,i,n)):i&&(this.obj3d.position.copy(i.position.clone().add(this.position)),1e4<=!this.i&&this.disc.position.copy(this.discPosition),this.locationId==o?this.enabled=!0:(this.enabled=!1,this.obj3d.visible=!1,this.hideDisc(t,e,i,n))):(G.settings.nesttags.setting.show_in_3d||(t!==A.PANORAMA?this.materials.free.opacity=0:this.materials.free.opacity=z.mattertags.disc.opacity),z.mattertags.enablePanoSize&&(this.enabled=!0)),z.mattertags.enablePanoSize||(this.materials.free.opacity=0,this.enabled=!1),this.enabled&&this.updateDisc(t,e,i,n,r)}},pn.prototype.updateDisc=function(t,e,i,n,o){if("editor"===this.model.SDKmode&&("-1"==this.tagid||"-2"==this.tagid))if(this.rt360){var r=this.player.getMouseDirection(),a=Math.sqrt(4/(r.x*r.x+r.y*r.y+r.z*r.z));r.multiplyScalar(a),this.obj3d.position.copy(i.position.clone().add(r)),this.disc.position.copy(this.discPosition)}else{var s=this.player.intersect;if(null!=s){(a={}).point=s.point.clone(),a.normal=s.normal.clone();var l=a.normal.clone().multiplyScalar(.1);this.obj3d.position.copy(a.point),this.disc.position.copy(l),null!=this.ar&&(this.ar[3]=l.x,this.ar[4]=l.y,this.ar[5]=l.z,this.geom.addAttribute("position",new v.BufferAttribute(this.ar,3)))}}var c,u=G.settings.nesttags.setting,h=z.mattertags.visibility,d=z.mattertags.disc.scale,p=this.disc.getWorldPosition(new v.Vector3);if(t===A.PANORAMA?(c=e.position.distanceTo(p),this.type!==gi.RegionalJump&&(1!=this.subtype&&this.type!=gi.Tag360T1&&this.type!==gi.Title?u.autohide&&(c>u.autohide_length?this.materials.free.opacity=0:this.materials.free.opacity=z.mattertags.disc.opacity):this.type===gi.Title||(this.materials.free.opacity=z.mattertags.disc.opacity))):c=h.visibleDistance,this.obj3d.visible=0!==this.disc.material.opacity&&(h.anyDistance||c<=h.visibleDistance||t===A.TRANSITIONING)&&(!h.hideViaFloor||this.tagVisibleOnCurrentFloor(t))&&(!h.hideOffScreenDisc||!this.offScreen(this.disc,e))&&(!h.hideOffScreenObject||!this.offScreen(this.obj3d,e)),this.obj3d.visible){this.disc.quaternion.copy(e.quaternion);var f=d.maxSize-(d.maxSize-d.minSize)*v.Math.smoothstep(c,d.nearBound,d.farBound),m=p.clone().project(e),g=new v.Vector3(this.player.container.clientWidth/2,this.player.container.clientHeight/2,1).multiply(m),y=new v.Vector3(f/2,0,0).add(g),b=(a=new v.Vector3(2/this.player.container.clientWidth,2/this.player.container.clientHeight,1).multiply(y)).clone().unproject(e).clone().distanceTo(p),w=1+d.responsiveness/100*(pn.viewportScale(this.type,this.player.container)-1);this.discScale=b*w,this.disc.scale.set(this.discScale,this.discScale,this.discScale),this.type===gi.RegionalJump&&this.obj3d.visible}},pn.prototype.hideDisc=function(t,e,i,n){this.obj3d.visible=!1},pn.prototype.tagVisibleOnCurrentFloor=function(t){if(this.clock&&this.gifObject){var e=this.clock.getDelta();this.gifObject.update(1e3*e)}return t!==A.DOLLHOUSE&&t!==A.FLOORPLAN||this.model.allFloorsVisible||!this.floor.hidden},pn.prototype.offScreen=function(t,e){var i=t.getWorldPosition(new v.Vector3).project(e);return!(-1<i.x&&i.x<1&&-1<i.y&&i.y<1)},pn.viewportScale=function(t,e){return pn.viewportWidth===e.clientWidth&&pn.viewportHeight===e.clientHeight||(pn.viewportWidth=e.clientWidth,pn.viewportHeight=e.clientHeight),t===gi.BuildingType?pn.currentViewportScaleBuilding=Math.sqrt(Math.min(pn.viewportWidth,pn.viewportHeight)/z.mattertags.disc.scale.buildingViewportSize):pn.currentViewportScaleCommon=Math.sqrt(Math.min(pn.viewportWidth,pn.viewportHeight)/z.mattertags.disc.scale.baseViewportSize)},pn.prototype.newBillboardOrientation=function(t){if(this.boardOrientation&&this.boardState!==ln)return this.boardOrientation;var e=t.y<-1/3?0:t.y<1/3?1:2,i=t.x<-1/3?0:t.x<1/3?1:2,n="";return n+=0===i?"right":2===i?"left":"",n+=0===e?"-down":2===e?"-up":"",1===i&&(n=0===e?"bottom":2===e?"top":"",1===e&&(n=this.player.container.clientWidth>this.player.container.clientHeight?t.x<0?"right":"left":t.y<0?"bottom":"top")),n},pn.prototype.regionalJumpOrientation=function(t){var e=this.disc.getWorldPosition().clone().project(t);return e.x<-.5?"Left":e.x<.5?"Center":"Right"},pn.prototype.updateBillboard=function(t){var e=this.disc.getWorldPosition(new v.Vector3),i=e.clone().project(t);if(i.y*=-1,this.type!==gi.Audio){var n=this.newBillboardOrientation(i);if(n!==this.boardOrientation){this.billboard.style.transform=this.billboard.style.webkitTransform="",this.billboard.classList.remove("tag-container-"+this.boardOrientation),this.billboard.classList.add("tag-container-"+n);var o=window.getComputedStyle(this.billboard);this.billboard.initialTransform=o.transform||o.webkitTransform,"none"===this.billboard.initialTransform&&(this.billboard.initialTransform="");var r=window.getComputedStyle(this.billboard).transform.slice(7,-1).split(","),a=-r[4],s=-r[5];this.billboard.style.webkitTransformOrigin=a+"px "+s+"px",this.billboard.style.transformOrigin=a+"px "+s+"px",this.boardOrientation=n}}var l=new v.Vector3(-this.discScale/2,0,0).applyQuaternion(t.quaternion).add(e).project(t),c=Math.abs(i.x-l.x)*this.player.container.clientWidth,u=Math.sqrt(c/40)*z.mattertags.boardScale.boardToDiscRatio,h=(i.x+1)*this.player.container.clientWidth/2,d=(i.y+1)*this.player.container.clientHeight/2;this.type===gi.IFrame||this.type===gi.ImageTextAudio?(this.billboard.screenTransform=this.billboard.initialTransform+" translate("+h+"px, "+d+"px) scale(0)",this.billboard.style.visibility="hidden"):(this.type===gi.Audio?this.billboard.screenTransform=" translate("+h+"px, "+d+"px) scale("+1*u+")":this.billboard.screenTransform=this.billboard.initialTransform+" translate("+h+"px, "+d+"px) scale("+u*this.animationScale+")",this.billboard.style.webkitTransform=this.billboard.screenTransform,this.billboard.style.transform=this.billboard.screenTransform)},pn.prototype.animateBoard=function(t,e){this.boardState===ln?(V.cancel(this.boardTransition),g.detectSamsungNative()?(this.boardOrientation=null,this.emit("tag.opened"),this.boardState=cn,t&&t()):this.boardTransition=V.start(b.property(this,"animationScale",1),z.mattertags.animation.animInTime,function(){this.emit("tag.opened"),this.boardState=cn,t&&t()}.bind(this))):this.boardState===un&&(V.cancel(this.boardTransition),this.boardTransition=V.start(b.property(this,"animationScale",0),z.mattertags.animation.animOutTime,function(){this.emit("tag.closed"),this.boardState=sn,e&&e()}.bind(this)))},pn.prototype.updatePosition=function(t){this.position.copy(t),this.basepos=this.position.clone(),this.obj3d.position.copy(this.position)},pn.prototype.updateDiscPosition=function(t){var e=t.direction;if(this.discPosition.copy(e),this.discPosition.y+=.03,this.type!=gi.Tag360T1&&this.disc.position.copy(this.discPosition),t.enable){var i=this.buildPole();i.renderOrder=Y.mattertagStem,this.obj3d.add(i)}},pn.prototype.updateLableData=function(t){if(this.locationId=t.locationid,t.base&&this.updatePosition(t.base),t.stem&&this.updateDiscPosition(t.stem),t.iconId){var e=this.model.getLabelIcon(t.iconId);this.updateTagMaterial(e,t.iconType)}};var gn=pn,vn=yn;function yn(t){if(this.set={},this.infContains=function(){return!0},"object"==typeof t)if(t instanceof Array)for(var e=0;e<t.length;e++)this.set[t[e]]=!0;else this.set=t;else if("function"==typeof t)this.infContains=t;else if(void 0!==t)throw new Error("set must be either an array or an object.")}yn.prototype.has=yn.prototype.contains=function(t){return!!this.set[t]},yn.prototype.add=function(t){if(1==arguments.length)this.set[t]=!0;else for(var e=0;e<arguments.length;e++)this.set[arguments[e]]=!0},yn.prototype.addAll=function(t){if("object"!=typeof t&&!(t instanceof Array))throw new Error("arr must be an array.");for(var e=0;e<t.length;e++)this.add(t[e])},yn.prototype.delete=yn.prototype.remove=function(t){if(1==arguments.length)delete this.set[t];else for(var e=0;e<arguments.length;e++)delete this.set[arguments[e]]},yn.prototype.clear=function(){this.set={}},yn.prototype.size=function(){return Object.keys(this.set).length},yn.prototype.toString=function(){return"{"+Object.keys(this.set).toString()+"}"},yn.prototype["*values"]=yn.prototype.toArray=function(){return void 0===this.set?[]:Object.keys(this.set)};var bn=d(function(t,e){(function(){var e,i,n,o,r,a,s,l,c,u,h,d,p,f,m;n=Math.floor,u=Math.min,i=function(t,e){return t<e?-1:e<t?1:0},c=function(t,e,o,r,a){var s;if(null==o&&(o=0),null==a&&(a=i),o<0)throw new Error("lo must be non-negative");for(null==r&&(r=t.length);o<r;)a(e,t[s=n((o+r)/2)])<0?r=s:o=s+1;return[].splice.apply(t,[o,o-o].concat(e)),e},a=function(t,e,n){return null==n&&(n=i),t.push(e),f(t,0,t.length-1,n)},r=function(t,e){var n,o;return null==e&&(e=i),n=t.pop(),t.length?(o=t[0],t[0]=n,m(t,0,e)):o=n,o},l=function(t,e,n){var o;return null==n&&(n=i),o=t[0],t[0]=e,m(t,0,n),o},s=function(t,e,n){var o;return null==n&&(n=i),t.length&&n(t[0],e)<0&&(e=(o=[t[0],e])[0],t[0]=o[1],m(t,0,n)),e},o=function(t,e){var o,r,a,s,l,c;for(null==e&&(e=i),l=[],r=0,a=(s=function(){c=[];for(var e=0,i=n(t.length/2);0<=i?e<i:i<e;0<=i?e++:e--)c.push(e);return c}.apply(this).reverse()).length;r<a;r++)o=s[r],l.push(m(t,o,e));return l},p=function(t,e,n){var o;if(null==n&&(n=i),-1!==(o=t.indexOf(e)))return f(t,0,o,n),m(t,o,n)},h=function(t,e,n){var r,a,l,c,u;if(null==n&&(n=i),!(a=t.slice(0,e)).length)return a;for(o(a,n),l=0,c=(u=t.slice(e)).length;l<c;l++)r=u[l],s(a,r,n);return a.sort(n).reverse()},d=function(t,e,n){var a,s,l,h,d,p,f,m,g;if(null==n&&(n=i),10*e<=t.length){if(!(l=t.slice(0,e).sort(n)).length)return l;for(s=l[l.length-1],h=0,p=(f=t.slice(e)).length;h<p;h++)n(a=f[h],s)<0&&(c(l,a,0,null,n),l.pop(),s=l[l.length-1]);return l}for(o(t,n),g=[],d=0,m=u(e,t.length);0<=m?d<m:m<d;0<=m?++d:--d)g.push(r(t,n));return g},f=function(t,e,n,o){var r,a,s;for(null==o&&(o=i),r=t[n];e<n&&o(r,a=t[s=n-1>>1])<0;)t[n]=a,n=s;return t[n]=r},m=function(t,e,n){var o,r,a,s,l;for(null==n&&(n=i),r=t.length,a=t[l=e],o=2*e+1;o<r;)(s=o+1)<r&&!(n(t[o],t[s])<0)&&(o=s),t[e]=t[o],o=2*(e=o)+1;return t[e]=a,f(t,l,e,n)},e=function(){function t(t){this.cmp=null!=t?t:i,this.nodes=[]}return t.push=a,t.pop=r,t.replace=l,t.pushpop=s,t.heapify=o,t.updateItem=p,t.nlargest=h,t.nsmallest=d,t.prototype.push=function(t){return a(this.nodes,t,this.cmp)},t.prototype.pop=function(){return r(this.nodes,this.cmp)},t.prototype.peek=function(){return this.nodes[0]},t.prototype.contains=function(t){return-1!==this.nodes.indexOf(t)},t.prototype.replace=function(t){return l(this.nodes,t,this.cmp)},t.prototype.pushpop=function(t){return s(this.nodes,t,this.cmp)},t.prototype.heapify=function(){return o(this.nodes,this.cmp)},t.prototype.updateItem=function(t){return p(this.nodes,t,this.cmp)},t.prototype.clear=function(){return this.nodes=[]},t.prototype.empty=function(){return 0===this.nodes.length},t.prototype.size=function(){return this.nodes.length},t.prototype.clone=function(){var e;return(e=new t).nodes=this.nodes.slice(0),e},t.prototype.toArray=function(){return this.nodes.slice(0)},t.prototype.insert=t.prototype.push,t.prototype.top=t.prototype.peek,t.prototype.front=t.prototype.peek,t.prototype.has=t.prototype.contains,t.prototype.copy=t.prototype.clone,t}(),t.exports=e}).call(h)}),wn=Object.prototype.hasOwnProperty,xn="~";function _n(t){return xn+t}function Sn(t){if("string"!=typeof t)throw new TypeError("key must be a string.")}function Tn(t){if(void 0===t.parent)return[t.data];var e=Tn(t.parent);return e.push(t.data),e}function Mn(t){return t.toString()}function In(t,e){return t.f-e.f}var Pn=function(t){void 0===t.timeout&&(t.timeout=1/0);var e=t.hash||Mn,i={data:t.start,g:0,h:t.heuristic(t.start)},n=i;i.f=i.h;var o=new vn,r=new bn(In),a=function(t){var e=Object.create(null),i=0,n={};return function(t,e){for(var i in e)Object.defineProperty(t,i,{value:e[i],configurable:!0,writable:!0})}(n,{get:function(t,i){Sn(t);var n=_n(t);return n in e?e[n]:i},set:function(t,n){Sn(t);var o=_n(t);return o in e||++i,e[o]=n},has:function(t){return Sn(t),_n(t)in e},delete:function(t){Sn(t);var n=_n(t);return n in e&&(--i,delete e[n],!0)},clear:function(){e=Object.create(null),i=0},forEach:function(t,i){if("function"!=typeof t)throw new TypeError("`callback` must be a function");for(var o in e)if(wn.call(e,o)){var r=o.substring(xn.length),a=e[o];t.call(i,a,r,n)}}}),Object.defineProperty(n,"size",{get:function(){return i},configurable:!0}),"object"==typeof t&&null!==t&&Object.keys(t).forEach(function(e){n.set(e,t[e])}),n}();r.push(i),a.set(e(i.data),i);for(var s=new Date;r.size();){if(new Date-s>t.timeout)return{status:"timeout",cost:n.g,path:Tn(n)};var l=r.pop();if(a.delete(e(l.data)),t.isEnd(l.data)){var c=Tn(l);return{status:"success",cost:l.g,path:c}}o.add(e(l.data));for(var u=t.neighbor(l.data),h=0;h<u.length;h++){var d=u[h];if(!o.contains(e(d))){var p=l.g+t.distance(l.data,d),f=a.get(e(d)),m=!1;if(void 0===f)f={data:d},a.set(e(d),f);else{if(f.g<p)continue;m=!0}f.parent=l,f.g=p,f.h=t.heuristic(d),f.f=p+f.h,f.h<n.h&&(n=f),m?r.heapify():r.push(f)}}}return{status:"noPath",cost:n.g,path:Tn(n)}},Cn=d(function(t){(function(e){function i(){x.call(this),this.neighbourMap={},this.map=null}var n,o,r,a,s,l,c,u,h,d,p,f=v,m=k,g=z,y=Ce,b=Pn,w=new S(e),x=Yi,_=V;m.inherit(i,x),i.prototype.getIndex=function(t){return t.id},i.prototype.find=function(t,e){var i=m.filterAll(this.list,t);if(0<i.length)return e&&e.forEach(function(t){i=m.stableSort(i,t)}),i[0]},i.prototype.sortByScore=function(t,e){var i=m.filterAll(this.list,t);return 0<i.length?i=i.map(function(t){return{pano:t,score:e.reduce(function(e,i){return e+i(t)},0)}}).sort(function(t,e){return e.score-t.score}):null},i.prototype.lowestByScore=function(t,e,i){return this.findRankedByScore(0,t,e,i)},i.prototype.findRankedByScore=function(t,e,i,n){n&&(n.candidates=null,n.pano=null),t||(t=0);var o=this.sortByScore(e,i);return o&&0!==o.length&&t<o.length?(n&&(n.candidates=o,n.pano=o[t].pano),o[t].pano):null},i.prototype.showPanoScores=function(t){this.list.forEach(function(t){t.removeTextSprite()});var e=6344768;t.forEach(function(t){t.pano.addTextSprite(t.score.toFixed(2),e),e=16428055})},i.prototype.isNeighbour=function(t,e){return this.neighbourMap[t.id][e.id]},i.prototype.getNeighbours=function(t){return this.neighbourMap[t.id]},i.prototype.setNeighbour=function(t,e,i){return this.neighbourMap[t.id]||(this.neighbourMap[t.id]={}),this.neighbourMap[e.id]||(this.neighbourMap[e.id]={}),this.neighbourMap[t.id][t.id]=!0,this.neighbourMap[e.id][e.id]=!0,this.neighbourMap[t.id][e.id]=i,this.neighbourMap[e.id][t.id]=i,this.neighbourMap[t.id]},i.prototype.findClosest=function(t,e){var i=[y.filters.isPanoAligned()];return e&&i.push(y.filters.inDirection(t,e,.75)),this.find(i,[y.sortFunctions.distanceToPoint(t)])},i.prototype.dualNeighbors=function(t,e){var i,n=[];for(i in this.neighbourMap[t.id])this.neighbourMap[e.id][i]&&n.push(i);return n},i.prototype.populate_path_graph=function(){var t,e,i,n,o,r,a,s,l=Date.now(),c={},u=0,h=new f.Vector3(0,0,0);for(t=0;t<this.list.length;t++){for(e in s=!(a={}),i=(o=this.list[t]).neighbourPanos||o.findNeighourPanos())if(i[e]){r=this.index[e],h.copy(o.floorPosition),h.sub(r.floorPosition);var d=Math.sqrt(h.x*h.x+h.z*h.z),p=Math.max(0,Math.abs(h.y)-.2);n=0<p?(p=Math.pow(4*p,2),d=Math.pow(d,2),Math.sqrt(p*p+d*d)):h.length(),a[r.id]=n,s=!0}s?c[o.id]=a:u+=1}this.map=c,w.info("graph ready in "+(Date.now()-l)+"ms, "+u+" had no neighbors")},i.prototype.aStarSearch=function(t,e){var i=Date.now(),n=new b({start:t,isEnd:function(t){return t===e},neighbor:function(t){var e=t.neighbourPanos||t.findNeighourPanos(),i=[];for(var n in e)i.push(this.index[n]);return i}.bind(this),distance:function(t,e){return this.map[t.id][e.id]}.bind(this),heuristic:function(t,e){return 1}.bind(this),hash:function(t){return t.id},timeout:5e3});if(w.debug("A* search in "+(Date.now()-i)+"ms"),"success"!==n.status)return w.debug("Did not find A* path from "+t+" to "+e),null;w.debug("Total cost "+n.cost.toPrecision(3)+", "+n.path.length+" steps");var o=[];return n.path.forEach(function(t){o.push(t.id)}),o},i.prototype.includeNodesNearPath=(n=new f.Vector3,o=new f.Vector3,r=new f.Vector3,a=new f.Vector3,s=new f.Vector3,l=new f.Vector3,c=new f.Vector3,u=new f.Vector3,h=[],d=new f.Vector3,p=new f.Vector3,function(t,e){if(t)for(var i=function(t,e,i){return s.copy(e).sub(t),s.dot(i)},f=function(t,e){return i(d,t.position,r)-i(d,e.position,r)},m=0;m<t.length-1;){var g=t[m],v=t[m+1],y=this.index[g],b=this.index[v];d.copy(y.position),p.copy(b.position),h.length=0,n.copy(p).sub(d),r.copy(n).normalize();for(var w=0;w<this.list.length;w++){var x=this.list[w];s.copy(x.position).sub(d);var _=s.dot(r);0<_&&(c.copy(r),c.multiplyScalar(_),l.copy(s),l.sub(c),l.length()<e&&(o.copy(n).negate(),a.copy(o).normalize(),u.copy(x.position).sub(p),0<u.dot(a)&&h.push(x)))}if(0<h.length){h.sort(f);for(var S=t.length+h.length-1;S>=m+h.length;S--)t[S]=t[S-h.length];for(var T=0;T<h.length;T++)t[T+m+1]=h[T].id}m+=h.length+1}}),i.prototype.fadeMarkerOpacity=function(t,e){var i=void 0===t?g.panorama.markerOpacity:t,n=this.list.findIndex(function(t){return t.marker});if(0<=n){var o=this.list[n].marker.material.opacity;if(o!==t){var r=i-o;_.trigger({func:function(t,e){var i=o+t*r;this.forEach(function(t){t.marker&&(t.marker.material.opacity=i)})}.bind(this),duration:void 0===e?g.markerOpacityTransitionTime:e,name:"_fpm"})}}},i.prototype.update=function(t){this.forEach(function(e){e.update(t)})},t.exports=i}).call(h,"/js/util/PanoramaCollection.js")}),An=d(function(t){var e,i;e=h,i=function(){function t(t,e,i){this.low=0|t,this.high=0|e,this.unsigned=!!i}function e(t){return!0===(t&&t.__isLong__)}Object.defineProperty(t.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),t.isLong=e;var i={},n={};function o(t,e){var o,r,s;return e?(s=0<=(t>>>=0)&&t<256)&&(r=n[t])?r:(o=a(t,(0|t)<0?-1:0,!0),s&&(n[t]=o),o):(s=-128<=(t|=0)&&t<128)&&(r=i[t])?r:(o=a(t,t<0?-1:0,!1),s&&(i[t]=o),o)}function r(t,e){if(isNaN(t)||!isFinite(t))return e?m:f;if(e){if(t<0)return m;if(h<=t)return w}else{if(t<=-d)return x;if(d<=t+1)return b}return t<0?r(-t,e).neg():a(t%u|0,t/u|0,e)}function a(e,i,n){return new t(e,i,n)}t.fromInt=o,t.fromNumber=r,t.fromBits=a;var s=Math.pow;function l(t,e,i){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return f;if(e="number"==typeof e?(i=e,!1):!!e,(i=i||10)<2||36<i)throw RangeError("radix");var n;if(0<(n=t.indexOf("-")))throw Error("interior hyphen");if(0===n)return l(t.substring(1),e,i).neg();for(var o=r(s(i,8)),a=f,c=0;c<t.length;c+=8){var u=Math.min(8,t.length-c),h=parseInt(t.substring(c,c+u),i);if(u<8){var d=r(s(i,u));a=a.mul(d).add(r(h))}else a=(a=a.mul(o)).add(r(h))}return a.unsigned=e,a}function c(e){return e instanceof t?e:"number"==typeof e?r(e):"string"==typeof e?l(e):a(e.low,e.high,e.unsigned)}t.fromString=l,t.fromValue=c;var u=4294967296,h=u*u,d=h/2,p=o(1<<24),f=o(0);t.ZERO=f;var m=o(0,!0);t.UZERO=m;var g=o(1);t.ONE=g;var v=o(1,!0);t.UONE=v;var y=o(-1);t.NEG_ONE=y;var b=a(-1,2147483647,!1);t.MAX_VALUE=b;var w=a(-1,-1,!0);t.MAX_UNSIGNED_VALUE=w;var x=a(0,-2147483648,!1);t.MIN_VALUE=x;var _=t.prototype;return _.toInt=function(){return this.unsigned?this.low>>>0:this.low},_.toNumber=function(){return this.unsigned?(this.high>>>0)*u+(this.low>>>0):this.high*u+(this.low>>>0)},_.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(x)){var e=r(t),i=this.div(e),n=i.mul(e).sub(this);return i.toString(t)+n.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var o=r(s(t,6),this.unsigned),a=this,l="";;){var c=a.div(o),u=(a.sub(c.mul(o)).toInt()>>>0).toString(t);if((a=c).isZero())return u+l;for(;u.length<6;)u="0"+u;l=""+u+l}},_.getHighBits=function(){return this.high},_.getHighBitsUnsigned=function(){return this.high>>>0},_.getLowBits=function(){return this.low},_.getLowBitsUnsigned=function(){return this.low>>>0},_.getNumBitsAbs=function(){if(this.isNegative())return this.eq(x)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;0<e&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},_.isZero=function(){return 0===this.high&&0===this.low},_.isNegative=function(){return!this.unsigned&&this.high<0},_.isPositive=function(){return this.unsigned||0<=this.high},_.isOdd=function(){return 1==(1&this.low)},_.isEven=function(){return 0==(1&this.low)},_.equals=function(t){return e(t)||(t=c(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},_.eq=_.equals,_.notEquals=function(t){return!this.eq(t)},_.neq=_.notEquals,_.lessThan=function(t){return this.comp(t)<0},_.lt=_.lessThan,_.lessThanOrEqual=function(t){return this.comp(t)<=0},_.lte=_.lessThanOrEqual,_.greaterThan=function(t){return 0<this.comp(t)},_.gt=_.greaterThan,_.greaterThanOrEqual=function(t){return 0<=this.comp(t)},_.gte=_.greaterThanOrEqual,_.compare=function(t){if(e(t)||(t=c(t)),this.eq(t))return 0;var i=this.isNegative(),n=t.isNegative();return i&&!n?-1:!i&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},_.comp=_.compare,_.negate=function(){return!this.unsigned&&this.eq(x)?x:this.not().add(g)},_.neg=_.negate,_.add=function(t){e(t)||(t=c(t));var i=this.high>>>16,n=65535&this.high,o=this.low>>>16,r=65535&this.low,s=t.high>>>16,l=65535&t.high,u=t.low>>>16,h=0,d=0,p=0,f=0;return p+=(f+=r+(65535&t.low))>>>16,d+=(p+=o+u)>>>16,h+=(d+=n+l)>>>16,h+=i+s,a((p&=65535)<<16|(f&=65535),(h&=65535)<<16|(d&=65535),this.unsigned)},_.subtract=function(t){return e(t)||(t=c(t)),this.add(t.neg())},_.sub=_.subtract,_.multiply=function(t){if(this.isZero())return f;if(e(t)||(t=c(t)),t.isZero())return f;if(this.eq(x))return t.isOdd()?x:f;if(t.eq(x))return this.isOdd()?x:f;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(p)&&t.lt(p))return r(this.toNumber()*t.toNumber(),this.unsigned);var i=this.high>>>16,n=65535&this.high,o=this.low>>>16,s=65535&this.low,l=t.high>>>16,u=65535&t.high,h=t.low>>>16,d=65535&t.low,m=0,g=0,v=0,y=0;return v+=(y+=s*d)>>>16,g+=(v+=o*d)>>>16,v&=65535,g+=(v+=s*h)>>>16,m+=(g+=n*d)>>>16,g&=65535,m+=(g+=o*h)>>>16,g&=65535,m+=(g+=s*u)>>>16,m+=i*d+n*h+o*u+s*l,a((v&=65535)<<16|(y&=65535),(m&=65535)<<16|(g&=65535),this.unsigned)},_.mul=_.multiply,_.divide=function(t){if(e(t)||(t=c(t)),t.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?m:f;var i,n,o;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return m;if(t.gt(this.shru(1)))return v;o=m}else{if(this.eq(x))return t.eq(g)||t.eq(y)?x:t.eq(x)?g:(i=this.shr(1).div(t).shl(1)).eq(f)?t.isNegative()?g:y:(n=this.sub(t.mul(i)),o=i.add(n.div(t)));if(t.eq(x))return this.unsigned?m:f;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();o=f}for(n=this;n.gte(t);){i=Math.max(1,Math.floor(n.toNumber()/t.toNumber()));for(var a=Math.ceil(Math.log(i)/Math.LN2),l=a<=48?1:s(2,a-48),u=r(i),h=u.mul(t);h.isNegative()||h.gt(n);)h=(u=r(i-=l,this.unsigned)).mul(t);u.isZero()&&(u=g),o=o.add(u),n=n.sub(h)}return o},_.div=_.divide,_.modulo=function(t){return e(t)||(t=c(t)),this.sub(this.div(t).mul(t))},_.mod=_.modulo,_.not=function(){return a(~this.low,~this.high,this.unsigned)},_.and=function(t){return e(t)||(t=c(t)),a(this.low&t.low,this.high&t.high,this.unsigned)},_.or=function(t){return e(t)||(t=c(t)),a(this.low|t.low,this.high|t.high,this.unsigned)},_.xor=function(t){return e(t)||(t=c(t)),a(this.low^t.low,this.high^t.high,this.unsigned)},_.shiftLeft=function(t){return e(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?a(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):a(0,this.low<<t-32,this.unsigned)},_.shl=_.shiftLeft,_.shiftRight=function(t){return e(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?a(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):a(this.high>>t-32,0<=this.high?0:-1,this.unsigned)},_.shr=_.shiftRight,_.shiftRightUnsigned=function(t){if(e(t)&&(t=t.toInt()),0==(t&=63))return this;var i=this.high;return t<32?a(this.low>>>t|i<<32-t,i>>>t,this.unsigned):a(32===t?i:i>>>t-32,0,this.unsigned)},_.shru=_.shiftRightUnsigned,_.toSigned=function(){return this.unsigned?a(this.low,this.high,!1):this},_.toUnsigned=function(){return this.unsigned?this:a(this.low,this.high,!0)},_.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},_.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24&255,255&t,t>>>8&255,t>>>16&255,t>>>24&255]},_.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24&255,t>>>16&255,t>>>8&255,255&t,e>>>24&255,e>>>16&255,e>>>8&255,255&e]},t},t&&t.exports?t.exports=i():(e.dcodeIO=e.dcodeIO||{}).Long=i()}),En=d(function(t){var e,i;e=h,i=function(t){var e=function(t,i,o){if(void 0===t&&(t=e.DEFAULT_CAPACITY),void 0===i&&(i=e.DEFAULT_ENDIAN),void 0===o&&(o=e.DEFAULT_NOASSERT),!o){if((t|=0)<0)throw RangeError("Illegal capacity");i=!!i,o=!!o}this.buffer=0===t?n:new ArrayBuffer(t),this.view=0===t?null:new Uint8Array(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=t,this.littleEndian=i,this.noAssert=o};e.VERSION="5.0.1",e.LITTLE_ENDIAN=!0,e.BIG_ENDIAN=!1,e.DEFAULT_CAPACITY=16,e.DEFAULT_ENDIAN=e.BIG_ENDIAN,e.DEFAULT_NOASSERT=!1,e.Long=t||null;var i=e.prototype;i.__isByteBuffer__,Object.defineProperty(i,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1});var n=new ArrayBuffer(0),o=String.fromCharCode;function r(t){var e=0;return function(){return e<t.length?t.charCodeAt(e++):null}}function a(){var t=[],e=[];return function(){if(0===arguments.length)return e.join("")+o.apply(String,t);1024<t.length+arguments.length&&(e.push(o.apply(String,t)),t.length=0),Array.prototype.push.apply(t,arguments)}}function s(t,e,i,n,o){var r,a,s=8*o-n-1,l=(1<<s)-1,c=l>>1,u=-7,h=i?o-1:0,d=i?-1:1,p=t[e+h];for(h+=d,r=p&(1<<-u)-1,p>>=-u,u+=s;0<u;r=256*r+t[e+h],h+=d,u-=8);for(a=r&(1<<-u)-1,r>>=-u,u+=n;0<u;a=256*a+t[e+h],h+=d,u-=8);if(0===r)r=1-c;else{if(r===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),r-=c}return(p?-1:1)*a*Math.pow(2,r-n)}function l(t,e,i,n,o,r){var a,s,l,c=8*r-o-1,u=(1<<c)-1,h=u>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:r-1,f=n?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),2<=(e+=1<=a+h?d/l:d*Math.pow(2,1-h))*l&&(a++,l/=2),u<=a+h?(s=0,a=u):1<=a+h?(s=(e*l-1)*Math.pow(2,o),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,o),a=0));8<=o;t[i+p]=255&s,p+=f,s/=256,o-=8);for(a=a<<o|s,c+=o;0<c;t[i+p]=255&a,p+=f,a/=256,c-=8);t[i+p-f]|=128*m}e.accessor=function(){return Uint8Array},e.allocate=function(t,i,n){return new e(t,i,n)},e.concat=function(t,i,n,o){"boolean"!=typeof i&&"string"==typeof i||(o=n,n=i,i=void 0);for(var r,a=0,s=0,l=t.length;s<l;++s)e.isByteBuffer(t[s])||(t[s]=e.wrap(t[s],i)),0<(r=t[s].limit-t[s].offset)&&(a+=r);if(0===a)return new e(0,n,o);var c,u=new e(a,n,o);for(s=0;s<l;)(r=(c=t[s++]).limit-c.offset)<=0||(u.view.set(c.view.subarray(c.offset,c.limit),u.offset),u.offset+=r);return u.limit=u.offset,u.offset=0,u},e.isByteBuffer=function(t){return!0===(t&&t.__isByteBuffer__)},e.type=function(){return ArrayBuffer},e.wrap=function(t,n,o,r){if("string"!=typeof n&&(r=o,o=n,n=void 0),"string"==typeof t)switch(void 0===n&&(n="utf8"),n){case"base64":return e.fromBase64(t,o);case"hex":return e.fromHex(t,o);case"binary":return e.fromBinary(t,o);case"utf8":return e.fromUTF8(t,o);case"debug":return e.fromDebug(t,o);default:throw Error("Unsupported encoding: "+n)}if(null===t||"object"!=typeof t)throw TypeError("Illegal buffer");var a;if(e.isByteBuffer(t))return(a=i.clone.call(t)).markedOffset=-1,a;if(t instanceof Uint8Array)a=new e(0,o,r),0<t.length&&(a.buffer=t.buffer,a.offset=t.byteOffset,a.limit=t.byteOffset+t.byteLength,a.view=new Uint8Array(t.buffer));else if(t instanceof ArrayBuffer)a=new e(0,o,r),0<t.byteLength&&(a.buffer=t,a.offset=0,a.limit=t.byteLength,a.view=0<t.byteLength?new Uint8Array(t):null);else{if("[object Array]"!==Object.prototype.toString.call(t))throw TypeError("Illegal buffer");(a=new e(t.length,o,r)).limit=t.length;for(var s=0;s<t.length;++s)a.view[s]=t[s]}return a},i.writeBitSet=function(t,e){var i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if(!(t instanceof Array))throw TypeError("Illegal BitSet: Not an array");if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}var n,o=e,r=t.length,a=r>>3,s=0;for(e+=this.writeVarint32(r,e);a--;)n=1&!!t[s++]|(1&!!t[s++])<<1|(1&!!t[s++])<<2|(1&!!t[s++])<<3|(1&!!t[s++])<<4|(1&!!t[s++])<<5|(1&!!t[s++])<<6|(1&!!t[s++])<<7,this.writeByte(n,e++);if(s<r){var l=0;for(n=0;s<r;)n|=(1&!!t[s++])<<l++;this.writeByte(n,e++)}return i?(this.offset=e,this):e-o},i.readBitSet=function(t){var e=void 0===t;e&&(t=this.offset);var i,n=this.readVarint32(t),o=n.value,r=o>>3,a=0,s=[];for(t+=n.length;r--;)i=this.readByte(t++),s[a++]=!!(1&i),s[a++]=!!(2&i),s[a++]=!!(4&i),s[a++]=!!(8&i),s[a++]=!!(16&i),s[a++]=!!(32&i),s[a++]=!!(64&i),s[a++]=!!(128&i);if(a<o){var l=0;for(i=this.readByte(t++);a<o;)s[a++]=!!(i>>l++&1)}return e&&(this.offset=t),s},i.readBytes=function(t,e){var i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+t>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+"+t+") <= "+this.buffer.byteLength)}var n=this.slice(e,e+t);return i&&(this.offset+=t),n},i.writeBytes=i.append,i.writeInt8=function(t,e){var i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}e+=1;var n=this.buffer.byteLength;return n<e&&this.resize((n*=2)>e?n:e),e-=1,this.view[e]=t,i&&(this.offset+=1),this},i.writeByte=i.writeInt8,i.readInt8=function(t){var e=void 0===t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var i=this.view[t];return 128==(128&i)&&(i=-(255-i+1)),e&&(this.offset+=1),i},i.readByte=i.readInt8,i.writeUint8=function(t,e){var i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t>>>=0,"number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}e+=1;var n=this.buffer.byteLength;return n<e&&this.resize((n*=2)>e?n:e),e-=1,this.view[e]=t,i&&(this.offset+=1),this},i.writeUInt8=i.writeUint8,i.readUint8=function(t){var e=void 0===t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var i=this.view[t];return e&&(this.offset+=1),i},i.readUInt8=i.readUint8,i.writeInt16=function(t,e){var i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}e+=2;var n=this.buffer.byteLength;return n<e&&this.resize((n*=2)>e?n:e),e-=2,this.littleEndian?(this.view[e+1]=(65280&t)>>>8,this.view[e]=255&t):(this.view[e]=(65280&t)>>>8,this.view[e+1]=255&t),i&&(this.offset+=2),this},i.writeShort=i.writeInt16,i.readInt16=function(t){var e=void 0===t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+2) <= "+this.buffer.byteLength)}var i=0;return this.littleEndian?(i=this.view[t],i|=this.view[t+1]<<8):(i=this.view[t]<<8,i|=this.view[t+1]),32768==(32768&i)&&(i=-(65535-i+1)),e&&(this.offset+=2),i},i.readShort=i.readInt16,i.writeUint16=function(t,e){var i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t>>>=0,"number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}e+=2;var n=this.buffer.byteLength;return n<e&&this.resize((n*=2)>e?n:e),e-=2,this.littleEndian?(this.view[e+1]=(65280&t)>>>8,this.view[e]=255&t):(this.view[e]=(65280&t)>>>8,this.view[e+1]=255&t),i&&(this.offset+=2),this},i.writeUInt16=i.writeUint16,i.readUint16=function(t){var e=void 0===t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+2) <= "+this.buffer.byteLength)}var i=0;return this.littleEndian?(i=this.view[t],i|=this.view[t+1]<<8):(i=this.view[t]<<8,i|=this.view[t+1]),e&&(this.offset+=2),i},i.readUInt16=i.readUint16,i.writeInt32=function(t,e){var i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}e+=4;var n=this.buffer.byteLength;return n<e&&this.resize((n*=2)>e?n:e),e-=4,this.littleEndian?(this.view[e+3]=t>>>24&255,this.view[e+2]=t>>>16&255,this.view[e+1]=t>>>8&255,this.view[e]=255&t):(this.view[e]=t>>>24&255,this.view[e+1]=t>>>16&255,this.view[e+2]=t>>>8&255,this.view[e+3]=255&t),i&&(this.offset+=4),this},i.writeInt=i.writeInt32,i.readInt32=function(t){var e=void 0===t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var i=0;return this.littleEndian?(i=this.view[t+2]<<16,i|=this.view[t+1]<<8,i|=this.view[t],i+=this.view[t+3]<<24>>>0):(i=this.view[t+1]<<16,i|=this.view[t+2]<<8,i|=this.view[t+3],i+=this.view[t]<<24>>>0),i|=0,e&&(this.offset+=4),i},i.readInt=i.readInt32,i.writeUint32=function(t,e){var i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t>>>=0,"number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}e+=4;var n=this.buffer.byteLength;return n<e&&this.resize((n*=2)>e?n:e),e-=4,this.littleEndian?(this.view[e+3]=t>>>24&255,this.view[e+2]=t>>>16&255,this.view[e+1]=t>>>8&255,this.view[e]=255&t):(this.view[e]=t>>>24&255,this.view[e+1]=t>>>16&255,this.view[e+2]=t>>>8&255,this.view[e+3]=255&t),i&&(this.offset+=4),this},i.writeUInt32=i.writeUint32,i.readUint32=function(t){var e=void 0===t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var i=0;return this.littleEndian?(i=this.view[t+2]<<16,i|=this.view[t+1]<<8,i|=this.view[t],i+=this.view[t+3]<<24>>>0):(i=this.view[t+1]<<16,i|=this.view[t+2]<<8,i|=this.view[t+3],i+=this.view[t]<<24>>>0),e&&(this.offset+=4),i},i.readUInt32=i.readUint32,t&&(i.writeInt64=function(e,i){var n=void 0===i;if(n&&(i=this.offset),!this.noAssert){if("number"==typeof e)e=t.fromNumber(e);else if("string"==typeof e)e=t.fromString(e);else if(!(e&&e instanceof t))throw TypeError("Illegal value: "+e+" (not an integer or Long)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof e?e=t.fromNumber(e):"string"==typeof e&&(e=t.fromString(e)),i+=8;var o=this.buffer.byteLength;o<i&&this.resize((o*=2)>i?o:i),i-=8;var r=e.low,a=e.high;return this.littleEndian?(this.view[i+3]=r>>>24&255,this.view[i+2]=r>>>16&255,this.view[i+1]=r>>>8&255,this.view[i]=255&r,i+=4,this.view[i+3]=a>>>24&255,this.view[i+2]=a>>>16&255,this.view[i+1]=a>>>8&255,this.view[i]=255&a):(this.view[i]=a>>>24&255,this.view[i+1]=a>>>16&255,this.view[i+2]=a>>>8&255,this.view[i+3]=255&a,i+=4,this.view[i]=r>>>24&255,this.view[i+1]=r>>>16&255,this.view[i+2]=r>>>8&255,this.view[i+3]=255&r),n&&(this.offset+=8),this},i.writeLong=i.writeInt64,i.readInt64=function(e){var i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}var n=0,o=0;this.littleEndian?(n=this.view[e+2]<<16,n|=this.view[e+1]<<8,n|=this.view[e],n+=this.view[e+3]<<24>>>0,e+=4,o=this.view[e+2]<<16,o|=this.view[e+1]<<8,o|=this.view[e],o+=this.view[e+3]<<24>>>0):(o=this.view[e+1]<<16,o|=this.view[e+2]<<8,o|=this.view[e+3],o+=this.view[e]<<24>>>0,e+=4,n=this.view[e+1]<<16,n|=this.view[e+2]<<8,n|=this.view[e+3],n+=this.view[e]<<24>>>0);var r=new t(n,o,!1);return i&&(this.offset+=8),r},i.readLong=i.readInt64,i.writeUint64=function(e,i){var n=void 0===i;if(n&&(i=this.offset),!this.noAssert){if("number"==typeof e)e=t.fromNumber(e);else if("string"==typeof e)e=t.fromString(e);else if(!(e&&e instanceof t))throw TypeError("Illegal value: "+e+" (not an integer or Long)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof e?e=t.fromNumber(e):"string"==typeof e&&(e=t.fromString(e)),i+=8;var o=this.buffer.byteLength;o<i&&this.resize((o*=2)>i?o:i),i-=8;var r=e.low,a=e.high;return this.littleEndian?(this.view[i+3]=r>>>24&255,this.view[i+2]=r>>>16&255,this.view[i+1]=r>>>8&255,this.view[i]=255&r,i+=4,this.view[i+3]=a>>>24&255,this.view[i+2]=a>>>16&255,this.view[i+1]=a>>>8&255,this.view[i]=255&a):(this.view[i]=a>>>24&255,this.view[i+1]=a>>>16&255,this.view[i+2]=a>>>8&255,this.view[i+3]=255&a,i+=4,this.view[i]=r>>>24&255,this.view[i+1]=r>>>16&255,this.view[i+2]=r>>>8&255,this.view[i+3]=255&r),n&&(this.offset+=8),this},i.writeUInt64=i.writeUint64,i.readUint64=function(e){var i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}var n=0,o=0;this.littleEndian?(n=this.view[e+2]<<16,n|=this.view[e+1]<<8,n|=this.view[e],n+=this.view[e+3]<<24>>>0,e+=4,o=this.view[e+2]<<16,o|=this.view[e+1]<<8,o|=this.view[e],o+=this.view[e+3]<<24>>>0):(o=this.view[e+1]<<16,o|=this.view[e+2]<<8,o|=this.view[e+3],o+=this.view[e]<<24>>>0,e+=4,n=this.view[e+1]<<16,n|=this.view[e+2]<<8,n|=this.view[e+3],n+=this.view[e]<<24>>>0);var r=new t(n,o,!0);return i&&(this.offset+=8),r},i.readUInt64=i.readUint64),i.writeFloat32=function(t,e){var i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof t)throw TypeError("Illegal value: "+t+" (not a number)");if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}e+=4;var n=this.buffer.byteLength;return n<e&&this.resize((n*=2)>e?n:e),e-=4,l(this.view,t,e,this.littleEndian,23,4),i&&(this.offset+=4),this},i.writeFloat=i.writeFloat32,i.readFloat32=function(t){var e=void 0===t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var i=s(this.view,t,this.littleEndian,23,4);return e&&(this.offset+=4),i},i.readFloat=i.readFloat32,i.writeFloat64=function(t,e){var i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof t)throw TypeError("Illegal value: "+t+" (not a number)");if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}e+=8;var n=this.buffer.byteLength;return n<e&&this.resize((n*=2)>e?n:e),e-=8,l(this.view,t,e,this.littleEndian,52,8),i&&(this.offset+=8),this},i.writeDouble=i.writeFloat64,i.readFloat64=function(t){var e=void 0===t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var i=s(this.view,t,this.littleEndian,52,8);return e&&(this.offset+=8),i},i.readDouble=i.readFloat64,e.MAX_VARINT32_BYTES=5,e.calculateVarint32=function(t){return(t>>>=0)<128?1:t<16384?2:t<1<<21?3:t<1<<28?4:5},e.zigZagEncode32=function(t){return((t|=0)<<1^t>>31)>>>0},e.zigZagDecode32=function(t){return t>>>1^-(1&t)|0},i.writeVarint32=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var o,r=e.calculateVarint32(t);i+=r;var a=this.buffer.byteLength;for(a<i&&this.resize((a*=2)>i?a:i),i-=r,t>>>=0;128<=t;)o=127&t|128,this.view[i++]=o,t>>>=7;return this.view[i++]=t,n?(this.offset=i,this):r},i.writeVarint32ZigZag=function(t,i){return this.writeVarint32(e.zigZagEncode32(t),i)},i.readVarint32=function(t){var e=void 0===t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var i,n=0,o=0;do{if(!this.noAssert&&t>this.limit){var r=Error("Truncated");throw r.truncated=!0,r}i=this.view[t++],n<5&&(o|=(127&i)<<7*n),++n}while(0!=(128&i));return o|=0,e?(this.offset=t,o):{value:o,length:n}},i.readVarint32ZigZag=function(t){var i=this.readVarint32(t);return"object"==typeof i?i.value=e.zigZagDecode32(i.value):i=e.zigZagDecode32(i),i},t&&(e.MAX_VARINT64_BYTES=10,e.calculateVarint64=function(e){"number"==typeof e?e=t.fromNumber(e):"string"==typeof e&&(e=t.fromString(e));var i=e.toInt()>>>0,n=e.shiftRightUnsigned(28).toInt()>>>0,o=e.shiftRightUnsigned(56).toInt()>>>0;return 0==o?0==n?i<16384?i<128?1:2:i<1<<21?3:4:n<16384?n<128?5:6:n<1<<21?7:8:o<128?9:10},e.zigZagEncode64=function(e){return"number"==typeof e?e=t.fromNumber(e,!1):"string"==typeof e?e=t.fromString(e,!1):!1!==e.unsigned&&(e=e.toSigned()),e.shiftLeft(1).xor(e.shiftRight(63)).toUnsigned()},e.zigZagDecode64=function(e){return"number"==typeof e?e=t.fromNumber(e,!1):"string"==typeof e?e=t.fromString(e,!1):!1!==e.unsigned&&(e=e.toSigned()),e.shiftRightUnsigned(1).xor(e.and(t.ONE).toSigned().negate()).toSigned()},i.writeVarint64=function(i,n){var o=void 0===n;if(o&&(n=this.offset),!this.noAssert){if("number"==typeof i)i=t.fromNumber(i);else if("string"==typeof i)i=t.fromString(i);else if(!(i&&i instanceof t))throw TypeError("Illegal value: "+i+" (not an integer or Long)");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}"number"==typeof i?i=t.fromNumber(i,!1):"string"==typeof i?i=t.fromString(i,!1):!1!==i.unsigned&&(i=i.toSigned());var r=e.calculateVarint64(i),a=i.toInt()>>>0,s=i.shiftRightUnsigned(28).toInt()>>>0,l=i.shiftRightUnsigned(56).toInt()>>>0;n+=r;var c=this.buffer.byteLength;switch(c<n&&this.resize((c*=2)>n?c:n),n-=r,r){case 10:this.view[n+9]=l>>>7&1;case 9:this.view[n+8]=9!==r?128|l:127&l;case 8:this.view[n+7]=8!==r?s>>>21|128:s>>>21&127;case 7:this.view[n+6]=7!==r?s>>>14|128:s>>>14&127;case 6:this.view[n+5]=6!==r?s>>>7|128:s>>>7&127;case 5:this.view[n+4]=5!==r?128|s:127&s;case 4:this.view[n+3]=4!==r?a>>>21|128:a>>>21&127;case 3:this.view[n+2]=3!==r?a>>>14|128:a>>>14&127;case 2:this.view[n+1]=2!==r?a>>>7|128:a>>>7&127;case 1:this.view[n]=1!==r?128|a:127&a}return o?(this.offset+=r,this):r},i.writeVarint64ZigZag=function(t,i){return this.writeVarint64(e.zigZagEncode64(t),i)},i.readVarint64=function(e){var i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n=e,o=0,r=0,a=0,s=0;if(o=127&(s=this.view[e++]),128&s&&(o|=(127&(s=this.view[e++]))<<7,(128&s||this.noAssert&&void 0===s)&&(o|=(127&(s=this.view[e++]))<<14,(128&s||this.noAssert&&void 0===s)&&(o|=(127&(s=this.view[e++]))<<21,(128&s||this.noAssert&&void 0===s)&&(r=127&(s=this.view[e++]),(128&s||this.noAssert&&void 0===s)&&(r|=(127&(s=this.view[e++]))<<7,(128&s||this.noAssert&&void 0===s)&&(r|=(127&(s=this.view[e++]))<<14,(128&s||this.noAssert&&void 0===s)&&(r|=(127&(s=this.view[e++]))<<21,(128&s||this.noAssert&&void 0===s)&&(a=127&(s=this.view[e++]),(128&s||this.noAssert&&void 0===s)&&(a|=(127&(s=this.view[e++]))<<7,128&s||this.noAssert&&void 0===s))))))))))throw Error("Buffer overrun");var l=t.fromBits(o|r<<28,r>>>4|a<<24,!1);return i?(this.offset=e,l):{value:l,length:e-n}},i.readVarint64ZigZag=function(i){var n=this.readVarint64(i);return n&&n.value instanceof t?n.value=e.zigZagDecode64(n.value):n=e.zigZagDecode64(n),n}),i.writeCString=function(t,e){var i=void 0===e;i&&(e=this.offset);var n,o=t.length;if(!this.noAssert){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");for(n=0;n<o;++n)if(0===t.charCodeAt(n))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}o=h.calculateUTF16asUTF8(r(t))[1],e+=o+1;var a=this.buffer.byteLength;return a<e&&this.resize((a*=2)>e?a:e),e-=o+1,h.encodeUTF16toUTF8(r(t),function(t){this.view[e++]=t}.bind(this)),this.view[e++]=0,i?(this.offset=e,this):o},i.readCString=function(t){var e=void 0===t;if(e&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var i,n=t,o=-1;return h.decodeUTF8toUTF16(function(){if(0===o)return null;if(t>=this.limit)throw RangeError("Illegal range: Truncated data, "+t+" < "+this.limit);return 0===(o=this.view[t++])?null:o}.bind(this),i=a(),!0),e?(this.offset=t,i()):{string:i(),length:t-n}},i.writeIString=function(t,e){var i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}var n,o=e;n=h.calculateUTF16asUTF8(r(t),this.noAssert)[1],e+=4+n;var a=this.buffer.byteLength;if(a<e&&this.resize((a*=2)>e?a:e),e-=4+n,this.littleEndian?(this.view[e+3]=n>>>24&255,this.view[e+2]=n>>>16&255,this.view[e+1]=n>>>8&255,this.view[e]=255&n):(this.view[e]=n>>>24&255,this.view[e+1]=n>>>16&255,this.view[e+2]=n>>>8&255,this.view[e+3]=255&n),e+=4,h.encodeUTF16toUTF8(r(t),function(t){this.view[e++]=t}.bind(this)),e!==o+4+n)throw RangeError("Illegal range: Truncated data, "+e+" == "+(e+4+n));return i?(this.offset=e,this):e-o},i.readIString=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var n=t,o=this.readUint32(t),r=this.readUTF8String(o,e.METRICS_BYTES,t+=4);return t+=r.length,i?(this.offset=t,r.string):{string:r.string,length:t-n}},e.METRICS_CHARS="c",e.METRICS_BYTES="b",i.writeUTF8String=function(t,e){var i,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}var o=e;i=h.calculateUTF16asUTF8(r(t))[1],e+=i;var a=this.buffer.byteLength;return a<e&&this.resize((a*=2)>e?a:e),e-=i,h.encodeUTF16toUTF8(r(t),function(t){this.view[e++]=t}.bind(this)),n?(this.offset=e,this):e-o},i.writeString=i.writeUTF8String,e.calculateUTF8Chars=function(t){return h.calculateUTF16asUTF8(r(t))[0]},e.calculateUTF8Bytes=function(t){return h.calculateUTF16asUTF8(r(t))[1]},e.calculateString=e.calculateUTF8Bytes,i.readUTF8String=function(t,i,n){"number"==typeof i&&(n=i,i=void 0);var o=void 0===n;if(o&&(n=this.offset),void 0===i&&(i=e.METRICS_CHARS),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal length: "+t+" (not an integer)");if(t|=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}var r,s=0,l=n;if(i===e.METRICS_CHARS){if(r=a(),h.decodeUTF8(function(){return s<t&&n<this.limit?this.view[n++]:null}.bind(this),function(t){++s,h.UTF8toUTF16(t,r)}),s!==t)throw RangeError("Illegal range: Truncated data, "+s+" == "+t);return o?(this.offset=n,r()):{string:r(),length:n-l}}if(i!==e.METRICS_BYTES)throw TypeError("Unsupported metrics: "+i);if(!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+t>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+"+t+") <= "+this.buffer.byteLength)}var c=n+t;if(h.decodeUTF8toUTF16(function(){return n<c?this.view[n++]:null}.bind(this),r=a(),this.noAssert),n!==c)throw RangeError("Illegal range: Truncated data, "+n+" == "+c);return o?(this.offset=n,r()):{string:r(),length:n-l}},i.readString=i.readUTF8String,i.writeVString=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.noAssert){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var o,a,s=i;o=h.calculateUTF16asUTF8(r(t),this.noAssert)[1],a=e.calculateVarint32(o),i+=a+o;var l=this.buffer.byteLength;if(l<i&&this.resize((l*=2)>i?l:i),i-=a+o,i+=this.writeVarint32(o,i),h.encodeUTF16toUTF8(r(t),function(t){this.view[i++]=t}.bind(this)),i!==s+o+a)throw RangeError("Illegal range: Truncated data, "+i+" == "+(i+o+a));return n?(this.offset=i,this):i-s},i.readVString=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n=t,o=this.readVarint32(t),r=this.readUTF8String(o.value,e.METRICS_BYTES,t+=o.length);return t+=r.length,i?(this.offset=t,r.string):{string:r.string,length:t-n}},i.append=function(t,i,n){"number"!=typeof i&&"string"==typeof i||(n=i,i=void 0);var o=void 0===n;if(o&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}t instanceof e||(t=e.wrap(t,i));var r=t.limit-t.offset;if(r<=0)return this;n+=r;var a=this.buffer.byteLength;return a<n&&this.resize((a*=2)>n?a:n),n-=r,this.view.set(t.view.subarray(t.offset,t.limit),n),t.offset+=r,o&&(this.offset+=r),this},i.appendTo=function(t,e){return t.append(this,e),this},i.assert=function(t){return this.noAssert=!t,this},i.capacity=function(){return this.buffer.byteLength},i.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},i.clone=function(t){var i=new e(0,this.littleEndian,this.noAssert);return i.view=t?(i.buffer=new ArrayBuffer(this.buffer.byteLength),new Uint8Array(i.buffer)):(i.buffer=this.buffer,this.view),i.offset=this.offset,i.markedOffset=this.markedOffset,i.limit=this.limit,i},i.compact=function(t,e){if(void 0===t&&(t=this.offset),void 0===e&&(e=this.limit),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof e||e%1!=0)throw TypeError("Illegal end: Not an integer");if(e>>>=0,t<0||e<t||e>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+e+" <= "+this.buffer.byteLength)}if(0===t&&e===this.buffer.byteLength)return this;var i=e-t;if(0===i)return this.buffer=n,this.view=null,0<=this.markedOffset&&(this.markedOffset-=t),this.offset=0,this.limit=0,this;var o=new ArrayBuffer(i),r=new Uint8Array(o);return r.set(this.view.subarray(t,e)),this.buffer=o,this.view=r,0<=this.markedOffset&&(this.markedOffset-=t),this.offset=0,this.limit=i,this},i.copy=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.limit),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}if(t===i)return new e(0,this.littleEndian,this.noAssert);var n=i-t,o=new e(n,this.littleEndian,this.noAssert);return o.offset=0,o.limit=n,0<=o.markedOffset&&(o.markedOffset-=t),this.copyTo(o,0,t,i),o},i.copyTo=function(t,i,n,o){var r,a;if(!this.noAssert&&!e.isByteBuffer(t))throw TypeError("Illegal target: Not a ByteBuffer");if(i=(a=void 0===i)?t.offset:0|i,n=(r=void 0===n)?this.offset:0|n,o=void 0===o?this.limit:0|o,i<0||i>t.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+i+" <= "+t.buffer.byteLength);if(n<0||o>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+n+" <= "+this.buffer.byteLength);var s=o-n;return 0===s?t:(t.ensureCapacity(i+s),t.view.set(this.view.subarray(n,o),i),r&&(this.offset+=s),a&&(t.offset+=s),this)},i.ensureCapacity=function(t){var e=this.buffer.byteLength;return e<t?this.resize((e*=2)>t?e:t):this},i.fill=function(t,e,i){var n=void 0===e;if(n&&(e=this.offset),"string"==typeof t&&0<t.length&&(t=t.charCodeAt(0)),void 0===e&&(e=this.offset),void 0===i&&(i=this.limit),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,e<0||i<e||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+i+" <= "+this.buffer.byteLength)}if(i<=e)return this;for(;e<i;)this.view[e++]=t;return n&&(this.offset=e),this},i.flip=function(){return this.limit=this.offset,this.offset=0,this},i.mark=function(t){if(t=void 0===t?this.offset:t,!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=t,this},i.order=function(t){if(!this.noAssert&&"boolean"!=typeof t)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!t,this},i.LE=function(t){return this.littleEndian=void 0===t||!!t,this},i.BE=function(t){return this.littleEndian=void 0!==t&&!t,this},i.prepend=function(t,i,n){"number"!=typeof i&&"string"==typeof i||(n=i,i=void 0);var o=void 0===n;if(o&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}t instanceof e||(t=e.wrap(t,i));var r=t.limit-t.offset;if(r<=0)return this;var a=r-n;if(0<a){var s=new ArrayBuffer(this.buffer.byteLength+a),l=new Uint8Array(s);l.set(this.view.subarray(n,this.buffer.byteLength),r),this.buffer=s,this.view=l,this.offset+=a,0<=this.markedOffset&&(this.markedOffset+=a),this.limit+=a,n+=a}else new Uint8Array(this.buffer);return this.view.set(t.view.subarray(t.offset,t.limit),n-r),t.offset=t.limit,o&&(this.offset-=r),this},i.prependTo=function(t,e){return t.prepend(this,e),this},i.printDebug=function(t){"function"!=typeof t&&(t=void 0),t(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},i.remaining=function(){return this.limit-this.offset},i.reset=function(){return 0<=this.markedOffset?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},i.resize=function(t){if(!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal capacity: "+t+" (not an integer)");if((t|=0)<0)throw RangeError("Illegal capacity: 0 <= "+t)}if(this.buffer.byteLength<t){var e=new ArrayBuffer(t),i=new Uint8Array(e);i.set(this.view),this.buffer=e,this.view=i}return this},i.reverse=function(t,e){if(void 0===t&&(t=this.offset),void 0===e&&(e=this.limit),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof e||e%1!=0)throw TypeError("Illegal end: Not an integer");if(e>>>=0,t<0||e<t||e>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+e+" <= "+this.buffer.byteLength)}return t===e||Array.prototype.reverse.call(this.view.subarray(t,e)),this},i.skip=function(t){if(!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal length: "+t+" (not an integer)");t|=0}var e=this.offset+t;if(!this.noAssert&&(e<0||e>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+t+" <= "+this.buffer.byteLength);return this.offset=e,this},i.slice=function(t,e){if(void 0===t&&(t=this.offset),void 0===e&&(e=this.limit),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof e||e%1!=0)throw TypeError("Illegal end: Not an integer");if(e>>>=0,t<0||e<t||e>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+e+" <= "+this.buffer.byteLength)}var i=this.clone();return i.offset=t,i.limit=e,i},i.toBuffer=function(t){var e=this.offset,i=this.limit;if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: Not an integer");if(e>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal limit: Not an integer");if(i>>>=0,e<0||i<e||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+i+" <= "+this.buffer.byteLength)}if(!t&&0===e&&i===this.buffer.byteLength)return this.buffer;if(e===i)return n;var o=new ArrayBuffer(i-e);return new Uint8Array(o).set(new Uint8Array(this.buffer).subarray(e,i),0),o},i.toArrayBuffer=i.toBuffer,i.toString=function(t,e,i){if(void 0===t)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof t&&(i=e=t="utf8"),t){case"utf8":return this.toUTF8(e,i);case"base64":return this.toBase64(e,i);case"hex":return this.toHex(e,i);case"binary":return this.toBinary(e,i);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+t)}};var c=function(){for(var t={},e=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],i=[],n=0,o=e.length;n<o;++n)i[e[n]]=n;return t.encode=function(t,i){for(var n,o;null!==(n=t());)i(e[n>>2&63]),o=(3&n)<<4,null!==(n=t())?(i(e[63&((o|=n>>4&15)|n>>4&15)]),o=(15&n)<<2,null!==(n=t())?(i(e[63&(o|n>>6&3)]),i(e[63&n])):(i(e[63&o]),i(61))):(i(e[63&o]),i(61),i(61))},t.decode=function(t,e){var n,o,r;function a(t){throw Error("Illegal character code: "+t)}for(;null!==(n=t());)if(void 0===(o=i[n])&&a(n),null!==(n=t())&&(void 0===(r=i[n])&&a(n),e(o<<2>>>0|(48&r)>>4),null!==(n=t()))){if(void 0===(o=i[n])){if(61===n)break;a(n)}if(e((15&r)<<4>>>0|(60&o)>>2),null!==(n=t())){if(void 0===(r=i[n])){if(61===n)break;a(n)}e((3&o)<<6>>>0|r)}}},t.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)},t}();i.toBase64=function(t,e){if(void 0===t&&(t=this.offset),void 0===e&&(e=this.limit),e|=0,(t|=0)<0||e>this.capacity||e<t)throw RangeError("begin, end");var i;return c.encode(function(){return t<e?this.view[t++]:null}.bind(this),i=a()),i()},e.fromBase64=function(t,i){if("string"!=typeof t)throw TypeError("str");var n=new e(t.length/4*3,i),o=0;return c.decode(r(t),function(t){n.view[o++]=t}),n.limit=o,n},e.btoa=function(t){return e.fromBinary(t).toBase64()},e.atob=function(t){return e.fromBase64(t).toBinary()},i.toBinary=function(t,e){if(void 0===t&&(t=this.offset),void 0===e&&(e=this.limit),e|=0,(t|=0)<0||e>this.capacity()||e<t)throw RangeError("begin, end");if(t===e)return"";for(var i=[],n=[];t<e;)i.push(this.view[t++]),1024<=i.length&&(n.push(String.fromCharCode.apply(String,i)),i=[]);return n.join("")+String.fromCharCode.apply(String,i)},e.fromBinary=function(t,i){if("string"!=typeof t)throw TypeError("str");for(var n,o=0,r=t.length,a=new e(r,i);o<r;){if(255<(n=t.charCodeAt(o)))throw RangeError("illegal char code: "+n);a.view[o++]=n}return a.limit=r,a},i.toDebug=function(t){for(var e,i=-1,n=this.buffer.byteLength,o="",r="",a="";i<n;){if(-1!==i&&(o+=(e=this.view[i])<16?"0"+e.toString(16).toUpperCase():e.toString(16).toUpperCase(),t&&(r+=32<e&&e<127?String.fromCharCode(e):".")),++i,t&&0<i&&i%16==0&&i!==n){for(;o.length<51;)o+=" ";a+=o+r+"\n",o=r=""}i===this.offset&&i===this.limit?o+=i===this.markedOffset?"!":"|":i===this.offset?o+=i===this.markedOffset?"[":"<":i===this.limit?o+=i===this.markedOffset?"]":">":o+=i===this.markedOffset?"'":t||0!==i&&i!==n?" ":""}if(t&&" "!==o){for(;o.length<51;)o+=" ";a+=o+r+"\n"}return t?a:o},e.fromDebug=function(t,i,n){for(var o,r,a=t.length,s=new e((a+1)/3|0,i,n),l=0,c=0,u=!1,h=!1,d=!1,p=!1,f=!1;l<a;){switch(o=t.charAt(l++)){case"!":if(!n){if(h||d||p){f=!0;break}h=d=p=!0}s.offset=s.markedOffset=s.limit=c,u=!1;break;case"|":if(!n){if(h||p){f=!0;break}h=p=!0}s.offset=s.limit=c,u=!1;break;case"[":if(!n){if(h||d){f=!0;break}h=d=!0}s.offset=s.markedOffset=c,u=!1;break;case"<":if(!n){if(h){f=!0;break}h=!0}s.offset=c,u=!1;break;case"]":if(!n){if(p||d){f=!0;break}p=d=!0}s.limit=s.markedOffset=c,u=!1;break;case">":if(!n){if(p){f=!0;break}p=!0}s.limit=c,u=!1;break;case"'":if(!n){if(d){f=!0;break}d=!0}s.markedOffset=c,u=!1;break;case" ":u=!1;break;default:if(!n&&u){f=!0;break}if(r=parseInt(o+t.charAt(l++),16),!n&&(isNaN(r)||r<0||255<r))throw TypeError("Illegal str: Not a debug encoded string");s.view[c++]=r,u=!0}if(f)throw TypeError("Illegal str: Invalid symbol at "+l)}if(!n){if(!h||!p)throw TypeError("Illegal str: Missing offset or limit");if(c<s.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+c+" < "+a)}return s},i.toHex=function(t,e){if(t=void 0===t?this.offset:t,e=void 0===e?this.limit:e,!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof e||e%1!=0)throw TypeError("Illegal end: Not an integer");if(e>>>=0,t<0||e<t||e>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+e+" <= "+this.buffer.byteLength)}for(var i,n=new Array(e-t);t<e;)(i=this.view[t++])<16?n.push("0",i.toString(16)):n.push(i.toString(16));return n.join("")},e.fromHex=function(t,i,n){if(!n){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if(t.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var o,r=t.length,a=new e(r/2|0,i),s=0,l=0;s<r;s+=2){if(o=parseInt(t.substring(s,s+2),16),!n&&(!isFinite(o)||o<0||255<o))throw TypeError("Illegal str: Contains non-hex characters");a.view[l++]=o}return a.limit=l,a};var u,h=u={MAX_CODEPOINT:1114111,encodeUTF8:function(t,e){var i=null;for("number"==typeof t&&(i=t,t=function(){return null});null!==i||null!==(i=t());)i<128?e(127&i):(i<2048?e(i>>6&31|192):(i<65536?e(i>>12&15|224):(e(i>>18&7|240),e(i>>12&63|128)),e(i>>6&63|128)),e(63&i|128)),i=null},decodeUTF8:function(t,e){for(var i,n,o,r,a=function(t){t=t.slice(0,t.indexOf(null));var e=Error(t.toString());throw e.name="TruncatedError",e.bytes=t,e};null!==(i=t());)if(0==(128&i))e(i);else if(192==(224&i))null===(n=t())&&a([i,n]),e((31&i)<<6|63&n);else if(224==(240&i))(null===(n=t())||null===(o=t()))&&a([i,n,o]),e((15&i)<<12|(63&n)<<6|63&o);else{if(240!=(248&i))throw RangeError("Illegal starting byte: "+i);(null===(n=t())||null===(o=t())||null===(r=t()))&&a([i,n,o,r]),e((7&i)<<18|(63&n)<<12|(63&o)<<6|63&r)}},UTF16toUTF8:function(t,e){for(var i,n=null;null!==(i=null!==n?n:t());)55296<=i&&i<=57343&&null!==(n=t())&&56320<=n&&n<=57343?(e(1024*(i-55296)+n-56320+65536),n=null):e(i);null!==n&&e(n)},UTF8toUTF16:function(t,e){var i=null;for("number"==typeof t&&(i=t,t=function(){return null});null!==i||null!==(i=t());)i<=65535?e(i):(e(55296+((i-=65536)>>10)),e(i%1024+56320)),i=null},encodeUTF16toUTF8:function(t,e){u.UTF16toUTF8(t,function(t){u.encodeUTF8(t,e)})},decodeUTF8toUTF16:function(t,e){u.decodeUTF8(t,function(t){u.UTF8toUTF16(t,e)})},calculateCodePoint:function(t){return t<128?1:t<2048?2:t<65536?3:4},calculateUTF8:function(t){for(var e,i=0;null!==(e=t());)i+=e<128?1:e<2048?2:e<65536?3:4;return i},calculateUTF16asUTF8:function(t){var e=0,i=0;return u.UTF16toUTF8(t,function(t){++e,i+=t<128?1:t<2048?2:t<65536?3:4}),[e,i]}};return i.toUTF8=function(t,e){if(void 0===t&&(t=this.offset),void 0===e&&(e=this.limit),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof e||e%1!=0)throw TypeError("Illegal end: Not an integer");if(e>>>=0,t<0||e<t||e>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+e+" <= "+this.buffer.byteLength)}var i;try{h.decodeUTF8toUTF16(function(){return t<e?this.view[t++]:null}.bind(this),i=a())}catch(i){if(t!==e)throw RangeError("Illegal range: Truncated data, "+t+" != "+e)}return i()},e.fromUTF8=function(t,i,n){if(!n&&"string"!=typeof t)throw TypeError("Illegal str: Not a string");var o=new e(h.calculateUTF16asUTF8(r(t),!0)[1],i,n),a=0;return h.encodeUTF16toUTF8(r(t),function(t){o.view[a++]=t}),o.limit=a,o},e},t&&t.exports?t.exports=function(){var t;try{t=An}catch(t){}return i(t)}():(e.dcodeIO=e.dcodeIO||{}).ByteBuffer=i(e.dcodeIO.Long)}),Ln={},Dn=d(function(t){var e,i;e=h,i=function(t,e){var i,n,o,r,a,s,l={};return l.ByteBuffer=t,l.Long=t.Long||null,l.VERSION="5.0.3",l.WIRE_TYPES={},l.WIRE_TYPES.VARINT=0,l.WIRE_TYPES.BITS64=1,l.WIRE_TYPES.LDELIM=2,l.WIRE_TYPES.STARTGROUP=3,l.WIRE_TYPES.ENDGROUP=4,l.WIRE_TYPES.BITS32=5,l.PACKABLE_WIRE_TYPES=[l.WIRE_TYPES.VARINT,l.WIRE_TYPES.BITS64,l.WIRE_TYPES.BITS32],l.TYPES={int32:{name:"int32",wireType:l.WIRE_TYPES.VARINT,defaultValue:0},uint32:{name:"uint32",wireType:l.WIRE_TYPES.VARINT,defaultValue:0},sint32:{name:"sint32",wireType:l.WIRE_TYPES.VARINT,defaultValue:0},int64:{name:"int64",wireType:l.WIRE_TYPES.VARINT,defaultValue:l.Long?l.Long.ZERO:void 0},uint64:{name:"uint64",wireType:l.WIRE_TYPES.VARINT,defaultValue:l.Long?l.Long.UZERO:void 0},sint64:{name:"sint64",wireType:l.WIRE_TYPES.VARINT,defaultValue:l.Long?l.Long.ZERO:void 0},bool:{name:"bool",wireType:l.WIRE_TYPES.VARINT,defaultValue:!1},double:{name:"double",wireType:l.WIRE_TYPES.BITS64,defaultValue:0},string:{name:"string",wireType:l.WIRE_TYPES.LDELIM,defaultValue:""},bytes:{name:"bytes",wireType:l.WIRE_TYPES.LDELIM,defaultValue:null},fixed32:{name:"fixed32",wireType:l.WIRE_TYPES.BITS32,defaultValue:0},sfixed32:{name:"sfixed32",wireType:l.WIRE_TYPES.BITS32,defaultValue:0},fixed64:{name:"fixed64",wireType:l.WIRE_TYPES.BITS64,defaultValue:l.Long?l.Long.UZERO:void 0},sfixed64:{name:"sfixed64",wireType:l.WIRE_TYPES.BITS64,defaultValue:l.Long?l.Long.ZERO:void 0},float:{name:"float",wireType:l.WIRE_TYPES.BITS32,defaultValue:0},enum:{name:"enum",wireType:l.WIRE_TYPES.VARINT,defaultValue:0},message:{name:"message",wireType:l.WIRE_TYPES.LDELIM,defaultValue:null},group:{name:"group",wireType:l.WIRE_TYPES.STARTGROUP,defaultValue:null}},l.MAP_KEY_TYPES=[l.TYPES.int32,l.TYPES.sint32,l.TYPES.sfixed32,l.TYPES.uint32,l.TYPES.fixed32,l.TYPES.int64,l.TYPES.sint64,l.TYPES.sfixed64,l.TYPES.uint64,l.TYPES.fixed64,l.TYPES.bool,l.TYPES.string,l.TYPES.bytes],l.ID_MIN=1,l.ID_MAX=536870911,l.convertFieldsToCamelCase=!1,l.populateAccessors=!0,l.populateDefaults=!0,l.Util=((i={}).IS_NODE=!("object"!=typeof u||u+""!="[object process]"||u.browser),i.XHR=function(){for(var t=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],e=null,i=0;i<t.length;i++){try{e=t[i]()}catch(t){continue}break}if(!e)throw Error("XMLHttpRequest is not supported");return e},i.fetch=function(t,e){if(e&&"function"!=typeof e&&(e=null),i.IS_NODE){var n=Ln;if(e)n.readFile(t,function(t,i){e(t?null:""+i)});else try{return n.readFileSync(t)}catch(t){return null}}else{var o=i.XHR();if(o.open("GET",t,!!e),o.setRequestHeader("Accept","text/plain"),"function"==typeof o.overrideMimeType&&o.overrideMimeType("text/plain"),!e)return o.send(null),200==o.status||0==o.status&&"string"==typeof o.responseText?o.responseText:null;if(o.onreadystatechange=function(){4==o.readyState&&(200==o.status||0==o.status&&"string"==typeof o.responseText?e(o.responseText):e(null))},4==o.readyState)return;o.send(null)}},i.toCamelCase=function(t){return t.replace(/_([a-zA-Z])/g,function(t,e){return e.toUpperCase()})},i),l.Lang={DELIM:/[\s\{\}=;:\[\],'"\(\)<>]/g,RULE:/^(?:required|optional|repeated|map)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,FQTYPEREF:/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0[xX][0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,ID:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,STRING_DQ:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,STRING_SQ:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},l.DotProto=function(t,e){var i={},n=function(t){this.source=t+"",this.index=0,this.line=1,this.stack=[],this._stringOpen=null},o=n.prototype;o._readString=function(){var t='"'===this._stringOpen?e.STRING_DQ:e.STRING_SQ;t.lastIndex=this.index-1;var i=t.exec(this.source);if(!i)throw Error("unterminated string");return this.index=t.lastIndex,this.stack.push(this._stringOpen),this._stringOpen=null,i[1]},o.next=function(){if(0<this.stack.length)return this.stack.shift();if(this.index>=this.source.length)return null;if(null!==this._stringOpen)return this._readString();var t,i,n;do{for(t=!1;e.WHITESPACE.test(n=this.source.charAt(this.index));)if("\n"===n&&++this.line,++this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if(++this.index,"/"===this.source.charAt(this.index)){for(;"\n"!==this.source.charAt(++this.index);)if(this.index==this.source.length)return null;++this.index,++this.line,t=!0}else{if("*"!==(n=this.source.charAt(this.index)))return"/";do{if("\n"===n&&++this.line,++this.index===this.source.length)return null;i=n,n=this.source.charAt(this.index)}while("*"!==i||"/"!==n);++this.index,t=!0}}while(t);if(this.index===this.source.length)return null;var o=this.index;if(e.DELIM.lastIndex=0,!e.DELIM.test(this.source.charAt(o++)))for(;o<this.source.length&&!e.DELIM.test(this.source.charAt(o));)++o;var r=this.source.substring(this.index,this.index=o);return'"'!==r&&"'"!==r||(this._stringOpen=r),r},o.peek=function(){if(0===this.stack.length){var t=this.next();if(null===t)return null;this.stack.push(t)}return this.stack[0]},o.skip=function(t){var e=this.next();if(e!==t)throw Error("illegal '"+e+"', '"+t+"' expected")},o.omit=function(t){return this.peek()===t&&(this.next(),!0)},o.toString=function(){return"Tokenizer ("+this.index+"/"+this.source.length+" at line "+this.line+")"},i.Tokenizer=n;var r=function(t){this.tn=new n(t),this.proto3=!1},a=r.prototype;function s(t,i){var n=-1,o=1;if("-"==t.charAt(0)&&(o=-1,t=t.substring(1)),e.NUMBER_DEC.test(t))n=parseInt(t);else if(e.NUMBER_HEX.test(t))n=parseInt(t.substring(2),16);else{if(!e.NUMBER_OCT.test(t))throw Error("illegal id value: "+(o<0?"-":"")+t);n=parseInt(t.substring(1),8)}if(n=o*n|0,!i&&n<0)throw Error("illegal id value: "+(o<0?"-":"")+t);return n}function l(t){var i=1;if("-"==t.charAt(0)&&(i=-1,t=t.substring(1)),e.NUMBER_DEC.test(t))return i*parseInt(t,10);if(e.NUMBER_HEX.test(t))return i*parseInt(t.substring(2),16);if(e.NUMBER_OCT.test(t))return i*parseInt(t.substring(1),8);if("inf"===t)return i*(1/0);if("nan"===t)return NaN;if(e.NUMBER_FLT.test(t))return i*parseFloat(t);throw Error("illegal number value: "+(i<0?"-":"")+t)}function c(t,e,i){void 0===t[e]?t[e]=i:(Array.isArray(t[e])||(t[e]=[t[e]]),t[e].push(i))}return a.parse=function(){var t,i,n={name:"[ROOT]",package:null,messages:[],enums:[],imports:[],options:{},services:[]},o=!0;try{for(;t=this.tn.next();)switch(t){case"package":if(!o||null!==n.package)throw Error("unexpected 'package'");if(t=this.tn.next(),!e.TYPEREF.test(t))throw Error("illegal package name: "+t);this.tn.skip(";"),n.package=t;break;case"import":if(!o)throw Error("unexpected 'import'");("public"===(t=this.tn.peek())||(i="weak"===t))&&this.tn.next(),t=this._readString(),this.tn.skip(";"),i||n.imports.push(t);break;case"syntax":if(!o)throw Error("unexpected 'syntax'");this.tn.skip("="),"proto3"===(n.syntax=this._readString())&&(this.proto3=!0),this.tn.skip(";");break;case"message":this._parseMessage(n,null),o=!1;break;case"enum":this._parseEnum(n),o=!1;break;case"option":this._parseOption(n);break;case"service":this._parseService(n);break;case"extend":this._parseExtend(n);break;default:throw Error("unexpected '"+t+"'")}}catch(t){throw t.message="Parse error at line "+this.tn.line+": "+t.message,t}return delete n.name,n},r.parse=function(t){return new r(t).parse()},a._readString=function(){var t,e,i="";do{if("'"!==(e=this.tn.next())&&'"'!==e)throw Error("illegal string delimiter: "+e);i+=this.tn.next(),this.tn.skip(e),t=this.tn.peek()}while('"'===t||'"'===t);return i},a._readValue=function(t){var i=this.tn.peek();if('"'===i||"'"===i)return this._readString();if(this.tn.next(),e.NUMBER.test(i))return l(i);if(e.BOOL.test(i))return"true"===i.toLowerCase();if(t&&e.TYPEREF.test(i))return i;throw Error("illegal value: "+i)},a._parseOption=function(t,i){var n=this.tn.next(),o=!1;if("("===n&&(o=!0,n=this.tn.next()),!e.TYPEREF.test(n))throw Error("illegal option name: "+n);var r=n;o&&(this.tn.skip(")"),r="("+r+")",n=this.tn.peek(),e.FQTYPEREF.test(n)&&(r+=n,this.tn.next())),this.tn.skip("="),this._parseOptionValue(t,r),i||this.tn.skip(";")},a._parseOptionValue=function(t,i){var n=this.tn.peek();if("{"!==n)c(t.options,i,this._readValue(!0));else for(this.tn.skip("{");"}"!==(n=this.tn.next());){if(!e.NAME.test(n))throw Error("illegal option name: "+i+"."+n);this.tn.omit(":")?c(t.options,i+"."+n,this._readValue(!0)):this._parseOptionValue(t,i+"."+n)}},a._parseService=function(t){var i=this.tn.next();if(!e.NAME.test(i))throw Error("illegal service name at line "+this.tn.line+": "+i);var n={name:i,rpc:{},options:{}};for(this.tn.skip("{");"}"!==(i=this.tn.next());)if("option"===i)this._parseOption(n);else{if("rpc"!==i)throw Error("illegal service token: "+i);this._parseServiceRPC(n)}this.tn.omit(";"),t.services.push(n)},a._parseServiceRPC=function(t){var i=this.tn.next();if(!e.NAME.test(i))throw Error("illegal rpc service method name: "+i);var n=i,o={request:null,response:null,request_stream:!1,response_stream:!1,options:{}};if(this.tn.skip("("),"stream"===(i=this.tn.next()).toLowerCase()&&(o.request_stream=!0,i=this.tn.next()),!e.TYPEREF.test(i))throw Error("illegal rpc service request type: "+i);if(o.request=i,this.tn.skip(")"),"returns"!==(i=this.tn.next()).toLowerCase())throw Error("illegal rpc service request type delimiter: "+i);if(this.tn.skip("("),"stream"===(i=this.tn.next()).toLowerCase()&&(o.response_stream=!0,i=this.tn.next()),o.response=i,this.tn.skip(")"),"{"===(i=this.tn.peek())){for(this.tn.next();"}"!==(i=this.tn.next());){if("option"!==i)throw Error("illegal rpc service token: "+i);this._parseOption(o)}this.tn.omit(";")}else this.tn.skip(";");void 0===t.rpc&&(t.rpc={}),t.rpc[n]=o},a._parseMessage=function(t,i){var n=!!i,o=this.tn.next(),r={name:"",fields:[],enums:[],messages:[],options:{},services:[],oneofs:{}};if(!e.NAME.test(o))throw Error("illegal "+(n?"group":"message")+" name: "+o);for(r.name=o,n&&(this.tn.skip("="),i.id=s(this.tn.next()),r.isGroup=!0),"["===(o=this.tn.peek())&&i&&this._parseFieldOptions(i),this.tn.skip("{");"}"!==(o=this.tn.next());)if(e.RULE.test(o))this._parseMessageField(r,o);else if("oneof"===o)this._parseMessageOneOf(r);else if("enum"===o)this._parseEnum(r);else if("message"===o)this._parseMessage(r);else if("option"===o)this._parseOption(r);else if("service"===o)this._parseService(r);else if("extensions"===o)r.hasOwnProperty("extensions")?r.extensions=r.extensions.concat(this._parseExtensionRanges()):r.extensions=this._parseExtensionRanges();else if("reserved"===o)this._parseIgnored();else if("extend"===o)this._parseExtend(r);else{if(!e.TYPEREF.test(o))throw Error("illegal message token: "+o);if(!this.proto3)throw Error("illegal field rule: "+o);this._parseMessageField(r,"optional",o)}return this.tn.omit(";"),t.messages.push(r),r},a._parseIgnored=function(){for(;";"!==this.tn.peek();)this.tn.next();this.tn.skip(";")},a._parseMessageField=function(t,i,n){if(!e.RULE.test(i))throw Error("illegal message field rule: "+i);var o,r={rule:i,type:"",name:"",options:{},id:0};if("map"===i){if(n)throw Error("illegal type: "+n);if(this.tn.skip("<"),o=this.tn.next(),!e.TYPE.test(o)&&!e.TYPEREF.test(o))throw Error("illegal message field type: "+o);if(r.keytype=o,this.tn.skip(","),o=this.tn.next(),!e.TYPE.test(o)&&!e.TYPEREF.test(o))throw Error("illegal message field: "+o);if(r.type=o,this.tn.skip(">"),o=this.tn.next(),!e.NAME.test(o))throw Error("illegal message field name: "+o);r.name=o,this.tn.skip("="),r.id=s(this.tn.next()),"["===(o=this.tn.peek())&&this._parseFieldOptions(r),this.tn.skip(";")}else if("group"===(n=void 0!==n?n:this.tn.next())){var a=this._parseMessage(t,r);if(!/^[A-Z]/.test(a.name))throw Error("illegal group name: "+a.name);r.type=a.name,r.name=a.name.toLowerCase(),this.tn.omit(";")}else{if(!e.TYPE.test(n)&&!e.TYPEREF.test(n))throw Error("illegal message field type: "+n);if(r.type=n,o=this.tn.next(),!e.NAME.test(o))throw Error("illegal message field name: "+o);r.name=o,this.tn.skip("="),r.id=s(this.tn.next()),"["===(o=this.tn.peek())&&this._parseFieldOptions(r),this.tn.skip(";")}return t.fields.push(r),r},a._parseMessageOneOf=function(t){var i=this.tn.next();if(!e.NAME.test(i))throw Error("illegal oneof name: "+i);var n,o=i,r=[];for(this.tn.skip("{");"}"!==(i=this.tn.next());)(n=this._parseMessageField(t,"optional",i)).oneof=o,r.push(n.id);this.tn.omit(";"),t.oneofs[o]=r},a._parseFieldOptions=function(t){this.tn.skip("[");for(var e=!0;"]"!==this.tn.peek();)e||this.tn.skip(","),this._parseOption(t,!0),e=!1;this.tn.next()},a._parseEnum=function(t){var i={name:"",values:[],options:{}},n=this.tn.next();if(!e.NAME.test(n))throw Error("illegal name: "+n);for(i.name=n,this.tn.skip("{");"}"!==(n=this.tn.next());)if("option"===n)this._parseOption(i);else{if(!e.NAME.test(n))throw Error("illegal name: "+n);this.tn.skip("=");var o={name:n,id:s(this.tn.next(),!0)};"["===(n=this.tn.peek())&&this._parseFieldOptions({options:{}}),this.tn.skip(";"),i.values.push(o)}this.tn.omit(";"),t.enums.push(i)},a._parseExtensionRanges=function(){var e,i,n,o=[];do{for(i=[];;){switch(e=this.tn.next()){case"min":n=t.ID_MIN;break;case"max":n=t.ID_MAX;break;default:n=l(e)}if(i.push(n),2===i.length)break;if("to"!==this.tn.peek()){i.push(n);break}this.tn.next()}o.push(i)}while(this.tn.omit(","));return this.tn.skip(";"),o},a._parseExtend=function(t){var i=this.tn.next();if(!e.TYPEREF.test(i))throw Error("illegal extend reference: "+i);var n={ref:i,fields:[]};for(this.tn.skip("{");"}"!==(i=this.tn.next());)if(e.RULE.test(i))this._parseMessageField(n,i);else{if(!e.TYPEREF.test(i))throw Error("illegal extend token: "+i);if(!this.proto3)throw Error("illegal field rule: "+i);this._parseMessageField(n,"optional",i)}return this.tn.omit(";"),t.messages.push(n),n},a.toString=function(){return"Parser at line "+this.tn.line},i.Parser=r,i}(l,l.Lang),l.Reflect=function(e){var i={},n=function(t,e,i){this.builder=t,this.parent=e,this.name=i,this.className},o=n.prototype;o.fqn=function(){for(var t=this.name,e=this;null!=(e=e.parent);)t=e.name+"."+t;return t},o.toString=function(t){return(t?this.className+" ":"")+this.fqn()},o.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},i.T=n;var r=function(t,e,i,o,r){n.call(this,t,e,i),this.className="Namespace",this.children=[],this.options=o||{},this.syntax=r||"proto2"},a=r.prototype=Object.create(n.prototype);a.getChildren=function(t){if(null==(t=t||null))return this.children.slice();for(var e=[],i=0,n=this.children.length;i<n;++i)this.children[i]instanceof t&&e.push(this.children[i]);return e},a.addChild=function(t){var e;if(e=this.getChild(t.name))if(e instanceof u.Field&&e.name!==e.originalName&&null===this.getChild(e.originalName))e.name=e.originalName;else{if(!(t instanceof u.Field&&t.name!==t.originalName&&null===this.getChild(t.originalName)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+t.name);t.name=t.originalName}this.children.push(t)},a.getChild=function(t){for(var e="number"==typeof t?"id":"name",i=0,n=this.children.length;i<n;++i)if(this.children[i][e]===t)return this.children[i];return null},a.resolve=function(t,e){var n,o="string"==typeof t?t.split("."):t,r=this,a=0;if(""===o[a]){for(;null!==r.parent;)r=r.parent;a++}do{do{if(!(r instanceof i.Namespace)){r=null;break}if(!(n=r.getChild(o[a]))||!(n instanceof i.T)||e&&!(n instanceof i.Namespace)){r=null;break}r=n,a++}while(a<o.length);if(null!=r)break;if(null!==this.parent)return this.parent.resolve(t,e)}while(null!=r);return r},a.qn=function(t){for(var e=[],n=t;e.unshift(n.name),null!==(n=n.parent););for(var o=1;o<=e.length;o++){var r=e.slice(e.length-o);if(t===this.resolve(r,t instanceof i.Namespace))return r.join(".")}return t.fqn()},a.build=function(){for(var t,e={},i=this.children,n=0,o=i.length;n<o;++n)(t=i[n])instanceof r&&(e[t.name]=t.build());return Object.defineProperty&&Object.defineProperty(e,"$options",{value:this.buildOpt()}),e},a.buildOpt=function(){for(var t={},e=Object.keys(this.options),i=0,n=e.length;i<n;++i){var o=e[i],r=this.options[e[i]];t[o]=r}return t},a.getOption=function(t){return void 0===t?this.options:void 0!==this.options[t]?this.options[t]:null},i.Namespace=r;var s=function(t,i,n,o,r){if(this.type=t,this.resolvedType=i,this.isMapKey=n,this.syntax=o,this.name=r,n&&e.MAP_KEY_TYPES.indexOf(t)<0)throw Error("Invalid map key type: "+t.name)},l=s.prototype;function c(t,i){if(t&&"number"==typeof t.low&&"number"==typeof t.high&&"boolean"==typeof t.unsigned&&t.low==t.low&&t.high==t.high)return new e.Long(t.low,t.high,void 0===i?t.unsigned:i);if("string"==typeof t)return e.Long.fromString(t,i||!1,10);if("number"==typeof t)return e.Long.fromNumber(t,i||!1);throw Error("not convertible to Long")}s.defaultFieldValue=function(i){if("string"==typeof i&&(i=e.TYPES[i]),void 0===i.defaultValue)throw Error("default value for type "+i.name+" is not supported");return i==e.TYPES.bytes?new t(0):i.defaultValue},l.toString=function(){return(this.name||"")+(this.isMapKey?"map":"value")+" element"},l.verifyValue=function(i){var n=this;function o(t,e){throw Error("Illegal value for "+n.toString(!0)+" of type "+n.type.name+": "+t+" ("+e+")")}switch(this.type){case e.TYPES.int32:case e.TYPES.sint32:case e.TYPES.sfixed32:return("number"!=typeof i||i==i&&i%1!=0)&&o(typeof i,"not an integer"),4294967295<i?0|i:i;case e.TYPES.uint32:case e.TYPES.fixed32:return("number"!=typeof i||i==i&&i%1!=0)&&o(typeof i,"not an integer"),i<0?i>>>0:i;case e.TYPES.int64:case e.TYPES.sint64:case e.TYPES.sfixed64:if(e.Long)try{return c(i,!1)}catch(r){o(typeof i,r.message)}else o(typeof i,"requires Long.js");case e.TYPES.uint64:case e.TYPES.fixed64:if(e.Long)try{return c(i,!0)}catch(r){o(typeof i,r.message)}else o(typeof i,"requires Long.js");case e.TYPES.bool:return"boolean"!=typeof i&&o(typeof i,"not a boolean"),i;case e.TYPES.float:case e.TYPES.double:return"number"!=typeof i&&o(typeof i,"not a number"),i;case e.TYPES.string:return"string"==typeof i||i&&i instanceof String||o(typeof i,"not a string"),""+i;case e.TYPES.bytes:return t.isByteBuffer(i)?i:t.wrap(i,"base64");case e.TYPES.enum:var r=this.resolvedType.getChildren(e.Reflect.Enum.Value);for(s=0;s<r.length;s++){if(r[s].name==i)return r[s].id;if(r[s].id==i)return r[s].id}if("proto3"===this.syntax)return("number"!=typeof i||i==i&&i%1!=0)&&o(typeof i,"not an integer"),(4294967295<i||i<0)&&o(typeof i,"not in range for uint32"),i;o(i,"not a valid enum value");case e.TYPES.group:case e.TYPES.message:if(i&&"object"==typeof i||o(typeof i,"object expected"),i instanceof this.resolvedType.clazz)return i;if(i instanceof e.Builder.Message){var a={};for(var s in i)i.hasOwnProperty(s)&&(a[s]=i[s]);i=a}return new this.resolvedType.clazz(i)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+i+" (undefined type "+this.type+")")},l.calculateLength=function(i,n){if(null===n)return 0;var o;switch(this.type){case e.TYPES.int32:return n<0?t.calculateVarint64(n):t.calculateVarint32(n);case e.TYPES.uint32:return t.calculateVarint32(n);case e.TYPES.sint32:return t.calculateVarint32(t.zigZagEncode32(n));case e.TYPES.fixed32:case e.TYPES.sfixed32:case e.TYPES.float:return 4;case e.TYPES.int64:case e.TYPES.uint64:return t.calculateVarint64(n);case e.TYPES.sint64:return t.calculateVarint64(t.zigZagEncode64(n));case e.TYPES.fixed64:case e.TYPES.sfixed64:return 8;case e.TYPES.bool:return 1;case e.TYPES.enum:return t.calculateVarint32(n);case e.TYPES.double:return 8;case e.TYPES.string:return o=t.calculateUTF8Bytes(n),t.calculateVarint32(o)+o;case e.TYPES.bytes:if(n.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+n.remaining()+" bytes remaining");return t.calculateVarint32(n.remaining())+n.remaining();case e.TYPES.message:return o=this.resolvedType.calculate(n),t.calculateVarint32(o)+o;case e.TYPES.group:return(o=this.resolvedType.calculate(n))+t.calculateVarint32(i<<3|e.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+n+" (unknown type)")},l.encodeValue=function(i,n,o){if(null===n)return o;switch(this.type){case e.TYPES.int32:n<0?o.writeVarint64(n):o.writeVarint32(n);break;case e.TYPES.uint32:o.writeVarint32(n);break;case e.TYPES.sint32:o.writeVarint32ZigZag(n);break;case e.TYPES.fixed32:o.writeUint32(n);break;case e.TYPES.sfixed32:o.writeInt32(n);break;case e.TYPES.int64:case e.TYPES.uint64:o.writeVarint64(n);break;case e.TYPES.sint64:o.writeVarint64ZigZag(n);break;case e.TYPES.fixed64:o.writeUint64(n);break;case e.TYPES.sfixed64:o.writeInt64(n);break;case e.TYPES.bool:"string"==typeof n?o.writeVarint32("false"===n.toLowerCase()?0:!!n):o.writeVarint32(n?1:0);break;case e.TYPES.enum:o.writeVarint32(n);break;case e.TYPES.float:o.writeFloat32(n);break;case e.TYPES.double:o.writeFloat64(n);break;case e.TYPES.string:o.writeVString(n);break;case e.TYPES.bytes:if(n.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+n.remaining()+" bytes remaining");var r=n.offset;o.writeVarint32(n.remaining()),o.append(n),n.offset=r;break;case e.TYPES.message:var a=(new t).LE();this.resolvedType.encode(n,a),o.writeVarint32(a.offset),o.append(a.flip());break;case e.TYPES.group:this.resolvedType.encode(n,o),o.writeVarint32(i<<3|e.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+n+" (unknown type)")}return o},l.decode=function(t,i,n){if(i!=this.type.wireType)throw Error("Unexpected wire type for element");var o,r;switch(this.type){case e.TYPES.int32:return 0|t.readVarint32();case e.TYPES.uint32:return t.readVarint32()>>>0;case e.TYPES.sint32:return 0|t.readVarint32ZigZag();case e.TYPES.fixed32:return t.readUint32()>>>0;case e.TYPES.sfixed32:return 0|t.readInt32();case e.TYPES.int64:return t.readVarint64();case e.TYPES.uint64:return t.readVarint64().toUnsigned();case e.TYPES.sint64:return t.readVarint64ZigZag();case e.TYPES.fixed64:return t.readUint64();case e.TYPES.sfixed64:return t.readInt64();case e.TYPES.bool:return!!t.readVarint32();case e.TYPES.enum:return t.readVarint32();case e.TYPES.float:return t.readFloat();case e.TYPES.double:return t.readDouble();case e.TYPES.string:return t.readVString();case e.TYPES.bytes:if(r=t.readVarint32(),t.remaining()<r)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+r+" required but got only "+t.remaining());return(o=t.clone()).limit=o.offset+r,t.offset+=r,o;case e.TYPES.message:return r=t.readVarint32(),this.resolvedType.decode(t,r);case e.TYPES.group:return this.resolvedType.decode(t,-1,n)}throw Error("[INTERNAL] Illegal decode type")},l.valueFromString=function(i){if(!this.isMapKey)throw Error("valueFromString() called on non-map-key element");switch(this.type){case e.TYPES.int32:case e.TYPES.sint32:case e.TYPES.sfixed32:case e.TYPES.uint32:case e.TYPES.fixed32:return this.verifyValue(parseInt(i));case e.TYPES.int64:case e.TYPES.sint64:case e.TYPES.sfixed64:case e.TYPES.uint64:case e.TYPES.fixed64:return this.verifyValue(i);case e.TYPES.bool:return"true"===i;case e.TYPES.string:return this.verifyValue(i);case e.TYPES.bytes:return t.fromBinary(i)}},l.valueToString=function(t){if(!this.isMapKey)throw Error("valueToString() called on non-map-key element");return this.type===e.TYPES.bytes?t.toString("binary"):t.toString()},i.Element=s;var u=function(t,e,i,n,o,a){r.call(this,t,e,i,n,a),this.className="Message",this.extensions=void 0,this.clazz=null,this.isGroup=!!o,this._fields=null,this._fieldsById=null,this._fieldsByName=null},h=u.prototype=Object.create(r.prototype);function d(t,i){var n=i.readVarint32(),o=7&n,r=n>>>3;switch(o){case e.WIRE_TYPES.VARINT:for(;128==(128&(n=i.readUint8())););break;case e.WIRE_TYPES.BITS64:i.offset+=8;break;case e.WIRE_TYPES.LDELIM:n=i.readVarint32(),i.offset+=n;break;case e.WIRE_TYPES.STARTGROUP:d(r,i);break;case e.WIRE_TYPES.ENDGROUP:if(r===t)return!1;throw Error("Illegal GROUPEND after unknown group: "+r+" ("+t+" expected)");case e.WIRE_TYPES.BITS32:i.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+t+": "+o)}return!0}h.build=function(i){if(this.clazz&&!i)return this.clazz;var n=function(e,i){var n=i.getChildren(e.Reflect.Message.Field),o=i.getChildren(e.Reflect.Message.OneOf),r=function(a,s){e.Builder.Message.call(this);for(var l=0,c=o.length;l<c;++l)this[o[l].name]=null;for(l=0,c=n.length;l<c;++l){var u=n[l];this[u.name]=u.repeated?[]:u.map?new e.Map(u):null,!u.required&&"proto3"!==i.syntax||null===u.defaultValue||(this[u.name]=u.defaultValue)}var h;if(0<arguments.length)if(1!==arguments.length||null===a||"object"!=typeof a||!("function"!=typeof a.encode||a instanceof r)||Array.isArray(a)||a instanceof e.Map||t.isByteBuffer(a)||a instanceof ArrayBuffer||e.Long&&a instanceof e.Long)for(l=0,c=arguments.length;l<c;++l)void 0!==(h=arguments[l])&&this.$set(n[l].name,h);else this.$set(a)},a=r.prototype=Object.create(e.Builder.Message.prototype);a.add=function(t,n,o){var r=i._fieldsByName[t];if(!o){if(!r)throw Error(this+"#"+t+" is undefined");if(!(r instanceof e.Reflect.Message.Field))throw Error(this+"#"+t+" is not a field: "+r.toString(!0));if(!r.repeated)throw Error(this+"#"+t+" is not a repeated field");n=r.verifyValue(n,!0)}return null===this[t]&&(this[t]=[]),this[t].push(n),this},a.$add=a.add,a.set=function(t,n,o){if(t&&"object"==typeof t){for(var r in o=n,t)t.hasOwnProperty(r)&&void 0!==(n=t[r])&&void 0===i._oneofsByName[r]&&this.$set(r,n,o);return this}var a=i._fieldsByName[t];if(o)this[t]=n;else{if(!a)throw Error(this+"#"+t+" is not a field: undefined");if(!(a instanceof e.Reflect.Message.Field))throw Error(this+"#"+t+" is not a field: "+a.toString(!0));this[a.name]=n=a.verifyValue(n)}if(a&&a.oneof){var s=this[a.oneof.name];null!==n?(null!==s&&s!==a.name&&(this[s]=null),this[a.oneof.name]=a.name):s===t&&(this[a.oneof.name]=null)}return this},a.$set=a.set,a.get=function(t,n){if(n)return this[t];var o=i._fieldsByName[t];if(!(o&&o instanceof e.Reflect.Message.Field))throw Error(this+"#"+t+" is not a field: undefined");if(!(o instanceof e.Reflect.Message.Field))throw Error(this+"#"+t+" is not a field: "+o.toString(!0));return this[o.name]},a.$get=a.get;for(var s=0;s<n.length;s++){var l=n[s];l instanceof e.Reflect.Message.ExtensionField||i.builder.options.populateAccessors&&function(t){var e=t.originalName.replace(/(_[a-zA-Z])/g,function(t){return t.toUpperCase().replace("_","")});e=e.substring(0,1).toUpperCase()+e.substring(1);var n=t.originalName.replace(/([A-Z])/g,function(t){return"_"+t}),o=function(e,i){return this[t.name]=i?e:t.verifyValue(e),this},r=function(){return this[t.name]};null===i.getChild("set"+e)&&(a["set"+e]=o),null===i.getChild("set_"+n)&&(a["set_"+n]=o),null===i.getChild("get"+e)&&(a["get"+e]=r),null===i.getChild("get_"+n)&&(a["get_"+n]=r)}(l)}function c(i,n,o,r){if(null===i||"object"!=typeof i){if(r&&r instanceof e.Reflect.Enum){var a=e.Reflect.Enum.getName(r.object,i);if(null!==a)return a}return i}if(t.isByteBuffer(i))return n?i.toBase64():i.toBuffer();if(e.Long.isLong(i))return o?i.toString():e.Long.fromValue(i);var s;if(Array.isArray(i))return s=[],i.forEach(function(t,e){s[e]=c(t,n,o,r)}),s;if(s={},i instanceof e.Map){for(var l=i.entries(),u=l.next();!u.done;u=l.next())s[i.keyElem.valueToString(u.value[0])]=c(u.value[1],n,o,i.valueElem.resolvedType);return s}var h=i.$type,d=void 0;for(var p in i)i.hasOwnProperty(p)&&(h&&(d=h.getChild(p))?s[p]=c(i[p],n,o,d.resolvedType):s[p]=c(i[p],n,o));return s}return a.encode=function(e,n){"boolean"==typeof e&&(n=e,e=void 0);var o=!1;e||(e=new t,o=!0);var r=e.littleEndian;try{return i.encode(this,e.LE(),n),(o?e.flip():e).LE(r)}catch(n){throw e.LE(r),n}},r.encode=function(t,e,i){return new r(t).encode(e,i)},a.calculate=function(){return i.calculate(this)},a.encodeDelimited=function(e,n){var o=!1;e||(e=new t,o=!0);var r=(new t).LE();return i.encode(this,r,n).flip(),e.writeVarint32(r.remaining()),e.append(r),o?e.flip():e},a.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(t){throw t.encoded&&(t.encoded=t.encoded.toArrayBuffer()),t}},a.toArrayBuffer=a.encodeAB,a.encodeNB=function(){try{return this.encode().toBuffer()}catch(t){throw t.encoded&&(t.encoded=t.encoded.toBuffer()),t}},a.toBuffer=a.encodeNB,a.encode64=function(){try{return this.encode().toBase64()}catch(t){throw t.encoded&&(t.encoded=t.encoded.toBase64()),t}},a.toBase64=a.encode64,a.encodeHex=function(){try{return this.encode().toHex()}catch(t){throw t.encoded&&(t.encoded=t.encoded.toHex()),t}},a.toHex=a.encodeHex,a.toRaw=function(t,e){return c(this,!!t,!!e,this.$type)},a.encodeJSON=function(){return JSON.stringify(c(this,!0,!0,this.$type))},r.decode=function(e,n,o){"string"==typeof n&&(o=n,n=-1),"string"==typeof e?e=t.wrap(e,o||"base64"):t.isByteBuffer(e)||(e=t.wrap(e));var r=e.littleEndian;try{var a=i.decode(e.LE(),n);return e.LE(r),a}catch(n){throw e.LE(r),n}},r.decodeDelimited=function(e,n){if("string"==typeof e?e=t.wrap(e,n||"base64"):t.isByteBuffer(e)||(e=t.wrap(e)),e.remaining()<1)return null;var o=e.offset,r=e.readVarint32();if(e.remaining()<r)return e.offset=o,null;try{var a=i.decode(e.slice(e.offset,e.offset+r).LE());return e.offset+=r,a}catch(n){throw e.offset+=r,n}},r.decode64=function(t){return r.decode(t,"base64")},r.decodeHex=function(t){return r.decode(t,"hex")},r.decodeJSON=function(t){return new r(JSON.parse(t))},a.toString=function(){return i.toString()},Object.defineProperty&&(Object.defineProperty(r,"$options",{value:i.buildOpt()}),Object.defineProperty(a,"$options",{value:r.$options}),Object.defineProperty(r,"$type",{value:i}),Object.defineProperty(a,"$type",{value:i})),r}(e,this);this._fields=[],this._fieldsById={},this._fieldsByName={},this._oneofsByName={};for(var o,r=0,a=this.children.length;r<a;r++)if((o=this.children[r])instanceof g||o instanceof u||o instanceof b){if(n.hasOwnProperty(o.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+o.toString(!0)+" cannot override static property '"+o.name+"'");n[o.name]=o.build()}else if(o instanceof u.Field)o.build(),this._fields.push(o),this._fieldsById[o.id]=o,this._fieldsByName[o.name]=o;else if(o instanceof u.OneOf)this._oneofsByName[o.name]=o;else if(!(o instanceof u.OneOf||o instanceof y))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[r].toString(!0));return this.clazz=n},h.encode=function(t,e,i){for(var n,o,r=null,a=0,s=this._fields.length;a<s;++a)o=t[(n=this._fields[a]).name],n.required&&null===o?null===r&&(r=n):n.encode(i?o:n.verifyValue(o),e,t);if(null===r)return e;var l=Error("Missing at least one required field for "+this.toString(!0)+": "+r);throw l.encoded=e,l},h.calculate=function(t){for(var e,i,n=0,o=0,r=this._fields.length;o<r;++o){if(i=t[(e=this._fields[o]).name],e.required&&null===i)throw Error("Missing at least one required field for "+this.toString(!0)+": "+e);n+=e.calculate(i,t)}return n},h.decode=function(t,i,n){"number"!=typeof i&&(i=-1);for(var o,r,a,s,l=t.offset,c=new this.clazz;t.offset<l+i||-1===i&&0<t.remaining();){if(a=(o=t.readVarint32())>>>3,(r=7&o)===e.WIRE_TYPES.ENDGROUP){if(a!==n)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+a+" ("+(n?n+" expected":"not a group")+")");break}if(s=this._fieldsById[a]){if(s.repeated&&!s.options.packed)c[s.name].push(s.decode(r,t));else if(s.map){var u=s.decode(r,t);c[s.name].set(u[0],u[1])}else if(c[s.name]=s.decode(r,t),s.oneof){var h=c[s.oneof.name];null!==h&&h!==s.name&&(c[h]=null),c[s.oneof.name]=s.name}}else switch(r){case e.WIRE_TYPES.VARINT:t.readVarint32();break;case e.WIRE_TYPES.BITS32:t.offset+=4;break;case e.WIRE_TYPES.BITS64:t.offset+=8;break;case e.WIRE_TYPES.LDELIM:var p=t.readVarint32();t.offset+=p;break;case e.WIRE_TYPES.STARTGROUP:for(;d(a,t););break;default:throw Error("Illegal wire type for unknown field "+a+" in "+this.toString(!0)+"#decode: "+r)}}for(var f=0,m=this._fields.length;f<m;++f)if(null===c[(s=this._fields[f]).name])if("proto3"===this.syntax)c[s.name]=s.defaultValue;else{if(s.required){var g=Error("Missing at least one required field for "+this.toString(!0)+": "+s.name);throw g.decoded=c,g}e.populateDefaults&&null!==s.defaultValue&&(c[s.name]=s.defaultValue)}return c},i.Message=u;var p=function(t,i,o,r,a,s,l,c,h,d){n.call(this,t,i,s),this.className="Message.Field",this.required="required"===o,this.repeated="repeated"===o,this.map="map"===o,this.keyType=r||null,this.type=a,this.resolvedType=null,this.id=l,this.options=c||{},this.defaultValue=null,this.oneof=h||null,this.syntax=d||"proto2",this.originalName=this.name,this.element=null,this.keyElement=null,!this.builder.options.convertFieldsToCamelCase||this instanceof u.ExtensionField||(this.name=e.Util.toCamelCase(this.name))},f=p.prototype=Object.create(n.prototype);f.build=function(){this.element=new s(this.type,this.resolvedType,!1,this.syntax,this.name),this.map&&(this.keyElement=new s(this.keyType,void 0,!0,this.syntax,this.name)),"proto3"!==this.syntax||this.repeated||this.map?void 0!==this.options.default&&(this.defaultValue=this.verifyValue(this.options.default)):this.defaultValue=s.defaultFieldValue(this.type)},f.verifyValue=function(t,i){i=i||!1;var n,o=this;function r(t,e){throw Error("Illegal value for "+o.toString(!0)+" of type "+o.type.name+": "+t+" ("+e+")")}if(null===t)return this.required&&r(typeof t,"required"),"proto3"===this.syntax&&this.type!==e.TYPES.message&&r(typeof t,"proto3 field without field presence cannot be null"),null;if(!this.repeated||i)return this.map&&!i?t instanceof e.Map?t:(t instanceof Object||r(typeof t,"expected ProtoBuf.Map or raw object for map field"),new e.Map(this,t)):(!this.repeated&&Array.isArray(t)&&r(typeof t,"no array expected"),this.element.verifyValue(t));Array.isArray(t)||(t=[t]);var a=[];for(n=0;n<t.length;n++)a.push(this.element.verifyValue(t[n]));return a},f.hasWirePresence=function(t,i){if("proto3"!==this.syntax)return null!==t;if(this.oneof&&i[this.oneof.name]===this.name)return!0;switch(this.type){case e.TYPES.int32:case e.TYPES.sint32:case e.TYPES.sfixed32:case e.TYPES.uint32:case e.TYPES.fixed32:return 0!==t;case e.TYPES.int64:case e.TYPES.sint64:case e.TYPES.sfixed64:case e.TYPES.uint64:case e.TYPES.fixed64:return 0!==t.low||0!==t.high;case e.TYPES.bool:return t;case e.TYPES.float:case e.TYPES.double:return 0!==t;case e.TYPES.string:return 0<t.length;case e.TYPES.bytes:return 0<t.remaining();case e.TYPES.enum:return 0!==t;case e.TYPES.message:return null!==t;default:return!0}},f.encode=function(i,n,o){if(null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===i||this.repeated&&0==i.length)return n;try{var r;if(this.repeated)if(this.options.packed&&0<=e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)){n.writeVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),n.ensureCapacity(n.offset+=1);var a=n.offset;for(r=0;r<i.length;r++)this.element.encodeValue(this.id,i[r],n);var s=n.offset-a,l=t.calculateVarint32(s);if(1<l){var c=n.slice(a,n.offset);a+=l-1,n.offset=a,n.append(c)}n.writeVarint32(s,a-l)}else for(r=0;r<i.length;r++)n.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,i[r],n);else this.map?i.forEach(function(i,o,r){var a=t.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,o)+t.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,i);n.writeVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),n.writeVarint32(a),n.writeVarint32(8|this.keyType.wireType),this.keyElement.encodeValue(1,o,n),n.writeVarint32(16|this.type.wireType),this.element.encodeValue(2,i,n)},this):this.hasWirePresence(i,o)&&(n.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,i,n))}catch(o){throw Error("Illegal value for "+this.toString(!0)+": "+i+" ("+o+")")}return n},f.calculate=function(i,n){if(i=this.verifyValue(i),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===i||this.repeated&&0==i.length)return 0;var o=0;try{var r,a;if(this.repeated)if(this.options.packed&&0<=e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)){for(o+=t.calculateVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),r=a=0;r<i.length;r++)a+=this.element.calculateLength(this.id,i[r]);o+=t.calculateVarint32(a),o+=a}else for(r=0;r<i.length;r++)o+=t.calculateVarint32(this.id<<3|this.type.wireType),o+=this.element.calculateLength(this.id,i[r]);else this.map?i.forEach(function(i,n,r){var a=t.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,n)+t.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,i);o+=t.calculateVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),o+=t.calculateVarint32(a),o+=a},this):this.hasWirePresence(i,n)&&(o+=t.calculateVarint32(this.id<<3|this.type.wireType),o+=this.element.calculateLength(this.id,i))}catch(n){throw Error("Illegal value for "+this.toString(!0)+": "+i+" ("+n+")")}return o},f.decode=function(t,i,n){var o,r;if(!(!this.map&&t==this.type.wireType||!n&&this.repeated&&this.options.packed&&t==e.WIRE_TYPES.LDELIM||this.map&&t==e.WIRE_TYPES.LDELIM))throw Error("Illegal wire type for field "+this.toString(!0)+": "+t+" ("+this.type.wireType+" expected)");if(t==e.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&0<=e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)&&!n){r=i.readVarint32(),r=i.offset+r;for(var a=[];i.offset<r;)a.push(this.decode(this.type.wireType,i,!0));return a}if(this.map){var l=s.defaultFieldValue(this.keyType);if(o=s.defaultFieldValue(this.type),r=i.readVarint32(),i.remaining()<r)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+r+" required but got only "+i.remaining());var c=i.clone();for(c.limit=c.offset+r,i.offset+=r;0<c.remaining();){var u=c.readVarint32();t=7&u;var h=u>>>3;if(1===h)l=this.keyElement.decode(c,t,h);else{if(2!==h)throw Error("Unexpected tag in map field key/value submessage");o=this.element.decode(c,t,h)}}return[l,o]}return this.element.decode(i,t,this.id)},i.Message.Field=p;var m=function(t,e,i,n,o,r,a){p.call(this,t,e,i,null,n,o,r,a),this.extension};m.prototype=Object.create(p.prototype),i.Message.ExtensionField=m,i.Message.OneOf=function(t,e,i){n.call(this,t,e,i),this.fields=[]};var g=function(t,e,i,n,o){r.call(this,t,e,i,n,o),this.className="Enum",this.object=null};g.getName=function(t,e){for(var i,n=Object.keys(t),o=0;o<n.length;++o)if(t[i=n[o]]===e)return i;return null},(g.prototype=Object.create(r.prototype)).build=function(t){if(this.object&&!t)return this.object;for(var i=new e.Builder.Enum,n=this.getChildren(g.Value),o=0,r=n.length;o<r;++o)i[n[o].name]=n[o].id;return Object.defineProperty&&Object.defineProperty(i,"$options",{value:this.buildOpt(),enumerable:!1}),this.object=i},i.Enum=g;var v=function(t,e,i,o){n.call(this,t,e,i),this.className="Enum.Value",this.id=o};v.prototype=Object.create(n.prototype),i.Enum.Value=v;var y=function(t,e,i,o){n.call(this,t,e,i),this.field=o};y.prototype=Object.create(n.prototype),i.Extension=y;var b=function(t,e,i,n){r.call(this,t,e,i,n),this.className="Service",this.clazz=null};(b.prototype=Object.create(r.prototype)).build=function(i){return this.clazz&&!i?this.clazz:this.clazz=function(e,i){for(var n=function(t){e.Builder.Service.call(this),this.rpcImpl=t||function(t,e,i){setTimeout(i.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},o=n.prototype=Object.create(e.Builder.Service.prototype),r=i.getChildren(e.Reflect.Service.RPCMethod),a=0;a<r.length;a++)!function(e){o[e.name]=function(n,o){try{try{n=e.resolvedRequestType.clazz.decode(t.wrap(n))}catch(n){if(!(n instanceof TypeError))throw n}if(null===n||"object"!=typeof n)throw Error("Illegal arguments");n instanceof e.resolvedRequestType.clazz||(n=new e.resolvedRequestType.clazz(n)),this.rpcImpl(e.fqn(),n,function(t,n){if(t)o(t);else{null===n&&(n="");try{n=e.resolvedResponseType.clazz.decode(n)}catch(t){}n&&n instanceof e.resolvedResponseType.clazz?o(null,n):o(Error("Illegal response type received in service method "+i.name+"#"+e.name))}})}catch(n){setTimeout(o.bind(this,n),0)}},n[e.name]=function(t,i,o){new n(t)[e.name](i,o)},Object.defineProperty&&(Object.defineProperty(n[e.name],"$options",{value:e.buildOpt()}),Object.defineProperty(o[e.name],"$options",{value:n[e.name].$options}))}(r[a]);return Object.defineProperty&&(Object.defineProperty(n,"$options",{value:i.buildOpt()}),Object.defineProperty(o,"$options",{value:n.$options}),Object.defineProperty(n,"$type",{value:i}),Object.defineProperty(o,"$type",{value:i})),n}(e,this)},i.Service=b;var w=function(t,e,i,o){n.call(this,t,e,i),this.className="Service.Method",this.options=o||{}};(w.prototype=Object.create(n.prototype)).buildOpt=a.buildOpt,i.Service.Method=w;var x=function(t,e,i,n,o,r,a,s){w.call(this,t,e,i,s),this.className="Service.RPCMethod",this.requestName=n,this.responseName=o,this.requestStream=r,this.responseStream=a,this.resolvedRequestType=null,this.resolvedResponseType=null};return x.prototype=Object.create(w.prototype),i.Service.RPCMethod=x,i}(l),l.Builder=(o=(n=l).Lang,r=l.Reflect,s=(a=function(t){this.ns=new r.Namespace(this,null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null,this.options=t||{}}).prototype,a.isMessage=function(t){return"string"==typeof t.name&&void 0===t.values&&void 0===t.rpc},a.isMessageField=function(t){return"string"==typeof t.rule&&"string"==typeof t.name&&"string"==typeof t.type&&void 0!==t.id},a.isEnum=function(t){return"string"==typeof t.name&&!(void 0===t.values||!Array.isArray(t.values)||0===t.values.length)},a.isService=function(t){return!("string"!=typeof t.name||"object"!=typeof t.rpc||!t.rpc)},a.isExtend=function(t){return"string"==typeof t.ref},s.reset=function(){return this.ptr=this.ns,this},s.define=function(t){if("string"!=typeof t||!o.TYPEREF.test(t))throw Error("illegal namespace: "+t);return t.split(".").forEach(function(t){var e=this.ptr.getChild(t);null===e&&this.ptr.addChild(e=new r.Namespace(this,this.ptr,t)),this.ptr=e},this),this},s.create=function(t){if(!t)return this;if(Array.isArray(t)){if(0===t.length)return this;t=t.slice()}else t=[t];for(var e=[t];0<e.length;){if(t=e.pop(),!Array.isArray(t))throw Error("not a valid namespace: "+JSON.stringify(t));for(;0<t.length;){var i=t.shift();if(a.isMessage(i)){var o=new r.Message(this,this.ptr,i.name,i.options,i.isGroup,i.syntax),s={};i.oneofs&&Object.keys(i.oneofs).forEach(function(t){o.addChild(s[t]=new r.Message.OneOf(this,o,t))},this),i.fields&&i.fields.forEach(function(t){if(null!==o.getChild(0|t.id))throw Error("duplicate or invalid field id in "+o.name+": "+t.id);if(t.options&&"object"!=typeof t.options)throw Error("illegal field options in "+o.name+"#"+t.name);var e=null;if("string"==typeof t.oneof&&!(e=s[t.oneof]))throw Error("illegal oneof in "+o.name+"#"+t.name+": "+t.oneof);t=new r.Message.Field(this,o,t.rule,t.keytype,t.type,t.name,t.id,t.options,e,i.syntax),e&&e.fields.push(t),o.addChild(t)},this);var l=[];if(i.enums&&i.enums.forEach(function(t){l.push(t)}),i.messages&&i.messages.forEach(function(t){l.push(t)}),i.services&&i.services.forEach(function(t){l.push(t)}),i.extensions&&("number"==typeof i.extensions[0]?o.extensions=[i.extensions]:o.extensions=i.extensions),this.ptr.addChild(o),0<l.length){e.push(t),t=l,l=null,this.ptr=o,o=null;continue}l=null}else if(a.isEnum(i))o=new r.Enum(this,this.ptr,i.name,i.options,i.syntax),i.values.forEach(function(t){o.addChild(new r.Enum.Value(this,o,t.name,t.id))},this),this.ptr.addChild(o);else if(a.isService(i))o=new r.Service(this,this.ptr,i.name,i.options),Object.keys(i.rpc).forEach(function(t){var e=i.rpc[t];o.addChild(new r.Service.RPCMethod(this,o,t,e.request,e.response,!!e.request_stream,!!e.response_stream,e.options))},this),this.ptr.addChild(o);else{if(!a.isExtend(i))throw Error("not a valid definition: "+JSON.stringify(i));if(o=this.ptr.resolve(i.ref,!0))i.fields.forEach(function(t){if(null!==o.getChild(0|t.id))throw Error("duplicate extended field id in "+o.name+": "+t.id);if(o.extensions){var e=!1;if(o.extensions.forEach(function(i){t.id>=i[0]&&t.id<=i[1]&&(e=!0)}),!e)throw Error("illegal extended field id in "+o.name+": "+t.id+" (not within valid ranges)")}var i=t.name;this.options.convertFieldsToCamelCase&&(i=n.Util.toCamelCase(i));var a=new r.Message.ExtensionField(this,o,t.rule,t.type,this.ptr.fqn()+"."+i,t.id,t.options),s=new r.Extension(this,this.ptr,t.name,a);a.extension=s,this.ptr.addChild(s),o.addChild(a)},this);else if(!/\.?google\.protobuf\./.test(i.ref))throw Error("extended message "+i.ref+" is not defined")}o=i=null}t=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},s.import=function(t,e){var i="/";if("string"==typeof e){if(n.Util.IS_NODE&&(e=Ln.resolve(e)),!0===this.files[e])return this.reset();this.files[e]=!0}else if("object"==typeof e){var o,r=e.root;if(n.Util.IS_NODE&&(r=Ln.resolve(r)),(0<=r.indexOf("\\")||0<=e.file.indexOf("\\"))&&(i="\\"),o=n.Util.IS_NODE?Ln.join(r,e.file):r+i+e.file,!0===this.files[o])return this.reset();this.files[o]=!0}if(t.imports&&0<t.imports.length){var a,s=!1;"object"==typeof e?(this.importRoot=e.root,s=!0,a=this.importRoot,e=e.file,(0<=a.indexOf("\\")||0<=e.indexOf("\\"))&&(i="\\")):"string"==typeof e?this.importRoot?a=this.importRoot:0<=e.indexOf("/")?""===(a=e.replace(/\/[^\/]*$/,""))&&(a="/"):0<=e.indexOf("\\")?(a=e.replace(/\\[^\\]*$/,""),i="\\"):a=".":a=null;for(var l=0;l<t.imports.length;l++)if("string"==typeof t.imports[l]){if(!a)throw Error("cannot determine import root");var c=t.imports[l];if("google/protobuf/descriptor.proto"===c)continue;if(c=n.Util.IS_NODE?Ln.join(a,c):a+i+c,!0===this.files[c])continue;/\.proto$/i.test(c)&&!n.DotProto&&(c=c.replace(/\.proto$/,".json"));var u=n.Util.fetch(c);if(null===u)throw Error("failed to import '"+c+"' in '"+e+"': file not found");/\.json$/i.test(c)?this.import(JSON.parse(u+""),c):this.import(n.DotProto.Parser.parse(u),c)}else e?/\.(\w+)$/.test(e)?this.import(t.imports[l],e.replace(/^(.+)\.(\w+)$/,function(t,e,i){return e+"_import"+l+"."+i})):this.import(t.imports[l],e+"_import"+l):this.import(t.imports[l]);s&&(this.importRoot=null)}t.package&&this.define(t.package),t.syntax&&function t(e){e.messages&&e.messages.forEach(function(i){i.syntax=e.syntax,t(i)}),e.enums&&e.enums.forEach(function(t){t.syntax=e.syntax})}(t);var h=this.ptr;return t.options&&Object.keys(t.options).forEach(function(e){h.options[e]=t.options[e]}),t.messages&&(this.create(t.messages),this.ptr=h),t.enums&&(this.create(t.enums),this.ptr=h),t.services&&(this.create(t.services),this.ptr=h),t.extends&&this.create(t.extends),this.reset()},s.resolveAll=function(){var t;if(null==this.ptr||"object"==typeof this.ptr.type)return this;if(this.ptr instanceof r.Namespace)this.ptr.children.forEach(function(t){this.ptr=t,this.resolveAll()},this);else if(this.ptr instanceof r.Message.Field){if(o.TYPE.test(this.ptr.type))this.ptr.type=n.TYPES[this.ptr.type];else{if(!o.TYPEREF.test(this.ptr.type))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(!(t=(this.ptr instanceof r.Message.ExtensionField?this.ptr.extension.parent:this.ptr.parent).resolve(this.ptr.type,!0)))throw Error("unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if((this.ptr.resolvedType=t)instanceof r.Enum){if(this.ptr.type=n.TYPES.enum,"proto3"===this.ptr.syntax&&"proto3"!==t.syntax)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(t instanceof r.Message))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=t.isGroup?n.TYPES.group:n.TYPES.message}}if(this.ptr.map){if(!o.TYPE.test(this.ptr.keyType))throw Error("illegal key type for map field in "+this.ptr.toString(!0)+": "+this.ptr.keyType);this.ptr.keyType=n.TYPES[this.ptr.keyType]}"proto3"===this.ptr.syntax&&this.ptr.repeated&&void 0===this.ptr.options.packed&&-1!==n.PACKABLE_WIRE_TYPES.indexOf(this.ptr.type.wireType)&&(this.ptr.options.packed=!0)}else if(this.ptr instanceof n.Reflect.Service.Method){if(!(this.ptr instanceof n.Reflect.Service.RPCMethod))throw Error("illegal service type in "+this.ptr.toString(!0));if(!((t=this.ptr.parent.resolve(this.ptr.requestName,!0))&&t instanceof n.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=t,!((t=this.ptr.parent.resolve(this.ptr.responseName,!0))&&t instanceof n.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=t}else if(!(this.ptr instanceof n.Reflect.Message.OneOf||this.ptr instanceof n.Reflect.Extension||this.ptr instanceof n.Reflect.Enum.Value))throw Error("illegal object in namespace: "+typeof this.ptr+": "+this.ptr);return this.reset()},s.build=function(t){if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null===this.result&&(this.result=this.ns.build()),!t)return this.result;for(var e="string"==typeof t?t.split("."):t,i=this.result,n=0;n<e.length;n++){if(!i[e[n]]){i=null;break}i=i[e[n]]}return i},s.lookup=function(t,e){return t?this.ns.resolve(t,e):this.ns},s.toString=function(){return"Builder"},a.Message=function(){},a.Enum=function(){},a.Service=function(){},a),l.Map=function(t,e){var i=function(t,i){if(!t.map)throw Error("field is not a map");if(this.field=t,this.keyElem=new e.Element(t.keyType,null,!0,t.syntax),this.valueElem=new e.Element(t.type,t.resolvedType,!1,t.syntax),this.map={},Object.defineProperty(this,"size",{get:function(){return Object.keys(this.map).length}}),i)for(var n=Object.keys(i),o=0;o<n.length;o++){var r=this.keyElem.valueFromString(n[o]),a=this.valueElem.verifyValue(i[n[o]]);this.map[this.keyElem.valueToString(r)]={key:r,value:a}}},n=i.prototype;function o(t){var e=0;return{next:function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}}return n.clear=function(){this.map={}},n.delete=function(t){var e=this.keyElem.valueToString(this.keyElem.verifyValue(t)),i=e in this.map;return delete this.map[e],i},n.entries=function(){for(var t,e=[],i=Object.keys(this.map),n=0;n<i.length;n++)e.push([(t=this.map[i[n]]).key,t.value]);return o(e)},n.keys=function(){for(var t=[],e=Object.keys(this.map),i=0;i<e.length;i++)t.push(this.map[e[i]].key);return o(t)},n.values=function(){for(var t=[],e=Object.keys(this.map),i=0;i<e.length;i++)t.push(this.map[e[i]].value);return o(t)},n.forEach=function(t,e){for(var i,n=Object.keys(this.map),o=0;o<n.length;o++)t.call(e,(i=this.map[n[o]]).value,i.key,this)},n.set=function(t,e){var i=this.keyElem.verifyValue(t),n=this.valueElem.verifyValue(e);return this.map[this.keyElem.valueToString(i)]={key:i,value:n},this},n.get=function(t){var e=this.keyElem.valueToString(this.keyElem.verifyValue(t));if(e in this.map)return this.map[e].value},n.has=function(t){return this.keyElem.valueToString(this.keyElem.verifyValue(t))in this.map},i}(0,l.Reflect),l.loadProto=function(t,e,i){return("string"==typeof e||e&&"string"==typeof e.file&&"string"==typeof e.root)&&(i=e,e=void 0),l.loadJson(l.DotProto.Parser.parse(t),e,i)},l.protoFromString=l.loadProto,l.loadProtoFile=function(t,e,i){if(e&&"object"==typeof e?(i=e,e=null):e&&"function"==typeof e||(e=null),e)return l.Util.fetch("string"==typeof t?t:t.root+"/"+t.file,function(n){if(null!==n)try{e(null,l.loadProto(n,i,t))}catch(n){e(n)}else e(Error("Failed to fetch file"))});var n=l.Util.fetch("object"==typeof t?t.root+"/"+t.file:t);return null===n?null:l.loadProto(n,i,t)},l.protoFromFile=l.loadProtoFile,l.newBuilder=function(t){return void 0===(t=t||{}).convertFieldsToCamelCase&&(t.convertFieldsToCamelCase=l.convertFieldsToCamelCase),void 0===t.populateAccessors&&(t.populateAccessors=l.populateAccessors),new l.Builder(t)},l.loadJson=function(t,e,i){return("string"==typeof e||e&&"string"==typeof e.file&&"string"==typeof e.root)&&(i=e,e=null),e&&"object"==typeof e||(e=l.newBuilder()),"string"==typeof t&&(t=JSON.parse(t)),e.import(t,i),e.resolveAll(),e},l.loadJsonFile=function(t,e,i){if(e&&"object"==typeof e?(i=e,e=null):e&&"function"==typeof e||(e=null),e)return l.Util.fetch("string"==typeof t?t:t.root+"/"+t.file,function(n){if(null!==n)try{e(null,l.loadJson(JSON.parse(n),i,t))}catch(n){e(n)}else e(Error("Failed to fetch file"))});var n=l.Util.fetch("object"==typeof t?t.root+"/"+t.file:t);return null===n?null:l.loadJson(JSON.parse(n),i,t)},l},t&&t.exports?t.exports=i(En):(e.dcodeIO=e.dcodeIO||{}).ProtoBuf=i(e.dcodeIO.ByteBuffer)}),kn=[],Rn=[],On="undefined"!=typeof Uint8Array?Uint8Array:Array,Fn=!1;function Nn(){Fn=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,i=t.length;e<i;++e)kn[e]=t[e],Rn[t.charCodeAt(e)]=e;Rn["-".charCodeAt(0)]=62,Rn["_".charCodeAt(0)]=63}function Un(t,e,i){for(var n,o,r=[],a=e;a<i;a+=3)n=(t[a]<<16)+(t[a+1]<<8)+t[a+2],r.push(kn[(o=n)>>18&63]+kn[o>>12&63]+kn[o>>6&63]+kn[63&o]);return r.join("")}function Bn(t){var e;Fn||Nn();for(var i=t.length,n=i%3,o="",r=[],a=0,s=i-n;a<s;a+=16383)r.push(Un(t,a,s<a+16383?s:a+16383));return 1===n?(e=t[i-1],o+=kn[e>>2],o+=kn[e<<4&63],o+="=="):2===n&&(e=(t[i-2]<<8)+t[i-1],o+=kn[e>>10],o+=kn[e>>4&63],o+=kn[e<<2&63],o+="="),r.push(o),r.join("")}function zn(t,e,i,n,o){var r,a,s=8*o-n-1,l=(1<<s)-1,c=l>>1,u=-7,h=i?o-1:0,d=i?-1:1,p=t[e+h];for(h+=d,r=p&(1<<-u)-1,p>>=-u,u+=s;0<u;r=256*r+t[e+h],h+=d,u-=8);for(a=r&(1<<-u)-1,r>>=-u,u+=n;0<u;a=256*a+t[e+h],h+=d,u-=8);if(0===r)r=1-c;else{if(r===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),r-=c}return(p?-1:1)*a*Math.pow(2,r-n)}function Vn(t,e,i,n,o,r){var a,s,l,c=8*r-o-1,u=(1<<c)-1,h=u>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:r-1,f=n?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),2<=(e+=1<=a+h?d/l:d*Math.pow(2,1-h))*l&&(a++,l/=2),u<=a+h?(s=0,a=u):1<=a+h?(s=(e*l-1)*Math.pow(2,o),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,o),a=0));8<=o;t[i+p]=255&s,p+=f,s/=256,o-=8);for(a=a<<o|s,c+=o;0<c;t[i+p]=255&a,p+=f,a/=256,c-=8);t[i+p-f]|=128*m}var Gn={}.toString,jn=Array.isArray||function(t){return"[object Array]"==Gn.call(t)};function Hn(){return qn.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Wn(t,e){if(Hn()<e)throw new RangeError("Invalid typed array length");return qn.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=qn.prototype:(null===t&&(t=new qn(e)),t.length=e),t}function qn(t,e,i){if(!(qn.TYPED_ARRAY_SUPPORT||this instanceof qn))return new qn(t,e,i);if("number"!=typeof t)return $n(this,t,e,i);if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return Xn(this,t)}function $n(t,e,i,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,i,n){if(e.byteLength,i<0||e.byteLength<i)throw new RangeError("'offset' is out of bounds");if(e.byteLength<i+(n||0))throw new RangeError("'length' is out of bounds");return e=void 0===i&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,i):new Uint8Array(e,i,n),qn.TYPED_ARRAY_SUPPORT?(t=e).__proto__=qn.prototype:t=Qn(t,e),t}(t,e,i,n):"string"==typeof e?function(t,e,i){if("string"==typeof i&&""!==i||(i="utf8"),!qn.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var n=0|Jn(e,i),o=(t=Wn(t,n)).write(e,i);return o!==n&&(t=t.slice(0,o)),t}(t,e,i):function(t,e){if(Kn(e)){var i=0|Zn(e.length);return 0===(t=Wn(t,i)).length||e.copy(t,0,0,i),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(n=e.length)!=n?Wn(t,0):Qn(t,e);if("Buffer"===e.type&&jn(e.data))return Qn(t,e.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function Yn(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function Xn(t,e){if(Yn(e),t=Wn(t,e<0?0:0|Zn(e)),!qn.TYPED_ARRAY_SUPPORT)for(var i=0;i<e;++i)t[i]=0;return t}function Qn(t,e){var i=e.length<0?0:0|Zn(e.length);t=Wn(t,i);for(var n=0;n<i;n+=1)t[n]=255&e[n];return t}function Zn(t){if(t>=Hn())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Hn().toString(16)+" bytes");return 0|t}function Kn(t){return!(null==t||!t._isBuffer)}function Jn(t,e){if(Kn(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return _o(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return So(t).length;default:if(n)return _o(t).length;e=(""+e).toLowerCase(),n=!0}}function to(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function eo(t,e,i,n,o){if(0===t.length)return-1;if("string"==typeof i?(n=i,i=0):2147483647<i?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=o?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(o)return-1;i=t.length-1}else if(i<0){if(!o)return-1;i=0}if("string"==typeof e&&(e=qn.from(e,n)),Kn(e))return 0===e.length?-1:io(t,e,i,n,o);if("number"==typeof e)return e&=255,qn.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):io(t,[e],i,n,o);throw new TypeError("val must be string, number or Buffer")}function io(t,e,i,n,o){var r,a=1,s=t.length,l=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s/=a=2,l/=2,i/=2}function c(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(o){var u=-1;for(r=i;r<s;r++)if(c(t,r)===c(e,-1===u?0:r-u)){if(-1===u&&(u=r),r-u+1===l)return u*a}else-1!==u&&(r-=r-u),u=-1}else for(s<i+l&&(i=s-l),r=i;0<=r;r--){for(var h=!0,d=0;d<l;d++)if(c(t,r+d)!==c(e,d)){h=!1;break}if(h)return r}return-1}function no(t,e,i,n){i=Number(i)||0;var o=t.length-i;n?o<(n=Number(n))&&(n=o):n=o;var r=e.length;if(r%2!=0)throw new TypeError("Invalid hex string");r/2<n&&(n=r/2);for(var a=0;a<n;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[i+a]=s}return a}function oo(t,e,i,n){return To(function(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,i,n)}function ro(t,e,i){return 0===e&&i===t.length?Bn(t):Bn(t.slice(e,i))}function ao(t,e,i){i=Math.min(t.length,i);for(var n=[],o=e;o<i;){var r,a,s,l,c=t[o],u=null,h=239<c?4:223<c?3:191<c?2:1;if(o+h<=i)switch(h){case 1:c<128&&(u=c);break;case 2:128==(192&(r=t[o+1]))&&127<(l=(31&c)<<6|63&r)&&(u=l);break;case 3:r=t[o+1],a=t[o+2],128==(192&r)&&128==(192&a)&&2047<(l=(15&c)<<12|(63&r)<<6|63&a)&&(l<55296||57343<l)&&(u=l);break;case 4:r=t[o+1],a=t[o+2],s=t[o+3],128==(192&r)&&128==(192&a)&&128==(192&s)&&65535<(l=(15&c)<<18|(63&r)<<12|(63&a)<<6|63&s)&&l<1114112&&(u=l)}null===u?(u=65533,h=1):65535<u&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),o+=h}return function(t){var e=t.length;if(e<=so)return String.fromCharCode.apply(String,t);for(var i="",n=0;n<e;)i+=String.fromCharCode.apply(String,t.slice(n,n+=so));return i}(n)}qn.TYPED_ARRAY_SUPPORT=void 0===t.TYPED_ARRAY_SUPPORT||t.TYPED_ARRAY_SUPPORT,Hn(),qn.poolSize=8192,qn._augment=function(t){return t.__proto__=qn.prototype,t},qn.from=function(t,e,i){return $n(null,t,e,i)},qn.TYPED_ARRAY_SUPPORT&&(qn.prototype.__proto__=Uint8Array.prototype,qn.__proto__=Uint8Array),qn.alloc=function(t,e,i){return n=null,r=e,a=i,Yn(o=t),o<=0?Wn(n,o):void 0!==r?"string"==typeof a?Wn(n,o).fill(r,a):Wn(n,o).fill(r):Wn(n,o);var n,o,r,a},qn.allocUnsafe=function(t){return Xn(null,t)},qn.allocUnsafeSlow=function(t){return Xn(null,t)},qn.isBuffer=function(t){return null!=t&&(!!t._isBuffer||Mo(t)||"function"==typeof(e=t).readFloatLE&&"function"==typeof e.slice&&Mo(e.slice(0,0)));var e},qn.compare=function(t,e){if(!Kn(t)||!Kn(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,n=e.length,o=0,r=Math.min(i,n);o<r;++o)if(t[o]!==e[o]){i=t[o],n=e[o];break}return i<n?-1:n<i?1:0},qn.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},qn.concat=function(t,e){if(!jn(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return qn.alloc(0);var i;if(void 0===e)for(i=e=0;i<t.length;++i)e+=t[i].length;var n=qn.allocUnsafe(e),o=0;for(i=0;i<t.length;++i){var r=t[i];if(!Kn(r))throw new TypeError('"list" argument must be an Array of Buffers');r.copy(n,o),o+=r.length}return n},qn.byteLength=Jn,qn.prototype._isBuffer=!0,qn.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)to(this,e,e+1);return this},qn.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)to(this,e,e+3),to(this,e+1,e+2);return this},qn.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)to(this,e,e+7),to(this,e+1,e+6),to(this,e+2,e+5),to(this,e+3,e+4);return this},qn.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?ao(this,0,t):function(t,e,i){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return uo(this,e,i);case"utf8":case"utf-8":return ao(this,e,i);case"ascii":return lo(this,e,i);case"latin1":case"binary":return co(this,e,i);case"base64":return ro(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ho(this,e,i);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}.apply(this,arguments)},qn.prototype.equals=function(t){if(!Kn(t))throw new TypeError("Argument must be a Buffer");return this===t||0===qn.compare(this,t)},qn.prototype.inspect=function(){var t="";return 0<this.length&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),50<this.length&&(t+=" ... ")),"<Buffer "+t+">"},qn.prototype.compare=function(t,e,i,n,o){if(!Kn(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),e<0||i>t.length||n<0||o>this.length)throw new RangeError("out of range index");if(o<=n&&i<=e)return 0;if(o<=n)return-1;if(i<=e)return 1;if(this===t)return 0;for(var r=(o>>>=0)-(n>>>=0),a=(i>>>=0)-(e>>>=0),s=Math.min(r,a),l=this.slice(n,o),c=t.slice(e,i),u=0;u<s;++u)if(l[u]!==c[u]){r=l[u],a=c[u];break}return r<a?-1:a<r?1:0},qn.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},qn.prototype.indexOf=function(t,e,i){return eo(this,t,e,i,!0)},qn.prototype.lastIndexOf=function(t,e,i){return eo(this,t,e,i,!1)},qn.prototype.write=function(t,e,i,n){if(void 0===e)n="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)n=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(i)?(i|=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var o=this.length-e;if((void 0===i||o<i)&&(i=o),0<t.length&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var r,a,s,l,c,u,h,d,p,f=!1;;)switch(n){case"hex":return no(this,t,e,i);case"utf8":case"utf-8":return d=e,p=i,To(_o(t,(h=this).length-d),h,d,p);case"ascii":return oo(this,t,e,i);case"latin1":case"binary":return oo(this,t,e,i);case"base64":return l=this,c=e,u=i,To(So(t),l,c,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return a=e,s=i,To(function(t,e){for(var i,n,o,r=[],a=0;a<t.length&&!((e-=2)<0);++a)n=(i=t.charCodeAt(a))>>8,o=i%256,r.push(o),r.push(n);return r}(t,(r=this).length-a),r,a,s);default:if(f)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),f=!0}},qn.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var so=4096;function lo(t,e,i){var n="";i=Math.min(t.length,i);for(var o=e;o<i;++o)n+=String.fromCharCode(127&t[o]);return n}function co(t,e,i){var n="";i=Math.min(t.length,i);for(var o=e;o<i;++o)n+=String.fromCharCode(t[o]);return n}function uo(t,e,i){var n=t.length;(!e||e<0)&&(e=0),(!i||i<0||n<i)&&(i=n);for(var o="",r=e;r<i;++r)o+=xo(t[r]);return o}function ho(t,e,i){for(var n=t.slice(e,i),o="",r=0;r<n.length;r+=2)o+=String.fromCharCode(n[r]+256*n[r+1]);return o}function po(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(i<t+e)throw new RangeError("Trying to access beyond buffer length")}function fo(t,e,i,n,o,r){if(!Kn(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(o<e||e<r)throw new RangeError('"value" argument is out of bounds');if(i+n>t.length)throw new RangeError("Index out of range")}function mo(t,e,i,n){e<0&&(e=65535+e+1);for(var o=0,r=Math.min(t.length-i,2);o<r;++o)t[i+o]=(e&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function go(t,e,i,n){e<0&&(e=4294967295+e+1);for(var o=0,r=Math.min(t.length-i,4);o<r;++o)t[i+o]=e>>>8*(n?o:3-o)&255}function vo(t,e,i,n,o,r){if(i+n>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function yo(t,e,i,n,o){return o||vo(t,0,i,4),Vn(t,e,i,n,23,4),i+4}function bo(t,e,i,n,o){return o||vo(t,0,i,8),Vn(t,e,i,n,52,8),i+8}qn.prototype.slice=function(t,e){var i,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),e<t&&(e=t),qn.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,e)).__proto__=qn.prototype;else{var o=e-t;i=new qn(o,void 0);for(var r=0;r<o;++r)i[r]=this[r+t]}return i},qn.prototype.readUIntLE=function(t,e,i){t|=0,e|=0,i||po(t,e,this.length);for(var n=this[t],o=1,r=0;++r<e&&(o*=256);)n+=this[t+r]*o;return n},qn.prototype.readUIntBE=function(t,e,i){t|=0,e|=0,i||po(t,e,this.length);for(var n=this[t+--e],o=1;0<e&&(o*=256);)n+=this[t+--e]*o;return n},qn.prototype.readUInt8=function(t,e){return e||po(t,1,this.length),this[t]},qn.prototype.readUInt16LE=function(t,e){return e||po(t,2,this.length),this[t]|this[t+1]<<8},qn.prototype.readUInt16BE=function(t,e){return e||po(t,2,this.length),this[t]<<8|this[t+1]},qn.prototype.readUInt32LE=function(t,e){return e||po(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},qn.prototype.readUInt32BE=function(t,e){return e||po(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},qn.prototype.readIntLE=function(t,e,i){t|=0,e|=0,i||po(t,e,this.length);for(var n=this[t],o=1,r=0;++r<e&&(o*=256);)n+=this[t+r]*o;return(o*=128)<=n&&(n-=Math.pow(2,8*e)),n},qn.prototype.readIntBE=function(t,e,i){t|=0,e|=0,i||po(t,e,this.length);for(var n=e,o=1,r=this[t+--n];0<n&&(o*=256);)r+=this[t+--n]*o;return(o*=128)<=r&&(r-=Math.pow(2,8*e)),r},qn.prototype.readInt8=function(t,e){return e||po(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},qn.prototype.readInt16LE=function(t,e){e||po(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},qn.prototype.readInt16BE=function(t,e){e||po(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},qn.prototype.readInt32LE=function(t,e){return e||po(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},qn.prototype.readInt32BE=function(t,e){return e||po(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},qn.prototype.readFloatLE=function(t,e){return e||po(t,4,this.length),zn(this,t,!0,23,4)},qn.prototype.readFloatBE=function(t,e){return e||po(t,4,this.length),zn(this,t,!1,23,4)},qn.prototype.readDoubleLE=function(t,e){return e||po(t,8,this.length),zn(this,t,!0,52,8)},qn.prototype.readDoubleBE=function(t,e){return e||po(t,8,this.length),zn(this,t,!1,52,8)},qn.prototype.writeUIntLE=function(t,e,i,n){t=+t,e|=0,i|=0,n||fo(this,t,e,i,Math.pow(2,8*i)-1,0);var o=1,r=0;for(this[e]=255&t;++r<i&&(o*=256);)this[e+r]=t/o&255;return e+i},qn.prototype.writeUIntBE=function(t,e,i,n){t=+t,e|=0,i|=0,n||fo(this,t,e,i,Math.pow(2,8*i)-1,0);var o=i-1,r=1;for(this[e+o]=255&t;0<=--o&&(r*=256);)this[e+o]=t/r&255;return e+i},qn.prototype.writeUInt8=function(t,e,i){return t=+t,e|=0,i||fo(this,t,e,1,255,0),qn.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},qn.prototype.writeUInt16LE=function(t,e,i){return t=+t,e|=0,i||fo(this,t,e,2,65535,0),qn.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):mo(this,t,e,!0),e+2},qn.prototype.writeUInt16BE=function(t,e,i){return t=+t,e|=0,i||fo(this,t,e,2,65535,0),qn.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):mo(this,t,e,!1),e+2},qn.prototype.writeUInt32LE=function(t,e,i){return t=+t,e|=0,i||fo(this,t,e,4,4294967295,0),qn.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):go(this,t,e,!0),e+4},qn.prototype.writeUInt32BE=function(t,e,i){return t=+t,e|=0,i||fo(this,t,e,4,4294967295,0),qn.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):go(this,t,e,!1),e+4},qn.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e|=0,!n){var o=Math.pow(2,8*i-1);fo(this,t,e,i,o-1,-o)}var r=0,a=1,s=0;for(this[e]=255&t;++r<i&&(a*=256);)t<0&&0===s&&0!==this[e+r-1]&&(s=1),this[e+r]=(t/a>>0)-s&255;return e+i},qn.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e|=0,!n){var o=Math.pow(2,8*i-1);fo(this,t,e,i,o-1,-o)}var r=i-1,a=1,s=0;for(this[e+r]=255&t;0<=--r&&(a*=256);)t<0&&0===s&&0!==this[e+r+1]&&(s=1),this[e+r]=(t/a>>0)-s&255;return e+i},qn.prototype.writeInt8=function(t,e,i){return t=+t,e|=0,i||fo(this,t,e,1,127,-128),qn.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},qn.prototype.writeInt16LE=function(t,e,i){return t=+t,e|=0,i||fo(this,t,e,2,32767,-32768),qn.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):mo(this,t,e,!0),e+2},qn.prototype.writeInt16BE=function(t,e,i){return t=+t,e|=0,i||fo(this,t,e,2,32767,-32768),qn.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):mo(this,t,e,!1),e+2},qn.prototype.writeInt32LE=function(t,e,i){return t=+t,e|=0,i||fo(this,t,e,4,2147483647,-2147483648),qn.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):go(this,t,e,!0),e+4},qn.prototype.writeInt32BE=function(t,e,i){return t=+t,e|=0,i||fo(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),qn.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):go(this,t,e,!1),e+4},qn.prototype.writeFloatLE=function(t,e,i){return yo(this,t,e,!0,i)},qn.prototype.writeFloatBE=function(t,e,i){return yo(this,t,e,!1,i)},qn.prototype.writeDoubleLE=function(t,e,i){return bo(this,t,e,!0,i)},qn.prototype.writeDoubleBE=function(t,e,i){return bo(this,t,e,!1,i)},qn.prototype.copy=function(t,e,i,n){if(i||(i=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),0<n&&n<i&&(n=i),n===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);var o,r=n-i;if(this===t&&i<e&&e<n)for(o=r-1;0<=o;--o)t[o+e]=this[o+i];else if(r<1e3||!qn.TYPED_ARRAY_SUPPORT)for(o=0;o<r;++o)t[o+e]=this[o+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+r),e);return r},qn.prototype.fill=function(t,e,i,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!qn.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;var r;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(r=e;r<i;++r)this[r]=t;else{var a=Kn(t)?t:_o(new qn(t,n).toString()),s=a.length;for(r=0;r<i-e;++r)this[r+e]=a[r%s]}return this};var wo=/[^+\/0-9A-Za-z-_]/g;function xo(t){return t<16?"0"+t.toString(16):t.toString(16)}function _o(t,e){var i;e=e||1/0;for(var n=t.length,o=null,r=[],a=0;a<n;++a){if(55295<(i=t.charCodeAt(a))&&i<57344){if(!o){if(56319<i){-1<(e-=3)&&r.push(239,191,189);continue}if(a+1===n){-1<(e-=3)&&r.push(239,191,189);continue}o=i;continue}if(i<56320){-1<(e-=3)&&r.push(239,191,189),o=i;continue}i=65536+(o-55296<<10|i-56320)}else o&&-1<(e-=3)&&r.push(239,191,189);if(o=null,i<128){if((e-=1)<0)break;r.push(i)}else if(i<2048){if((e-=2)<0)break;r.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;r.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;r.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return r}function So(t){return function(t){var e,i,n,o,r,a;Fn||Nn();var s=t.length;if(0<s%4)throw new Error("Invalid string. Length must be a multiple of 4");r="="===t[s-2]?2:"="===t[s-1]?1:0,a=new On(3*s/4-r),n=0<r?s-4:s;var l=0;for(i=e=0;e<n;e+=4,i+=3)o=Rn[t.charCodeAt(e)]<<18|Rn[t.charCodeAt(e+1)]<<12|Rn[t.charCodeAt(e+2)]<<6|Rn[t.charCodeAt(e+3)],a[l++]=o>>16&255,a[l++]=o>>8&255,a[l++]=255&o;return 2===r?(o=Rn[t.charCodeAt(e)]<<2|Rn[t.charCodeAt(e+1)]>>4,a[l++]=255&o):1===r&&(o=Rn[t.charCodeAt(e)]<<10|Rn[t.charCodeAt(e+1)]<<4|Rn[t.charCodeAt(e+2)]>>2,a[l++]=o>>8&255,a[l++]=255&o),a}(function(t){var e;if((t=(e=t,e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")).replace(wo,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function To(t,e,i,n){for(var o=0;o<n&&!(o+i>=e.length||o>=t.length);++o)e[o+i]=t[o];return o}function Mo(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}var Io=qn,Po=d(function(t){(function(e,i){var n=v,o=Dn,r=P,a=Ki,s=new S(i);function l(t){this.urls=t;var i=e("bWVzc2FnZSBtZXNoZXMgew0KICAgIHJlcXVpcmVkIHN0cmluZyB2ZXJzaW9uID0gMTsNCiAgICByZXBlYXRlZCBibG9ja19kZWZhdWx0IGJsb2NrX2RlZmF1bHQgPSAyOw0KICAgIHJlcGVhdGVkIGJsb2NrX21vZGVsIGJsb2NrX21vZGVsID0gMzsNCiAgICByZXBlYXRlZCBibG9ja19jdXN0b21pemVkIGJsb2NrX2N1c3RvbWl6ZWQgPSA0Ow0KfQ0KDQptZXNzYWdlIHZlcnRpY2VzX3NpbXBsZSB7DQogICAgcmVwZWF0ZWQgZmxvYXQgdXYgPSAxIFtwYWNrZWQ9dHJ1ZV07DQogICAgcmVwZWF0ZWQgZmxvYXQgeHl6ID0gMiBbcGFja2VkPXRydWVdOw0KfQ0KDQptZXNzYWdlIGZhY2VzX3NpbXBsZSB7DQogICAgcmVwZWF0ZWQgdWludDMyIGZhY2VzID0gMSBbcGFja2VkPXRydWVdOw0KfQ0KDQptZXNzYWdlIGJsb2NrX21vZGVsIHsNCiAgICBvcHRpb25hbCB2ZXJ0aWNlc19zaW1wbGUgdmVydGljZXMgPSAxOw0KICAgIG9wdGlvbmFsIGZhY2VzX3NpbXBsZSBmYWNlcyA9IDI7DQogICAgb3B0aW9uYWwgc3RyaW5nIGJsb2NrX25hbWUgPSAzOw0KICAgIG9wdGlvbmFsIHN0cmluZyB0eHRuYW1lID0gNDsNCn0NCg0KbWVzc2FnZSBibG9ja19kZWZhdWx0IHsNCiAgICByZXBlYXRlZCBibG9ja19kZWZhdWx0X3VuaXQgZGVmYXVsdF91bml0cyA9IDE7DQp9DQoNCm1lc3NhZ2UgYmxvY2tfZGVmYXVsdF91bml0IHsNCiAgICByZXF1aXJlZCBzdHJpbmcgdW5pdF9pZCA9IDE7DQogICAgb3B0aW9uYWwgdmVydGljZXNfc2ltcGxlIHZlcnRpY2VzID0gMjsNCiAgICBvcHRpb25hbCBmYWNlc19zaW1wbGUgZmFjZXMgPSAzOw0KICAgIG9wdGlvbmFsIHN0cmluZyBibG9ja19kZXMgPSA0Ow0KICAgIG9wdGlvbmFsIHN0cmluZyB0eHRuYW1lID0gNTsNCn0NCg0KbWVzc2FnZSBibG9ja19jdXN0b21pemVkIHsNCiAgICByZXBlYXRlZCBibG9ja19jdXN0b21pemVkX3VuaXQgY3VzdG9taXplZF91bml0cyA9IDE7DQp9DQoNCm1lc3NhZ2UgYmxvY2tfY3VzdG9taXplZF91bml0IHsNCiAgICByZXF1aXJlZCBzdHJpbmcgdW5pdF9pZCA9IDE7DQogICAgcmVxdWlyZWQgc3RyaW5nIHJlbGF0ZWRfaWQgPSAyOw0KICAgIG9wdGlvbmFsIHZlcnRpY2VzX3NpbXBsZSB2ZXJ0aWNlcyA9IDM7DQogICAgb3B0aW9uYWwgZmFjZXNfc2ltcGxlIGZhY2VzID0gNDsNCiAgICBvcHRpb25hbCBzdHJpbmcgYmxvY2tfZGVzID0gNTsNCiAgICBvcHRpb25hbCBzdHJpbmcgdHh0bmFtZSA9IDY7DQp9DQo=","base64");this.decoder=o.loadProto(i).build("meshes")}l.prototype={constructor:l,load:function(t,e,i,n){return s.time("download"),r.get(t,{responseType:"arraybuffer"}).done(function(o){s.timeEnd("download"),this.parse(o,t,e,i,n)}.bind(this)).fail(n)},parse:function(t,e,i,n,o){var r=this.readProtobuf(t);if(!r)return o();try{s.time("convert to webgl"),this.convertProtobufToSceneObject(r,e,i,n,o),s.timeEnd("convert to webgl")}catch(t){return s.error("failed parsing .dam"),s.error(t.message),o()}},readProtobuf:function(t){var e;try{s.time("parse proto"),e=this.decoder.decode(t),s.timeEnd("parse proto")}catch(t){return s.error("failed parsing proto for .dam"),s.error(t.message),null}return e},convertProtobufToSceneObject:function(t,e,i,o,r){if(0===t.block_model.length)return s.warn("No chunks in damfile..."),i([]);var l=new n.Matrix4;l.set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1);var c=t.block_model.map(function(t){var i=new n.BufferGeometry;return i.addAttribute("position",new n.BufferAttribute(new Float32Array(t.vertices.xyz,0,3),3)),0<t.vertices.uv.length&&i.addAttribute("uv",new n.BufferAttribute(new Float32Array(t.vertices.uv,0,2),2)),i.setIndex(new n.BufferAttribute(new Uint32Array(t.faces.faces,0,1),1)),i.applyMatrix(l),i.computeBoundingBox(),new a({geometry:i,textureName:t.txtname,name:t.block_name,meshUrl:e})});return c?i(c):(s.error("no blocks..."),r())}},t.exports=l}).call(h,Io,"/js/loaders/DamLoader.js")}),Co=d(function(t){(function(e){var i=Po,n=new S(e);t.exports={getLoaders:function(t){return[["_50k",".dam",i],["",".dam",i]][t]},load:function(t,e,i,o,r){r=r||0;var a=this.getLoaders(r);if(a){var s=a[0],l=a[1],c=new a[2](t),u=G.url.model+"/model.nest",h=this;u?(n.debug("Trying "+s+l),c.load(u,e,i,function(){h.load(t,e,i,o,++r)})):(n.debug("Skipping "+l+", not available"),this.load(t,e,i,o,++r))}else o&&o("No suitable model file found...")}}}).call(h,"/js/loaders/ModelLoader.js")}),Ao=(Co.getLoaders,Co.load,new S("/js/loaders/ModelTextureLoader.js")),Eo=function(t){if(!t.chunks[0]||!t.chunks[0].meshUrl)return o.when();var e=k.countUnique(t.chunks.map(function(t){return t.textureName})),i="high";g.isMobile()&&"high"===i&&(g.detectSamsungS6()?(Ao.warn("Galaxy S6 cannot handle large textures, turning down quality."),i="low"):e>z.maxMobileTextures&&(Ao.warn("Model probably too large for mobile, turning down quality."),i="low"));var n=o.Deferred(),r=0,a=G.url.model+"/texture_"+i+"/";return t.chunks.forEach(function(t){if(!t.material.map&&t.textureName){var i=a+t.textureName;t.setTextureMap(H.load(i,function(t){t||(r++,n.notify(r,e),r===e&&n.resolve())}.bind(this,H.isLoaded(i))))}}),n.promise()},Lo=d(function(t){(function(e,i){var n=P,r=J,a=v,s=new S(i);function l(t){this.model=t,this.modelDataPath=G.url.model+"/vision.modeldata"}l.prototype.load=function(){return this.modelDataPath?(s.info("Using vision.modeldata"),this.loadVisionModelData()):(s.warn("No sweep file found"),o.when([]))},l.prototype.loadVisionModelData=function(){var t=this;return n.get(this.modelDataPath,{responseType:"json",fetchNum:1,prefetchFrom:"locations"}).then(function(e){var i=e.points.map(function(t){var e=t.color;return e?(e.brightness||(e.brightness=0),e.contrast||(e.contrast=0),null!==e.gamma&&void 0!==e.gamma||(e.gamma=1),e.hue||(e.hue=0),e.saturation||(e.saturation=0),e.vibrance||(e.vibrance=0),e.balance||(e.balance=new a.Vector3(0,0,0))):e={brightness:0,contrast:0,gamma:1,hue:0,saturation:0,vibrance:0,balance:new a.Vector3(0,0,0)},{enable:t.enable,locationid:t.locationid,position:{x:t.viewpoint.x,y:t.viewpoint.y,z:t.viewpoint.z},quaternion:{x:t.rotation.x,y:t.rotation.y,z:t.rotation.z,w:t.rotation.w},puck:{x:t.spot.x,y:t.spot.y,z:t.spot.z},u:t.u,v:t.v,floor:t.flooridx,neighbours:t.vps,alignmentType:t.type,angle_enable:t.angle_enable,angle_x:t.angle_x,angle_y:t.angle_y,angle_z:t.angle_z,launch:t.launch,color:e,roomid:t.roomidx}}).map(function(e){if(t.model.straight_enable){var i=new a.Euler;i.setFromQuaternion(new a.Quaternion(e.quaternion.x,e.quaternion.y,e.quaternion.z,e.quaternion.w),"ZYX",!1),i._x=0,i._y=0;var n=new a.Quaternion;n.setFromEuler(i,!1),e.quaternion.x=n.x,e.quaternion.y=n.y,e.quaternion.z=n.z,e.quaternion.w=n.w}return e.position=r.convertVisionVector(e.position),e.quaternion=r.convertVisionQuaternion(e.quaternion),e.quaternionAutoScene=r.convertVisionQuaternionAutoScene(e.quaternion),e.puck=r.convertVisionVector(e.puck),e});return i.forEach(function(t){t.neighbours=t.neighbours.map(function(t){return i[t].locationid})}),!G.conf.jfedit&&G.conf.isNewEditVersion||(i=i.filter(function(t){return t.enable})),i}.bind(this))},t.exports=l}).call(h,Io,"/js/loaders/SweepDataLoader.js")}),Do=d(function(t){(function(e){function i(){s.call(this)}var n=z,o=A,r=Ee,a=k,s=Yi,l=new S(e);a.inherit(i,s),i.prototype.getbg=function(){for(var t=0;t<this.list.length;t++)if(this.list[t].init_point)return this.list[t];return null},i.prototype.filterByModesAndReel=function(t,e){for(var i,n=t[o.DOLLHOUSE],r=t[o.FLOORPLAN],a=[],s=0;s<e.length;s++)i=this.index[e[s].sceneid],0==s&&(i.isHero=!0),i&&a.push(i);(a=a.filter(function(t){var e;if(t._camera&&void 0!==t._camera._type){try{e=o.convertWorkshopModeInt(t._camera._type)}catch(t){return void l.debug(t.message)}return e===o.PANORAMA||e===o.FLOORPLAN&&r||e===o.DOLLHOUSE&&n}})).length!==this.list.length&&(l.info("Disallowed "+(this.list.length-a.length)+" highlight images"),this.list=a,this.reIndex()),this.list=a,this.reIndex()},i.prototype.getHeroLocations=function(t){var e=[],a=!1;if(0===this.list.length)return[];for(var s=0;s<this.list.length;++s){var l=this.list[s],c=l.shortcuturl,u=l.name;if(l.script=l.script?l.script:0,l._camera&&void 0!==l._camera._rotation){if(!n.show360Views.enabled&&l._camera._locationid){var h=t.get(l._camera._locationid);if(h&&!h.isAligned())continue}if(o.convertWorkshopModeInt(l._camera._type)===o.MESH)continue;var d=new r({cameraMode:"panorama",position:l._camera._viewpoint,quaternion:l._camera._rotation,panoId:l._camera._locationid,orthoZoom:l._camera._zoom,floorVisibility:void 0!==l._camera.floor_visibility?l._camera.floor_visibility.slice(0):[],thumbUrl:c,name:i.filterImageName(u),isHero:l.init_point,script:l.script,cameraType:l._camera._type});e.push(d),a=a||l.init_point}}return 0<e.length&&!a&&(e[0].isHero=!0),e},i.prototype.getIndex=function(t){return t.sceneid},i.filterImageName=function(t){return""===t||t.match(/^[0-9.]+_[0-9.]+$/)?null:t},t.exports=i}).call(h,"/js/model/ImageCollection.js")}),ko=d(function(t){function e(t,e){this.chunks=[],this.floorId=t,this.roomId=e,this.position=new v.Vector3}e.prototype.addChunk=function(t){this.chunks.push(t)},e.prototype.calcBoundaries=function(){for(var t=new v.Vector3,e=new v.Vector3(0,0,0),i=new v.Vector3(0,0,0),n=new v.Vector3(0,0,0),o=0,r=0;r<this.chunks.length;r++){var a=this.chunks[r].geometry.attributes.position;if(a)for(var s=0;s<a.array.length;s+=3)t.set(a.array[s],a.array[s+1],a.array[s+2]),e.add(t),0===s?(i.copy(t),n.copy(t)):(i.max(t),n.min(t)),o++}this.average=0<o?(e.multiplyScalar(1/o),e):null,this.boundsMax=i,this.boundsMin=n,this.center=new v.Vector3,this.center.copy(i).sub(n).multiplyScalar(.5).add(n)},t.exports=e}),Ro=d(function(t){(function(e){new S(e);var i={parseIdsFromChunkName:function(t,e){e.floorId=i.parseFloor(t),e.roomId=i.parseRoom(t)},parseFloor:function(t){var e,i=t.match(/block_([0-9]+)/);if(!i)return 0;try{e=parseInt(i[1],10)}catch(t){return 0}return this.getfid(e)},getfid:function(t){for(var e=G.settings.building.blocks,i=e.length||0,n=0;n<i;n++)if(e[n].blockidx===t)return e[n].flooridx;return 0},getflooridx:function(){for(var t=G.model.chunks,e=0;e<t.length;e++)if(G.model.chunks[e].id===G.interchunkid)return this.getfid(e);return 0},getrid:function(t){for(var e=G.settings.building.blocks,i=e.length||0,n=0;n<i;n++)if(e[n].blockidx===t)return e[n].roomidx;return 0},parseRoom:function(t){var e,i=t.match(/block_([0-9]+)/);if(!i)return 0;try{e=parseInt(i[1],10)}catch(t){return 0}return this.getrid(e)}};t.exports=i}).call(h,"/js/model/Chunks.js")}),Oo=d(function(t){(function(e){function i(){r.call(this)}var n=ko,o=k,r=Yi,a=Ro;new S(e),o.inherit(i,r),i.prototype.getIndex=function(t){return t.roomId},i.prototype.calcRoomBoundaries=function(){this.forEach(function(t){t.calcBoundaries()})},i.prototype.createFromChunks=function(t){var e={floorId:-1,roomId:-1},o={};t.forEach(function(t){a.parseIdsFromChunkName(t.name,e);var r=o[e.roomId];if(!r){var s=i.generateRoomId(e.floorId,e.roomId);r=new n(e.floorId,s),this.add(r),o[e.roomId]=r}r.addChunk(t)}.bind(this)),this.calcRoomBoundaries()},i.generateRoomId=function(t,e){return t+"_"+e},t.exports=i}).call(h,"/js/model/RoomCollection.js")}),Fo=ot.EventEmitter,No=function(){this.audioContext=null,window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext,window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame;try{this.audioContext=new AudioContext}catch(t){}this.bufferList={},this.cellList={}};No.prototype.load=function(t){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer";var i=this;i.cellList[t]=new Uo(this.audioContext),e.onload=function(){i.audioContext.decodeAudioData(e.response,function(e){e&&i.cellList[t].setBuffer(e)})},e.onerror=function(){},e.send()},No.prototype.getCell=function(t){return null!==this.cellList[t]?this.cellList[t]:null};var Uo=function(t){this.audioContext=t,this.audioBuffer=null,this.source=null,this.pauseTime=0,this.startTime=0,this.readyState=0,this.oncanplay=function(){},this.audioContext.addEventListener("ended",function(){}),this._ended=this._ended.bind(this);var e=this;Object.defineProperty(this,"contextCurrentTime",{get:function(){return e.audioContext.currentTime},set:function(t){e.pauseTime=t}}),Object.defineProperty(this,"currentTime",{get:function(){return e.audioContext.currentTime-e.startTime},set:function(t){e.pauseTime=t}}),Object.defineProperty(this,"duration",{get:function(){return e.audioBuffer.duration}}),this.keeprunning=this.keeprunning.bind(this),document.body.addEventListener("touchend",this.keeprunning,!1)};Uo.prototype=Object.create(Fo.prototype),Uo.prototype.setBuffer=function(t){this.audioBuffer=t,this.readyState=4,this.oncanplay()},Uo.prototype.keeprunning=function(){if("running"!==this.audioContext){var t=this;this.audioContext.resume();var e=setTimeout(function(){"running"===t.audioContext.state&&clearTimeout(e)},0)}},Uo.prototype.play=function(){var t=0;0!==this.pauseTime&&(t=this.pauseTime,this.pauseTime=0);var e=this.audioContext,i=e.createBufferSource();i.connect(e.destination),i.buffer=this.audioBuffer,i.start||(i.start=i.noteOn,i.stop=i.noteOff),this.source=i,this.startTime=this.contextCurrentTime,i.onended=this._ended,i.start(0,t)},Uo.prototype._ended=function(){this.emit("play_done")},Uo.prototype.pause=function(){null!==this.source&&(this.pauseTime=this.contextCurrentTime-this.startTime,this.source.disconnect())},Uo.prototype.stop=function(){null!==this.source&&this.source.disconnect()};var Bo,zo=(Bo=null,function(){return null===Bo&&(Bo=new No),Bo});function Vo(){this.loader=new v.XHRLoader}Vo.prototype.load=function(t){var e=this;return new Promise(function(i,n){e.loader.load(t,function(t){t?i(JSON.parse(t)):n("load json failed!")})})};var Go=new Vo;function jo(t){v.Mesh.call(this),this.paths=t,this.actions=[],this.geometry=this.getPathGeometry(t[this.actions.length]),this.material=new v.MeshBasicMaterial({color:1693931})}(jo.prototype=Object.create(v.Mesh.prototype)).getPathGeometry=function(t){for(var e=new v.Shape,i=0;i<t.length;++i)0===i?e.moveTo(t[i].x,t[i].y):e.lineTo(t[i].x,t[i].y);return new v.ExtrudeGeometry(e,{amount:4})},jo.prototype.play=function(){17===this.actions.length&&(this.actions=[]),this.geometry.dispose(),this.geometry=this.getPathGeometry(this.paths[this.actions.length]),this.actions.push(1)};var Ho=jo;function Wo(){v.Group.call(this),this.paths=[{x:-.72,y:14},{x:-13.82,y:.83},{x:-13.82,y:-1},{x:-.63,y:-14},{x:14,y:-14},{x:1.02,y:0},{x:14,y:14}],this.defaultColor=6714495,this.heightLightColor=8316152,this.actions=[];var t=this.initArrow(),e=this.initArrow(),i=this.initArrow();t.userData.type="arrow",e.userData.type="arrow",i.userData.type="arrow",t.geometry.computeBoundingBox();var n=t.geometry.boundingBox.size(new v.Vector3);this.arrowSize=n,e.position.x+=1*n.x,i.position.x+=2*n.x,t.rotateX(-Math.PI/2),e.rotateX(-Math.PI/2),i.rotateX(-Math.PI/2),this.add(t),this.add(e),this.add(i),this.userData.arrows=[t,e,i],this.initWalker()}(Wo.prototype=Object.create(v.Group.prototype)).initArrow=function(){for(var t=new v.Shape,e=0,i=this.paths.length;e<i;++e)0===e?t.moveTo(this.paths[e].x,this.paths[e].y):t.lineTo(this.paths[e].x,this.paths[e].y);var n=new v.ExtrudeGeometry(t,{amount:4}),o=new v.MeshBasicMaterial({color:this.defaultColor,transparent:!0,opacity:1});return new v.Mesh(n,o)},Wo.prototype.initWalker=function(){var t=this;Go.load("https://template2.3dnest.cn/common/img/walker.json").then(function(e){var i=new Ho(e);i.userData.type="walker",i.userData.paths=e,i.scale.set(.5,.5,.5),i.rotateY(Math.PI),i.position.y+=46,i.position.x+=5*t.arrowSize.x,t.add(i),t.userData.walker=i})},Wo.prototype.runAction=function(){3===this.actions.length&&(this.actions=[]);for(var t=this.userData.arrows,e=0;e<3;++e)t[e].material.color.set(this.defaultColor);t[2-this.actions.length].material.color.set(this.heightLightColor),this.actions.push(1)},Wo.prototype.play=function(){var t=this,e=0,i=0;!function n(o){i++,0==++e%12&&3===t.userData.arrows.length&&(e=0,t.runAction()),0==i%4&&t.userData.walker&&(i=0,t.userData.walker.play()),requestAnimationFrame(n)}()};var qo,$o=Wo,Yo=ot.EventEmitter,Xo=new S("/js/model/Model.js");function Qo(t,e){this.settings=e,G.model=this,e.floors="",v.Object3D.call(this),this.modelid=e.basic.model.modelid,this.moreHouse=e.nestrecommends?0===e.nestrecommends.models.length?null:e.nestrecommends.models:null;var i=e.basic;G.settings.basic.menu.compass_enable=!0,qo=zo(),this.walkerControls=null,window.disclaimer&&window.disclaimer.content&&i.user&&1!==parseInt(i.user.group)&&(i.model.disclaimer=window.disclaimer),this.data={modelid:i.model.modelid,name:i.model.name,floors:"",image:-1===e.nestscenes.backgroundimgurl.indexOf("background.")?e.nestscenes.backgroundimgurl:"",mobileimg:e.nestscenes.backgroundmobileimgurl&&0<=e.nestscenes.backgroundmobileimgurl.indexOf("mobile.")?e.nestscenes.backgroundmobileimgurl:"",images:e.nestscenes,player_options:{highlight_reel:!0,tour_buttons:!0,contact_email:!0,address:i.menu.address_enable,contact_name:i.menu.contact_name_enable,presented_by:i.menu.producer_enable,floor_plan:!0,dollhouse:!0,fast_transitions:!1,model_summary:i.menu.description_enable,contact_phone:i.menu.phone_enable,model_name:!0,autoplay:!1,bottom_presented_by:i.menu.bottom_presented_enable,show3d:void 0===i.menu.single_indoor||!i.menu.single_indoor,businessname:i.menu.businessname_enable,innerimage:i.menu.innerimage_enable},camera_start:null,summary:i.menu.description,description_voice_url:i.menu.description_voice_url,presented_by:i.menu.producer,address:i.menu.address,contact_name:i.menu.contact_name,contact_phone:i.menu.phone,contact_email:i.menu.contact_email,bottom_presented_by:i.menu.bottom_presented_by,audio:i.model.audio,businessname:i.menu.businessname,innerimage:i.menu.innerimage,orientations:e.locations.orientations,orientationkey:e.locations.orientationkey,orientation_correct:i.menu.orientation_correct};var n=g.valueFromHash("cleanui",0);if(n&&(G.conf.isCleanUI=n),this.settings.panorama_settings&&(z.panoramaSettings=this.settings.panorama_settings,z.screenshot?z.insideFOV=z.panoramaSettings.screenshot_fov82?82:70:z.insideFOV=z.panoramaSettings.loading_fov82?82:70),this.scene_enable=i.menu.scene_enable,this.scene_autoplay=i.menu.scene_autoplay,this.single_3D=i.menu.single_3D,this.innermap_enable=!1,this.innermap_type=i.menu.innermap_type,this.innermap_imgurl=i.menu.innermap_imgurl,this.outermap_enable=i.menu.outermap_enable,this.outermap_type=i.menu.outermap_type,this.outermap_url=i.menu.outermap_url,this.visiotors_enable=i.menu.visiotors_enable,this.mlanguage_enable=i.menu.mlanguage_enable,this.measure_enable=i.menu.measure_enable,this.mlanguage_type=null,this.t_logo_enable=i.menu.t_logo_enable,this.t_logo_url=i.menu.t_logo_url,this.house_type_enabled=i.menu.house_type_enabled,this.floorplan_enable=!1!==i.menu.floorplan_enable,this.inside_limit=51,this.model_name_style=i.menu.model_name_style,this.menu_autohide=i.menu.menu_autohide,this.share_enable=i.model.share_enable,this.startup_type=i.menu.startup_type||3,this.switch_scene_type=i.menu.switch_scene_type,this.oauth=i.menu.oauth,this.back_url=i.menu.back_url,this.entrance=e.building.house?e.building.house.entrance:null,this.entranceMesh=null,this.compassMesh=null,this.rooms_real=e.building.rooms,this.panosUV=[],this.buildFloors=e.building,i.menu.house_type_url?this.house_type_url=i.menu.house_type_url:e.building.floors&&e.building.floors[0]&&(this.house_type_url=e.building.floors[0].planurl),this.building_tag_enable=i.model.building_tag_enable,this.tour_tag_enable=i.model.tour_tag_enable,G.P={a:.025,b:0,c:.01},this.loading_enable=i.menu.loading_enable,this.iframe_screen_enable=i.menu.iframe_screen_enable,this.straight_enable=i.menu.straight_enable,this.catalogue=e.catalogue,this.catalogue&&((!this.catalogue.tagopentime||this.catalogue.tagopentime<0)&&(this.catalogue.tagopentime=5),(!this.catalogue.mediamaxtime||this.catalogue.mediamaxtime<0)&&(this.catalogue.mediamaxtime=180),(!this.catalogue.iframemaxtime||this.catalogue.iframemaxtime<0)&&(this.catalogue.iframemaxtime=20)),z.zoom.enabled=!0,e.nestscenes.scenes&&0<e.nestscenes.scenes.length){for(var o=-1,r=0;r<e.nestscenes.scenes.length;r++)if(1!==e.nestscenes.scenes[r].script){o=r;break}-1!==o&&(e.nestscenes.scenes[o].init_point=!0,this.normalMovie=!0),this.scene_switch_scene_type=e.nestscenes.switch_scene_type}for(this.outline_fills=e.building.outlines,this.language=null,this.language_type=null,this.options=t,this.urls=new Bi(t.urlFiles),this.isPublic=2!==e.basic.privacy,this.images=new Do(this),this.images.extend(e.nestscenes.scenes),this.scenes360=[],this.points=e.locations.points,this.gotoFrom360Item=-1,e.nestscenes.path=Ui,this.switch_scene_type=2,this.jfData=null,e.jf&&e.jf.enable&&e.jf.dataset.length&&(this.jfData=e.jf.dataset,G.R.arrSet=e.jf.dataset,G.R.arrSet.forEach(function(t,e){var i=G.R.arrSet[e].audiourl;qo.load(i)})),o=-1,r=0;r<e.nestscenes.scenes.length;r++)if(1===e.nestscenes.scenes[r].script){o=r;break}-1!==o&&(this.enableTagMovie=!0);var a=null,s=null;if(0<this.images.getLength()){var l=this.images.list.length,c=this.points.length;for(r=0;r<l;r++)1==this.images.list[r].type?-1==this.gotoFrom360Item&&(a=this.images.list[r]._camera._locationid,s=this.images.list[r]._camera._rotation,this.gotoFrom360Item=r):2==this.images.list[r].type&&this.scenes360.push(this.images.list[r]);if(!a)for(r=0;r<l;r++)for(o=0;o<c;o++)this.points[o].locationid==this.images.list[r]._camera._locationid&&(1==this.points[o].type?-1==this.gotoFrom360Item&&(a=this.images.list[r]._camera._locationid,s=this.images.list[r]._camera._rotation,this.gotoFrom360Item=r):this.scenes360.push(this.images.list[r]));if(!a)for(r=0;r<c;r++)if(1==this.points[r].type){a=this.points[r].locationid,s=this.points[r].rotation,this.gotoFrom360Item=this.images.getLength();break}if(null!=a){var u={init_point:!0,name:"",sceneid:"test",shortcuturl:"",_camera:{_locationid:a,_rotation:s,_type:0,_viewpoint:new v.Vector3(0,0,0),_zoom:0,_zoom_enable:0}};this.images.add(u)}}-1==this.gotoFrom360Item&&(this.gotoFrom360Item=0),this.enableOri=i.model.orientation,g.isMobile()||(this.enableOri=!1),G.ori.flag=!1,this.vr_num=0,this.vr_enable=!(null!=i.menu.vr_enable&&!i.menu.vr_enable),this.vr_enable&&this.vr_num++,this.enableOri&&this.vr_num++,this.heroImage=this.images.getbg(),this.heroLocations=[],this.outdoorPanoLocations=[],this.floors=new Qi(this),this.floorsEnabled=void 0===t.floors||t.floors,this.changingFloor=!1,this.chunks=[],this.panos=new Cn,this.colliders=[],this.loadPanosPromise=null,this.loadMeshTexturesPromise=null,this.meshTexturesLoaded=!1,this.mattertags={},this.tagsShown=!1,this.shouldShowMattertags=!1,this.has360Views=!0,this.supportedModes={},this.supportedModes[A.PANORAMA]=!0,this.supportedModes[A.DOLLHOUSE]=!e.player_options||e.player_options.dollhouse,this.supportedModes[A.FLOORPLAN]=!e.player_options||e.player_options.floor_plan,this.supportedModes[A.TRANSITIONING]=!0,this.steeringWheel=null,this.steeringWheelVisible=null,this.supportsTiles=!!i.model.multiple,z.tiling.allowUltraHighResolution=!!i.model.hq,z.tiling.mobileHighQualityOverride=!!i.model.mobile2k,this.adjustCompass=parseFloat(i.model.adjustCompass?i.model.adjustCompass:0),this.mode=A.DOLLHOUSE,this.size=null,this.center=null,this.boundingBox=new v.Box3,this.currentFloor=null,this.allFloorsVisible=!0,this.projectedPano0=null,this.projectedPano1=null,this.floorsEnabled&&e.floors&&-1!==e.floors.indexOf(",")&&e.floors.split(",").forEach(function(t,e){this.addFloor(new qi(this,e,t.trim()))}.bind(this)),this.floorsHeight=this.setFloorsHeight(e),this.enablefilter=!1;var h=G.settings.locations.points;for(r=0;r<h.length;r++)!h[r].color||0===h[r].color.brightness&&0===h[r].color.contrast&&1===h[r].color.gamma&&0===h[r].color.hue&&0===h[r].color.saturation&&0===h[r].color.vibrance||(this.enablefilter=!0);this.waitQueue=[],this.on("load",function(t){0!==this.waitQueue.length&&(this.waitQueue=this.waitQueue.filter(function(t){return!t.isLoadedCallback()}),0===this.waitQueue.length&&this.emit("waiting-done"))}.bind(this)),this.setupCustomProperties(),this.buildStreeringWheel()}Qo.prototype=Object.create(v.Object3D.prototype),k.extend(Qo,Yo),Qo.prototype.setupCustomProperties=function(){var t=z.modelAlpha;Object.defineProperty(this,"alpha",{get:function(){return t},set:function(e){t=e,this.chunks.forEach(function(e){e.material&&e.material.uniforms.modelAlpha&&(e.material.uniforms.modelAlpha.value=t)})}})};Qo.prototype.buildStreeringWheel=function(){var t=this,e=new v.CircleGeometry(.62,32),i=new v.TextureLoader;i.setCrossOrigin(!0);var n=function(){var t=parseInt(g.getQueryString("lang"));return t||(t=function(){var t=null;switch(window.navigator.userLanguage?window.navigator.userLanguage.substring(0,2).toLowerCase():window.navigator.language.substring(0,2).toLowerCase()){case"zh":t=3;break;case"en":t=1;break;case"ja":t=2;break;default:t=1}return t}()),t}(),o="https://template2.3dnest.cn/common/img/ewsn_512.png";1==n?o="https://template2.3dnest.cn/common/img/ewsn_en_512.png":2==n&&(o="https://template2.3dnest.cn/common/img/ewsn_jp_512.png"),i.load(o,function(i){var n=new v.MeshBasicMaterial({map:i,transparent:!0,opacity:.5,side:v.DoubleSide,depthTest:!1}),o=new v.Mesh(e,n);if(o.renderOrder=10,o.visible=null!==t.steeringWheelVisible&&t.steeringWheelVisible,o.rotation.set(-Math.PI/2,0,0),t.data.orientation_correct){var r=-t.data.orientation_correct*Math.PI/180;o.rotation.set(-Math.PI/2,0,r)}t.add(o),t.steeringWheel=o})},Qo.prototype.showSteeringWheel=function(){this.steeringWheel?this.steeringWheel.visible=!0:this.steeringWheelVisible=!0},Qo.prototype.hideSteeringWheel=function(){this.steeringWheel?this.steeringWheel.visible=!1:this.steeringWheelVisible=!1},Qo.prototype.getCurrentHouseTypeImage=function(){var t="";return(t=this.buildFloors.floors&&0<this.buildFloors.floors.length?this.buildFloors.floors[this.currentFloor.floorIndex].planurl:this.house_type_url)?t="http:"===window.location.protocol?t:t.replace("http:","https:"):""},Qo.prototype.toggleAlpha=function(){this.alpha<1?this.alpha=1:this.alpha=0},Qo.prototype.load=function(t){var e=function(){return o.when(this.loadPanos(),this.loadMesh())}.bind(this);e=e(),t?e=e.then(this.loadMeshTextures.bind(this)):e.then(this.loadMeshTextures.bind(this));var i=o.when(this.loadHighlightReel(),this.loadMattertags());return o.when(e,i).done(this.build.bind(this))},Qo.prototype.loadMesh=function(){var t=o.Deferred(),e=this;return Co.load(e.urls,function(i,n){if(0===i.length){Xo.warn("No geometry found for model, loading faux geometry, disabling outside mode"),e.supportedModes[A.DOLLHOUSE]=!1,e.supportedModes[A.FLOORPLAN]=!1;var o=new Ki({geometry:new v.PlaneBufferGeometry(5,5,1,1)});o.material.visible=!1,o.rotateX(-Math.PI/2),o.geometry.computeBoundingBox(),i=[o]}i.forEach(function(t){var i=e.floorsEnabled?Ro.parseFloor(t.name):0;e.addChunk(i,t)}),e.floors.sort(),t.resolve(e)},function(e,i){t.notify(e,i)},function(e){Xo.error(e),t.reject("loading-failed")}),t.promise()},Qo.prototype.flyToTagid=function(t){if(!G.d.tourIsPlaying){G.player.mattertagManager.closeTag();var e=this.getTagByTagid(t);if(e){var i={pano:this.panos.index[e.locationId],lookAtPoint:{x:e.position.x,y:e.position.y,z:e.position.z}};if(G.d.flyingtag)return;G.d.flyingtag=!0,G.d.player.flyToPano(i,function(){G.d.player.mattertagManager.openTag(e),G.d.flyingtag=!1})}}},Qo.prototype.loadMeshTextures=function(){return this.loadTexturesPromise||(this.loadTexturesPromise=Eo(this).then(function(){this.meshTexturesLoaded=!0}.bind(this))),this.loadTexturesPromise},Qo.prototype.generateEntrance=function(t){var e=t.world.ep,i=t.world.sp,n=new v.Vector3(e.x,e.y+.5,e.z),o=new v.Vector3(i.x,i.y+.5,i.z),r=(new v.Vector3).subVectors(n,o).divideScalar(2),a=(new v.Vector3).subVectors(n,o).normalize(),s=new v.Vector3(0,1,0),l=(new v.Vector3).crossVectors(s,a),c=s.angleTo(a),u=(new v.Quaternion).setFromAxisAngle(l,c),h=o.sub(r),d={actiontype:2,base:{y:h.y+.5,x:h.x,z:h.z},details:{subtype:0,tagpictype:null,title:this.settings.entry_door_text,tagpicurl:"",time:""},enable:!0,locationid:"location_10000",normal:{y:1,x:0,z:0},showtitle:!0,stem:{direction:{y:.1,x:0,z:0},enabled:!1},tagid:"1",tagtitle:""},p=new v.CylinderGeometry(.04,.16,.7,4),f=new v.MeshBasicMaterial({color:3342335}),m=new v.Mesh(p,f);return m.position.copy(h),m.quaternion.multiply(u),m.visible=!0,{mesh:m,info:d}},Qo.prototype.setEntranceState=function(t){if(this.entrance&&this.entranceMesh){this.entranceMesh.visible=t;var e=this.userData.navigator_arrow;!e||"floorplan"!==this.mode&&"panorama"!==this.mode||(e.visible=!1)}},Qo.prototype.setCompassVisible=function(t){this.compassMesh&&(this.compassMesh.visible=t)},Qo.prototype.setCompassMesh=function(){var t=new v.Group,e=this.size.length()/2,i=this.generateCompass(this.settings.languageObj.currentLanguage.direction_s_text);i.position.z=e,t.add(i);var n=this.generateCompass(this.settings.languageObj.currentLanguage.direction_n_text);if(n.position.z=-e,n.rotation.y=Math.PI,t.add(n),t.position.copy(this.boundingBox.center()),this.data.orientation_correct){var o=-this.data.orientation_correct%360*Math.PI/180;t.rotation.y=o}this.compassMesh=t,this.add(t)},Qo.prototype.generateCompass=function(t){var e=H.loadurl("https://template2.3dnest.cn/common/img/compassArrow.png"),i=new v.PlaneGeometry(1,1),n=new v.MeshBasicMaterial({map:e,transparent:!0,side:v.DoubleSide}),o=new v.Mesh(i,n);o.rotation.x=-Math.PI/2,o.position.z=.5;var r=H.getCanvasTexture(t),a=new v.SpriteMaterial({map:r,transparent:!0}),s=new v.Sprite(a);s.position.z=1.5;var l=new v.Group;return l.scale.set(.8,.8,.8),l.add(s,o),l},Qo.prototype.loadMattertags=function(){var t=this,e=o.Deferred();if(!z.mattertags.enabled||G.conf.screenshot)return e.resolve();var i=this,n=this.options.urlBase+"/play/data/"+this.modelid+"/nesttags";return P.get(n,{responseType:"json",fetchNum:1,prefetchFrom:"nesttags",auth:this.isPublic?null:z.authorizationHeader}).done(function(n){if(!(n&&n.setting&&n.setting.display))return e.resolve();var o,r=n.info,a=this.building_tag_enable,s=this.tour_tag_enable;if(a=isNaN(parseInt(a))?1:parseInt(a),s=isNaN(parseInt(s))?1:parseInt(s),r=r.filter(function(t){return 1==a||2!=parseInt(t.actiontype)}),this.entrance&&this.entrance.world&&1==a){var l=t.generateEntrance(t.entrance),c=new $o;c.scale.set(.01,.01,.01),c.position.copy(l.mesh.position),c.position.y=-.9,0!==l.mesh.rotation.x&&c.rotateY(l.mesh.rotation.x),0!==l.mesh.rotation.y&&c.rotateY(l.mesh.rotation.y),0!==l.mesh.rotation.z&&l.mesh.rotation.z<0&&c.rotateY(2*l.mesh.rotation.z),t.entranceMesh=l.mesh,t.userData.navigator_arrow=c,t.add(c),c.play()}var u=0;for(var h in G.titletags=[],r)if((o=r[h]).enable){if(37===o.details.templatetype)continue;this.mattertags[h]=new gn(this,h,o),o.showtitle&&o.tagtitle&&12!==o.details.templatetype&&(o.details.tagpictype=2,o.details.tagpicurl=o.tagtitle,this.mattertags[1e4+parseInt(h)]=new gn(this,1e4+parseInt(h),o)),12===o.details.templatetype&&G.titletags.push(this.mattertags[h])}if(o={actiontype:1,base:{x:1e4,y:1e4,z:1e4},details:{description:"faketag",subtype:1,tagpictype:1,tagpicurl:null,templatetype:9,title:"faketag"},enable:!0,flooridx:0,locationid:"location_01",normal:{x:0,y:0,z:0},showtitle:!1,stem:{direction:{x:0,y:0,z:0},enabled:!1},tagid:"faketag"},this.mattertags[2e4]=new gn(this,2e4,o),this.buildFloors.rooms&&1==s){var d="";u=0,this.buildFloors.rooms.forEach(function(t,e){t.connected_rooms&&(d=t.roomidx,t.connected_rooms.forEach(function(t,e){t.position.y?t.position.y=t.position.y+.3:t.position.x=0,o={actiontype:1,details:{description:"区域跳转标签",subtype:0,tagpictype:2,tagpicurl:null,templatetype:13,title:t.target_name},enable:!0,flooridx:0,locationid:"location_01",showtitle:!1,stem:{direction:{x:0,y:0,z:0},enabled:!1},tagid:"faketag",target_room:t.target_room,target_scene:t.target_scene,end_position:t.end_position,base:{x:t.position.x||0,y:t.position.y||0,z:t.position.z||0},roomidx:d},i.mattertags[3e4+parseInt(u)]=new gn(i,3e4+parseInt(u),o),u++}))})}e.resolve()}.bind(this)).fail(function(){Xo.warn("Getting tags failed, not displaying tags."),e.resolve()}),e},Qo.prototype.buildTagsForAddTag=function(t){var e=0;for(var i in this.mattertags)e++;var n=new gn(this,e,t);this.mattertags[e]=n,this.mattertags[e].build(),this.mattertags[e].disc.material.opacity=1},Qo.prototype.newBuildTagsForAddTag=function(t){var e=0;for(var i in this.delTag(t.tagid),this.mattertags)parseInt(i)<1e4&&(e=parseInt(i)+1);var n=new gn(this,e,t);this.mattertags[e]=n,this.mattertags[e].build(),this.mattertags[e].disc.material.opacity=1,t.showtitle&&t.tagtitle&&(e+=1e4,t.details.tagpictype=2,t.details.tagpicurl=t.tagtitle,this.mattertags[e]=new gn(this,e,t),this.mattertags[e].build(),this.mattertags[e].disc.material.opacity=1)},Qo.prototype.delTag=function(t){var e=null;for(var i in this.mattertags)if(this.mattertags[i]&&this.mattertags[i].tagid&&this.mattertags[i].tagid==t){e=this.mattertags[i];break}null!=e&&(e.floor.remove(e.obj3d),"open"!==e.boardState&&"active"!==e.boardState||(e.setClosedState(),e.boardState="closed"),delete this.mattertags[i])},Qo.prototype.newAddScene=function(t){},Qo.prototype.getSceneLength=function(){for(var t=this.settings.nestscenes.scenes,e=0,i=0;i<t.length;i++)0!==t[i].script&&void 0!==t[i].script||e++;return e},Qo.prototype.build360TagsForAddTag=function(t){var e=Object.keys(this.mattertags).length,i=this.mattertags[0],n=JSON.parse(JSON.stringify(i.data));n.base.x=t.base.x,n.base.y=t.base.y,n.base.z=t.base.z,n.details.title=t.details.title,n.details.templatetype=t.details.templatetype,n.locationid=t.locationid;var o=new gn(this,e,n);return this.mattertags[e]=o,this.mattertags[e].build(),this.mattertags[e].disc.material.opacity=1,n.locationid},Qo.prototype.removeScene=function(t){for(var e=this.heroLocations.length-1;0<=e;e--)this.heroLocations[e].panoId==t&&this.heroLocations.splice(e,1);G.d.updateModel()},Qo.prototype.loadPanos=function(){if(this.loadPanosPromise)return this.loadPanosPromise;var t=new Lo(this),e=this;return this.loadPanosPromise=t.load().then(function(t){return e.data.sweeps&&0<Object.keys(e.data.sweeps).length&&(t=t.filter(function(t){return!(!e.data.sweeps[t.locationid]||void 0===e.data.sweeps[t.locationid].enabled)&&e.data.sweeps[t.locationid].enable})),e.panos.extend(t.map(function(t){return new Ce(e,t.locationid,t,e.supportsTiles)})),e.panos.forEach(function(t){if(z.delBK&&1==t.alignmentType){var i=new Object;i.id=t.id,i.u=t.u,i.v=t.v,e.panosUV.push(i)}t.neighbourUUIDs&&(t.neighbourUUIDs.forEach(function(i){var n=e.panos.get(i);n&&e.panos.setNeighbour(t,n,!0)}),t.neighbourPanos=e.panos.getNeighbours(t)||e.panos.setNeighbour(t,t,!0))}),0===e.panos.length&&(Xo.warn("Model has no panos, turning off inside mode"),e.supportedModes[A.PANORAMA]=!1),o.when(e)}),this.loadPanosPromise},Qo.prototype.oldloadPanos=function(){if(this.loadPanosPromise)return this.loadPanosPromise;var t=new Lo(this);return this.loadPanosPromise=t.load().then(function(t){return this.data.sweeps&&0<Object.keys(this.data.sweeps).length&&(t=t.filter(function(t){return!(!this.data.sweeps[t.locationid]||void 0===this.data.sweeps[t.locationid].enabled)&&this.data.sweeps[t.locationid].enabled}.bind(this))),this.panos.extend(t.map(function(t){return new Ce(this,t.locationid,t,this.supportsTiles)}.bind(this))),this.panos.forEach(function(t){if(z.delBK&&1==t.alignmentType){var e=new Object;e.id=t.id,e.u=t.u,e.v=t.v,this.panosUV.push(e)}}.bind(this)),this.panos.forEach(function(t){t.neighbourUUIDs&&(t.neighbourUUIDs.forEach(function(e){var i=this.panos.get(e);i&&this.panos.setNeighbour(t,i,!0)}.bind(this)),t.neighbourPanos=this.panos.getNeighbours(t)||this.panos.setNeighbour(t,t,!0))}.bind(this)),0===this.panos.length&&(Xo.warn("Model has no panos, turning off inside mode"),this.supportedModes[A.PANORAMA]=!1),o.when(this)}.bind(this)),this.loadPanosPromise},Qo.prototype.loadHighlightReel=function(){var t=o.Deferred(),e=this.options.urlBase+"/play/data/"+this.modelid+"/nestscenes";return P.get(e,{responseType:"json",fetchNum:1,prefetchFrom:"nestscenes",auth:this.isPublic?null:z.authorizationHeader}).done(function(e){t.resolve()}.bind(this)).fail(function(){Xo.warn("Getting highlight reel failed, no highlights available"),t.resolve()}),t},Qo.prototype.waitForLoad=function(t,e){e()||(this.waitQueue.push({object:t,isLoadedCallback:e}),1===this.waitQueue.length&&this.emit("waiting"))},Qo.prototype.update=function(t){this.panos.update(t)},Qo.prototype.hide=function(){this.floors.hide()},Qo.prototype.show=function(){this.floors.show()},Qo.prototype.floorNames=function(){return this.floors.names()},Qo.prototype.warpDestFloors=function(t,e){if(t&&this.floors.length===t.length){var i=t.findIndex(function(t){return t}.bind(this));-1!==i&&this.setFloor(this.floors.list[i],null,e)}else this.toggleAllFloors(!0)},Qo.prototype.setFloor=function(t,e,i){this.allFloorsVisible&&this.emit("allfloors.toggled",!1,this.currentFloor),this.allFloorsVisible=!1,this._setFloor(t,e,i)},Qo.prototype.toggleAllFloors=function(t){this.allFloorsVisible=void 0!==t?t:!this.allFloorsVisible,this.emit("allfloors.toggled",this.allFloorsVisible,this.currentFloor),this._setFloor(this.currentFloor)},Qo.prototype._setFloor=function(t,e,i){e=e||this.mode,this.currentFloor=t,this.emit("floor.changed",t,e,this.currentFloor);var n=null;if(this.floors.list.forEach(function(t){t.toggle(t===this.currentFloor||this.allFloorsVisible,i||this.allFloorsVisible)}.bind(this)),e===A.PANORAMA){if(this.show(),this.shouldShowMattertags&&this.tagsShown)for(n in this.mattertags)this.mattertags[n].show(z.showFloorDuration)}else if((e===A.FLOORPLAN||e===A.DOLLHOUSE)&&this.shouldShowMattertags&&this.tagsShown)for(n in this.mattertags){var o=this.mattertags[n];this.allFloorsVisible?o.show(z.showFloorDuration):o.floor===this.currentFloor?o.show(z.showFloorDuration,z.showFloorDelay):o.hide(z.hideFloorDuration,z.hideFloorDelay)}var r=this,a=t;V.start(function(){},z.showFloorDelay,function(){r.floors.forEach(function(t){t.chunks.forEach(function(e){e.renderOrder=t===a?Y.visibleFloor:Y.ghostFloor})})}.bind(this))},Qo.prototype.toggleExplode=function(){this.floors.toggleExplodeHorizontal()},Qo.prototype.toggleExplodeUp=function(){this.floors.toggleExplodeVertical()},Qo.prototype.nextFloor=function(t){return this.floors.nextFloor(this.currentFloor,t)},Qo.prototype.addFloor=function(t){this.floors.add(t)},Qo.prototype.getFloorAtPoint=function(t){return this.floors.getFloorAtPoint(t)},Qo.prototype.getTagByIdx=function(t){return 1e4<=t&&(t-=1e4),this.mattertags[t]},Qo.prototype.getTagByTagid=function(t){for(var e in this.mattertags)if(this.mattertags[e].tagid===t)return this.mattertags[e];return null},Qo.prototype.addChunk=function(t,e){this.floors.getOrMakeFloor(t).addChunk(e),this.chunks.push(e)},Qo.prototype.setMode=function(t){if(!this.supportedModes[t])throw new p("Mode not supported for this model: "+t);this.mode=t,this.chunks.forEach(function(e){e.setMode(t)})},Qo.prototype.showPanoEnableTag=function(){var t=this;this.panos.forEach(function(e){if(1===e.alignmentType&&"editor"===t.SDKmode){var i={actiontype:1,base:{x:e.marker.position.x,y:e.marker.position.y,z:e.marker.position.z},details:{templatetype:9e3,subtype:0,time:"2017-09-15 03:39:33",title:"点击隐藏或显示全景点："+e.id,description:"pano使能",tagpictype:1},enable:!0,locationid:e.id,normal:{x:0,y:1,z:0},stem:{direction:{x:0,y:1,z:0},enabled:!0},tagid:"pano_"+e.id};t.newBuildTagsForAddTag(i)}})},Qo.prototype.hidePanoEnableTag=function(){var t=this;this.panos.forEach(function(e){if(1===e.alignmentType&&"editor"===t.SDKmode){var i="pano_"+e.id;t.delTag(i)}})},Qo.prototype.build=function(){var t=this;function e(t,e){return new v.Quaternion(t.x,t.y,t.z,t.w).multiply((new v.Quaternion).setFromAxisAngle(new v.Vector3(1,0,0),v.Math.degToRad(e)))}this.heroLocations=this.images.getHeroLocations(this.panos),this.has360Views=z.show360Views.enabled&&this.heroLocations.some(function(t){return t.cameraMode===A.PANORAMA&&this.panos.get(t.panoId)&&!this.panos.get(t.panoId).isAligned()}.bind(this)),null===this.heroImage&&Xo.warn("No hero image defined."),this.currentFloor=this.floors.last(),this.floors.build(),this.colliders=this.floors.reduce(function(t,e){return t.concat(e.collider.children)},[]);var i=[],n=[];for(var r in this.panos.forEach(function(t){2==t.alignmentType?n.push(t):i.push(t)}.bind(this)),i.forEach(function(t){t.build1(),t.on("enter",function(){t.floor!==this.currentFloor&&this.setFloor(t.floor)}.bind(this))}.bind(this)),n.forEach(function(t){t.build1(),t.on("enter",function(){t.floor!==this.currentFloor&&this.setFloor(t.floor)}.bind(this))}.bind(this)),this.panos.forEach(function(e){if(e.build2(),1===e.alignmentType&&G.conf.isNewEditVersion&&G.editPanos){var i={actiontype:1,base:{x:e.marker.position.x,y:e.marker.position.y,z:e.marker.position.z},details:{templatetype:9e3,subtype:0,time:"2017-09-15 03:39:33",title:"点击隐藏或显示全景点："+e.id,description:"pano使能",tagpictype:1},enable:!0,locationid:e.id,normal:{x:0,y:1,z:0},stem:{direction:{x:0,y:1,z:0},enabled:!0},tagid:"pano_"+e.id};t.buildTagsForAddTag(i)}}),this.floors.forEach(function(t){this.boundingBox.union(t.boundingBox)}.bind(this)),this.outline_fills&&(t=this,this.outline_fills.forEach(function(e){var i=t.floors.get(e.flooridx).boundingBox.min.y+.8;e.segments.forEach(function(e){var n=new v.Geometry;e.forEach(function(t){n.vertices.push(new v.Vector3(t.x,i,-t.y))});var o=new v.PointsMaterial({color:16711680,size:.01,transparent:!0,opacity:0}),r=new v.Points(n,o);r.geometry.computeBoundingBox(),t.boundingBox.union(r.geometry.boundingBox)})})),this.size=this.boundingBox.size(),this.center=this.boundingBox.center(),this.floors.forEach(function(t){Xo.info("Floor "+t+": "+t.children.length+" chunks, "+t.panos.length+" panos.")}.bind(this)),this.panos.populate_path_graph(),this.skybox=new Gi(this.boundingBox),this.skybox.matrixWorldNeedsUpdate=!0,this.add(this.skybox),this.mattertags)12!==this.mattertags[r].type&&this.mattertags[r].build();if(1==z.thirdCustomer&&(null==this.floorNavigationMesh||null==this.floorNavigationMesh)){var a=new v.PlaneBufferGeometry(this.boundingBox.max.x-this.boundingBox.min.x,this.boundingBox.max.z-this.boundingBox.min.z),s=new v.TextureLoader;s.setCrossOrigin(!0);var l=s.load("https://template2.3dnest.cn/dianli/"+this.modelid+".png"),c=new v.MeshBasicMaterial({map:l,side:v.FrontSide,transparent:!0,opacity:1});this.floorNavigationMesh=new v.Mesh(a,c);var u=(new v.Vector3).copy(this.boundingBox.center(new v.Vector3)),h=this.boundingBox.max.y,d=u.clone().setY(h);this.floorNavigationMesh.position.copy(d),"zq_sxex_17"==this.modelid?this.floorNavigationMesh.quaternion.copy(e(this.floorNavigationMesh.quaternion,-95)):"zq_dnjl_7"==this.modelid?this.floorNavigationMesh.quaternion.copy(e(this.floorNavigationMesh.quaternion,-92)):"zq_sxsx_18"==this.modelid?this.floorNavigationMesh.quaternion.copy(e(this.floorNavigationMesh.quaternion,-95)):"zq_ylck_24"==this.modelid?this.floorNavigationMesh.quaternion.copy(e(this.floorNavigationMesh.quaternion,-92)):this.floorNavigationMesh.quaternion.copy(e(this.floorNavigationMesh.quaternion,-90)),this.add(this.floorNavigationMesh)}return this.setCompassMesh(),Xo.debug("Done building model"),0<Ce.raycastsDone&&(Xo.warn("raycasts: "+Ce.raycastsDone),Xo.warn("raycasts skipped: "+Ce.raycastsSkipped)),this.buildRooms(),o.when(this)},Qo.prototype.buildRooms=function(){this.rooms=new Oo(this),this.rooms.createFromChunks(this.chunks),this.rooms.calcRoomBoundaries()},Qo.prototype.updateProjectedPanos=function(){this.projectedPano0&&this.projectedPano1&&this.setProjectedPanos(this.projectedPano0,this.projectedPano1,!1)},Qo.prototype.setProjectedPanos=function(t,e,i){null!=i||(i=!0),i=!!i,this.projectedPano0=t,this.projectedPano1=e,this.skybox.material.setProjectedPanos(t,e,i),this.chunks.forEach(function(n){n.materialInside.setProjectedPanos(t,e,i)})},Qo.prototype.setSide=function(t){this.floors.forEach(function(e){e.collider.material.side=t})},Qo.prototype.setSide=function(t){this.floors.forEach(function(e){e.collider.material.side=t})},Qo.prototype.heroCount=function(){return this.heroLocations?this.heroLocations.length:0},Qo.prototype.getHeroDescriptorByIndex=function(t){if(t<0)return Xo.warn("Model.getHeroDescriptorByHeroIndex() -> heroIndex is less than 0."),null;if(this.heroCount()<1)return Xo.warn("Model.getHeroDescriptorByIndex() -> No hero locations in this model"),null;var e=this.heroLocations[t];return void 0===e?(Xo.warn("Model.getHeroDescriptorByIndex() -> Index "+t+" is not a validindex"),null):e},Qo.prototype.findPanoramicHero=function(){for(var t in this.heroLocations)if(this.heroLocations[t].cameraMode===A.PANORAMA)return this.heroLocations[t];return null},Qo.prototype.listImagePanos=function(){var t=[],e=this;return this.images.forEach(function(i){if(i._camera&&i._camera._locationid){var n=e.panos.get(i._camera._locationid);n&&(e.supportsTiles||n.isLoaded("high")||t.push(n))}}),t},Qo.prototype.fadePanoMarkers=function(t,e){this.panos.fadeMarkerOpacity(t,e)},Qo.prototype.setSweepVisibility=function(t){this.panos.forEach(function(e){e.marker&&(e.marker.visible=t)})},Qo.prototype.outsideAllowed=function(){return this.supportedModes[A.DOLLHOUSE]&&this.supportedModes[A.FLOORPLAN]},Qo.prototype.setFloorsHeight=function(t){var e=t.locations.points,i=t.building.totalfloor,n={totalfloor:i,height:[]};if(i&&1<i){for(var o=[],r=0;r<i;r++)o.push([]);e.forEach(function(t){null!==t.flooridx&&o[t.flooridx].push(t.spot.z)}),o.forEach(function(t){t.sort(function(t,e){return t-e});var e=Math.floor(t.length/2);n.height.push(t[e])})}return n},Qo.prototype.destory=function(){this.panos.forEach(function(t){t.destory()})};var Zo=Qo,Ko=d(function(t){function e(){var t=new v.SphereBufferGeometry(z.skyboxRadius,20,5),e=new v.RawShaderMaterial({fragmentShader:$.skysphere.fragmentShader,vertexShader:$.skysphere.vertexShader,uniforms:v.UniformsUtils.clone($.skysphere.uniforms),side:v.BackSide,name:"skysphere"});e.uniforms.radius.value=t.parameters.radius,v.Mesh.call(this,t,e)}(e.prototype=Object.create(v.Mesh.prototype)).constructor=e,t.exports=e}),Jo=d(function(t,e){!function(i,n){var o="model",r="name",a="type",s="vendor",l="version",c="architecture",u="console",h="mobile",d="tablet",p="smarttv",f="wearable",m={extend:function(t,e){var i={};for(var n in t)e[n]&&e[n].length%2==0?i[n]=e[n].concat(t[n]):i[n]=t[n];return i},has:function(t,e){return"string"==typeof t&&-1!==e.toLowerCase().indexOf(t.toLowerCase())},lowerize:function(t){return t.toLowerCase()},major:function(t){return"string"==typeof t?t.replace(/[^\d\.]/g,"").split(".")[0]:n},trim:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},g={rgx:function(t,e){for(var i,o,r,a,s,l,c=0;c<e.length&&!s;){var u=e[c],h=e[c+1];for(i=o=0;i<u.length&&!s;)if(s=u[i++].exec(t))for(r=0;r<h.length;r++)l=s[++o],"object"==typeof(a=h[r])&&0<a.length?2==a.length?"function"==typeof a[1]?this[a[0]]=a[1].call(this,l):this[a[0]]=a[1]:3==a.length?"function"!=typeof a[1]||a[1].exec&&a[1].test?this[a[0]]=l?l.replace(a[1],a[2]):n:this[a[0]]=l?a[1].call(this,l,a[2]):n:4==a.length&&(this[a[0]]=l?a[3].call(this,l.replace(a[1],a[2])):n):this[a]=l||n;c+=2}},str:function(t,e){for(var i in e)if("object"==typeof e[i]&&0<e[i].length){for(var o=0;o<e[i].length;o++)if(m.has(e[i][o],t))return"?"===i?n:i}else if(m.has(e[i],t))return"?"===i?n:i;return t}},v={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},y={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[r,l],[/(opios)[\/\s]+([\w\.]+)/i],[[r,"Opera Mini"],l],[/\s(opr)\/([\w\.]+)/i],[[r,"Opera"],l],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark)\/([\w\.-]+)/i],[r,l],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[r,"IE"],l],[/(edge|edgios|edga)\/((\d+)?[\w\.]+)/i],[[r,"Edge"],l],[/(yabrowser)\/([\w\.]+)/i],[[r,"Yandex"],l],[/(puffin)\/([\w\.]+)/i],[[r,"Puffin"],l],[/(focus)\/([\w\.]+)/i],[[r,"Firefox Focus"],l],[/(opt)\/([\w\.]+)/i],[[r,"Opera Touch"],l],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[r,"UCBrowser"],l],[/(comodo_dragon)\/([\w\.]+)/i],[[r,/_/g," "],l],[/(micromessenger)\/([\w\.]+)/i],[[r,"WeChat"],l],[/(brave)\/([\w\.]+)/i],[[r,"Brave"],l],[/(qqbrowserlite)\/([\w\.]+)/i],[r,l],[/(QQ)\/([\d\.]+)/i],[r,l],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[r,l],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[r,l],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[r,l],[/(MetaSr)[\/\s]?([\w\.]+)/i],[r],[/(LBBROWSER)/i],[r],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[l,[r,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[l,[r,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[r,l],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[l,[r,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[r,/(.+)/,"$1 WebView"],l],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[r,/(.+(?:g|us))(.+)/,"$1 $2"],l],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[l,[r,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[r,l],[/(dolfin)\/([\w\.]+)/i],[[r,"Dolphin"],l],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[r,"Chrome"],l],[/(coast)\/([\w\.]+)/i],[[r,"Opera Coast"],l],[/fxios\/([\w\.-]+)/i],[l,[r,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[l,[r,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[l,r],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[r,"GSA"],l],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[r,[l,g.str,v.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[r,l],[/(navigator|netscape)\/([\w\.-]+)/i],[[r,"Netscape"],l],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[r,l]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[c,"amd64"]],[/(ia32(?=;))/i],[[c,m.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[c,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[c,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[c,/ower/,"",m.lowerize]],[/(sun4\w)[;\)]/i],[[c,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[c,m.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[o,s,[a,d]],[/applecoremedia\/[\w\.]+ \((ipad)/],[o,[s,"Apple"],[a,d]],[/(apple\s{0,1}tv)/i],[[o,"Apple TV"],[s,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[s,o,[a,d]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[o,[s,"Amazon"],[a,d]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[o,g.str,v.device.amazon.model],[s,"Amazon"],[a,h]],[/android.+aft([bms])\sbuild/i],[o,[s,"Amazon"],[a,p]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[o,s,[a,h]],[/\((ip[honed|\s\w*]+);/i],[o,[s,"Apple"],[a,h]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[s,o,[a,h]],[/\(bb10;\s(\w+)/i],[o,[s,"BlackBerry"],[a,h]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[o,[s,"Asus"],[a,d]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[s,"Sony"],[o,"Xperia Tablet"],[a,d]],[/android.+\s([c-g]\d{4}|so[-l]\w+)\sbuild\//i],[o,[s,"Sony"],[a,h]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[s,o,[a,u]],[/android.+;\s(shield)\sbuild/i],[o,[s,"Nvidia"],[a,u]],[/(playstation\s[34portablevi]+)/i],[o,[s,"Sony"],[a,u]],[/(sprint\s(\w+))/i],[[s,g.str,v.device.sprint.vendor],[o,g.str,v.device.sprint.model],[a,h]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[s,o,[a,d]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[s,[o,/_/g," "],[a,h]],[/(nexus\s9)/i],[o,[s,"HTC"],[a,d]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[o,[s,"Huawei"],[a,h]],[/(microsoft);\s(lumia[\s\w]+)/i],[s,o,[a,h]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[o,[s,"Microsoft"],[a,u]],[/(kin\.[onetw]{3})/i],[[o,/\./g," "],[s,"Microsoft"],[a,h]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[o,[s,"Motorola"],[a,h]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[o,[s,"Motorola"],[a,d]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[s,m.trim],[o,m.trim],[a,p]],[/hbbtv.+maple;(\d+)/i],[[o,/^/,"SmartTV"],[s,"Samsung"],[a,p]],[/\(dtv[\);].+(aquos)/i],[o,[s,"Sharp"],[a,p]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[s,"Samsung"],o,[a,d]],[/smart-tv.+(samsung)/i],[s,[a,p],o],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[s,"Samsung"],o,[a,h]],[/sie-(\w*)/i],[o,[s,"Siemens"],[a,h]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[s,"Nokia"],o,[a,h]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[o,[s,"Acer"],[a,d]],[/android.+([vl]k\-?\d{3})\s+build/i],[o,[s,"LG"],[a,d]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[s,"LG"],o,[a,d]],[/(lg) netcast\.tv/i],[s,o,[a,p]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[o,[s,"LG"],[a,h]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[o,[s,"Lenovo"],[a,d]],[/linux;.+((jolla));/i],[s,o,[a,h]],[/((pebble))app\/[\d\.]+\s/i],[s,o,[a,f]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[s,o,[a,h]],[/crkey/i],[[o,"Chromecast"],[s,"Google"]],[/android.+;\s(glass)\s\d/i],[o,[s,"Google"],[a,f]],[/android.+;\s(pixel c)[\s)]/i],[o,[s,"Google"],[a,d]],[/android.+;\s(pixel( [23])?( xl)?)\s/i],[o,[s,"Google"],[a,h]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[o,/_/g," "],[s,"Xiaomi"],[a,h]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[o,/_/g," "],[s,"Xiaomi"],[a,d]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[o,[s,"Meizu"],[a,d]],[/(mz)-([\w-]{2,})/i],[[s,"Meizu"],o,[a,h]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[o,[s,"OnePlus"],[a,h]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[o,[s,"RCA"],[a,d]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[o,[s,"Dell"],[a,d]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[o,[s,"Verizon"],[a,d]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[s,"Barnes & Noble"],o,[a,d]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[o,[s,"NuVision"],[a,d]],[/android.+;\s(k88)\sbuild/i],[o,[s,"ZTE"],[a,d]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[o,[s,"Swiss"],[a,h]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[o,[s,"Swiss"],[a,d]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[o,[s,"Zeki"],[a,d]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[s,"Dragon Touch"],o,[a,d]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[o,[s,"Insignia"],[a,d]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[o,[s,"NextBook"],[a,d]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[s,"Voice"],o,[a,h]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[s,"LvTel"],o,[a,h]],[/android.+;\s(PH-1)\s/i],[o,[s,"Essential"],[a,h]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[o,[s,"Envizen"],[a,d]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[s,o,[a,d]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[o,[s,"MachSpeed"],[a,d]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[s,o,[a,d]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[o,[s,"Rotor"],[a,d]],[/android.+(KS(.+))\s+build/i],[o,[s,"Amazon"],[a,d]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[s,o,[a,d]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[a,m.lowerize],s,o],[/(android[\w\.\s\-]{0,9});.+build/i],[o,[s,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[l,[r,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[r,l],[/rv\:([\w\.]{1,9}).+(gecko)/i],[l,r]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[r,l],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[r,[l,g.str,v.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[r,"Windows"],[l,g.str,v.os.windows.version]],[/\((bb)(10);/i],[[r,"BlackBerry"],l],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]*)/i,/linux;.+(sailfish);/i],[r,l],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[r,"Symbian"],l],[/\((series40);/i],[r],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[r,"Firefox OS"],l],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[r,l],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[r,"Chromium OS"],l],[/(sunos)\s?([\w\.\d]*)/i],[[r,"Solaris"],l],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[r,l],[/(haiku)\s(\w+)/i],[r,l],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[l,/_/g,"."],[r,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[r,"Mac OS"],[l,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[r,l]]},b=function(t,e){if("object"==typeof t&&(e=t,t=n),!(this instanceof b))return new b(t,e).getResult();var o=t||(i&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:""),r=e?m.extend(y,e):y;return this.getBrowser=function(){var t={name:n,version:n};return g.rgx.call(t,o,r.browser),t.major=m.major(t.version),t},this.getCPU=function(){var t={architecture:n};return g.rgx.call(t,o,r.cpu),t},this.getDevice=function(){var t={vendor:n,model:n,type:n};return g.rgx.call(t,o,r.device),t},this.getEngine=function(){var t={name:n,version:n};return g.rgx.call(t,o,r.engine),t},this.getOS=function(){var t={name:n,version:n};return g.rgx.call(t,o,r.os),t},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return o},this.setUA=function(t){return o=t,this},this};b.VERSION="0.7.19",b.BROWSER={NAME:r,MAJOR:"major",VERSION:l},b.CPU={ARCHITECTURE:c},b.DEVICE={MODEL:o,VENDOR:s,TYPE:a,CONSOLE:u,MOBILE:h,SMARTTV:p,TABLET:d,WEARABLE:f,EMBEDDED:"embedded"},b.ENGINE={NAME:r,VERSION:l},b.OS={NAME:r,VERSION:l},t.exports&&(e=t.exports=b),e.UAParser=b;var w=i&&(i.jQuery||i.Zepto);if(void 0!==w&&!w.ua){var x=new b;w.ua=x.getResult(),w.ua.get=function(){return x.getUA()},w.ua.set=function(t){x.setUA(t);var e=x.getResult();for(var i in e)w.ua[i]=e[i]}}}("object"==typeof window?window:h)});Jo.UAParser,new S("js/showcase"),v.ImageUtils.crossOrigin=z.crossOrigin;var tr={shaders:$,transitions:V,Model:Zo,Chunk:Ki,Floor:qi,Skybox:Ko,Reticule:Z,Panorama:Ce,DollhouseCamera:He,FloorplanCamera:qe,PanoramaCamera:Ge,DollhouseControls:Kt,FloorplanControls:te,PanoramaControls:jt,initS:function(t,e){if(!t.url)throw'getModel(): missing parameter "url"';t.autoload=void 0===t.autoload||t.autoload;var i=F.parseModelid(t.url);t.urlBase=i.urlBase,t.urlModel=i.urlModel,t.urlFiles=i.urlFiles;var n=this._getPlatformError();return n?o.Deferred().reject(n).promise():(this.options=t,this.createS(e))},_getPlatformError:function(){var t=(new Jo).getResult();return"IE"===t.browser.name&&parseInt(t.browser.major)<11?"webgl-unsupported":"iOS"===t.os.name&&/^[0-7][$\.]/.test(t.os.version)?"webgl-ios":window.WebGLRenderingContext?null:"webgl-unsupported"},_loadModel:function(t){return o.when(t)},createS:function(t){t.nestscenes=F.normalizeModeldata(t.nestscenes,J);var e=new Zo(this.options,t);return o.when(e)}},er=d(function(t){(function(e){var i=v,n=A,o=new S(e);t.exports={serialize:function(t){return encodeURI(JSON.stringify(t))},deserialize:function(t){try{var e=JSON.parse(decodeURI(t));return{mode:n.fromInt(e._type),panoId:e._locationid,position:(new i.Vector3).copy(e._viewpoint),quaternion:(new i.Quaternion).copy(e._rotation),zoom:e._zoom,floorVisibility:e.floor_visibility}}catch(e){o.debug("Not able to parse start location as JSON; falling back to old array style parsing");try{var r=t.split(","),a={x:parseFloat(r[2]),y:parseFloat(r[3]),z:parseFloat(r[4])},s={x:parseFloat(r[5]),y:parseFloat(r[6]),z:parseFloat(r[7]),w:parseFloat(r[8])};return{mode:n.fromInt(r[0]),panoId:r[1],position:(new i.Vector3).copy(a),quaternion:(new i.Quaternion).copy(s)}}catch(e){o.warn('Invalid start override, ignoring: "'+t+'"',e.message)}}return null}}}).call(h,"/js/controls/serializer.js")}),ir=(er.serialize,er.deserialize,d(function(t){(function(e){function i(t){return t=t||new l.Quaternion,0===Math.abs(t.x)&&0===Math.abs(t.y)&&0===Math.abs(t.z)&&0===Math.abs(t.w)&&(t.w=1),t}function n(t){return o.deserialize(t)}var o=er,r=J,a=g,s=A,l=v,c=new S(e);t.exports={optionsFromString:n,getStartCameraOptions:function(t,e,o,u){var h,d,p,f={};if(u||(h=e,p={},""!==(d=a.valueFromHash("start",""))&&(c.debug("Start override found in parameters, trying to parse..."),(p=n(d)||{}).tag=a.valueFromHash("tag",null),p.panoId&&(p.pano=h.get(p.panoId))),f=p),""!=(f=function(t){var e=a.valueFromHash("o",""),i={};if(e||(e=t.data.orientationkey),e){var n=t.data.orientations;if(null!=n&&null!=n){var o=n.length;for(i=0;i<o;i++)if(n[i].key==e)return n[i]}}return i}(t))&&f.enable){var m=f.location_id,g=f.rotation,v=e.list.length;if(1==f.type){for(f.mode=s.PANORAMA,o=0;o<v;o++)e.list[o].id==m&&(f.pano=e.list[o],f.position=f.pano.position,f.quaternion=g);return f.quaternion&&(f.quaternion=r.convertWorkshopQuaternion(f.quaternion)),f}for(o=0;o<v;o++)e.list[o].id==m&&(f.pano=e.list[o],f.position=f.pano.position,f.quaternion=f.pano.quaternion);return f}var y=a.valueFromHash("l","");if(""!=y){for(m=y,v=e.list.length,f.mode=s.PANORAMA,o=0;o<v;o++)e.list[o].id==m&&(f.pano=e.list[o],f.position=f.pano.position,f.quaternion=f.pano.quaternion);return f.quaternion&&(f.quaternion=r.convertWorkshopQuaternion(f.quaternion)),f}var b=function(t){var e=t.data.images.scenes,i=t.settings;if(i.jf&&i.jf.enable&&0<i.jf.dataset.length)return e[0]._camera;for(var n=0;n<e.length;n++){var o=e[n];if(null!==o.name&&"总述"!==o.name)return o._camera}return""}(t);if(""!==b){for(m=b._locationid,v=e.list.length,g=b._rotation,f.mode=s.PANORAMA,o=0;o<v;o++)e.list[o].id==m&&(f.pano=e.list[o],2==b._type?f.quaternion=f.pano.quaternionAutoScene:f.quaternion=g,f.position=f.pano.position);if(f.quaternion){var w=f.quaternion;f.quaternion=new l.Quaternion(w.x,w.y,w.z,w.w)}return f}var x,_=t.data.camera_start;if(_)try{(x=_).camera&&(x.camera.quaternion=i(x.camera.quaternion)),x.pano&&(x.pano.quaternion=i(x.pano.quaternion)),0<Object.keys(_).length&&0===Object.keys(f).length&&(f.mode=s.convertWorkshopModeInt(_.mode),f.position=_.camera.position,f.quaternion=_.camera.quaternion,f.zoom=r.convertWorkshopOrthoZoom(_.camera.zoom),_.pano&&(f.pano=e.get(_.pano.locationid),c.debug("Using camera_start"),c.debug("Modeldata pano: ",f.pano.quaternion),c.debug("Camera start pano: ",_.pano.quaternion)),f.mode!==s.PANORAMA&&(f.floorVisibility=t.heroImage._camera.floor_visibility))}catch(t){c.warn(t.message)}if(0===Object.keys(f).length&&(f=function(t,e){if(!t.heroImage||!t.heroImage._camera._viewpoint)return{};var i={},n=t.heroImage._camera;c.debug("Using start position from thumbnail image"),i.position=n._viewpoint,i.quaternion=n._rotation;try{i.mode=s.convertWorkshopModeInt(0),i.mode===s.PANORAMA?i.pano=e.get(n._locationid):i.floorVisibility=n.floor_visibility}catch(t){c.debug(t.message)}return i}(t,e)),t.outsideAllowed()||f.mode===s.PANORAMA||(f={}),0===Object.keys(f).length){for(o=0;o<e.list.length&&1!=e.list[o].alignmentType;o++);f.pano=e.list[o],f.position=f.pano.position,f.quaternion=f.pano.quaternionAutoScene,c.info("Starting at 1st pano "+f.pano.id)}return f.mode=f.mode||s.PANORAMA,f.pano||(c.debug("No pano selected, choosing the closest one to player location"),f.pano=e.findClosest(f.position||o)),f.mode===s.MESH&&(f.mode=s.PANORAMA,f.position=f.pano?f.pano.position:o),f}}}).call(h,"/js/util/camera.js")})),nr=(ir.optionsFromString,ir.getStartCameraOptions,d(function(t){(function(e){function i(t,e){this.model=t,this.panos=t.panos,this.player=e,this.imagePanos=this.listImagePanos(),this.retryMinimumTime=1e4}var n=A,o=Ce,r=new S(e);i.prototype.start=function(){this.loadNextPano(function(t){t?this.start():(r.debug("No suitable pano loaded, waiting a little while before looking again"),setTimeout(function(){this.start()}.bind(this),1e3))}.bind(this))},i.prototype.validLoadTarget=function(t){return t&&!t.isLoaded("high")&&Date.now()-t.failedLoadingAt>this.retryMinimumTime},i.prototype.listImagePanos=function(){var t=[],e=this;return this.model.images.forEach(function(i){if(i._camera&&i._camera._locationid){var n=e.model.panos.get(i._camera._locationid);n&&!n.isLoaded("high")&&t.push(n)}}),t},i.prototype.nextNotLoadedImage=function(){for(;0<this.imagePanos.length;){var t=this.imagePanos[0];if(!t.isLoaded("high"))return t;this.imagePanos.shift()}return null},i.prototype.loadNextPano=function(t){var e,i,a=this.model.waitQueue.filter(function(t){return t.object instanceof o});0<a.length?(e=a[0].object,r.debug("Overrode pano selection: Flying to an unloaded pano "+e.id)):this.validLoadTarget(this.player.currentPano)?(e=this.player.currentPano,r.debug("Overrode pano selection: Currently at an unloaded pano "+e.id)):this.validLoadTarget(this.player.closestPano)?(e=this.player.closestPano,r.debug("Overrode pano selection: Hovering over an unloaded pano "+e.id)):this.validLoadTarget(this.nextNotLoadedImage())?(i="high",e=this.imagePanos[0],r.debug("Overrode pano selection: Highlight image "+e.id)):this.player.mode===n.PANORAMA&&(e=this.panos.lowestByScore([this.validLoadTarget.bind(this),o.filters.isNeighbourPanoTo(this.player.currentPano)],[o.scoreFunctions.distance(this.player.currentPano),o.scoreFunctions.direction(this.player.position,this.player.getDirection()),o.scoreFunctions.inFieldOfView(this.player.position,this.player.getDirection())]))&&r.debug("Normal pano selection: neighbor "+e.id),e?(i=i||e.isLoaded("low")?"high":"low",r.debug("Preloading "+i+"-res pano "+e.id),e.loadCube(i).done(t).fail(function(){r.warn("Failed preloading pano",e.id,", marking it as failed and forgetting it for a while"),t()})):t&&t(null)},t.exports=i}).call(h,"/js/preloaders.js")})),or=d(function(t){!function(){if("performance"in window==0&&(window.performance={}),Date.now=Date.now||function(){return(new Date).getTime()},"now"in window.performance==0){var t=Date.now();performance.timing&&performance.timing.navigationStart&&(t=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-t}}}();var e,i,n,o,r,a,s,l=l||{};e=l,n=i=0,o=function(t,e,i,n){return{uid:t,message:e,type:i,waitForResponse:n}},r={},a={},s=null,window.addEventListener("message",function(t){var i=t.origin||t.originalEvent.origin;e.receiveMessage(i,t.data,t.source)},!1),e.setReceiver=function(t){s=t},e.sendMessage=function(t,e,a,s){var l=i++;if(s){var c={targetWindow:t,uid:l,timestamp:performance.now(),onResponse:s};r[l]=c}var u=o(l,a,n,!!s);t.postMessage(u,e)},e.receiveMessage=function(t,e,i){if(e){if(e.type===n&&e.waitForResponse){var o={uid:e.uid,timestamp:performance.now(),sourceWindow:i};a[e.uid]=o}if(1===e.type){var l=e.uid,c=r[l];r[l]=null,c.onResponse&&c.onResponse(e.message)}}s&&s(t,e.message,e.uid)},e.respondToMessage=function(t,e){var i=a[t];if(i&&i.sourceWindow){var n=o(t,e,1,!1);i.sourceWindow.postMessage(n,"*"),a[n.uid]=null}},t.exports=l}),rr=d(function(t){(function(e){function i(t,e,i){t&&(t=t.toLowerCase().trim());var n=new s.Vector3(0,1,0),o=Math.PI/3,r=Math.PI/2;switch(t){case"left":i.copy(e),i.applyAxisAngle(n,r);break;case"right":i.copy(e),i.applyAxisAngle(n,-r);break;case"forwardleft":i.copy(e),i.applyAxisAngle(n,o);break;case"forwardright":i.copy(e),i.applyAxisAngle(n,-o);break;case"forward":default:i.copy(e)}return i}function n(t,e){if(t){var i={pano:t,lookAtPoint:null,duration:null,maxDistanceOverride:null,skipWarpingCheck:!1};this.player.flyToPano(i,function(){e&&e({success:!0,message:"Transition complete."})})}else f.warn("Automation -> clickPanoObject: Unable to find pano."),e&&e({success:!1,error:"Unable to find pano."})}function o(t,e){e.copy(h.FORWARD),t.getDirection(e)}var r,a,s=v,l=A,c=et,u=z,h=tt,d=or,p=J,f=new S(e),m=null,g=(a=new s.Vector3,function(t){t?(a.copy(t.position),a.add(t.discPosition),p.projectPositionToCanvas(a,this.player.camera,a),this.click(a.x,a.y)):f.warn("Automation -> clickMattertagObject: Unable to find Mattertag.")}),y=(r=new s.Vector3,function(t){var e=this.player.getDirection(),i=0,n=0;if(this.player.mode===l.PANORAMA)i=u.insideLookLimitUp,n=u.insideLookLimitDown;else{if(this.player.mode!==l.DOLLHOUSE)return t;i=u.dollhouseDefault.maxPolarAngle,n=u.dollhouseDefault.minPolarAngle}r.copy(e),r.y=0,r.normalize();var o=-s.Math.radToDeg(r.angleTo(e));return(i-=o)<t&&(t=i),t<(n-=o)&&(t=n),t});d.setReceiver(function(t,e,i){if(e){var n=e.targetFunction,o=e.params;if(n){var r=m[n];if(r){(o=o||{}).onDone=function(t){d.respondToMessage(i,t)};var a=[];for(var s in o)o.hasOwnProperty(s)&&a.push(o[s]);r.apply(m,a)}}}});var b,w,x,_,T={};m={handleToObject:{},objectToHandle:{},handleCount:0,director:null,player:null,init:function(t,e){this.director=t,this.player=e;var i=T.onInitComplete;i?i({success:!0,message:"Init complete."}):T.onInitComplete={completed:!0}},findRankedPano:(x=new s.Vector3,_=new s.Vector3,function(t,e){o(this.player,_),i(e,_,x);var n=this.player.rankedPanoInDirection(t,x);if(n){var r=this.objectToHandle[n.id];return r||(this.objectToHandle[n.id]=r=this.handleCount++,this.handleToObject[r]=n),r}return f.warn("Automation -> findRankedPano: Unable to find nearby pano."),-1}),findRankedMattertag:(b=new s.Vector3,w=new s.Vector3,function(t,e){o(this.player,w),i(e,w,b);var n=this.player.rankedMattertagInDirection(t,b);if(n){var r=this.objectToHandle[n.i];return r||(this.objectToHandle[n.i]=r=this.handleCount++,this.handleToObject[r]=n),r}return f.warn("Automation -> findRankedMattertag: Unable to find nearby Mattertag."),-1}),clickNearestMattertag:function(t){this.clickRankedMattertag(0,t)},clickRankedMattertag:function(t,e){var i=function(t,e){var i=this.findRankedMattertag(t,e);return 0<=i?this.handleToObject[i]:(f.warn("Automation -> findRankedMattertagObject: Unable to find nearby Mattertag."),null)}.call(this,t,e);i&&g.call(this,i)},clickNearestPano:function(t,e){this.clickRankedPano(0,t,e)},clickRankedPano:function(t,e,i){var o=function(t,e){var i=this.findRankedPano(t,e);return 0<=i?this.handleToObject[i]:(f.warn("Automation -> findRankedPanoObject: Unable to find nearby pano."),null)}.call(this,t,e);o?n.call(this,o,i):i(null)},clickPano:function(t,e){var i=this.handleTable[t];i?n.call(this,i,e):e(null)},rotate:function(){function t(t){return"right"===t?c.RIGHTARROW:"left"===t?c.LEFTARROW:"up"===t?c.I:"down"===t?c.K:void 0}var e=(new s.Vector3,new s.Vector3),i=new s.Vector3(0,0,0),n=!1,o=new s.Vector3;return function(r,a,l){if(!n){if(!a||isNaN(a))return f.warn("Automation -> rotate: Invalid rotation angle."),void(l&&l({success:!1,error:"Invalid rotation angle."}));"right"===r||"left"===r?(i.set(0,1,0),"right"===r&&(a=-a)):"up"===r||"down"===r?(i.set(1,0,0),"down"===r&&(a=-a),a=y.call(this,a)):(f.warn("Automation -> rotate: Invalid direction for rotation: "+r),l&&l({success:!1,error:"Invalid direction for rotation."})),a=s.Math.degToRad(a),e=this.player.getDirection(),n=!0;var c=this.player.controls[this.player.mode];c.handleKeyDown(t(r));var u=0;(function i(){o.copy(h.FORWARD),this.player.getDirection(o);var s=o.angleTo(e);(u+=Math.abs(s))>=Math.abs(a)?(n=!1,c.handleKeyUp(t(r)),l&&l({success:!0,message:"Rotation complete."})):(e.copy(o),window.setTimeout(i.bind(this),4))}).bind(this)()}}}(),click:function(t,e,i){!0===i&&(t=t/100*window.innerWidth,e=e/100*window.innerHeight),this.player.handleInputStart(t,e),this.player.updateIntersect(),this.player.handleInputEnd(t,e)},mouseOver:function(t,e,i){!0===i&&(t=t/100*window.innerWidth,e=e/100*window.innerHeight),this.player.handleInputMove(t,e),this.player.updateIntersect()}},t.exports=m,window.__showcaseAutomationApi=m}).call(h,"/js/automation.js")}),ar={ContextCreated:"scene-renderer-context-created",AfterRender:"after-render",MemoryUsageUpdated:"scene-renderer-memory-usage-updated"},sr=d(function(t){function e(t){p.call(this,t)}e.prototype=Object.create(p.prototype),t.exports=e}),lr=d(function(t,e){var i;t.exports=((i=function(){function t(t){return o.appendChild(t.dom),t}function e(t){for(var e=0;e<o.children.length;e++)o.children[e].style.display=e===t?"block":"none";n=t}var n=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",function(t){t.preventDefault(),e(++n%o.children.length)},!1);var r=(performance||Date).now(),a=r,s=0,l=t(new i.Panel("FPS","#0ff","#002")),c=t(new i.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=t(new i.Panel("MB","#f08","#201"));return e(0),{REVISION:16,dom:o,addPanel:t,showPanel:e,begin:function(){r=(performance||Date).now()},end:function(){s++;var t=(performance||Date).now();if(c.update(t-r,200),a+1e3<t&&(l.update(1e3*s/(t-a),100),a=t,s=0,u)){var e=performance.memory;u.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){r=this.end()},domElement:o,setMode:e}}).Panel=function(t,e,i){var n=1/0,o=0,r=Math.round,a=r(window.devicePixelRatio||1),s=80*a,l=48*a,c=3*a,u=2*a,h=3*a,d=15*a,p=74*a,f=30*a,m=document.createElement("canvas");m.width=s,m.height=l,m.style.cssText="width:80px;height:48px";var g=m.getContext("2d");return g.font="bold "+9*a+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=i,g.fillRect(0,0,s,l),g.fillStyle=e,g.fillText(t,c,u),g.fillRect(h,d,p,f),g.fillStyle=i,g.globalAlpha=.9,g.fillRect(h,d,p,f),{dom:m,update:function(l,v){n=Math.min(n,l),o=Math.max(o,l),g.fillStyle=i,g.globalAlpha=1,g.fillRect(0,0,s,d),g.fillStyle=e,g.fillText(r(l)+" "+t+" ("+r(n)+"-"+r(o)+")",c,u),g.drawImage(m,h+a,d,p-a,f,h,d,p-a,f),g.fillRect(h+p-a,d,a,f),g.fillStyle=i,g.globalAlpha=.9,g.fillRect(h+p-a,d,a,r((1-l/v)*f))}}},i)}),cr=ar,ur=p,hr=sr,dr=ot.EventEmitter;function pr(t,e,i){this.scene=t,this.camera=e,this.renderer=null,this.stats=null,this.effects=i,this.animateCallback=null,this.composer=null,this.qualityManager=null,t.renderWidth=0,t.renderHeight=0,this.updateClock=new v.Clock,this.components=[],this.updateListeners=[],this.resizeListeners=[],this.forceUpdateSize=!1,this.started=!1,this.animationFrameState=!0,this.animationFrameHandle=null}var fr,mr,gr,vr,yr,br,wr,xr,_r,Sr,Tr,Mr,Ir,Pr,Cr,Ar,Er,Lr,Dr,kr,Rr,Or,Fr=-1,Nr=0;window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame,window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame,(pr.prototype=Object.create(dr.prototype)).addComponent=function(t){this.components.push(t),t.update&&this.updateListeners.push(t),t.setSize&&(this.resizeListeners.push(t),this.forceUpdateSize=!0)},pr.prototype.removeComponent=function(t){var e=function(e){return e!=t};this.components=this.components.filter(e),this.updateListeners=this.updateListeners.filter(e),this.resizeListeners=this.resizeListeners.filter(e)},pr.prototype.destory=function(){this.components=[],this.updateListeners=[],this.resizeListeners=[],this.stopAnimationFrame()},pr.prototype.start=function(t){if(this.started)throw new ur("Can't start SceneRenderer, already started");this.createContext(t),this.boluoVrInit(),this.initComposer(),this.started=!0,this.animateFrame=this.animateFrame.bind(this),this.animateFrame()},pr.prototype.createContext=function(t){try{this.renderer=new v.WebGLRenderer({preserveDrawingBuffer:!0,antialias:!1}),this.container=t;var e=G.conf.screenshot?2:1;this.renderer.autoClear=!0,g.isMobile()?this.renderer.setPixelRatio(e||1):this.renderer.setPixelRatio(window.devicePixelRatio?window.devicePixelRatio:1),this.renderer.setSize(t.clientWidth,t.clientHeight),this.emit(cr.ContextCreated)}catch(t){throw new hr("Unable to create a WebGL rendering context")}t.appendChild(this.renderer.domElement)},pr.prototype.getTextureTypeFromTarget=function(t,e){switch(e){case t.TEXTURE_CUBE_MAP_POSITIVE_X:case t.TEXTURE_CUBE_MAP_NEGATIVE_X:case t.TEXTURE_CUBE_MAP_POSITIVE_Y:case t.TEXTURE_CUBE_MAP_NEGATIVE_Y:case t.TEXTURE_CUBE_MAP_POSITIVE_Z:case t.TEXTURE_CUBE_MAP_NEGATIVE_Z:return 1;case t.TEXTURE_2D:return 0;default:return null}},pr.prototype.overrideTextures=function(){var t=this.renderer.context,e=0,i=t.createTexture;t.createTexture=function(){var n=i.call(t);return n.id=e++,this.textures[n.id]=n}.bind(this);var n=t.texImage2D;t.texImage2D=function(e,i,o,r,a,s,l,c,u){var h,d=this.getTextureTypeFromTarget(t,e);h=1===d?t.getParameter(t.TEXTURE_BINDING_CUBE_MAP):t.getParameter(t.TEXTURE_BINDING_2D),void 0!==l?n.call(t,e,i,o,r,a,s,l,c,u):(l=r,c=a,r=(u=s).naturalWidth,a=u.naturalHeight,n.call(t,e,i,o,l,c,u));var p=this.textures[h.id];p.width=1===d?6*r:r,p.height=a}.bind(this);var o=t.deleteTexture;t.deleteTexture=function(e){delete this.textures[e.id],o.call(t,e)}.bind(this)},pr.prototype.initComposer=function(){this.composer=new v.EffectComposer(this.renderer),this.composer.addPass(new v.RenderPass(this.scene,this.camera)),this.composer.addPass(this.effects.hblurPass),this.composer.addPass(this.effects.vblurPass)},pr.prototype.setSize=function(t,e){this.renderWidth=t,this.renderHeight=e,this.effects.aspect=t/e,this.renderer.setSize(t,e),this.composer.setSize(t,e);for(var i=0;i<this.resizeListeners.length;i++)this.resizeListeners[i].setSize(t,e);G.render=this},pr.prototype.render=function(){0<this.effects.currentBlur?this.composer.render():this.renderer.render(this.scene,this.camera)},pr.prototype.boluoVrInit=function(){this.isHuawei5X=g.detectHUAWEI5X(),this.oldRenderer=this.renderer,this.newRenderer=new this.vrRenderer(this.renderer,this,this.camera);var t=this;window._vrEnabled=!1,Object.defineProperty(t,"vrEnabled",{get:function(){return window._vrEnabled},set:function(e){(e=!!e)?(t.renderer=t.newRenderer,window.vrMarkers.forEach(function(t){t.visible=!0})):(t.renderer=t.oldRenderer,window.vrMarkers.forEach(function(t){t.visible=!1})),t.cursor.visible=e,t.setSize(t.container.clientWidth,t.container.clientHeight),window._vrEnabled=e}}),this.createCursor(.5,!1,1,16777215,0);var e={setSize:function(e,i){t.camera.aspect=e/i}};this.resizeListeners.push(e),this.vrLoadingInit()},pr.prototype.vrLoadingInit=function(){var t=new(t=function(t){var e=this,i=new v.RingGeometry(1.3,1.5,32,32,0,1.2*Math.PI),n=new v.MeshBasicMaterial({color:4967932,side:v.DoubleSide}),o=new v.Mesh(i,n);(this.mesh=o).position.z=-2,o.scale.set(.08,.08,.08),o.visible=!1,t.add(o),e.enabled=!1,this.update=function(t){1==e.enabled&&(o.rotation.z+=15*t)}})(this.camera);window.Loading=t,this.updateListeners.push(t)},pr.prototype.createCursor=function(t,e,i,n,o){var r,a=new v.SpriteMaterial({opacity:i,color:n,transparent:e,map:this.boluoGetTexture(X.splitUrl("https://template2.3dnest.cn/common/img/cursor.png")),needsUpdate:!0,side:v.DoubleSide});a.map.offset=new v.Vector2(1/17*o,0),a.map.repeat=new v.Vector2(1/17,1),a.depthTest=!1,a.blending=v.AdditiveBlending,(r=new v.Sprite(a)).scale.set(t,t,t),r.position.z=-2,r.visible=!1,r.name="cursor",this.camera.add(r),this.scene.add(this.camera),this.cursor=r;var s=new this.CursorAnimation(this.scene,r,this.camera);this.cursor.triggerTargetEvent=s.triggerTargetEvent,this.updateListeners.push(s)},pr.prototype.CursorAnimation=function(t,e,i){this.cursor=e,this.raycaster=new v.Raycaster,this.targetEventObj={},this.type=1,this.tweenFlag=!0,this.target=i,this.euler=new v.Euler,this.q0=new v.Quaternion,this.q1=new v.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),this.zee=new v.Vector3(0,0,1),this.alpha=-1e3,this.beta=-1e3,this.gamma=-1e3,this.orient=v.Math.degToRad(window.orientation||0);var n=this;window.addEventListener("orientationchange",function(){n.orient=v.Math.degToRad(window.orientation||0)}),window.addEventListener("deviceorientation",function(t){var e=v.Math.degToRad(t.alpha),i=v.Math.degToRad(t.beta),r=v.Math.degToRad(t.gamma);if(this.isHuawei5X?(-1e3===n.alpha&&(n.alpha=e),-1e3===n.beta&&(n.beta=i),-1e3===n.gamma&&(n.gamma=r),.06<Math.abs(e-n.alpha)&&(n.alpha=e),.006<Math.abs(i-n.beta)&&(n.beta=i),.006<Math.abs(r-n.gamma)&&(n.gamma=r)):(n.alpha=e,n.beta=i,n.gamma=r),z.vrDebug){o("#info-device-orientation").css("display","block");var a="";a+="alpha=("+n.alpha+")<BR/>",a+="beta=("+n.beta+")<BR/>",a+="gamma="+n.gamma+"<BR/>",document.getElementById("info-device-orientation").innerHTML=a}}),this.setObjectQuaternion=function(t,e,o,r,a){n.euler.set(o,e,-r,"YXZ"),t.setFromEuler(n.euler),t.multiply(n.q1),t.multiply(n.q0.setFromAxisAngle(n.zee,-a)),i.updateMatrixWorld()},parent!==window&&window.addEventListener("message",function(t){var e,i,o,r,a=JSON.parse(t.data),s=-1!==window.navigator.userAgent.indexOf("KIW-TL00H");a&&a.alpha&&a.beta&&a.gamma&&(e=s,i=v.Math.degToRad(a.alpha),o=v.Math.degToRad(a.beta),r=v.Math.degToRad(a.gamma),e?(-1e3===n.alpha&&(n.alpha=i),-1e3===n.beta&&(n.beta=o),-1e3===n.gamma&&(n.gamma=r),.06<Math.abs(i-n.alpha)&&(n.alpha=i),.006<Math.abs(o-n.beta)&&(n.beta=o),.006<Math.abs(r-n.gamma)&&(n.gamma=r)):(n.alpha=i,n.beta=o,n.gamma=r))}),this.update=function(t){TWEEN.update(),window._vrEnabled&&(this.setObjectQuaternion(this.target.quaternion,this.alpha,this.beta,this.gamma,this.orient),this.triggerTargetEvent())},this.triggerTargetEvent=function(){var t=this.choseObj(),e=t?t.object:void 0;(this.targetEventObj.currentObj=e)!==this.targetEventObj.lastObj&&(e&&this.autoCursorPosition(t),1===this.type?(this.cursorAnimate&&this.cursorAnimate.stop(),e&&e.enabled&&this.startAnimate(function(){this.clickCallback(e)}.bind(this))):this.type,this.targetEventObj.lastObj=e)},this.choseObj=function(){this.raycaster.setFromCamera({x:0,y:0},i),this.raycaster.ray;var t=window.vrMarkers,e=this.raycaster.intersectObjects(t);if(0<e.length)return e[0]},this.clickCallback=function(t){this.runTHREEAction(t,"onclick")},this.runTHREEAction=function(t,e){switch(e){case"onclick":t._listeners&&t._listeners.click&&t._listeners.click.forEach(function(t){t()});break;case"onhover":t._listeners&&t._listeners.hover&&t._listeners.hover.forEach(function(t){t()});break;case"onout":t._listeners&&t._listeners.out&&t._listeners.out.forEach(function(t){t()})}},this.startAnimate=function(t){this.tweenFlag&&this.initAnimation(t)},this.initAnimation=function(t){var e=this,i=this.cursor.material.map.offset;e.tweenFlag=!1,this.cursorAnimate=new TWEEN.Tween(i).to({x:1},1e3).onStart(function(){e.tweenFlag=!1}).onStop(function(){e.tweenFlag=!0,this.x=0,i.x=0}).onUpdate(function(){}).onComplete(function(){t(),i.x=0,setTimeout(function(){e.tweenFlag=!0},1500)}),this.cursorAnimate.easing(function(t){return Math.floor(17*t)/17}),this.cursorAnimate.start()},this.autoCursorPosition=function(t){var e=Math.abs(t.distance-10);this.cursor.position.z=-e,e/=10,this.cursor.scale.set(e,e,e)}},pr.prototype.vrRenderer=function(t,e,i){var n=new e.vrCamera(i);n.bananaAspect=.8,this.width,this.height,e=this,this.setSize=function(i,n){t.setSize.call(this,i,n),e.width=i,e.height=n},this.render=function(e,i,o,r){var a,s;if(i.__RESS__SKIP__STEREO__)return t.render(e,i,o,r);if("PerspectiveCamera"===i.type)a=n.cameraL,s=n.cameraR,e.updateMatrixWorld(),null===i.parent&&i.updateMatrixWorld(),n.vrCameraUpdate(i);else{if("OrthographicCamera"!==i.type)return DEBUG&&void 0;a=s=i}t.setScissorTest(!0),t.setScissor(0,0,this.width/2,this.height),t.setViewport(0,0,this.width/2,this.height),t.render.call(this,e,a,o,r),t.setScissor(this.width/2,0,this.width/2,this.height),t.setViewport(this.width/2,0,this.width/2,this.height),t.render.call(this,e,s,o,r),t.setScissorTest(!1)},this.__proto__={__proto__:t}},pr.prototype.vrCamera=function(t){this.type="StereoCamera",this._aspect=1,this._overlap=.064,this.cameraL=new v.PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new v.PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this.eyeRight=new v.Matrix4,this.eyeLeft=new v.Matrix4,this.vrCameraNeedsUpdate=!0,Object.defineProperty(this,"bananaAspect",{get:function(){return this._aspect},set:function(t){this._aspect!==t&&(this.vrCameraNeedsUpdate=!0),this._aspect=t}}),Object.defineProperty(this,"overlap",{get:function(){return this._overlap},set:function(t){this._overlap!==t&&(this.vrCameraNeedsUpdate=!0),this._overlap=t}}),this.vrCameraUpdate=function(t){if(this.vrCameraNeedsUpdate=this.vrCameraNeedsUpdate||this.bananaFov!==t.fov||this.bananaReal_aspect!==t.aspect*this.bananaAspect||this.bananaNear!==t.near||this.bananaFar!==t.far,this.vrCameraNeedsUpdate){this.vrCameraNeedsUpdate=!1,this.bananaFocus=t.focus,this.bananaFov=t.fov,this.bananaReal_aspect=t.aspect*this.bananaAspect,this.bananaNear=t.near,this.bananaFar=t.far,this.bananaFocus=10;var e,i,n=t.projectionMatrix.clone(),o=this.overlap/2,r=o*this.bananaNear/this.bananaFocus,a=this.bananaNear*Math.tan(Math.PI/180*this.bananaFov*.5);this.eyeLeft.elements[12]=-o,this.eyeRight.elements[12]=o,e=-a*this.bananaReal_aspect+r,i=a*this.bananaReal_aspect+r,n.elements[0]=2*this.bananaNear/(i-e),n.elements[8]=(i+e)/(i-e),this.cameraL.projectionMatrix.copy(n),e=-a*this.bananaReal_aspect-r,i=a*this.bananaReal_aspect-r,n.elements[0]=2*this.bananaNear/(i-e),n.elements[8]=(i+e)/(i-e),this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(this.eyeLeft),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(this.eyeRight)}},pr.prototype.boluoGetTexture=function(t){var e=new v.TextureLoader;return e.crossOrigin="anonymous",e.load(t)},pr.prototype.updateScreenSize=function(){(this.container.clientWidth!=this.renderWidth||this.container.clientHeight!=this.renderHeight||this.forceUpdateSize)&&(this.setSize(this.container.clientWidth,this.container.clientHeight),this.forceUpdateSize=!1)},pr.prototype.updateComponents=function(){for(var t=Math.min(1,this.updateClock.getDelta()),e=0;e<this.updateListeners.length;e++)this.updateListeners[e].update(t)},pr.prototype.animateFrame=function(){if(this.animationFrameHandle=window.requestAnimationFrame(this.animateFrame),this.updateScreenSize(),this.updateComponents(),this.render(),this.stats&&this.stats.update(),-1==Fr&&G.model.settings.basic&&G.model.settings.basic.user){var t=G.model.settings.basic.user.group;Fr=15==t?1:0}if(1==Fr&&!0===G.startEntryPage&&!G.frameRate&&G.player&&"panorama"===G.player.mode){fr||(fr=(performance||Date).now());var e=function(){var t;Nr++;var e=(performance||Date).now();if(fr+1e3<=e&&(t=1e3*Nr/(e-fr),fr=e,Nr=0),t)return Math.ceil(t)}();G.frameRate=e}this.computeCompassAngle(),this.emit(cr.AfterRender)},pr.prototype.computeCompassAngle=function(){var t=this.camera.getWorldDirection(new v.Vector3),e=new v.Vector2(t.z,t.x),i=e.length(),n=Math.acos(e.x/i);e.y<0&&(n*=-1),n=180*n/Math.PI+180,this.emit("compass",n)},pr.prototype.stopAnimationFrame=function(){this.animationFrameState=!1,window.cancelAnimationFrame(this.animationFrameHandle)},pr.prototype.getImageData=(mr=document.createElement("canvas"),gr=mr.getContext("2d"),function(t,e,i){return mr.width==e&&mr.height==i||(mr.width=e,mr.height=i),gr.drawImage(t,0,0,e,i),gr.getImageData(0,0,e,i)}),pr.prototype.initSizedTexture2D=function(t,e,i){var n=this.renderer,o=n.context,r=n.state,a=new v.Texture(null);!(a.flipY=!1)!==i&&(i=!1),a.generateMipmaps=i;var s=n.paramThreeToGL(a.format),l=n.paramThreeToGL(a.type),c=n.properties.get(a),u=o.createTexture();r.bindTexture(o.TEXTURE_2D,u),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,a.flipY),o.texImage2D(o.TEXTURE_2D,0,s,t,t,0,s,l,null),a.wrapS=e,a.wrapT=e;var h=n.paramThreeToGL(e);return o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,h),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,h),i?(a.magFilter=v.LinearFilter,a.minFilter=v.LinearMipMapLinearFilter,o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR_MIPMAP_NEAREST),o.generateMipmap(o.TEXTURE_2D)):(a.magFilter=v.LinearFilter,a.minFilter=v.LinearFilter,o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR)),r.bindTexture(o.TEXTURE_2D,null),c.__webglTexture=u,a},pr.prototype.initSizedCubeMap=function(t,e){var i=this.renderer,n=i.context,o=i.state,r=new v.CubeTexture([null,null,null,null,null,null]);r.flipY=!1,r.generateMipmaps=e;var a=i.paramThreeToGL(r.format),s=i.paramThreeToGL(r.type),l=i.properties.get(r),c=n.createTexture();o.bindTexture(n.TEXTURE_CUBE_MAP,c),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,r.flipY);for(var u=0;u<6;u++)n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+u,0,a,t,t,0,a,s,null);return e?(r.magFilter=v.LinearFilter,r.minFilter=v.LinearMipMapLinearFilter,n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MIN_FILTER,n.LINEAR_MIPMAP_LINEAR),n.texParameteri(n.TEXTURE_CUBE_MAP,n.GENERATE_MIPMAP,n.TRUE),n.generateMipmap(n.TEXTURE_CUBE_MAP)):(r.magFilter=v.LinearFilter,r.minFilter=v.LinearFilter,n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_MIN_FILTER,n.LINEAR)),o.bindTexture(n.TEXTURE_CUBE_MAP,null),l.__image__webglTextureCube=c,r},pr.prototype.deallocateCubeTexture=function(t){var e=this.renderer,i=e.context,n=e.properties.get(t);i.deleteTexture(n.__image__webglTextureCube)},pr.prototype.uploadTexture2D=function(t,e,i,n,o,r){var a=this.renderer,s=a.context,l=a.state,c=a.properties.get(e);l.bindTexture(s.TEXTURE_2D,c.__webglTexture),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,e.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,e.unpackAlignment),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,a.paramThreeToGL(e.wrapS)),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,a.paramThreeToGL(e.wrapT)),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,a.paramThreeToGL(e.magFilter)),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,a.paramThreeToGL(e.minFilter)),s.texSubImage2D(s.TEXTURE_2D,0,i,n,s.RGBA,s.UNSIGNED_BYTE,t),e.generateMipmaps&&s.generateMipmap(s.TEXTURE_2D),l.bindTexture(s.TEXTURE_2D,null)},pr.prototype.rebuildMipMaps2D=function(t){var e=this.renderer,i=e.context,n=e.state;e.properties.get(t),i.generateMipmap(i.TEXTURE_2D),n.bindTexture(i.TEXTURE_2D,null)},pr.prototype.rebuildMipMaps3D=function(t){var e=this.renderer,i=e.context,n=e.state,o=e.properties.get(t);n.bindTexture(i.TEXTURE_CUBE_MAP,o.__image__webglTextureCube),i.generateMipmap(i.TEXTURE_CUBE_MAP),n.bindTexture(i.TEXTURE_CUBE_MAP,null)},pr.prototype.renderToCubeMap=(vr=!1,_r=xr=wr=br=yr=null,function(t,e,i,n,o,r,a,s,l,c,u,h,d,p,f,m){this.renderer.context,vr||((br=new v.OrthographicCamera(-.5,.5,.5,-.5,-200,200)).position.z=150,(yr=new v.Scene).add(br),wr=new v.ShaderMaterial({uniforms:{tDiffuse:{type:"t",value:null},alpha:{type:"f",value:1}},vertexShader:$.basicTextured.vertexShader,fragmentShader:$.basicTextured.fragmentShader,depthWrite:!1,depthTest:!1,side:v.DoubleSide}),xr=new v.PlaneBufferGeometry(1,1),(_r=new v.Mesh(xr,wr)).position.z=0,yr.add(_r),vr=!0);var g=xr.getAttribute("uv");g.setDynamic(!0),g.needsUpdate=!0;var y=g.array,b=o/i,w=r/n,x=a/i,_=s/n;y[0]=b,y[1]=w+_,y[2]=b+x,y[3]=w+_,y[4]=b,y[5]=w,y[6]=b+x,y[7]=w;var S=xr.getAttribute("position");S.setDynamic(!0),S.needsUpdate=!0;var T=S.array,M=l/e.width-.5,I=c/e.height-.5,P=u/e.width,C=h/e.height;T[0]=M,T[1]=I+C,T[3]=M+P,T[4]=I+C,T[6]=M,T[7]=I,T[9]=M+P,T[10]=I,this.renderer.properties.get(t),wr.uniforms.tDiffuse.value=t,wr.blending=p||v.NoBlending,wr.transparent=!!f,null!=m||(m=1),wr.uniforms.alpha.value=m,wr.needUpdate=!0,e.activeCubeFace=d,e.viewport.set(0,0,e.width,e.height);var A=this.renderer.autoClear;this.renderer.autoClear=!1,this.renderer.render(yr,br,e,!1),this.renderer.autoClear=A}),pr.prototype.copyCubeMap=(Sr=!1,Cr=Pr=Ir=Mr=Tr=null,Ar=new v.Euler,new v.Vector3,function(t,e,i,n,o,r,a,s,l){this.renderer,Sr||((Mr=new v.OrthographicCamera(-1,1,1,-1,0,200)).position.set(0,0,0),(Tr=new v.Scene).add(Mr),Ir=new v.ShaderMaterial({uniforms:{tDiffuse:{type:"t",value:null},alpha:{type:"f",value:1}},vertexShader:$.copyCubeMap.vertexShader,fragmentShader:$.copyCubeMap.fragmentShader,depthWrite:!1,depthTest:!1,side:v.DoubleSide}),Pr=new v.BoxGeometry(2,2,2),Cr=new v.Mesh(Pr,Ir),Tr.add(Cr),Sr=!0);for(var c=0;c<6;c++)pr.getCubeOrientationForCubeFace(c,Ar),Cr.rotation.copy(Ar),Cr.matrixWorldNeedsUpdate=!0,Cr.updateMatrixWorld(),Ir.uniforms.tDiffuse.value=t,Ir.blending=a||v.NoBlending,Ir.transparent=!!s,null!=l||(l=1),Ir.uniforms.alpha.value=l,Ir.needUpdate=!0,e.activeCubeFace=c,e.viewport.set(0,0,o,r),this.renderer.render(Tr,Mr,e,!1)}),pr.getCubeOrientationForCubeFace=function(t,e){switch(t){case ne.GL_TEXTURE_CUBE_MAP_POSITIVE_X:e.set(0,-Math.PI/2,0);break;case ne.GL_TEXTURE_CUBE_MAP_NEGATIVE_X:e.set(0,Math.PI/2,0);break;case ne.GL_TEXTURE_CUBE_MAP_POSITIVE_Y:e.set(Math.PI/2,Math.PI,0);break;case ne.GL_TEXTURE_CUBE_MAP_NEGATIVE_Y:e.set(-Math.PI/2,Math.PI,0);break;case ne.GL_TEXTURE_CUBE_MAP_POSITIVE_Z:e.set(0,-Math.PI,0);break;case ne.GL_TEXTURE_CUBE_MAP_NEGATIVE_Z:e.set(0,0,0)}},pr.prototype.renderSolidTileToCubeMap=(Er=!1,Or=Rr=kr=Dr=Lr=null,function(t,e,i,n,o,r,a,s,l,c){if(this.renderer.context,!Er){(Dr=new v.OrthographicCamera(-.5,.5,.5,-.5,-200,200)).position.z=150,(Lr=new v.Scene).add(Dr);var u=["void main() { "," vec4 pos = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );"," gl_Position = pos; ","}"].join("\n"),h=["uniform vec4 blockColor;","uniform float alpha;","void main() {","  gl_FragColor = vec4(blockColor.rgb, alpha);","}"].join("\n");kr=new v.ShaderMaterial({uniforms:{blockColor:{type:"v4",value:null},alpha:{type:"f",value:1}},vertexShader:u,fragmentShader:h,depthWrite:!1,depthTest:!1,side:v.DoubleSide}),(Rr=new v.PlaneBufferGeometry(1,1)).getAttribute("position"),(Or=new v.Mesh(Rr,kr)).position.z=0,Lr.add(Or),Er=!0}kr.uniforms.blockColor.value=a,null!=c||(c=1),kr.uniforms.alpha.value=c,kr.blending=s||v.NoBlending,kr.transparent=!!l,kr.needUpdate=!0,t.activeCubeFace=r,t.viewport.set(e,i,n,o),this.renderer.render(Lr,Dr,t,!1)}),pr.prototype.showFPS=function(){this.stats=new lr,document.body.appendChild(this.stats.domElement)};var Ur=pr,Br=d(function(t){function e(t){t=t||{},v.RawShaderMaterial.call(this,k.extendObject({fragmentShader:$.cube.fragmentShader,vertexShader:$.cube.vertexShader,uniforms:v.UniformsUtils.clone($.cube.uniforms),name:"CubemapMaterial"},t))}(e.prototype=Object.create(v.RawShaderMaterial.prototype)).constructor=e,t.exports=e}),zr=function(t,e,i){var n=e,o=i;return 2*Math.atan(Math.tan(t*me.RADIANS_PER_DEGREE/2)*(n/o))*me.DEGREES_PER_RADIAN},Vr={getHFOVForCamera:function(t,e,i){return zr(t.fov,e,i)},getHFOVFromVFov:zr},Gr=new S("/js/gui/helpManager.js"),jr=function(){var t;try{return t=window.localStorage.getItem("visitCount")||"0",t=(parseFloat(t)+1).toString(),window.localStorage.setItem("visitCount",t),Gr.debug("visitCount = "+t),t}catch(e){t="1",Gr.debug("couldn't set local storage")}}(),Hr={isHelpEnabled:function(){return("1"===jr||"1"===g.valueFromHash("help",null))&&"0"!==g.valueFromHash("help",null)&&z.warp.auto<0},isQuickstartHelpEnabled:function(){if(z.quickstart.enabled&&this.isHelpEnabled())return!0},isStandardHelpEnabled:function(){if(!z.quickstart.enabled&&this.isHelpEnabled())return!0}};function Wr(t,e,i,n){this.qualityManager=t,this.scene=e,this.camera=i,this.container=n,this.quickstartCamera=new Ge(n),this.endFOV=N.insideFOV,this.quickstartCamera.fov=this.endFOV+Yr.quickstart.fovChange,this.controls=new jt(this.quickstartCamera,n),this.controls.bindEvents(n),this.controls.enabled=!0,this.controls.locked=!0,this.skybox=null}var qr=Br,$r=Vr,Yr=z,Xr=new S("/js/scene/QuickstartManager.js");Wr.prototype.load=function(t){t.pano.shouldRedrawOnBaseLoaded=!0;var e,i=this,n=tt.FORWARD.clone().applyQuaternion(t.quaternion),r=n.clone().negate();this.controls.lookAt(n.add(this.quickstartCamera.position));var a=this.qualityManager.getPanoSize(1);if(this.qualityManager.getPanoSize(2),t.pano.tiled){window.loadingCount=1,window.firstPanoId=t.pano.id,Xr.warn("Loading startPano, TILED",t.pano.id),t.pano.update();var s=$r.getHFOVForCamera(this.quickstartCamera,this.container.clientWidth,this.container.clientHeight),l=this.quickstartCamera.fov;Xr.warn("Quickstart loading tiles in frustum: [horizontal FOV: "+s+", vertical FOV: "+l+"]"),e=t.pano.loadTiledPano(a,r,null,!1,!1,!0)}else Xr.warn("Loading startPano",t.pano.id),e=t.pano.loadCube("high");return o.when(e).then(function(){i.init(t.pano,t.quaternion),t.pano.tiled?e.done(function(){t.pano.lockUntilRenderingComplete=!1,this.controls.locked=!1}.bind(this)):this.controls.locked=!1}.bind(this))},Wr.prototype.init=function(t,e){Xr.info("Quickstart done loading, adding scene objects"),t.lockUntilRenderingComplete=!0,this.skybox=new v.Mesh(new v.CubeGeometry(1,1,1),new qr({side:v.BackSide})),this.skybox.material.uniforms.map.value=t.skybox,this.skybox.quaternion.copy(t.quaternion),this.scene.add(this.skybox),o(this.container).show()},Wr.prototype.update=function(t){this.controls.update(t),this.camera.copy(this.quickstartCamera)},Wr.prototype.setSize=function(t,e){this.quickstartCamera.updateAspect(t/e)},Wr.prototype.destroy=function(){this.scene.remove(this.skybox)},Wr.prototype.startLanding=function(){function t(){var t=V.getById("quickAnimation"),i=0<t.length?t[0].current:Yr.quickstart.animation,o=i<Yr.quickstart.animation?Yr.quickstart.animation-i:0;setTimeout(n,o),e()}function e(){r.forEach(function(e){document.body.removeEventListener(e,t,!0)})}var i=o.Deferred(),n=i.resolve.bind(i);V.start(b.property(this.quickstartCamera,"fov",this.endFOV,function(){this.quickstartCamera.updateProjectionMatrix()}.bind(this)),Yr.quickstart.animation,null,0,D.easeOutQuad,null,"quickAnimation");var r=["touchstart","mousedown","keydown"];r.forEach(function(e){document.body.addEventListener(e,t,!0)});var a=Hr.isQuickstartHelpEnabled()?Yr.quickstart.fadeOutDelay:Yr.quickstart.animation;return setTimeout(n,a),setTimeout(e,a),i.promise()};var Qr,Zr,Kr,Jr,ta,ea,ia,na,oa,ra=Wr,aa=d(function(t){function e(t,e,i){this.maxNavPanoSize=-1,this.maxZoomPanoSize=-1,this.devicePixelDensity=t,this.deviceScreenSize=e,this.clientBandwidth=i,this.panoSizeClassMap={},this.useHighResolutionPanos=!0,this.useUltraHighResolutionPanos=!1,this.modelHasUltraHighPanos=!1}e.prototype.init=function(t){this.buildPanoSizeClassMap(this.devicePixelDensity,this.deviceScreenSize,this.clientBandwidth),this.ultraHighSize=this.getPanoSize(4),this.highSize=this.getPanoSize(3),this.standardSize=this.getPanoSize(2),this.baseSize=this.getPanoSize(1),z.tiling.maxZoomPanoQuality&&this.ultraHighSize<=z.tiling.maxZoomPanoQuality&&(z.tiling.allowUltraHighResolution=!0),this.highQualityThreshold=g.valueFromHash("threshold2k",N.windowHeightHighQualityThreshold),this.updateMaximums(),t.on(ke.ActiveModelChanged,this.onModelChanged.bind(this))},e.prototype.updateFromModel=function(t){this.updateHighResolutionSettings(t),this.updateUltraHighResolutionSettings(t)},e.prototype.updateHighResolutionSettings=function(t){this.updateMaximums()},e.prototype.updateUltraHighResolutionSettings=function(t){z.tiling.allowUltraHighResolution&&this.modelHasUltraHighPanos?this.useUltraHighResolutionPanos=!0:this.useUltraHighResolutionPanos=!1,this.updateMaximums()},e.prototype.enableUltraHighQualityMode=function(){this.modelHasUltraHighPanos=!0,this.updateUltraHighResolutionSettings(null)},e.prototype.ultraHighQualityModeEnabled=function(){return this.modelHasUltraHighPanos},e.prototype.onModelChanged=function(t){this.updateFromModel(t.model),this.updateMaximums()},e.prototype.updateMaximums=function(){this.maxNavPanoSize=z.tiling.maxNavPanoQuality||this.detectMaxNavPanoSize(),this.maxZoomPanoSize=z.tiling.maxZoomPanoQuality||this.detectMaxZoomPanoSize(),this.maxZoomPanoSize<this.maxNavPanoSize&&(this.maxNavPanoSize=this.maxZoomPanoSize)},e.prototype.buildPanoSizeClassMap=function(){this.panoSizeClassMap[1]=512,this.panoSizeClassMap[2]=1024,this.panoSizeClassMap[3]=2048,this.panoSizeClassMap[4]=4096},e.prototype.getPanoSize=function(t){return this.panoSizeClassMap[t]},e.prototype.getMaxPossiblePanoSize=function(){return this.getPanoSize(4)},e.prototype.getMaxPanoSize=function(){return this.maxZoomPanoSize},e.prototype.getMaxNavPanoSize=function(){return this.maxNavPanoSize},e.prototype.getMaxZoomPanoSize=function(){return this.maxZoomPanoSize},e.prototype.detectMaxNavPanoSizeClass=function(){var t;return t=z.screenshot?z.panoramaSettings.screenshot_2k?3:2:z.panoramaSettings.loading_2k?3:2,this.useHighResolutionPanos?(g.isMobile()||(window.innerHeight,this.highQualityThreshold),t):2},e.prototype.detectMaxNavPanoSize=function(){var t=this.detectMaxNavPanoSizeClass();return this.getPanoSize(t)},e.prototype.detectMaxZoomPanoSize=function(){return this.useHighResolutionPanos?g.isMobile()?z.tiling.mobileHighQualityOverride?this.getPanoSize(3):this.getPanoSize(2):this.useUltraHighResolutionPanos?this.getPanoSize(4):this.getPanoSize(3):this.getPanoSize(2)},t.exports=e}),sa="idle",la="browse",ca="examine",ua=ot.EventEmitter;function ha(){this.tagState=sa,this.intersectTag=null,this.hoveredTag=null,this.activeTag=null,this.mattertagDiscs=[],this.raycaster=new v.Raycaster,this.modelManager=null,this.player=null,this.director=null,this.totalMattertags=0,this.lastAudioTag=null,this.hide360TagForce=""}new S("/js/mattertag/MattertagManager.js"),k.extend(ha,ua),ha.prototype.init=function(t,e,i){this.modelManager=t,this.player=e,this.director=i,this.updateModel(),this.bindEvents();var n=this;o("#iframe-close, .help_back").click(function(){o("#iframeBox, #iframe-close").attr("class",""),o("#iframe-close").addClass("css-sprites"),document.getElementsByClassName("iframe-open")[0].src="about:blank",o("#iframe-parent, #iframe-close, .help_back").fadeOut(300),n.dismissExaminedTag()}),o(".closeTagContainer").on("click",function(){o(".pctagcontainer").fadeOut(300,function(){o(".moreImages").remove()}),setTimeout(function(){o(".imageCon").attr("src","").removeClass("longimgCon highimgCon commimgCon"),o(".topimg").removeClass("topimgCss")},300),n.dismissExaminedTag()}),this.model.settings.building.rooms&&(this.hasroom=!0)},ha.prototype.update=function(t){this.updateTags(this.player.mode,this.player.camera,this.player.currentPano,this.player.flying)},ha.prototype.updateTags=function(t,e,i,n){for(var o in this.model.mattertags)12!==this.model.mattertags[o].type&&this.model.mattertags[o].update(t,e,i,n,this.show360TagPanoId)},ha.prototype.updateModel=function(){this.model=this.modelManager.getActiveModel(),this.getMattertagsFromModel(),this.totalMattertags=Object.keys(this.model.mattertags).length},ha.prototype.getMattertagsFromModel=function(){for(var t in this.mattertagDiscs=[],this.model.mattertags){var e=this.model.mattertags[t].disc;e&&this.mattertagDiscs.push(e)}},ha.prototype.bindEvents=function(){this.modelManager.on(ke.ActiveModelChanged,this.updateModel.bind(this)),this.player.on(Le.ModeChanging,this.onPlayerModeChanging.bind(this)),this.player.on(Le.Move,this.onPlayerMove.bind(this)),this.player.on(Le.Ready,this.onPlayerReady.bind(this)),this.player.on(Le.FlyingEnded,this.onPlayerFlyingEnded.bind(this)),this.player.on(Le.WarpStarted,this.handleWarpStart.bind(this)),this.player.on(Le.WarpInterrupted,this.handleWarpInterruption.bind(this))},ha.prototype.handleWarpStart=function(t,e,i,n){this.dismissExaminedTag(),e===L.BLACK&&(n=n||z.warp.teleportTime,t&&(i=Ue.END),this.hideShowTagsForBlackoutStyle(i,n))},ha.prototype.handleWarpInterruption=function(t,e,i){i=i||z.warp.teleportTime,this.hideShowTagsForBlackoutStyle(e,i)},ha.prototype.hideShowTagsForBlackoutStyle=function(t,e){var i=0,n=0,o=e/2;switch(null==t&&(t=Ue.MIDDLE),t){case Ue.END:this.hideAllMattertags(o);break;case Ue.BEGINNING:this.hideAllMattertags().done(this.showAllMattertags.bind(this,o));break;case Ue.NONE:break;case Ue.MIDDLE:n=i=o,this.hideAllMattertags(n),setTimeout(function(){this.showAllMattertags(i)}.bind(this),n);break;case Ue.FADEIN:setTimeout(function(){this.showAllMattertags(o)}.bind(this),o)}},ha.prototype.onPlayerModeChanging=function(){this.dismissExaminedTag()},ha.prototype.onPlayerMove=function(){this.dismissExaminedTag(!0)},ha.prototype.onPlayerReady=function(t,e,i){this.startAllMattertags(t,e?i:null)},ha.prototype.onPlayerFlyingEnded=function(t,e){t&&this.updateClosestTags(t)},ha.prototype.dismissExaminedTag=function(t){t&&this.activeTag&&this.activeTag.type===gi.Audio?(this.boardState,this.tagState=la):(this.activeTag&&this.tagState===ca&&this.dismissActiveTag(),this.hoveredTag&&(this.hoveredTag.setFreeState(!0),this.hoveredTag=null))},ha.prototype.startAllMattertags=function(t,e){this.model.shouldShowMattertags=z.mattertags.enabled,t||(this.showAllMattertags(z.mattertags.startup.fadeInDuration,z.mattertags.startup.fadeInDelay),e&&setTimeout(function(){this.activateTag(this.model.getTagByIdx(e))}.bind(this),z.mattertags.startup.fadeInDuration/2))},ha.prototype.showAllMattertags=function(t,e){function i(){++r===this.totalMattertags&&(this.model.tagsShown=!0,n.resolve())}var n=o.Deferred(),r=0;if(!this.model.shouldShowMattertags)return n.resolve().promise();for(var a in this.model.mattertags){var s=this.model.mattertags[a];s.type!==gi.Title&&s.type!==gi.RegionalJump&&s.show(t,e).done(i.bind(this))}return this.showtitletags=!0,this.updatetitletags(),n.promise()},ha.prototype.updatetitletags=function(){if(this.showtitletags&&G.titletags&&"panorama"===G.player.mode){var t,e,i,n=G.player.camera.clone();this.ttagsshow=[],this.ttagshide=[];for(var r=0;r<G.titletags.length;r++)if(G.player&&G.player.currentPano&&2===G.player.currentPano.alignmentType)this.ttagsshow.push(G.titletags[r]);else if("dollhouse"!==G.player.mode&&"floorplan"!==G.player.mode)if(this.hasroom)i=G.titletags[r],G.player.currentPano&&G.model.panos.index[i.locationId]&&G.player.currentPano.roomid===G.model.panos.index[i.locationId].roomid?this.ttagsshow.push(G.titletags[r]):this.ttagshide.push(G.titletags[r]);else{if((e=(t=G.titletags[r].position).clone().distanceTo(n.position))<=z.titletagMaxdistance){var a=new v.Raycaster(n.position,n.position.clone().sub(t).normalize()).intersectObjects(G.model.colliders);if(a.length,!a.length||-.5<a[0].distance-e){this.ttagsshow.push(G.titletags[r]);continue}}this.ttagshide.push(G.titletags[r])}else this.ttagshide.push(G.titletags[r]);this.ttposition()}else o(".viewport-tag").css("display","none")},ha.prototype.ttposition=function(){if(!this.showtitletags)return!1;if(!this.ttagsshow)return!0;for(var t=this.player.camera.clone(),e=t.getWorldDirection(new v.Vector3),i=0;i<this.ttagsshow.length;i++){var n=this.ttagsshow[i],r=n.position;if(r.clone().sub(t.position).normalize().angleTo(e)>Math.PI/2)o("#titletag"+n.i).css("display","none");else{var a=r.clone().project(t),s=(a.x+1)/2*100,l=(1-a.y)/2*100;o("#titletag"+n.i).css({display:"",left:s+"%",top:l+"%"})}}for(i=0;i<this.ttagshide.length;i++)o("#titletag"+this.ttagshide[i].i).css("display","none")},ha.prototype.updateRegionalJumpTags=function(t){var e=null;for(var i in this.model.mattertags){var n=this.model.mattertags[i],o=n.data;3e4<=i&&(t.roomid===n.data.roomidx?(n.isTargetRoomHavePoint=!1,e=new v.Line3(new v.Vector3(o.base.x,0,o.base.z),new v.Vector3(t.position.x,0,t.position.z)),this.model.settings.locations.points.forEach(function(t){t.roomidx===n.data.target_room&&(n.isTargetRoomHavePoint=!0)}),!n.isTargetRoomHavePoint||e.distance()<1?n.hide(0,0):n.show(0,0)):n.hide(0,0))}},ha.prototype.hideAllMattertags=function(t,e){function i(){++r===this.totalMattertags&&(this.model.tagsShown=!1,n.resolve())}var n=o.Deferred(),r=0;for(var a in this.model.mattertags){var s=this.model.mattertags[a];s.type!==gi.RegionalJump&&s.type!==gi.Title&&-1!==s.tagid&&-2!==s.tagid&&(s.hide(t,e).done(i.bind(this)),s===this.activeTag&&this.dismissActiveTag())}return n.promise()},ha.prototype.update360Tags=function(t){var e=o.Deferred();for(var i in this.hideAllMattertags(z.mattertags.startup.fadeInDuration),this.model.mattertags){var n=this.model.mattertags[i];if(n.type==gi.Tag360T1||1===n.subtype){var r=this;setTimeout(function(){r.show360TagPanoId=t},600)}}return e.promise()},ha.prototype.hideAllMattertagsExceptType=function(t,e,i){function n(){++a===this.totalMattertags&&(this.model.tagsShown=!1,r.resolve())}var r=o.Deferred(),a=0;for(var s in this.model.mattertags){var l=this.model.mattertags[s];l.type!==t&&(l.hide(e,i).done(n.bind(this)),l===this.activeTag&&this.dismissActiveTag())}return r.promise()},ha.prototype.activateTag=function(t,e){e=e||ca,this.activeTag=t,"panorama"===this.player.mode&&(this.activeTag.type===gi.IFrame||this.activeTag.type===gi.ImageText||this.activeTag.type===gi.ImageTextAudio||this.activeTag.type===gi.Video||this.activeTag===gi.IKEA?document.getElementsByTagName("html").item(0).style.cursor="default":this.activeTag.type===gi.Tag360T1||(document.getElementsByTagName("html").item(0).style.cursor="default",(this.activeTag.type!=gi.TextOnly&&this.activeTag!==gi.TextAudio||null!=this.activeTag.label&&""!=this.activeTag.label)&&(this.activeTag.type==gi.TagTo360||this.activeTag.setHoverState(e===ca)))),this.tagState=e,this.emit(Fi.TagActivated,t,e),this.emitTagEvent(t,e)},ha.prototype.activateAudioTag=function(t,e,i){e=e||ca,this.activeTag=t,this.activeTag.setHoverState(e===ca,i),this.tagState=e,this.emit(Fi.TagActivated,t,e),this.emitTagEvent(t,e)},ha.prototype.activateOtherModelTag=function(t,e,i){e=e||ca,this.activeTag=t,this.activeTag.setHoverState(e===ca,i),this.tagState=e,this.emit(Fi.TagActivated,t,e),this.emitTagEvent(t,e)},ha.prototype.dismissActiveTag=function(t){if(null!==this.activeTag){t?this.lastAudioTag&&this.lastAudioTag.setFreeState(!0,!0):this.activeTag.setFreeState(!0);var e=this.activeTag;this.activeTag=null,this.tagState=sa,this.emit(Fi.TagDismissed,e)}},ha.prototype.dismissAudioActiveTag=function(){if(null!=this.activeTag){var t=this.activeTag;this.lastAudioTag.setFreeState(!0,!0),this.activeTag=null,this.tagState=sa,this.emit(Fi.TagDismissed,t)}},ha.prototype.pauseAudioTag=function(){null!=this.lastAudioTag&&this.lastAudioTag.setFreeState(!0,!0)},ha.prototype.openTag=function(t,e,i){t&&(this.activeTag=t,this.tagState=ca,t.setHoverState(!0,0),e&&0<=e&&(this.toid=setTimeout(function(){this.closeTag(),i&&i()}.bind(this),e)))},ha.prototype.closeTag=function(){this.activeTag&&(this.activeTag.stopAudio(),this.activeTag.setClosedState()),this.dismissExaminedTag(),this.activeTag=null,this.tagState=sa},ha.prototype.clickedOnTag=function(t,e,i){var n,o,r,a,s,l,c,u,h,d,p,f,m,g,y=this;if(this.intersectTag.type===gi.BuildingType)return i.stopPropagation(),!0;if(this.intersectTag.type===gi.TagTo360||this.intersectTag.type===gi.Tag360T1){if(i.stopPropagation(),this.director){var b=function(t){var e=-1;for(var i in y.player.model.images.list)y.player.model.images.list[i].sceneid==t&&(e=i);return e}(this.intersectTag.tagInfoUrl);-1===b&&(b=0),this.director.goToHighlight(b)}return!0}if(this.intersectTag.type===gi.RegionalJump){i.stopPropagation();var w=(u=this.intersectTag.data.target_room,h=this.intersectTag.data.base,d=y.model.settings.locations.points,p=[],m=[],g=f=null,d&&(d.forEach(function(t){u===t.roomidx&&(f=new v.Line3(new v.Vector3(h.x,0,h.z),new v.Vector3(t.viewpoint.x,0,t.viewpoint.y)),t.lineLength=f.distance(),m.push(f.distance()),p.push(t))}),m.sort(function(t,e){return t-e}),p.forEach(function(t){t.lineLength===m[0]&&(g=t.locationid)})),g),x=(n=this.intersectTag.data,o=y.model.settings.nestscenes.scenes,r=null,a=new v.Vector3,s=n.target_scene,l=new v.Vector3(n.base.x,0,n.base.z),c=new v.Vector3(n.end_position.x,0,n.end_position.z),o&&(o.forEach(function(t){s===parseInt(t.sceneid)&&(r=t._camera._locationid)}),y.model.settings.locations.points.forEach(function(t){r===t.locationid&&a.copy(t.spot).add((new v.Vector3).subVectors(c,l))})),e);return y.intersectTag.data.base,y.intersectTag.data.end_position,x.model.panos.list.forEach(function(t){w===t.id&&x.flyToPano({pano:t})}),!0}if(!(this.intersectTag.type!=gi.TextOnly&&this.intersectTag!==gi.TextAudio||null!=this.intersectTag.label&&""!=this.intersectTag.label))return!0;if(this.intersectTag.type==gi.Pano)return!0;if(!t)return this.tagState!==ca?(this.intersectTag.type===gi.Audio?(null==this.lastAudioTag&&(this.lastAudioTag=this.intersectTag),this.intersectTag.i==this.lastAudioTag.i?"active"==this.intersectTag.boardState?this.dismissActiveTag(!0):this.intersectTag.setHoverState(!0,0):(this.dismissActiveTag(!0),this.intersectTag.setHoverState(!0,0),this.lastAudioTag=this.intersectTag)):(this.pauseAudioTag(),this.dismissActiveTag(!0),this.intersectTag.type===gi.OtherModel||this.intersectTag.type===gi.IFrame||this.intersectTag.type===gi.ImageText||this.intersectTag.type===gi.ImageTextAudio||this.intersectTag.type===gi.TextOnly||this.intersectTag.type===gi.TextAudio||this.intersectTag===gi.IKEA?this.intersectTag.setHoverState(!0,0):this.intersectTag.setHoverState(!0)),this.activeTag=this.intersectTag,(this.intersectTag.type!==gi.IFrame&&this.intersectTag.type!==gi.ImageText&&this.intersectTag.type!==gi.ImageTextAudio||this.intersectTag!==gi.IKEA)&&this.activeTag.examineMattertag(this.player,this.activateTag.bind(this)),this.tagState=ca,this.emit(Fi.TagNavigation,this.activeTag),!0):(this.dismissActiveTag(!0),!1);if(this.tagState===sa)return this.intersectTag.type===gi.Audio?(null==this.lastAudioTag&&(this.lastAudioTag=this.intersectTag),this.intersectTag.i==this.lastAudioTag.i?this.activateAudioTag(this.intersectTag,ca,1):(this.dismissAudioActiveTag(),this.lastAudioTag=this.intersectTag,this.activateAudioTag(this.intersectTag,ca,0))):(this.pauseAudioTag(),this.dismissActiveTag(),this.intersectTag.type===gi.OtherModel||this.intersectTag.type===gi.IFrame||this.intersectTag.type===gi.ImageText||this.intersectTag.type===gi.ImageTextAudio||this.intersectTag.type===gi.Video||this.intersectTag.type===gi.TextOnly||this.intersectTag.type===gi.TextAudio||this.intersectTag===gi.IKEA?this.activateOtherModelTag(this.intersectTag,ca,0):this.intersectTag.examineMattertag(this.player,this.activateTag.bind(this)));if(this.tagState===ca)return this.intersectTag!==this.activeTag?this.intersectTag.type===gi.Audio?(this.pauseAudioTag(),this.dismissActiveTag(),this.lastAudioTag=this.intersectTag,this.activateAudioTag(this.intersectTag,ca,1)):(this.pauseAudioTag(),this.dismissActiveTag(),this.intersectTag.type===gi.OtherModel||this.intersectTag.type===gi.IFrame||this.intersectTag.type===gi.ImageText||this.intersectTag.type===gi.ImageTextAudio||this.intersectTag===gi.IKEA?this.activateOtherModelTag(this.intersectTag,ca,0):this.activateTag(this.intersectTag,ca)):(this.intersectTag.type===gi.Audio?(this.pauseAudioTag(),this.dismissActiveTag()):(this.dismissActiveTag(),this.intersectTag.type!==gi.ImageText&&this.intersectTag.type!==gi.ImageTextAudio&&this.intersectTag!==gi.IKEA||this.intersectTag.label||this.intersectTag.data.details.description||this.intersectTag.tagInfoUrl||this.activateOtherModelTag(this.intersectTag,ca,0)),!1);if(this.tagState===la){if(this.intersectTag.type!==gi.Audio)return this.pauseAudioTag(),this.dismissActiveTag(),this.intersectTag.type===gi.OtherModel||this.intersectTag.type===gi.IFrame||this.intersectTag.type===gi.ImageText||this.intersectTag.type===gi.ImageTextAudio||this.intersectTag===gi.IKEA?this.activateOtherModelTag(this.intersectTag,ca,0):this.intersectTag.examineMattertag(this.player,this.activateTag.bind(this));this.intersectTag.i==this.lastAudioTag.i?(this.pauseAudioTag(),this.dismissActiveTag()):(this.pauseAudioTag(),this.lastAudioTag=this.intersectTag,this.intersectTag.setHoverState(!0,0))}},ha.prototype.disposeCursorFor360=function(t){t&&t.type===gi.Tag360T1?document.getElementsByTagName("html").item(0).style.cursor="pointer":document.getElementsByTagName("html").item(0).style.cursor="default"},ha.prototype.intersectMattertag=(Qr=new v.Vector3,Zr=new v.Vector3,Kr=new v.Vector3,function(t,e,i){var n=null,o=this.mattertagDiscs.filter(function(t){return t.parent.visible});if(0<o.length){var r=this.model.floors.reduce(function(t,e){return e.hidden?t:t.concat(e.collider.children)},o);Qr.set(t.x,t.y,-1).unproject(i),Zr.set(t.x,t.y,1).unproject(i),Kr.copy(Zr).sub(Qr).normalize(),this.raycaster.set(Qr,Kr);var a=this.raycaster.intersectObjects(r);0<a.length&&-1!==o.indexOf(a[0].object)&&a[0].object.tag.type&&(3e4<=(n=a[0].object.tag).i?n=this.model.mattertags[n.i]:1e4<=n.i&&(n=this.model.mattertags[n.i-1e4]))}return n&&"-1"===n.tagId?null:(this.intersectTag=n,this.disposeCursorFor360(n),e&&(this.activeTag&&n!==this.activeTag&&(this.tagState===la||this.tagState===ca&&n)&&this.dismissActiveTag(),n&&n!==this.activeTag&&(n.listeners("enter").length<1&&(n.on("enter",function(t){this.hoveredTag=t}.bind(this)),n.on("leave",function(t){this.hoveredTag=null}.bind(this))),this.activateTag(n,la))),n)}),ha.prototype.rankedMattertagInDirection=(Jr=[],ta=[],ea=new v.Vector3,ia=new v.Vector3,na=new v.Vector3,function(t,e,i,n){for(var o=0,r=ta.length=0;r<this.closestMattertags.length;r++){var a=this.closestMattertags[r];ia.copy(a.position),ia.add(a.discPosition),ea.copy(e),ea.sub(ia).negate(),ea.normalize();var s=ea.dot(n);if(0<=s&&(na.copy(ia),na.project(i),this.intersectMattertag(na,!1,i))){if(o>=Jr.length)for(var l=0;l<64;l++)Jr.push({tag:a,dot:s});var c=Jr[o];c.tag=a,c.dot=s,c.position=math.projectPositionToCanvas(this.player.container,ia,i),ta.push(c),o++}}return ta.sort(function(t,e){return t.dot>e.dot?-1:t.dot<e.dot?1:0}),t<ta.length?ta[t].tag:null}),ha.prototype.updateClosestTags=(oa=new v.Vector3,function(t){this.closestMattertags||(this.closestMattertags=[]),this.closestMattertags.length=0;var e=this.model.mattertags;if(e)for(var i in e)if(e.hasOwnProperty(i)){if(1e4<=i)return;var n=e[i],o=n.position;oa.copy(t),oa.sub(o).negate();var r=oa.lengthSq();12!==n.type&&r<30&&this.closestMattertags.push(n)}}),ha.prototype.emitTagEvent=function(t,e){if("-1"!==t.tagid){e===ca?e="click":e===la&&(e="hover");var i=t.data.details,n="";for(var o in gi)if(i.templatetype===gi[o]){n=o,i.type=o;break}var r={tagId:t.tagid,type:n,mode:e,detail:i};"click"===e&&(this.tagState=la,this.activeTag=t),this.emit("tagActiveEvent",r)}};var da=ha,pa={TileDownloadSuccess:"tiledownloader.download.success",TileDownloadFailure:"tiledownloader.download.failure",PanoDownloadComplete:"tiledownloader.pano.download.complete"},fa=d(function(t){(function(e){function i(t){this.panos=null,this.retryMinimumTime=1e4,this.urls=null,this.panoLoadCallbacks={},this.downloadDescriptors={},this.priorityQueue=[],this.forceQueue=[],this.activeDownloads=[],this.qualityManager=null,this.tilePrioritizer=null,this.refreshInterval=null,this.processPriorityQueue=!1,this.concurrentDownloads=t.concurrentDownloads||1,this.downloadTestResults={}}var n,o,r,a,s,l=v,c=z,u=pa,h=ni,d=ge,p=ii,f=le,m=P,g=ot.EventEmitter,y=(new S(e),Object.freeze({Testing:1,Success:2,Fail:3}));i.prototype=Object.create(g.prototype),i.IDLE_REFRESH_DELAY=500,i.ACTIVE_REFRESH_DELAY=0,i.DOWNLOAD_RETRIES=4,i.prototype.init=function(t){this.qualityManager=t},i.prototype.setUrls=function(t){this.urls=t},i.prototype.setPanoData=function(t,e,i){this.panos=t,this.imagePanos=e,this.panoGroupId=i},i.prototype.start=function(){this.refreshUpdateInterval(0)},i.prototype.stop=function(){clearTimeout(this.refreshInterval),this.panos=null,this.retryMinimumTime=1e4,this.urls=null,this.panoLoadCallbacks={},this.downloadDescriptors={},this.priorityQueue=[],this.forceQueue=[],this.activeDownloads=[],this.qualityManager=null,this.tilePrioritizer=null,this.refreshInterval=null,this.processPriorityQueue=!1,this.downloadTestResults={}},i.prototype.refreshUpdateInterval=function(t){t||(t=0),this.refreshInterval=window.setTimeout(function(){this.update()?this.refreshUpdateInterval(i.ACTIVE_REFRESH_DELAY):this.refreshUpdateInterval(i.IDLE_REFRESH_DELAY)}.bind(this),t)},i.prototype.update=function(){var t=0<this.forceQueue.length;return this.processQueueForDownloading(this.forceQueue),this.processPriorityQueue&&(this.queuePrioritizedTilesForPanos(this.panos),0<this.priorityQueue.length&&(t=!0),this.processQueueForDownloading(this.priorityQueue)),t},i.prototype.forceQueueTilesForPano=(a=[],s=[],function(t,e,i,n,o,r){a.length=0;for(var l=this.getTileDownloadDescriptors(t,e),c=0;c<l.length;c++){var u=l[c];u.status!==p.None&&u.status!==p.Queued||a.push(u)}if(i&&0<a.length){h.sortPanoTiles(a,t,i),s.length=0,d.matchingTilesInDirection(t,e,i,n,o,s);for(var f=function(t){return t.face===g.face&&t.faceTileIndex===g.faceTileIndex},m=0;m<a.length;){var g=a[m];s.findIndex(f)<0?a.splice(m,1):m++}}for(var v=0;v<a.length;v++)this.forceQueue.push(a[v]);this.setStatusForAllDescriptors(this.forceQueue,p.ForceQueued),this.clearFromQueue(this.priorityQueue,p.ForceQueued,!1),r&&this.processQueueForDownloading(this.forceQueue,!0)}),i.prototype.clearForceQueue=function(){this.clearQueue(this.forceQueue)},i.prototype.queuePrioritizedTilesForPanos=function(t){this.tilePrioritizer&&(this.clearQueue(this.priorityQueue),this.tilePrioritizer.filterAndPrioritize(this.priorityQueue,t,this),this.clearFromQueue(this.priorityQueue,p.None,!0),this.setStatusOrRemoveForAllDescriptors(this.priorityQueue,p.Queued))},i.prototype.clearQueue=function(t){this.setStatusForAllDescriptors(t,p.None),t.length=0},i.prototype.clearFromQueue=function(t,e,i){for(var n=0;n<t.length;n++){var o=t[n];o&&(e===o.status&&!i||e!==o.status&&i)&&(t[n]=null)}},i.prototype.setStatusForAllDescriptors=function(t,e){for(var i=0;i<t.length;i++){var n=t[i];n&&(n.status=e)}},i.prototype.setStatusOrRemoveForAllDescriptors=function(t,e){for(var i=0;i<t.length;i++){var n=t[i];n&&(n.status!==e?n.status=e:t[i]=null)}},i.prototype.getTileDownloadDescriptors=function(t,e){var i=this.getAllTileDownloadDescriptorsForPano(t),n=i[e];return n||(n=this.buildDownloadDescriptorArray(e),i[e]=n,this.initTileDownloadDescriptors(n,t,e)),n},i.prototype.getAllTileDownloadDescriptorsForPano=function(t){var e=this.downloadDescriptors[t.id];return e||(e={},this.downloadDescriptors[t.id]=e),e},i.prototype.processQueueForDownloading=function(t,e){if(this.cleanupActiveDownloads(),this.activeDownloads.length<this.concurrentDownloads||e)var i=e?t.length:this.concurrentDownloads-this.activeDownloads.length;for(var n=0,o=0;n<i&&0<t.length;o++){var r=t.shift();r&&(this.startDownload(r),n++)}},i.prototype.testDownload=function(t,e,i){var n=this.downloadTestResults[t];if(n)n===y.Success?i(!0):n===y.Fail&&i(!1);else{this.downloadTestResults[t]=y.Testing;var o=this.panos.list[0],r=this.getTileUrl(o.id,t,e,0),a=function(e){this.downloadTestResults[t]=y.Success,i(!0)}.bind(this),s=function(){this.downloadTestResults[t]=y.Fail,i(!1)}.bind(this);this.loadImage(r,0,a,s)}},i.prototype.startDownload=function(t){t.status=p.Downloading;var e=this.getTileUrl(t.pano.id,t.panoSize,t.tileSize,t.tileIndex);this.activeDownloads.push(t),this.loadImage(e,i.DOWNLOAD_RETRIES,this.downloadComplete.bind(this,t),this.downloadFailed.bind(this,t))},i.prototype.downloadFailed=function(t,e){},i.prototype.downloadComplete=function(t,e){if(t.panoGroupId===this.panoGroupId){var i=this.getPanoLoadCallbacks(t.pano,t.panoSize);t.status=p.Downloaded,i&&i.onProgress&&i.onProgress(t.pano,t.panoSize);var n={panoId:t.pano.id,image:e,tileSize:t.tileSize,panoSize:t.panoSize,tileIndex:t.tileIndex,faceTileIndex:t.faceTileIndex,totalTiles:t.totalTiles,face:t.face,tileX:t.tileX,tileY:t.tileY,direction:t.direction};t.image=e,this.emit(u.TileDownloadSuccess,n),this.isPanoDownloaded(t.pano,t.panoSize)&&(n={panoId:t.pano.id,tileSize:t.tileSize,panoSize:t.panoSize},this.emit(u.PanoDownloadComplete,n),i&&i.onLoad&&i.onLoad(t.pano,t.panoSize))}},i.prototype.cleanupActiveDownloads=(r=[],function(){for(var t=r.length=0;t<this.activeDownloads.length;t++){var e=this.activeDownloads[t];e.status!==p.Downloaded&&e.status!==p.Failed&&r.push(e)}this.activeDownloads.length=0,this.activeDownloads.push.apply(this.activeDownloads,r)}),i.prototype.isPanoDownloaded=function(t,e){var i=this.getTileDownloadDescriptors(t,e);if(i.length<=0)return!1;for(var n=0;n<i.length;n++)if(i[n].status!==p.Downloaded)return!1;return!0},i.prototype.setPanoLoadCallbacks=function(t,e,i,n,o){var r=t.id+":"+this.qualityManager.getPanoSize(e);this.panoLoadCallbacks[r]={onLoad:i,onFail:n,onProgress:o}},i.prototype.getPanoLoadCallbacks=function(t,e){var i=t.id+":"+e;return this.panoLoadCallbacks[i]},i.prototype.buildDownloadDescriptorArray=function(t){for(var e=d.getTileCountForSize(t),i=[],n=0;n<e;n++){var o=this.buildDownloadDescriptor();i.push(o)}return i},i.prototype.buildDownloadDescriptor=function(){return{panoGroupId:null,pano:null,panoSize:-1,tileSize:-1,tileIndex:-1,totalTiles:-1,faceTileIndex:-1,status:p.None,url:null,image:null,direction:new l.Vector3,face:-1,cubeFace:-1,tileX:-1,tileY:-1}},i.prototype.initTileDownloadDescriptors=function(t,e,i){for(var n=0;n<t.length;n++){var o=t[n];this.initTileDownloadDescriptor(o,e,i,n)}},i.prototype.initTileDownloadDescriptor=function(t,e,i,n){var o=i>=d.TILE_SIZE?d.TILE_SIZE:i;t.face=d.getFaceForTile(i,n),t.cubeFace=f.mapFaceToCubemapFace(t.face),t.panoGroupId=this.panoGroupId,t.pano=e,t.panoSize=i,t.tileSize=o,t.tileIndex=n,t.totalTiles=d.getTileCountForSize(i),t.status=p.None,t.image=null,d.getTileLocation(t.panoSize,t.tileIndex,t),d.getTileVector(t.panoSize,t.tileSize,t.cubeFace,t.tileX,t.tileY,d.LocationOnTile.Center,0,t.direction)},i.prototype.getTileUrl=(n={256:"256",512:"512",1024:"1k",2048:"2k",4096:"4k"},o={face:-1,faceTileIndex:-1,tileX:-1,tileY:-1},function(t,e,i,r){d.getTileLocation(e,r,o);var a=Math.floor(e/i),s=a*a,l=Math.floor(r/s),u="";return 1===c.tiling.customCompression&&(u="_"+c.tiling["q"+n[e]]),this.urls.get("multiple/"+t+"/"+n[e]+u+"_face"+l+"_"+o.tileX+"_"+o.tileY+".jpg")}),i.prototype.loadImage=function(t,e,i,n){m.getImage(t,e).then(function(t){i(t)}).fail(n)},i.prototype.destory=function(){this.tilePrioritizer&&this.tilePrioritizer.destory()},t.exports=i}).call(h,"/js/tile/TileDownloader.js")});function ma(t){t.root=function t(e,i,n){if(n>e.levels)return null;var o=new function(t,e){this.tree=t,this.parent=e,this.children=[],this.id=++ga}(e,i);e.allNodes.push(o);for(var r=0;r<ya;r++)o.children[r]=t(e,o,n+1);return o}(t,null,0)}var ga=0,va=2,ya=va*va;function ba(t,e){this.levels=e,this.tileSize=t,this.root=null,this.allNodes=[],ma(this)}ba.TraversalType=Object.freeze({PreOrder:0,PostOrder:1}),ba.getLevelCountForSize=function(t,e){var i=0;for(e<t&&(e=t);!((e/=va)<t);)i++;return i},ba.getSizeForLevel=function(t,e){return Math.pow(va,e)*t},ba.prototype.getSubNode=function(t,e,i){(!e||t<this.tileSize)&&(e=0),(!i||t<this.tileSize)&&(i=0),t<this.tileSize&&(t=this.tileSize);var n=ba.getLevelCountForSize(this.tileSize,t);return function t(e,i,n,o,r){if(!e)return null;if(0===n)return e;if(!e.children||0===e.children.length)return null;var a=Math.pow(va,n)/va,s=o%a,l=r%a,c=Math.floor(r/a),u=Math.floor(o/a),h=c*va+u;return t(e.children[h],i+1,n-1,s,l)}(this.root,0,n,e,i)},ba.prototype.breadthFirst=function(t){var e=!!(t=t||{}).nullLevelEnd,i=t.maxLevel,n=t.minLevel,o=t.callback,r=t.saveVisited,a=[],s={},l=0;for(a.push(this.root),a.push(s);0<a.length&&!(i&&i<l);){var c=a.shift();if(c===s)(!n||n<=l)&&(o&&e&&o(null),r&&e&&r.push(null)),0<a.length&&a.push(s),l++;else{if(c.children)for(var u=0;u<c.children.length;u++)c.children[u]&&a.push(c.children[u]);var h=this.getFaceIndexFromNode(c);(!n||n<=l)&&(o&&o(c,l,h),r&&r.push(c))}}},ba.prototype.getFaceIndexFromNode=function(t){if(!t)return-1;for(var e=1,i=t,n=0,o=0;;){var r=i.parent;if(!r)break;for(var a=-1,s=0;s<r.children.length;s++)r.children[s]===i&&(a=s);n=a%va*e+n,o=Math.floor(a/va)*e+o,e*=va,i=r}return o*e+n},ba.prototype.depthFirst=function(t,e,i){!function t(e,i,n,o,r,a,s,l){if(e){s=s||ba.TraversalType.PreOrder;var c=o*va+n;if(s===ba.TraversalType.PreOrder&&(r&&r(e,i,c,n,o),a&&a.push(e)),e.children&&0!==e.children.length){for(var u=o*va,h=n*va,d=0;d<va;d++)for(var p=0;p<va;p++)t(e.children[p*va+d],i+1,h+d,u+p,r,a,s,l);s===ba.TraversalType.PostOrder&&(r&&r(e,i,c,n,o),a&&a.push(e))}}}(this.root,0,0,0,t,e,i,this.tileSize)},ba.destory=function(){ga=0,ya=(va=2)*va};var wa=ba;function xa(t){for(var e=0;e<Oa.length;e++){var i=Oa[e];if(i.renderTarget===t)return!(i.inUse=!1)}return!1}var _a={};function Sa(){this.tileDirectory={},this.activeRenderTargetDescriptors={},this.activePanos=[],this.panoLODDescriptors={},this.panoDescriptors={},this.tileTrees={},this.sceneRenderer=null,this.tileDownloader=null,this.forceQueue=[],this.needActivePanos=[],this.uploadQueues={},this.uploadInterval=null,this.uploadIntervalCancelled=!1,this.usingTileOverlay=!1,this.overlayTilesLoaded=!1,this.overlayTileBase=null,this.overlayTilesBasic={},this.overlayTilesEnhanced={},this.zoomRenderTarget=null,this.zoomPano=null,this.zoomingActive=!1,this.zoomPanoId=null,this.zoomPanoRenderingDisabled=!1,this.direction=new v.Vector3,this.initTime=-1,this.updataCount=0,this.maxBaseUploadsPerFrame=ka,this.maxNonBaseUploadsPerFrame=Da,this.checkUploadInterval=this.checkUploadInterval.bind(this)}var Ta,Ma,Ia,Pa,Ca=ot.EventEmitter,Aa=!1,Ea=z.tiling.uploadIntervalDelay,La=z.tiling.initialIntervalDelay,Da=z.tiling.maxNonBaseUploadsPerFrame,ka=z.tiling.maxBaseUploadsPerFrame,Ra={Base:0,Remaining:1},Oa=[];(Sa.prototype=Object.create(Ca.prototype)).init=function(t,e,i){this.sceneRenderer=t,this.tileDownloader=e,this.qualityManager=i,this.bindEvents(),this.sceneRenderer.on(ar.ContextCreated,this.loadOverlayTiles.bind(this)),this.initTime=performance.now()},Sa.prototype.checkUploadInterval=function(){this.uploadIntervalCancelled||this.overlayTilesLoaded||(this.usingTileOverlay?this.refreshUploadInterval(this.uploadIntervalDelay):(Aa=!0,this.updateUploadQueue(this.maxNonBaseUploadsPerFrame,this.maxBaseUploadsPerFrame),this.peekNextFromUploadQueue()?this.refreshUploadInterval(Ea):this.uploadInterval=null))},Sa.prototype.getActivePanoTextures=function(t){t=t||[];for(var e=0;e<Oa.length;e++){var i=Oa[e];i.renderTarget&&i.renderTarget.texture&&t.push(i.renderTarget.texture)}},Sa.prototype.hasQueuedTiles=function(){return null!=this.peekNextFromUploadQueue()},Sa.prototype.getActiveRenderTargetDescriptor=function(t){return this.activeRenderTargetDescriptors[t]},Sa.prototype.setActiveRenderTargetDescriptor=function(t,e){this.activeRenderTargetDescriptors[t]=e},Sa.prototype.loadOverlayTiles=function(){if(0!==z.tiling.overlayStyle){var t=0,e=function(e,n,o){e=n?e[n]=this.sceneRenderer.initSizedTexture2D(ge.TILE_SIZE,v.ClampToEdgeWrapping):this.overlayTileBase=this.sceneRenderer.initSizedTexture2D(ge.TILE_SIZE,v.ClampToEdgeWrapping),this.sceneRenderer.uploadTexture2D(o,e,0,0,ge.TILE_SIZE,ge.TILE_SIZE),++t===i.length&&(this.overlayTilesLoaded=!0)}.bind(this),i=[["images/outlineBase.png",e.bind(this,this.overlayTileBase,null)],["images/outlineBasic512.png",e.bind(this,this.overlayTilesBasic,256)],["images/outlineBasic512.png",e.bind(this,this.overlayTilesBasic,512)],["images/outlineBasic1024.png",e.bind(this,this.overlayTilesBasic,1024)],["images/outlineBasic2048.png",e.bind(this,this.overlayTilesBasic,2048)],["images/outlineBasic4096.png",e.bind(this,this.overlayTilesBasic,4096)],["images/outlineEnhanced512.png",e.bind(this,this.overlayTilesEnhanced,256)],["images/outlineEnhanced512.png",e.bind(this,this.overlayTilesEnhanced,512)],["images/outlineEnhanced1024.png",e.bind(this,this.overlayTilesEnhanced,1024)],["images/outlineEnhanced2048.png",e.bind(this,this.overlayTilesEnhanced,2048)],["images/outlineEnhanced4096.png",e.bind(this,this.overlayTilesEnhanced,4096)]];i.forEach(function(t){this.tileDownloader.loadImage(t[0],0,t[1])}.bind(this)),this.usingTileOverlay=!0}else this.usingTileOverlay=!1},Sa.prototype.bindEvents=function(){this.tileDownloader.on(pa.TileDownloadSuccess,this.onTileDownloaded.bind(this))},Sa.prototype.setupZoomRenderTarget=function(){if(this.qualityManager.getMaxZoomPanoSize()>=this.qualityManager.getMaxNavPanoSize()){if(this.zoomRenderTarget&&this.zoomRenderTarget.width===this.qualityManager.getMaxZoomPanoSize())return;var t=this.zoomRenderTarget;if(this.zoomRenderTarget=this.initTiledPano(this.qualityManager.getMaxZoomPanoSize(),!1),t){var e=t.width,i=this.zoomRenderTarget.width;this.sceneRenderer.copyCubeMap(t.texture,this.zoomRenderTarget,e,e,i,i),t.texture.dispose(),t.texture.loaded=!1,t.texture.version=0,this.sceneRenderer.deallocateCubeTexture(t.texture),t.texture=null}this.zoomPanoRenderingDisabled=!1}else this.zoomPanoRenderingDisabled=!0},Sa.prototype.enableUltraHighQualityMode=function(t){if(!this.qualityManager.ultraHighQualityModeEnabled()){var e=this.qualityManager.getPanoSize(4);this.tileDownloader.testDownload(e,ge.TILE_SIZE,function(e){e&&(this.qualityManager.enableUltraHighQualityMode(),this.setupZoomRenderTarget(),t())}.bind(this))}},Sa.prototype.activateTiledPano=function(t,e,i){i&&this.clearAllQueuedUploads();for(var n=0;n<ge.FACES_PER_PANO;n++)this.initTileTree(t.id,n,this.qualityManager.getMaxPossiblePanoSize());this.linkAllTilesAndNodes(t);var o=this.getActiveRenderTargetDescriptor(t.id);if(e>this.qualityManager.getMaxNavPanoSize()&&(e=this.qualityManager.getMaxNavPanoSize()),!o||e!==o.size){if(o&&xa(o.renderTarget),!(o=function(t){for(var e=0;e<Oa.length;e++){var i=Oa[e];if(!i.inUse&&i.size===t)return i.inUse=!0,i}return null}(e))){var r=this.initTiledPano(e,!1);(o=function(t){var e,i={renderTarget:null,inUse:!1,size:-1,pano:null};return i.inUse=!0,i.size=t,e=i,Oa.push(e),i}(r.width)).renderTarget=r}o.pano=t,this.resetPanoDescriptor(t.id),this.resetPanoLODDescriptors(t.id),this.resetRenderStatus(t.id,!0,!0)}this.setActiveRenderTargetDescriptor(t.id,o);var a=i?0:1;return this.updateActivePanos(t,a),o.renderTarget},Sa.prototype.deactivateTiledPano=function(t){var e=this.getActiveRenderTargetDescriptor(t.id);this.isRenderTargetDescriptorValid(e)&&xa(e.renderTarget),this.setActiveRenderTargetDescriptor(t.id,null);var i=this.getUploadQueueForPano(t.id);this.clearUploadQueue(i),this.updateActivePanos()},Sa.prototype.updateActivePanos=function(t,e){for(var i=this.needActivePanos.length=0;i<this.activePanos.length;i++){t&&this.needActivePanos.length===e&&this.needActivePanos.push(t);var n=this.activePanos[i],o=this.getActiveRenderTargetDescriptor(n.id);t&&n.id===t.id||!this.isRenderTargetDescriptorValid(o)||this.needActivePanos.push(n)}t&&e>=this.needActivePanos.length&&this.needActivePanos.push(t),this.activePanos.length=0,this.activePanos.push.apply(this.activePanos,this.needActivePanos)},Sa.prototype.getActivePanoCount=function(){return this.activePanos.length},Sa.prototype.resetRenderStatus=function(t,e,i,n){var o=function(t,n,o,r){i&&(n.tile.zoomUploaded=!1),e&&(n.tile.uploaded=!1)},r=null;n&&(r=wa.getLevelCountForSize(ge.TILE_SIZE,n)+1);for(var a=0;a<ge.FACES_PER_PANO;a++)this.getTileTree(t,a).breadthFirst({callback:o.bind(this,a),minLevel:r})},Sa.prototype.copyBaseRenderStatusToZoomed=function(t){for(var e=wa.getLevelCountForSize(ge.TILE_SIZE,this.qualityManager.getMaxNavPanoSize()),i=function(t,e,i,n){e.tile.zoomUploaded=e.tile.uploaded,e.zoomCovered=e.covered},n=0;n<ge.FACES_PER_PANO;n++)this.getTileTree(t,n).breadthFirst({callback:i.bind(this,n),maxLevel:e})},Sa.prototype.renderPanoTiles=(Ta=[],function(t,e,i,n){this.zoomRenderTarget&&this.zoomRenderTarget.width===this.qualityManager.getMaxZoomPanoSize()||this.zoomPanoRenderingDisabled||this.setupZoomRenderTarget(),e=e||this.direction||tt.FORWARD;var o=this.getActiveRenderTargetDescriptor(t);if(!this.isRenderTargetDescriptorValid(o))throw new p("PanoRenderer.renderPanoTiles() -> Cannot render to a pano that is not activated.");for(var r=0;r<ge.FACES_PER_PANO;r++){var a=this.getTileTree(t,r);Ta.length=0,a.breadthFirst({saveVisited:Ta});for(var s=0;s<Ta.length;s++){var l=Ta[s];this.queueTileUpload(l.tile,!1,n||0===s&&i)}}this.updateDirection(e)}),Sa.prototype.isRenderTargetDescriptorValid=function(t){return t&&t.renderTarget},Sa.prototype.isPanoActive=function(t){var e=this.getActiveRenderTargetDescriptor(t);return this.isRenderTargetDescriptorValid(e)},Sa.prototype.isPanoZoomed=function(t){return this.zoomingActive&&this.zoomPanoId===t},Sa.prototype.initTileTree=function(t,e,i){var n=this.tileTrees[t];n||(n=[],this.tileTrees[t]=n);var o=n[e];if(!o){var r=wa.getLevelCountForSize(ge.TILE_SIZE,i);o=new wa(ge.TILE_SIZE,r),n[e]=o}},Sa.prototype.getTileTree=function(t,e){var i=this.tileTrees[t];if(!i)throw new p("PanoRenderer.getTileTree() -> Tree array not yet initialized!");var n=i[e];if(!n)throw new p("PanoRenderer.getTileTree() -> Tree not yet initialized!");return n},Sa.prototype.initTiledPano=function(t,e){var i=this.sceneRenderer.renderer,n=(i.context,new v.WebGLRenderTargetCube(t,t,{stencilBuffer:!1})),o=new v.CubeTexture([]);(n.texture=o).image=[null,null,null,null,null,null],o.flipY=!0,o.minFilter=e?(o.generateMipmaps=!0,o.magFilter=v.LinearFilter,v.LinearMipMapLinearFilter):(o.generateMipmaps=!1,o.magFilter=v.LinearFilter,v.LinearFilter),o.format=v.RGBAFormat,i.setRenderTarget(n),i.setRenderTarget(null);var r=i.properties.get(o);return r.__image__webglTextureCube=r.__webglTexture,n},Sa.prototype.getUploadQueueForPano=function(t){var e=this.uploadQueues[t];return e||(e=[],this.uploadQueues[t]=e),e},Sa.prototype.isTileUploaded=function(t){return this.isPanoZoomed(t.panoId)?t.zoomUploaded:t.uploaded},Sa.prototype.setUploaded=function(t,e){this.isPanoZoomed(t.panoId)?t.zoomUploaded=e:t.uploaded=e},Sa.prototype.queueTileUpload=function(t,e,i){var n=this.getActiveRenderTargetDescriptor(t.panoId);if(this.isRenderTargetDescriptorValid(n)&&t.downloaded&&!this.isTileUploaded(t)&&(!t.uploadQueued||i)&&(!(t.panoSize>this.qualityManager.getMaxNavPanoSize())||this.zoomingActive)){var o=this.getUploadQueueForPano(t.panoId);i?this.uploadTile(t,!1):(this.shoulPushToFrontOfQueue(t)?this.forceQueue.push(t):e&&this.direction?ni.insertSortedPanoTile(o,t,n.pano,this.direction):o.push(t),t.uploadQueued=!0,this.uploadInterval||this.uploadIntervalCancelled||this.refreshUploadInterval(0))}},Sa.prototype.shoulPushToFrontOfQueue=function(t){return 0===wa.getLevelCountForSize(ge.TILE_SIZE,t.panoSize)},Sa.prototype.getTopUploadQueue=function(){for(var t=null,e=null,i=Ra.Base;i<=Ra.Remaining;i++)for(var n=0;n<this.activePanos.length;n++)if(t=this.activePanos[n],0<(e=this.getUploadQueueForPano(t.id)).length)switch(i){case Ra.Base:if(0===e[0].level)return e;break;case Ra.Remaining:return e}return null},Sa.prototype.getNextFromUploadQueue=(Ma=function(t){var e=t.shift();return e.uploadQueued=!1,e},function(){if(0<this.forceQueue.length)return Ma(this.forceQueue);var t=this.getTopUploadQueue();return t&&0<t.length?Ma(t):null}),Sa.prototype.peekNextFromUploadQueue=function(){if(0<this.forceQueue.length)return this.forceQueue[0];var t=this.getTopUploadQueue();return t&&0<t.length?t[0]:null},Sa.prototype.clearAllQueuedUploads=function(){this.clearAllUploadQueues(null,0)},Sa.prototype.clearAllQueuedUploadsForPano=function(t){this.clearAllUploadQueues(t,0)},Sa.prototype.clearAllUploadQueues=function(t,e){if(t)this.clearUploadQueue(this.getUploadQueueForPano(t),e),this.clearUploadQueue(this.forceQueue,e,t);else{for(var i=0;i<this.activePanos.length;i++){var n=this.activePanos[i];this.clearUploadQueue(this.getUploadQueueForPano(n.id),e)}this.clearUploadQueue(this.forceQueue,e)}},Sa.prototype.clearUploadQueue=function(t,e,i){null!=e||(e=0);for(var n=0;n<t.length;){var o=t[n];(!i||i&&i===o.tile.panoId)&&o.level>=e?(o.uploadQueued=!1,t.splice(n,1)):n++}},Sa.prototype.refreshUploadInterval=function(t){this.uploadIntervalCancelled||(null!=t||(t=Ea),Aa||(t=La),this.uploadInterval=window.setTimeout(this.checkUploadInterval,t),this.uploadIntervalDelay=t)},Sa.prototype.update=(Ia=performance.now(),function(){this.uploadIntervalCancelled=!0,window.clearTimeout(this.uploadInterval),this.uploadInterval=null;var t=performance.now()-Ia;!(Ea<t||0===this.updataCount)||!this.overlayTilesLoaded&&this.usingTileOverlay||(this.updateUploadQueue(this.maxNonBaseUploadsPerFrame,this.maxBaseUploadsPerFrame),Ia=performance.now()),this.updataCount++}),Sa.prototype.updateUploadQueue=function(t,e){t||(t=1);for(var i=0,n=0;!(e<=n||t<=i);){var o=this.getNextFromUploadQueue();if(!o)break;if(0!==o.level?i++:n++,!(o.panoSize>this.qualityManager.getMaxNavPanoSize())||this.zoomingActive){var r=this.getActiveRenderTargetDescriptor(o.panoId);this.isRenderTargetDescriptorValid(r)&&this.uploadTile(o,o.forceUpload)}}},Sa.prototype.updateDirection=function(t){if(t=t||this.direction){this.direction=t;for(var e=0;e<this.activePanos.length;e++){var i=this.activePanos[e],n=this.getUploadQueueForPano(i.id);ni.sortPanoTiles(n,i,this.direction)}}},Sa.prototype.uploadTile=(Pa=z.tiling.overlayStyle,function(t,e){var i=t.panoId,n=t.image,o=t.tileSize,r=t.panoSize,a=t.tileIndex,s=(t.faceTileIndex,t.totalTiles),l=(t.face,t.tileX),c=t.tileY,u=!0,h=!1,d=(this.getPanoDescriptor(i),this.getPanoLODDescriptor(i,r)),p=this.getActiveRenderTargetDescriptor(i),f=p.renderTarget,m=p.size;if(this.isPanoZoomed(i)&&(f=this.zoomRenderTarget,m=this.qualityManager.getMaxZoomPanoSize()),this.isRenderTargetDescriptorValid(p)||(h=u=!1),e||(this.anyUploaded(t.node)&&(h=!(u=!1)),this.isTileUploaded(t)&&(h=u=!1)),u){var g=o/r*m,y=l*o/r*m,b=c*o/r*m;_a[o]||(_a[o]=this.sceneRenderer.initSizedTexture2D(o,v.ClampToEdgeWrapping));var w=_a[o];if(this.sceneRenderer.uploadTexture2D(n,w,0,0,o,o),1===Pa||2===Pa){var x=1===Pa?this.overlayTilesBasic:this.overlayTilesEnhanced;this.sceneRenderer.renderToCubeMap(w,f,o,o,0,0,o,o,y,b,g,g,t.cubeFace),this.sceneRenderer.renderToCubeMap(x[r],f,o,o,0,0,o,o,y,b,g,g,t.cubeFace,v.NormalBlending,!0,.5)}else this.sceneRenderer.renderToCubeMap(w,f,o,o,0,0,o,o,y,b,g,g,t.cubeFace);d.uploadCount++,this.emit(pe,i,r,a,s),d.uploadCount===s&&this.emit(de,i,r,s),this.setUploaded(t,!0),this.addCoverageForNode(t.node)}else this.setUploaded(t,!1);return t.uploadAttempted||(d.uploadAttempts++,this.emit("panorama.tile.upload.attempted",i,r,a,s)),t.uploadAttempted=!0,d.uploadAttempts===s&&this.emit(fe,i,r,s),h}),Sa.prototype.linkTileAndNode=function(t,e){(e.tile=t).node=e},Sa.prototype.linkAllTilesAndNodes=function(t){for(var e=function(e,i,n,o,r){var a=this.getTileDirectoryEntry(t.id,i,o,r);this.linkTileAndNode(a,n)},i=0;i<ge.FACES_PER_PANO;i++){var n=this.getTileTree(t.id,i);n.breadthFirst({callback:e.bind(this,n,i)})}},Sa.prototype.anyUploaded=function(t){if(!t)return!1;if(t.tile&&this.isTileUploaded(t.tile))return!0;if(t.children)for(var e=0;e<t.children.length;e++){var i=t.children[e];if(this.anyUploaded(i))return!0}return!1},Sa.prototype.setNodeCovered=function(t,e){this.isPanoZoomed(t.tile.panoId)?t.zoomCovered=e:t.covered=e},Sa.prototype.isNodeCovered=function(t){return!!t&&(this.isPanoZoomed(t.tile.panoId)?t.zoomCovered:t.covered)},Sa.prototype.addCoverageForNode=function(t){if(this.setNodeCovered(t,!0),t.parent&&t.covered){var e=t.parent;this.nodeSubcovered(e)&&this.addCoverageForNode(e,!0)}},Sa.prototype.calcFullCoverage=function(t){var e=!1;if(t.children)for(var i=0;i<t.children.length;i++){var n=t.children[i];e=e||this.calcFullCoverage(n)}t.covered=t.tile.uploaded||e},Sa.prototype.nodeSubcovered=function(t){if(!t.children)return!1;for(var e=0;e<t.children.length;e++)if(!t.children[e]||!this.isNodeCovered(t.children[e]))return!1;return!0},Sa.prototype.resetPanoDescriptor=function(t){this.getPanoDescriptor(t)},Sa.prototype.getPanoDescriptor=function(t){var e=this.panoDescriptors[t];return e||(e={},this.panoDescriptors[t]=e),e},Sa.prototype.resetPanoLODDescriptors=function(t){var e=this.getPanoLODDescriptors(t);for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];n.uploadCount=0,n.uploadAttempts=0}},Sa.prototype.getPanoLODDescriptor=function(t,e){var i=this.getPanoLODDescriptors(t),n=i[e];return n||(n={uploadCount:0,uploadAttempts:0},i[e]=n),n},Sa.prototype.getPanoLODDescriptors=function(t){var e=this.panoLODDescriptors[t];return e||(e={},this.panoLODDescriptors[t]=e),e},Sa.prototype.onTileDownloaded=function(t){var e=wa.getLevelCountForSize(ge.TILE_SIZE,t.panoSize),i=this.getTileDirectoryEntry(t.panoId,t.face,e,t.faceTileIndex);if(i.downloaded=!0,i.image=t.image,i.panoSize=t.panoSize,i.tileX=t.tileX,i.tileY=t.tileY,i.totalTiles=t.totalTiles,i.tileIndex=t.tileIndex,i.faceTileIndex=t.faceTileIndex,i.face=t.face,i.cubeFace=le.mapFaceToCubemapFace(t.face),i.panoId=t.panoId,i.tileSize=t.tileSize,i.direction=(new v.Vector3).copy(t.direction),i.node=null,i.level=wa.getLevelCountForSize(ge.TILE_SIZE,i.panoSize),this.isPanoActive(i.panoId)){var n=this.getTileTree(i.panoId,i.face).getSubNode(i.panoSize,i.tileX,i.tileY);this.linkTileAndNode(i,n),this.queueTileUpload(i,!0)}},Sa.prototype.getTileDirectoryEntry=function(t,e,i,n){var o=this.tileDirectory[t];o||(o={},this.tileDirectory[t]=o);var r=16384*e+1024*i+n,a=o[r];return a||(a={downloaded:!1,uploaded:!1,zoomUploaded:!1},o[r]=a),a._key=t+":"+e+":"+i+":"+n,a._tileKey=r,a},Sa.prototype.setZoomingActive=function(t,e,i){this.zoomPanoRenderingDisabled||t===this.zoomingActive&&this.zoomPanoId===e.id||(this.zoomingActive=t,this.zoomPanoId=e.id,this.zoomingActive&&(this.zoomPanoId!==e.id||i)&&this.updateZoomedPanoFromBase(e))},Sa.prototype.updateZoomedPanoFromBase=function(t){if(!this.zoomPanoRenderingDisabled){var e=this.getActiveRenderTargetDescriptor(t.id);if(e&&e.renderTarget){var i=this.qualityManager.getMaxZoomPanoSize(),n=e.renderTarget,o=e.size;this.sceneRenderer.copyCubeMap(n.texture,this.zoomRenderTarget,o,o,i,i),this.copyBaseRenderStatusToZoomed(t.id)}}},Sa.prototype.destory=function(){_a={},this.updataCount=0,this.needActivePanos=[],Oa=[],Aa=!(Ra={Base:0,Remaining:1}),wa.destory()};var Fa=Sa,Na=ot.EventEmitter;function Ua(t){this.enable=!1,this.container=document.createElement("div"),this.container.id="pano-size",this.container.style.position="fixed",this.container.style.width="100%",this.container.style.height="100%",t.appendChild(this.container)}(Ua.prototype=Object.create(Na.prototype)).init=function(t){this.lineLeft=this.buildPanoDom("left"),this.lineRight=this.buildPanoDom("right"),this.lineHeight=this.buildPanoDom("height"),this.frames=0,this.checkedPoint=null,this.areaName=t?t.areaName:null,this.raycaster=new v.Raycaster},Ua.prototype.buildPanoDom=function(t){var e=document.createElement("div");e.className="pano-size-line",this.container.appendChild(e);var i=document.createElement("em");e.appendChild(i);var n=document.createElement("div");n.className="pano-size-label";var o=document.createElement("div");o.className="pano-size-label-point";var r=document.createElement("div");return t&&(r.className="pano-size-label-name "+t),e.appendChild(n),n.appendChild(o),n.appendChild(r),e},Ua.prototype.setEnable=function(t){this.enable=t,document.getElementById("pano-size").style.display=t?"block":"none"},Ua.prototype.update=function(t){if(this.enable){var e,i,n=t.mode,o=t.camera,r=t.currentPano,a=r.floorIndex||0,s=this.getFloorCeilingHeight(t);if(this.frames+=1,n!==A.PANORAMA||null===r||!r.areasPoints)return this.emit("updatePanoSize","height",!1,{}),this.emit("updatePanoSize","left",!1,{}),this.emit("updatePanoSize","right",!1,{}),!1;for(var l,c=r.areasPoints,u=0,h=[],d=[],p=this.checkedPoint,f=this.areaName,m=o.getWorldDirection(new v.Vector3),g=0;g<c.length;g++){var y=new v.Vector3(m.x,m.y,m.z),b=new v.Vector3(c[g].x-o.position.x,c[g].y-o.position.y,c[g].z-o.position.z);this.raycaster.set(o.position,b),this.raycaster.intersectObjects(G.model.colliders),d.push(y.angleTo(b)),h[u]=c[g],u++}for(var w=d.slice().sort(function(t,e){return t-e})[0],x=0;x<d.length;x++)if(w===d[x]){var _=x;this.checkedPoint=x,this.areaName=r.areaName}if(f!==this.areaName&&(p=null),p!==this.checkedPoint&&p)return this.emit("updatePanoSize","height",!1,{}),this.emit("updatePanoSize","left",!1,{}),this.emit("updatePanoSize","right",!1,{}),!1;l={x:h[_].x,y:s[a],z:h[_].z},e=0===_?h[h.length-1]:h[_-1],i=_===h.length-1?h[0]:h[_+1],0===Math.round(h[_].y)&&(h[_].y=0===_?h[_+1].y:h[0].y);var S=this.getAngleAndDistance(h[_],l,o),T=this.getAngleAndDistance(h[_],e,o),M=this.getAngleAndDistance(h[_],i,o);this.emit("updatePanoSize","height",!0,S),this.emit("updatePanoSize","left",!0,T),this.emit("updatePanoSize","right",!0,M)}},Ua.prototype.getFloorCeilingHeight=function(t){var e=[],i=t.model.floorsHeight,n=i.totalfloor,o=i.height;return 1<n?o.forEach(function(i,r){e[r]=r===n-1?t.model.boundingBox.max.y:o[r+1]}):e.push(t.model.boundingBox.max.y),e},Ua.prototype.getAngleAndDistance=function(t,e,i){function n(t){var e,n,r=t.project(i);return r.y*=-1,e=Math.round((r.x+1)*o.container.clientWidth/2),n=Math.round((r.y+1)*o.container.clientHeight/2),new v.Vector2(e,n)}var o=this,r=new v.Matrix4,a=new v.Line3(new v.Vector3(t.x,t.y,t.z),new v.Vector3(e.x,e.y,e.z)),s=a.distance();r.multiplyMatrices(i.projectionMatrix,r.getInverse(i.matrixWorld));var l=r.elements,c=new v.Vector3(l[3]+l[2],l[7]+l[6],l[11]+l[10]),u=new v.Plane(c,l[15]+l[14]),h=(new v.Vector3).copy(a.start).dot(u.normal)+u.constant,d=(new v.Vector3).copy(a.end).dot(u.normal)+u.constant;if(h<0&&d<0)return null;var p=u.intersectLine(a);void 0!==p&&(h<0?a.start.copy(p):a.end.copy(p));var f=n(a.start),m=n(a.end),g=this.getAngle(f,m);return g.point=f,g.length=s,g},Ua.prototype.updateUI=function(t,e,i){null!==i?(t.style.display="block",setTimeout(function(){t.style.top=i.point.y+"px",t.style.left=i.point.x+"px",t.style.width=i.dis+"px",t.style.webkitTransform="rotate("+i.angle+"deg)",t.style.transform="rotate("+i.angle+"deg)",o(".pano-size-label-name").hasClass(e)&&o(".pano-size-label-name."+e).text("≈"+(i.length*z.unit_conversion_value).toFixed(2)+z.unit_name)},0)):t.style.display="none"},Ua.prototype.getAngle=function(t,e){var i=(new v.Vector2).subVectors(e,t),n=i.length(),o=Math.acos(i.x/n);return i.y<0&&(o*=-1),{angle:180*o/Math.PI,dis:n}};var Ba=Ua,za=ot.EventEmitter,Va=zo(),Ga=function(){this.debug=!1,this.arr=[],this.parr=[],this.arrSet=[],this.cur=0,this.len=0,this.lon=0,this.playing=!1,this.pidx=0,this.pcur=0,this.enable=!0,this.longplaying=!1,this.adiv=null,this.loadAudio=this.loadAudio.bind(this)};((Ga.prototype=Object.create(za.prototype)).constructor=Ga).prototype.init=function(t){t?(t&&t.enable&&t.dataset.length&&(this.arrSet=t.dataset,this.arrSet.forEach(function(t,e){var i=t.audiourl;Va.load(i)})),this.len=t.dataset.length):this.enable=!1},Ga.prototype.startRecord=function(t){this.recording?this.emit("recording"):(this.emit("readyToRecord"),this.recordstart=!0,this.rtime=0,this.loadAudio(t),this.ridx=t)},Ga.prototype.endRecord=function(){this.recording=!1,this.elapsedtime=this.time.getElapsedTime(),this.time.stop(),this.elapsedtime>this.adiv.duration&&(this.elapsedtime=this.adiv.duration),this.send({data:this.arr,totalTime:parseFloat(this.elapsedtime.toFixed(5))}),G.player.controls[A.PANORAMA].rtime=0,this.adiv.currentTime=0,this.adiv.pause(),this.emit("stopRecord"),this.pidx=0},Ga.prototype.save=function(t){return t.time=parseFloat(this.time.getElapsedTime().toFixed(5)),this.arr.push(t),t.time},Ga.prototype.save2=function(t){this.arr.push(t)},Ga.prototype.checkserver=function(){return window.parent&&window.parent.NestP},Ga.prototype.send=function(t){this.arrSet[this.recordidx]={name:this.arrSet[this.recordidx].name,audiourl:this.arrSet[this.recordidx].audiourl,totalTime:t.totalTime,record:t.data.concat()},this.emit("record_Data",t),this.checkserver()&&window.parent.NestP.record(t)},Ga.prototype.reset=function(){this.arr=[],this.time=new v.Clock(!1)},Ga.prototype.trytopause=function(t,e){t!==this.pidx&&(this.playing=!1,this.stop(),e&&(this.want=t,setTimeout(e,500)))},Ga.prototype.perviewPlay=function(t){G.d.currentScript=1,this.inputidx=t,this.load(function(){this.cplay()}.bind(this))},Ga.prototype.pplay=function(t){if(this.enable){if(!this.checkEnable())return this.emit("emity"),!1;if(void 0===t&&(t=this.pidx),t===this.pidx)this.checkstate()?this.ppause():this.loadAudio(t);else if(this.stopAction(),this.stopAudio(),this.clearview(this.pidx),this.checkstate()){var e=this.pidx;this.pidx=t,this.rstop(e,this.loadAudio,t)}else this.pidx=t,this.loadAudio(t);this.setCurrentView(this.pidx)}},Ga.prototype.checkEnable=function(){return 0!==this.arrSet.length},Ga.prototype.presume=function(t,e){this.checkstate()||(void 0===t?t=this.pidx:this.pidx=t,this.pplay(t))},Ga.prototype.preset=function(){},Ga.prototype.ppause=function(t){this.checkstate()&&(void 0===t&&(t=this.pidx),this.rpause(t),this.paused=!0)},Ga.prototype.loadAudio=function(t){function e(){if(i.floading=!1,i.adiv.oncanplay=function(){},i.fgotoh=!0,i.inputidx=t,G.player.flying||G.player.isWarping())var e=setInterval(function(){G.player.flying||G.player.isWarping()||(clearInterval(e),G.d.goToHighlight(t))},100);else G.d.goToHighlight(t)}var i=this;this.pidx=t;var n=this.arrSet[t].audiourl;if(this.adiv=Va.getCell(n),null!==this.adiv&&(this.floading=!0,4===this.adiv.readyState?e():(this.emit("loadingAudio"),this.adiv.oncanplay=function(){e(),this.emit("loadAudioDone")}),this.debug&&!this.debugstart)){this.debugstart=!0;var r="audioBuffer:",a=this.adiv.audioBuffer;a?(r+="duration:"+a.duration+",",r+="length:"+a.length+",",r+="numberOfChannels:"+a.numberOfChannels+",",r+="sampleRate:"+a.sampleRate+","):r+="undefined",setInterval(function(){o(".debuginfo").html(r),o(".debugpanel").show()},1e3)}},Ga.prototype.rstop=function(t,e,i){this.rpause(t),this.clearview(t),G.d.tourIsPlaying?setTimeout(function(){this.rstop(t,e,i)}.bind(this),500):(this.stopAction(),this.stopAudio(),e(i))},Ga.prototype.stopAction=function(){this.playing=!1,this.exetime&&this.exetime.stop(),this.exetime=new v.Clock(!1),this.parr=[],this.w=void 0,this.st=0,this.arrSet[this.pidx].inited=!1},Ga.prototype.stopAudio=function(){this.adiv.currentTime=0,this.adiv.pause()},Ga.prototype.rpause=function(t){this.floading&&(this.adiv.oncanplay=function(){},this.floading=!1),this.fgotoh&&(this.fgotoh=!1),this.acpause(),this.aupause()},Ga.prototype.acpause=function(){this.playing=!1,this.exetime&&this.exetime.stop()},Ga.prototype.acresume=function(){this.arrSet[this.pidx].inited?(this.playing=!0,this.exetime.start()):this.acstart(this.pidx)},Ga.prototype.aupause=function(){this.adiv.pause()},Ga.prototype.auresume=function(){this.adiv.play()},Ga.prototype._emitCountDown=function(t){this.emit("countdown",t)},Ga.prototype.pafter=function(){var t=this;if(this.fgotoh)if(this.fgotoh=!1,this.recordstart){this._emitCountDown(3);var e=3,i=setInterval(function(){0<--e?t._emitCountDown(e):t.emit("startRecord"),0==e&&(clearInterval(i),this.recordstart=!1,this.arr=[],this.recordidx=this.ridx,this.time=new v.Clock(!1),this.time.start(),this.rtime=void 0,this.recording=!0,this.austart(this.inputidx))}.bind(this),1e3)}else this.paused?(this.paused=!1,this.acresume(),this.auresume()):(this.acstart(this.pidx),this.austart(this.pidx))},Ga.prototype.acstart=function(t){this.parr=[],this.parr=this.arrSet[t].record.concat(),this.totalTime=this.arrSet[t].totalTime,this.totalTime||(this.totalTime=this.adiv.duration),this.exetime=new v.Clock(!1),this.exetime.start(),this.playing=!0,this.arrSet[t].inited=!0},Ga.prototype.austart=function(){this.adiv.currentTime=0,this.adiv.play()},Ga.prototype.load=function(t){o(".aloading_back").css("display","block");var e=this,i=0,n=setInterval(function(){100<++i&&(clearInterval(n),o(".5").css("display","none")),4===e.adiv.readyState&&(o(".aloading_back").css("display","none"),clearInterval(n),t&&t())},100)},Ga.prototype.pause=function(){this.trytopause()},Ga.prototype.next=function(){return this.pidx++,this.pidx===this.len?(this.pidx=0,this.stop(),-1):this.pidx},Ga.prototype.cplay=function(){G.d.goToHighlight(this.pidx)},Ga.prototype.cstop=function(){G.d.stopTour(),G.playing=!1},Ga.prototype.stop=function(){this.playing=!1,this.exetime.stop(),this.exetime=new v.Clock(!1),this.adiv.currentTime=0,this.adiv.pause(),this.emit("stop")},Ga.prototype.update=function(t){if(this.recording){var e=this.adiv.duration-this.time.getElapsedTime();this.recordnotice(e)}else this.playing&&(this.cur=this.exetime.getElapsedTime(),this.excute(),this.changeview(),G.player.mattertagManager.showtitletags&&G.player.mattertagManager.ttposition())},Ga.prototype.recordnotice=function(t){t<=0?(G.toast("录制结束"),this.autoend()):this.emit("stopRecordCountDown",t)},Ga.prototype.autoend=function(){this.endRecord()},Ga.prototype.excute=function(){var t;if(void 0===this.w)this.parr&&this.parr.length?(this.w=this.parr[0],this.outdated()?(this.last={lon:this.parr[0].lon,tap:this.parr[0].tap,action:this.parr[0].action},this.parse(),this.w=void 0,this.parr.shift()):(t=this.smoothable())&&("dollhouse"===t?this.cal2(t):"floorplan"===t?this.cal2(t):"panorama"===t&&this.cal2())):this.playing&&this.cur>=this.totalTime&&this.rstop(this.pidx,function(){var t=this.next();0<=t&&this.pplay(t)}.bind(this));else if(this.outdated())this.last={lon:this.parr[0].lon,tap:this.parr[0].tap,action:this.parr[0].action},this.parse(),this.w=void 0,this.parr.shift();else{if(!(t=this.smoothable()))return;"dollhouse"===t?this.get2(t):"floorplan"===t?this.get2(t):"panorama"===t&&this.get2(),this.uu(t)}},Ga.prototype.clearnext=function(){var t=this.w,e=1.5,i=this.actiontype(t);2===i?e+=1:3===i&&(e+=z.transition.flyTime),t.time,this.w=void 0,this.actiontype(this.parr[0])||this.parr[0].time>e||this.parr.shift()},Ga.prototype.smoothable=function(){var t=this.w;return"dollhouse"===t.tap&&G.player.mode===A.DOLLHOUSE?"dollhouse":"floorplan"===t.tap&&G.player.mode===A.FLOORPLAN?"floorplan":!("panorama"!==t.tap||"rotate"!==t.action||G.player.mode!==A.PANORAMA||!G.player.currentPano||G.player.currentPano.id!==t.panoid)&&"panorama"},Ga.prototype.outdated=function(){return this.cur>=this.w.time},Ga.prototype.cal3=function(t){var e=this.w.time-this.cur;this.st=this.cur,this.iv3={target:this.calv3((new v.Vector3).copy(this.w.target),G.player.controls[t].target,e),offset:this.calv3((new v.Vector3).copy(this.w.offset),G.player.controls[t].offset,e),camera:this.calv3((new v.Vector3).copy(this.w.camera),G.player.controls[t].camera.position,e)},this.initv3={target:G.player.controls[t].target.clone(),offset:G.player.controls[t].offset.clone(),camera:G.player.controls[t].camera.position.clone()}},Ga.prototype.cal2=function(t){t||(t=A.PANORAMA);var e=this.w.time-this.cur;this.st=this.cur,this.iv2={lon:(this.w.lon-G.player.controls[t].lon)/e,lat:(this.w.lat-G.player.controls[t].lat)/e},this.initv2={lon:G.player.controls[t].lon,lat:G.player.controls[t].lat}},Ga.prototype.calv3=function(t,e,i){return t.clone().sub(e).multiplyScalar(1/i)},Ga.prototype.get3=function(t){for(i in this.step={},this.iv3)this.step[i]=this.iv3[i].clone().multiply(this.cur-this.st).add(this.initv3[i])},Ga.prototype.get2=function(){this.step={},this.step.lon=this.iv2.lon*(this.cur-this.st)+this.initv2.lon,this.step.lat=this.iv2.lat*(this.cur-this.st)+this.initv2.lat},Ga.prototype.uu=function(t){t!==A.FLOORPLAN&&G.player.controls[t].play(this.step)},Ga.prototype.changeview=function(){if(this.playing){var t=this.cur/this.totalTime*100;if(100<t)return;this.emit("updateView",this.pidx,t)}},Ga.prototype.setCurrentView=function(t){this.emit("updateView",t,0)},Ga.prototype.clearview=function(t){this.emit("updateView",t,0)},Ga.prototype.checkstate=function(){return!!(G.d&&G.d.tourIsPlaying||this.playing||this.floading||this.fgotoh)},Ga.prototype.parse=function(){var t=this.w;if(t.tap)switch(t.tap){case"housedetail":this.housedetail(null,t.open);break;case"dollhouse":if(t.action)if(G.player.mode!==A.DOLLHOUSE&&G.player.mode!==A.TRANSITIONING)G.d.changeMode(A.DOLLHOUSE,"gui");else switch(t.action){case"rotate":G.player.controls[A.DOLLHOUSE].play(t)}else G.d.changeMode(A.DOLLHOUSE,"gui");break;case"floorplan":t.action?G.player.mode!==A.FLOORPLAN&&G.player.mode!==A.TRANSITIONING?G.d.changeMode(A.FLOORPLAN,"gui"):t.action:G.d.changeMode(A.FLOORPLAN,"gui");break;case"panorama":t.action?G.player.mode!==A.PANORAMA&&G.player.mode!==A.TRANSITIONING?t.panoid?G.player.flyToNewMode({mode:A.PANORAMA,pano:G.model.panos.index[t.panoid]}):G.d.changeMode(A.PANORAMA,"gui"):"move"===t.action?G.player.flyToPano({pano:G.model.panos.index[t.destid]}):G.player.currentPano&&G.player.currentPano.id!==t.panoid?G.player.flyToPano({pano:G.model.panos.index[t.panoid]}):"rotate"===t.action&&(this.panoid=t.panoid,G.player.controls[A.PANORAMA].play(t)):G.d.changeMode(A.PANORAMA,"gui");break;case"outermap":break;case"floor":"all"===t.action?G.d.allFloors():G.d.gotoFloor(parseInt(t.action));break;case"zoom":if(t.type===A.PANORAMA&&G.player.mode===A.PANORAMA){var e=G.player.controls[A.PANORAMA].camera;G.player.zoomLevel=t.level,e.fov=G.player.baseFov*(1/G.player.zoomLevel),e.updateProjectionMatrix(),G.player.zoomFov=e.fov}else t.type===A.DOLLHOUSE&&G.player.mode===A.DOLLHOUSE&&G.player.controls[A.DOLLHOUSE].dollyOut(parseFloat(t.level))}},Ga.prototype.actiontype=function(t){switch(t.tap){case"housedetail":case"outermap":return 1;case"dollhouse":case"floorplan":case"panorama":return"rotate"===t.action?0:"move"===t.action?3:2;case"floor":return 2;case"zoom":return 1}return 0},Ga.prototype.housedetail=function(t,e){this.emit("housedetail",e)};var ja=Ga,Ha={load:{LOADING_START:"loading.start",LOADING_PROCESS:"loading.progress",LOADING_DONE:"loading.done",LOADING_ENTERPOINT:"loading.enterpoint"},tour:{UPDATE_TOUR:"tour.update",PAUSE_TOUR:"tour.pause"},lecture:{LECTURE_UPDATE:"lecture.update",LECTURE_PAUSE:"lecture.pause"},floor:{FLOOR_UPDATE:"floor.update"},core:{MODE_CHANGE:"core.modechange",FLYING_END:"core.flyingend",MOVE:"core.move",COMPASS:"core.compass",UPDATE_PANOSEIZE:"core.updatepanosize"},tag:{ACTIVE:"tag.active",DISMISS:"tag.dismiss"}};window.G={},G.conf={isNewServerPreviewVersion:!1,isNewEditVersion:!1,isCleanUI:0,jfedit:!1,screenshot:!1,connectDelay:200};var Wa=ot.EventEmitter,qa=At(),$a=new S("/js/main.js");function Ya(t){t.stopPropagation(),t.preventDefault()}function Xa(t,e,i){try{t.start(e)}catch(t){throw $a.warn(t.message),i.modelid,(n=g.details())&&"Safari"===n.name&&500<n.version&&n.version,t}var n}S.level=z.logLevel,S.consoleEnabled=z.console;var Qa=function(t){this.event={load:new Wa,player:new Wa,director:new Wa,model:new Wa},this.playContainer=void 0!==t.container?t.container:document.getElementById("player"),this.modelId=void 0!==t.modelId?t.modelId:"",this.appKey=t.appKey,this.settings=void 0!==t.settings?t.settings:{},this.version=void 0!==t.version?t.version:{},this.siteConf=void 0!==t.siteConf?t.siteConf:{},this.enterType=void 0!==t.enterType?t.enterType:2,this.showMode=void 0!==t.showMode?t.showMode:"play",this.loadingState=!1,this.compassAngle=0,this.lastCompassAngle=0;var e=this;this.progStruct={panoElementsToLoad:6,modelElementsToLoad:0,totalElementsLoaded:0,totalElementsToLoad:0,totalPercentageLoaded:0,progressCallback:null},this.qFlag=z.quickstart.enabled,this.quickstartManager=null,this.startOptions=null,this.player=null,this.director=null,this.mattertagManager=null,this.sceneRenderer=null,this.tileDownloader=null,this.qualityManager=null,this.model=null,this.Controller=null,this.panoRenderer=null,this.quickStart=null,this.panoramaSize=new Ba(this.playContainer),this.panoramaSize.on("updatePanoSize",function(t,i,n){e.panoramaSize.enable&&e.emit("updatePanoSize",t,i,n)}),this.record=null;var i=g.isMobile(),n=document.createElement("div");n.id="viewport-tags",n.className=i?"viewport-tags-mobile":"viewport-tags-pc",n.style.top="0",n.style.left="0",n.style.right="0",n.style.bottom="0",n.style.position="fixed",n.style.pointerEvents="none",this.playContainer.appendChild(n),this._updatePanorameSize=this._updatePanorameSize.bind(this),this._emitAngle=this._emitAngle.bind(this),this._emitFloorChange=this._emitFloorChange.bind(this),this._emitSpinnerState=this._emitSpinnerState.bind(this),this._emitFlyingEnd=this._emitFlyingEnd.bind(this),this._emitHighlightsBarChange=this._emitHighlightsBarChange.bind(this),this._emitModeChange=this._emitModeChange.bind(this),this._emitMoveState=this._emitMoveState.bind(this),this._emitUpdateTour=this._emitUpdateTour.bind(this),this._emitPanoChange=this._emitPanoChange.bind(this),this._emitPanoChosen=this._emitPanoChosen.bind(this),this._emitStopTour=this._emitStopTour.bind(this),this._emitLoadProgress=this._emitLoadProgress.bind(this),this.registryOri()};(Qa.prototype=Object.create(Wa.prototype))._initSettings=function(){if(this.settings.basic.menu&&(z.unit_type=this.settings.basic.menu.unit_type||0,1===z.unit_type&&(z.unit_conversion_value=3.28,z.unit_name="ft",z.unit_sq_name="ft²")),!this.modelId)return this.event.error.emit("invalid_modelid");var t=this.settings.building.blocks;if(t&&this.settings.building)for(var e=0;e<t.length;e++)t[e].blockidx=parseInt(t[e].blockidx),t[e].flooridx=parseInt(t[e].flooridx),t[e].roomidx=parseInt(t[e].roomidx);else this.settings.building.blocks={};G.url=G.url||{},G.url.modelid=this.modelId,G.url.type=this.siteConf.type,window.PREFETCHED_MODELDATA=this.settings,this.playType="heighlight",function(t){var e;$a.info("Version","2.11.9-0-ga9537d5"),Wa.defaultMaxListeners=1e3,(e=t).addEventListener("dragenter",Ya,!1),e.addEventListener("dragover",Ya,!1)}(this.playContainer);var i=function(t,e,i,n){var r=n.type,a="",s="";if("display"===r)a=n.modelpre+e.version,s=n.infopre+e.version;else if("gjf"===r)a=n.modelpre+e.version,s=n.infopre+e.version;else if("sms"===r){var l=i.basic.locationpics.match(/([0-9\-]+)\/{{filename}}/);e="",l&&l[1]&&(e=l[1]),s=e?(a=n.modelpre+e,n.infopre+e):($a.info("no version"),a=n.modelpre,n.infopre)}else"local"===r?(a=n.modelpre+t,s=n.infopre+t):"demo"===r&&(e=o.getUrlParam("version"),a=n.modelpre+e,s=n.modelpre+e);return{modelLink:a,infoLink:s}}(this.modelId,this.version,this.settings,this.siteConf);G.url.model=i.modelLink,G.url.info=i.infoLink,G.settings=this.settings||{},function(t){!function t(e){for(var i in e)"object"==typeof e[i]?t(e[i]):"string"==typeof e[i]&&(e[i]=e[i].replace("modelcdn.3dnest.cn","modelcdn2.3dnest.cn").replace("infocdn.3dnest.cn","infocdn2.3dnest.cn").replace("template.3dnest.cn","template2.3dnest.cn"))}(t)}(this.settings)},Qa.prototype.start=function(t){this.startRender(t)},Qa.prototype.startRender=function(t){var e="quickstart"===t||z.quickstart.enabled;this._initSettings();var i=null,n=null,r=this;this.loadingState=!0,this.record=new ja,G.R=this.record,tr.initS({url:this.modelId,floors:g.valueFromHash("f",!0),autoload:!1},this.settings).then(function(t){return r.model=t,3===r.model.startup_type&&(e=!0,z.quickstart.enabled=!0),r.model.loadPanos()}).then(function(){var t,a,s,l,c,u,h,d,p,f,m,y,b,w,x,_,S;i=ir.getStartCameraOptions(r.model,r.model.panos,new v.Vector3(0,0,0),!0),r.sceneRenderer=(t=r.model,a=new v.PerspectiveCamera,s=new v.Scene,l=new v.AmbientLight(16777215),s.add(l),s.skybox=new Ko,s.add(s.skybox),s.plane=new v.Mesh(new v.PlaneBufferGeometry(1e5,1e5),new v.RawShaderMaterial({side:v.DoubleSide})),s.plane.position.y=0,s.plane.rotateX(-Math.PI/2),s.plane.material.visible=!1,s.add(s.plane),s.updateMatrixWorld(),z.showScreenshotLocations&&t.data.images.forEach(function(t){if(t._camera&&t._camera._viewpoint){var e=t._camera._viewpoint,i=new v.Mesh(new v.BoxGeometry(.3,.3,.3));i.position.copy(e.clone()),s.add(i);var n=t._camera._viewpoint,o=new v.Vector3(0,0,-1).applyQuaternion(n);s.add(new v.ArrowHelper(o,e.clone(),1,16711680))}}),z.showAxis&&(s.add(new v.ArrowHelper(new v.Vector3(0,1,0),new v.Vector3(0,0,0),1,65280)),s.add(new v.ArrowHelper(new v.Vector3(0,0,1),new v.Vector3(0,0,0),1,16711680)),s.add(new v.ArrowHelper(new v.Vector3(1,0,0),new v.Vector3(0,0,0),1,255))),new Ur(s,a,De)),c=e,u=i.mode,h=r.sceneRenderer,d=r.model,p=c?1:1e3,f=new aa,m=new fa({concurrentDownloads:g.valueFromHash("tileconc",4)}),y=new Fa,b=new Ne,w=new Oi,x=new Ti(u),_=new Ni(p),S=new da,f.init(b),m.init(f),y.init(h,m,f),b.init(m,y,f),b.addModel(d),h.addComponent(V),n={qualityManager:f,panoRenderer:y,tileDownloader:m,player:x,director:w,modelManager:b,mattertagManager:S,displayController:_},r.player=n.player,r.director=n.director,r.mattertagManager=n.mattertagManager,r.tileDownloader=n.tileDownloader,r.qualityManager=n.qualityManager,r.panoRenderer=n.panoRenderer,r.record.init(r.settings.jf),r.model.supportsTiles&&r.tileDownloader.start(),e&&i.mode!==A.PANORAMA&&($a.warn("Tried to quickstart, but failed as we are not starting in inside mode."),e=!1),(e||i.mode===A.PANORAMA)&&i.pano&&r.emit("enterPoint",i.pano.id);var T=null;return e&&(r.quickstartManager=new ra(r.qualityManager,r.sceneRenderer.scene,r.sceneRenderer.camera,r.playContainer),Xa(r.sceneRenderer,r.playContainer,r.model),T=r.quickstartManager.load(i).then(function(){r.sceneRenderer.addComponent(r.quickstartManager),z.autoplay&&(r.quickStart=r.quickstartManager.startLanding()),r.sceneRenderer.once(ar.AfterRender,function(){})})),r.director.sLen=r.model.getSceneLength(),r.emit("initLoading"),r.emit("startLoading",r.model,!0,e,r.settings),o.when(T)}).then(function(){return function(t,e,i,n){return n.progressCallback=e,t.load(i).progress(function(t,e){var i,n;t.modelElementsToLoad=e[1],(n=t).totalElementsToLoad=n.modelElementsToLoad+n.panoElementsToLoad,(i=t).totalElementsLoaded++,i.totalPercentageLoaded=i.totalElementsLoaded/i.totalElementsToLoad,i.progressCallback&&i.progressCallback(100*i.totalPercentageLoaded)}.bind(this,n))}(r.model,r._emitLoadProgress,!e,r.progStruct)}).then(function(){var o=!1,a=!1;function s(){var s,l;o=!0,function(t,e,i,n){var o=i.qualityManager,r=i.panoRenderer,a=i.tileDownloader,s=i.modelManager,l=i.player,c=i.director,u=i.mattertagManager,h=i.displayController;e.scene.add(t),e.qualityManager=o,t.update();var d={camera:e.camera,director:c,modelManager:s,tileDownloader:a,panoRenderer:r,qualityManager:o,mattertagManager:u,container:n};l.init(d),l.setScene(e.scene),c.init(l,s),u.init(s,l,c),h.init(c,l,s,u,n),De.bindEvents(l),e.addComponent(u),e.addComponent(t),e.addComponent(l),e.addComponent(r),e.addComponent(G.R),l.mattertagManager.updateModel()}(r.model,r.sceneRenderer,n,r.playContainer),rr.init(r.director,r.player),r.sceneRenderer.started||Xa(r.sceneRenderer,r.playContainer,r.model),r.settings.jf&&r.settings.jf.dataset&&0<r.settings.jf.dataset.length&&r.settings.jf.enable&&(r.playType="Lecture"),e||(r.emit("endLoading",i.mode),r.emit("load_progress",100)),(s=r.player,r.model,l=i,$a.info("Starting player in "+l.mode),s.start(l)).done(function(){if(G.model.panosUV.find(function(t){return G.player.currentPano?G.player.currentPano.id==t.id:null})&&r.player.currentPano){var n=G.player.currentPano;r._emitPanoChange(n,0),r._emitModeChange(null,r.player.mode),r.player.updateWarpEnded()}e&&(r.quickstartManager.controls.locked=!1,!a&&r.player.control.copy(r.quickstartManager.controls),r.sceneRenderer.removeComponent(r.quickstartManager),r.quickstartManager.destroy()),r.model.supportsTiles||new nr(r.model,r.player).start(),r.registryEvent(r.model,r.play,r.director),r.panoramaSize.init(r.player.currentPano),r._initEvent(),e&&r.emit("endLoading",i.mode),G.startEntryPage=!0,r.model.steeringWheel.visible=!0,r.sceneRenderer.once(ar.AfterRender,function(){r.loadingState=!1,r.emit("afterRender"),r.player.mode===A.PANORAMA&&r.model.setEntranceState(!1),"guid"!==t||c||(qa.setStateDone(),qa.startVoiceLink(),r.emit("guidMode"),r.emit("connect_identity_update",qa.userInfo))})})}i=ir.getStartCameraOptions(r.model,r.model.panos,r.player.position),r.model.data.player_options.show3d?3===r.model.startup_type?i.quickstart=!0:i.quickstart=e:i.quickstart=!0;var l=null,c=null,u=!1;if(r.connectEvent(qa,{init:"connect_init_start",init_done:"connect_init_done",wait_connect:"connect_wait_connect",user_added:"connect_uesr_added",bussiness_busy:"connect_call_refuse",user_connected:"connect_user_addIn",close_connect:"connect_close",remote_busy:"connect_remote_operate_busy",callsuccess:"connect_call_success",calling:"connect_calling",connect_busyline:"connect_busyline"}),qa.on("init_done",function(t){G.startEntryPage||(bt.sendLog("wait start"),l=setTimeout(function(){e?r.quickStart.done(s):s(),bt.sendLog("started"),l=null},"4"===t?0:1e4))}),qa.on("operation",function(t){r.emit("connect_operation",t)}),qa.on("calling_left_time",function(t){r.emit("connect_calling_left_time",t)}),qa.on("close_connect",function(t){r.emit("connect_identity_update",t)}),qa.on("identity",function(t){r.emit("connect_identity_update",t)}),qa.on("changestate",function(t){if(l&&clearTimeout(l),!o){var n=function(t,e){for(var i=null,n=r.model.panos.list,o=0;o<n.length;o++)if(n[o].id===t){i=n[o];break}return i}(t.location);i.mode=t.mode,i.pano=n,"panorama"===t.mode?(i.position=t.position,i.quaternion=(new v.Quaternion).copy(t.rotation)):"dollhouse"===t.mode?(i.floorVisibility=t.floorVisibility,i.position=t.position,i.quaternion=(new v.Quaternion).copy(t.rotation)):"floorplan"===t.mode&&(i.floorVisibility=t.floorVisibility,i.position=t.position,i.quaternion=(new v.Quaternion).copy(t.rotation),i.zoom=t.zoom),a=!0,u?s():e?r.quickStart.done(s):s()}}),"guid"===t)try{bt.getUserInfo(function(t){bt.sendLog("get userInfo:"+JSON.stringify(t)),e&&r.quickStart.done(function(){u=!0}),qa.joinChannel(t,r.player.getCurrentState)})}catch(t){c=t,e?r.quickStart.done(s):s()}else e?r.quickStart.done(s):s()}).fail(function(t,e){$a.error(e)}.bind(this))},Qa.prototype.connectEvent=function(t,e){function i(t,e,i){t.on(e,function(){n.emit(i)})}var n=this;for(var o in e)i(t,o,e[o])},Qa.prototype.registryEvent=function(t,e,i){var n=this;this.model.on("floor.changed",this._emitFloorChange),this.model.on("waiting",this._emitSpinnerState),this.model.on("waiting-done",this._emitSpinnerState),this.director.on("tourStop",this._emitStopTour),this.director.on("update.controls",this._emitUpdateTour),this.player.on("PanoAnimation",this._emitPanoChange),this.player.on(Le.ModeChanged,this._emitModeChange),this.player.on(Le.WarpEnded,function(){var t=n.player.currentPano;n._emitPanoChange(t,0)}),this.player.on(Le.FlyingEnded,this._emitFlyingEnd),this.player.on(Le.Ready,function(){}),this.player.on(Le.PanoChosen,this._emitPanoChosen),this.player.on(Le.RulersMove,this._updatePanorameSize),this.player.on(it.RulersWalk,this._updatePanorameSize),this.player.on(Le.EditAddTagHighlight,this._EditAddTagHighligh),this.player.on(it.MoveHighlightsBar,this._emitHighlightsBarChange),this.player.on(it.ClickHighlightsBar,this._emitHighlightsBarChange),this.player.controls[A.PANORAMA].on("move",this._emitMoveState),this.player.controls[A.DOLLHOUSE].on("move",this._emitMoveState),this.player.controls[A.FLOORPLAN].on("move",this._emitMoveState),this.player.on("updateSize",function(){setTimeout(function(){o._emitFloorChange(o.model.currentFloor,o.player.mode)},90)});var o=this;this.mattertagManager.on("tagActiveEvent",function(t){o.emit(Ha.tag.ACTIVE,t)}),this.mattertagManager.on(Fi.TagDismissed,function(t){o.emit(Ha.tag.DISMISS,t.tagid)}),this.mattertagManager.on(Fi.TagNavigation,function(t){}),this.sceneRenderer.on("compass",this._emitAngle),this.record.on("recording",function(){}),this.record.on("readyToRecord",function(){}),this.record.on("startRecord",function(){}),this.record.on("stopRecord",function(){}),this.record.on("countdown",function(t){}),this.record.on("stopRecordCountDown",function(t){}),this.record.on("emity",function(){o._emitLectureError("emity")}),this.record.on("loadAudio",function(){o._emitLectureLoadAudio("load")}),this.record.on("loadAudioDone",function(){o._emitLectureLoadAudio("done")}),this.record.on("updateView",function(t,e){o._emitLectureUpdate(t,e)}),this.record.on("housedetail",function(t){o._emitLectureUI("housedetail",t)}),this.record.on("stop",function(){o.emit("lecture","stop")}),this.on("afterRender",this._emitFirstRender)},Qa.prototype._emitFirstRender=function(){var t=this.player.mode,e=this.player.currentPano;this._emitModeChange(null,t),this._emitFlyingEnd(null,null,e,null)},Qa.prototype._emitLectureError=function(t){this.emit("lectureError",t)},Qa.prototype._emitLectureLoadAudio=function(t){this.emit("lectureLoadaudio",t)},Qa.prototype._emitLectureUpdate=function(t,e){this.emit("lectureUpdate",t,e)},Qa.prototype._emitLectureUI=function(t,e){this.emit("lecutreUI",t,e)},Qa.prototype._updatePanorameSize=function(){this.panoramaSize.enable&&this.panoramaSize.update(this.player)},Qa.prototype._emitAngle=function(t){var e={angle:t,director:t};this.model.data.orientation_correct&&(e.angle+=this.model.data.orientation_correct),this.angle=e.director,this.emit("compass",e)},Qa.prototype._emitHighlightsBarChange=function(t){this.emit("highLightsBarChange",t,this.settings)},Qa.prototype._EditAddTagHighligh=function(t){this.emit("addTagData",t),G.conf.isNewEditVersion&&G.sendTag(t)};var Za=0;Qa.prototype._emitPanoChosen=function(t,e){var i=this.player.mode;this.emit("panoChosen",this.player),"editor"===this.showMode&&(i===A.DOLLHOUSE?t.alignmentType===e.alignmentType&&2===t.alignmentType?(this.emit("intoTypedPano",2),1===Za&&G.hideFakeTag("-1")):t.alignmentType===e.alignmentType&&1===t.alignmentType&&(this.emit("intoTypedPano",1),2===Za&&G.hideFakeTag("-2")):t.alignmentType!==e.alignmentType&&(e.isAligned()?this.emit("intoTypedPano",1):this.emit("intoTypedPano",2),G.hideFakeTag("-1")),Za=e.alignmentType,e&&this.emit("updateAngleValue",{id:e.id,adjustAngleX:e.adjustAngleX,adjustAngleY:e.adjustAngleY,adjustAngleZ:e.adjustAngleZ}))},Qa.prototype._emitFlyingEnd=function(t,e,i,n){var o={};z.delBK&&(this.model.currentFloor.floorIndex,o.floorUrl=this.model.house_type_url),o.showArea=this.model.floorplan_enable,z.delBK&&i&&i.areaName&&i.areaSize&&(o.areaName=i.areaName,o.areaSize=i.areaSize),this.needsUpdateRadar&&(this.needsUpdateRadar=!1,o.showRadar=!0,o.pano=i),this.player.mattertagManager.ttflying=!1,this.player.mattertagManager.updatetitletags(),this.emit("flyingEnd",o)},Qa.prototype._emitModeChange=function(t,e){this._updatePanorameSize(),"panorama"===e&&(this.needsUpdateRadar=!0),e===A.DOLLHOUSE?this.model.setCompassVisible(!0):this.model.setCompassVisible(!1),this.emit("modeChange",t,e)},Qa.prototype._emitPanoChange=function(t,e){var i=this.model.floorplan_enable;this.emit("panoChange",{pano:t,time:e,showArea:i})},Qa.prototype._emitStopTour=function(){this.emit("stopTour")},Qa.prototype._emitUpdateTour=function(){this.emit("updateTour",this.director.describe())},Qa.prototype._emitSpinnerState=function(){var t="stopSpinner";this.model.waitQueue.length<0?t="stopSpinner":this.loadingState||(t="delayStopSpinner"),this.emit("spinner",t)},Qa.prototype._emitFloorChange=function(t,e){var i=this.getModelScreenSize(),n={mode:e,model:this.model,project:i,floorIndex:t.floorIndex,imageUrl:this.model.getCurrentHouseTypeImage()};this.model.allFloorsVisible&&(n.floorIndex="all"),this.emit("floorChange",n)},Qa.prototype._emitMoveState=function(){this.emit("move",this.player),this._updatePanorameSize()},Qa.prototype._initEvent=function(){this.emit("load_progress",100),this.emit("init_UI",this.model)},Qa.prototype._emitLoadProgress=function(t){this.emit("load_progress",t)},Qa.prototype._registryKeyEvent=function(){var t=this;g.isMobile()||(this.playContainer.addEventListener("keydown",function(e){switch(e.which){case Keys.ZERO:z.debug&&t.model.toggleAlpha();break;case Keys.ONE:t.player.model.has360Views&&!t.player.isInMode(A.TRANSITIONING)?t.player.isInMode(A.PANORAMA)&&t.player.currentPano.isAligned()||(t.player.controls[A.PANORAMA].emit(it.InteractionKey),t.director.tourIsPlaying?t.director.stopTour():t.player.goToLastView(!0)):t.player.isInMode(A.PANORAMA,A.TRANSITIONING)||t.director.changeMode(A.PANORAMA,"key");break;case Keys.TWO:t.model.outsideAllowed()&&!t.player.isInMode(A.DOLLHOUSE,A.TRANSITIONING)&&t.director.changeMode(A.DOLLHOUSE,"key");break;case Keys.THREE:t.model.outsideAllowed()&&!t.player.isInMode(A.FLOORPLAN,A.TRANSITIONING)&&t.director.changeMode(A.FLOORPLAN,"key");break;case Keys.FOUR:t.player.model.has360Views&&!t.player.isInMode(A.TRANSITIONING)&&(t.player.isInMode(A.PANORAMA)&&!t.player.currentPano.isAligned()||(t.player.controls[A.PANORAMA].emit(it.InteractionKey),t.director.tourIsPlaying?t.director.stopTour():t.player.goToLastView(!1)));break;case Keys.SPACE:z.debug&&t.model.toggleExplode();break;case Keys.RETURN:z.debug&&t.model.toggleExplodeUp();break;case Keys.PLUSEQUALS:t.director.player.activatePersistentZooming(!0);break;case Keys.DASHUNDERSCORE:t.director.player.activatePersistentZooming(!1);break;case Keys.EIGHT:t.director.player.decreaseZoomSpeed();break;case Keys.NINE:t.director.player.increaseZoomSpeed()}return t.player&&t.player.reticule.hide(),!0}),this.playContainer.addEventListener("keyup",function(e){switch(e.which){case Keys.PLUSEQUALS:t.director.player.deactivatePersistentZooming();break;case Keys.DASHUNDERSCORE:t.director.player.deactivatePersistentZooming()}}))},Qa.prototype.registryOri=function(){G.ori={},g.isMobile()?G.ori.flag=!0:G.ori.flag=!1,G.ori.isHuawei5X=g.detectHUAWEI5X(),G.ori.gamma=-1e3,G.ori.beta=-1e3,G.ori.alpha=-1e3,G.ori.enable=!0,G.orientationHandler=function(t){t.gamma||t.beta||(t.gamma=t.x*(180/Math.PI),t.beta=t.y*(180/Math.PI),t.alpha=t.z*(180/Math.PI));var e=t.gamma,i=t.beta,n=t.alpha;t.accelerationIncludingGravity&&(e=10*event.accelerationIncludingGravity.x,i=10*-event.accelerationIncludingGravity.y,n=10*event.accelerationIncludingGravity.z),G.ori.gamma=e,G.ori.beta=i,G.ori.alpha=n},G.HorientationChange=function(){G.ori.orient=v.Math.degToRad(window.orientation||0)},G.HdeviceOrientation=function(t){var e=v.Math.degToRad(t.alpha),i=v.Math.degToRad(t.beta),n=v.Math.degToRad(t.gamma);G.ori.isHuawei5X?(-1e3==G.ori.alpha&&(G.ori.alpha=e),-1e3==G.ori.beta&&(G.ori.beta=i),-1e3==G.ori.gamma&&(G.ori.gamma=n),.06<Math.abs(e-G.ori.alpha)&&(G.ori.alpha=e),.006<Math.abs(i-G.ori.beta)&&(G.ori.beta=i),.006<Math.abs(n-G.ori.gamma)&&(G.ori.gamma=n)):(G.ori.alpha=e,G.ori.beta=i,G.ori.gamma=n)},window.addEventListener("orientationchange",G.HorientationChange),window.addEventListener("deviceorientation",G.HdeviceOrientation)},Qa.prototype.getModelScreenSize=function(){function t(t,e){var i=window.innerWidth/2,n=window.innerHeight/2,o=t.project(e),r=Math.round(o.x*i+i),a=Math.round(-o.y*n+n);return new v.Vector2(r,a)}var e=this.model.boundingBox,i=this.player.camera,n=new v.Vector3(e.max.x,0,e.max.z),o=new v.Vector3(e.min.x,0,e.min.z),r=new v.Vector3(e.max.x,0,e.min.z),a=new v.Vector3(e.min.x,0,e.max.z),s=t(n,i),l=t(o,i),c=t(r,i),u=t(a,i),h=Math.max(s.x,l.x,c.x,u.x),d=Math.min(s.x,l.x,c.x,u.x),p=Math.max(s.y,l.y,c.y,u.y),f=Math.min(s.y,l.y,c.y,u.y);return{width:h-d,height:p-f,top:f,left:d}},Qa.prototype.getFloorPlanParam=function(){var t=this.getModelScreenSize(),e={model:this.model,project:t,floorIndex:this.model.currentFloor.floorIndex};return this.player.currentPano&&this.player.currentPano.u&&(e.radar={uv:{u:this.player.currentPano.u,v:this.player.currentPano.v},angle:this.lastCompassAngle}),e},Qa.prototype.changeMode=function(t){if(!1===this.model.data.player_options.show3d)return!1;"floorplan"===t&&(this.lastCompassAngle=this.angle),this.director.changeMode(t)},Qa.prototype.play=function(t){if(this.disablePanramaSize(),"Lecture"===this.playType)this.record.pplay(t);else if(this.settings.nestscenes&&this.settings.nestscenes.scenes&&0<this.settings.nestscenes.scenes.length){var e=0;this.model.enableTagMovie&&(e=1),G.playing=!0,this.director.currentScript=e,this.director.playTour()}},Qa.prototype.startTakeLook=function(){var t=this;bt.getUserInfo(function(e){qa.joinChannel(e,t.player.getCurrentState),qa.setStateDone(),qa.startVoiceLink()})},Qa.prototype.takeLookCall=function(){qa.initState&&(qa.callAgain(),this.emit("connect_call_again"))},Qa.prototype.hangupTakeLook=function(){qa.hangUp()},Qa.prototype.sendUIOperation=function(){},Qa.prototype.pause=function(){"Lecture"===this.playType?this.record.ppause():this.settings.nestscenes&&this.settings.nestscenes.scenes&&0<this.settings.nestscenes.scenes.length&&(this.director.stopTour(),G.playing=!1)},Qa.prototype.enterVR=function(){return"panorama"===this.player.mode&&!!g.isMobile()&&(this.sceneRenderer.vrEnabled=!0,G.ori.flag=!0,"function"==typeof DeviceMotionEvent.requestPermission&&DeviceMotionEvent.requestPermission().then(function(t){"granted"===t&&window.addEventListener("devicemotion",function(){})}).catch(console.error),"function"==typeof DeviceOrientationEvent.requestPermission&&DeviceOrientationEvent.requestPermission().then(function(t){"granted"===t&&window.addEventListener("deviceorientation",function(){})}).catch(console.error),!0)},Qa.prototype.exitVR=function(){this.sceneRenderer.vrEnabled=!1,G.ori.flag=!1},Qa.prototype.gotoFloor=function(t){"all"===t?this.director.allFloors():this.director.gotoFloor(t)},Qa.prototype.mute=function(){qa.setMute(!0)},Qa.prototype.unmute=function(){qa.setMute(!1)},Qa.prototype.disableTag=function(){this.player.mattertagManager.showtitletags=!1,this.player.mattertagManager.updatetitletags(),this.player.mattertagManager.hideAllMattertags(10,10)},Qa.prototype.enableTag=function(){this.player.mattertagManager.showtitletags=!0,this.player.mattertagManager.updatetitletags(),this.player.mattertagManager.showAllMattertags(10,10)},Qa.prototype.disablePanramaSize=function(){this.panoramaSize.setEnable(!1)},Qa.prototype.enablePanramaSize=function(){this.panoramaSize.setEnable(!0),this.panoramaSize.update(this.player)},Qa.prototype.gotoScenebyId=function(t){this.director.goToHighlight(t)},Qa.prototype.getCurrentState=function(){return{panoSize:this.panoramaSize.enable}},Qa.prototype.showPanoEnableTag=function(){this.model.showPanoEnableTag(),this.player.mattertagManager.updateModel(),this.player.mattertagManager.updatetitletags()},Qa.prototype.hidePanoEnableTag=function(){this.model.hidePanoEnableTag(),this.player.mattertagManager.updateModel(),this.player.mattertagManager.updatetitletags()},Qa.prototype.setPanoramaEnable=function(t,e){var i,n=null;i=e?(n=this.editorIcons.enableIcon,this.editorIcons.enableTagIcon):(n=this.editorIcons.disableIcon,this.editorIcons.disableTagIcon);var o=this.model.getTagByTagid("pano_"+t);this.model.panos.index[o.locationId].marker.material.map=texture.loadurl(n),o.materials.free.map=texture.loadurl(i),o.materials.hover.map=texture.loadurl(i),o.disc.material.map=texture.loadurl(i),this.model.panos.index[o.locationId].enable=e},Qa.prototype.getCurrentView=function(){var t={};if("panorama"===this.player.mode&&null!=this.player.currentPano&&null!=this.player.currentPano.id&&this.player.currentPano.enable)return t.location_id=this.player.currentPano.id,t.rotation={x:this.player.camera.quaternion.z,y:this.player.camera.quaternion.w,z:this.player.camera.quaternion.x,w:this.player.camera.quaternion.y},t},Qa.prototype.getScreenShot=function(t,e,i,n){var o=this.director.player.reticule;o.hidden=!0,o.material.uniforms.opacity.value=0,this.model.panos.list.forEach(function(t){t.marker&&(t.marker.material.opacity=0)}),this.model.steeringWheel.visible=!1;var r=this;setTimeout(function(){var o,a=r.playContainer.querySelector("canvas"),s=null;t&&e&&i&&n?((s=document.createElement("canvas")).width=i,s.height=n,s.getContext("2d").drawImage(a,t,e,i,n,0,0,i,n)):s=a,o=s.toDataURL("image/png"),r.emit(Ha.core.SCREENSHOT,o),G.model.panos.list.forEach(function(t){t.marker&&(t.marker.material.opacity=1)}),r.model.steeringWheel.visible=!0},1e3)},Qa.prototype.showFakeTag=function(t,e,i,n){if("panorama"===this.player.mode&&null!=this.player.currentPano&&null!=this.player.currentPano.id){null!=this.player.reticule&&(this.player.reticule.editHidden=!0,this.player.reticule.hide());var o=this.model.mattertags,r=null;if(0===n&&o)for(var a in o)if("-1"===o[a].tagid){r=o[a];break}var s={actiontype:1,base:{x:0,y:0,z:0},details:{description:"",subtype:0,tagpictype:1,tagpicurl:i,templatetype:1,time:"",title:""},enable:!0,locationid:"location_01",normal:{x:0,y:0,z:0},stem:{direction:{x:0,y:0,z:0},enabled:!0}};G.typeT=t,0===n?(s.tagid="-1",this.model.newBuildTagsForAddTag(s)):1===n?r&&r.updateTagMaterial(i):2===n&&(s.tagid="-2",s.rt360=!0,this.model.newBuildTagsForAddTag(s))}},Qa.prototype.hideFakeTag=function(t){null!=this.player.reticule&&(this.player.reticule.editHidden=!1,this.player.reticule.show());var e=this.model.mattertags,i=null;for(var n in e)if(e[n]&&e[n].tagid&&e[n].tagid==t){i=e[n];break}null!=i&&(i.floor.remove(i.obj3d),delete e[n])},Qa.prototype.removeScene=function(t){this.model.removeScene(t)},Qa.prototype.gotoRoam=function(t){this.director.goToHighlightByLocation(t)},Qa.prototype.adjustAngle=function(t,e){this.player.currentPano.updateAngle(t,e)},Qa.prototype.compassAdjust=function(t,e){0===e?this.director.compassReset(0):this.director.compassAdd(t)},Qa.prototype.compassAdjustSetVisible=function(t){G.settings.basic.menu.compass_enable=t},Qa.prototype.setPlaySpeed=function(t){var e="";switch(t){case 1:e="0.3x";break;case 2:e="0.5x";break;case 3:e="1.0x";break;case 4:e="1.5x";break;case 5:e="2.0x";break;default:e="1.0x"}this.player.setSpeedMultiplier(e)},Qa.prototype.destroy=function(){this.panoRenderer.destory(),rr.destory(),this.tileDownloader.stop(),this.tileDownloader.destory(),texture.clearTexture(),this.model.destory(),this.playContainer.innerHTML="",this.sceneRenderer.destory(),this.player.removeEvents(),window.removeEventListener("orientationchange",G.HorientationChange),window.removeEventListener("deviceorientation",G.HdeviceOrientation)};var Ka=Qa,Ja=g,ts=z,es=S,is=Ha,ns={HousePlay:Ka,Browser:Ja,Config:ts,Logger:es,EVENT:is};e.default=ns,e.HousePlay=Ka,e.Browser=Ja,e.Config=ts,e.Logger=es,e.EVENT=is,Object.defineProperty(e,"__esModule",{value:!0})})(e)}).call(e,o("DuR2"),o("awxD"),o("awxD"),o("awxD"),o("W2nU"))},"HMN+":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"vr-tip-component",data:function(){return{}},created:function(){},mounted:function(){},methods:{closeVrTip:function(){this.$store.dispatch("changeVrTipStatus",!1),this.$store.dispatch("changeVrStatus",!1),this.statistic_utils.trackEvent(80)},enterVr:function(){this.$store.dispatch("changeVrTipStatus",!1),this.$store.dispatch("changeVrStatus",!0),this.statistic_utils.trackEvent(32)}}}},HPFS:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=d(i("Xxa5")),r=d(i("exGp")),a=d(i("bOdI")),s=d(i("//Fk")),l=d(i("3pLw")),c=d(i("mtWM")),u=d(i("G97a")),h=d(i("R+JH"));function d(t){return t&&t.__esModule?t:{default:t}}function p(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}var f=i("xiRS"),m=i("ynQN").getStyle();window.initializeGoogleMap=function(){},e.default={name:"Index",data:function(){return{modelInfo:{modelId:"",companyId:"",currentVisitStyle:"",versionpre:"",modelpre:"",infopre:"",setpre:""},housePlayParams:{},showHousePlay:!1,modelSettings:null,loadingFade:"fade"}},components:{HousePlayComponent:function(){return{component:s.default.resolve().then(function(){return p(i("0B5h"))})}},PcRightComponent:function(){return{component:s.default.resolve().then(function(){return p(i("vLgS"))})}},PcPanoramaBtn:function(){return{component:s.default.resolve().then(function(){return p(i("pGBC"))})}},PcBottomPanel:function(){return{component:s.default.resolve().then(function(){return p(i("VgN/"))})}},PcTitleComponent:function(){return{component:s.default.resolve().then(function(){return p(i("1mZ1"))})}},PcHouseComponentContainer:function(){return{component:s.default.resolve().then(function(){return p(i("HdZj"))})}},PcDisclaimerBtnComponent:function(){return{component:s.default.resolve().then(function(){return p(i("Voun"))})}},PcDisclaimerContentComponent:function(){return{component:s.default.resolve().then(function(){return p(i("72YK"))})}},PcImgSwiper:function(){return{component:s.default.resolve().then(function(){return p(i("GDEm"))})}},PcBigBaiduMap:function(){return{component:s.default.resolve().then(function(){return p(i("rM3Y"))})}},PcBigGoogleMap:function(){return{component:s.default.resolve().then(function(){return p(i("m4ZJ"))})}},PcCompanyLogo:function(){return{component:s.default.resolve().then(function(){return p(i("1O0X"))})}},PcFloorPlan:function(){return{component:s.default.resolve().then(function(){return p(i("2OPp"))})}},PcMiniFloorPlan:function(){return{component:s.default.resolve().then(function(){return p(i("hah5"))})}},PcFloorBar:function(){return{component:s.default.resolve().then(function(){return p(i("QhOe"))})}},PcLoadingComponent:function(){return{component:s.default.resolve().then(function(){return p(i("SqvG"))})}},PcHelpTip:function(){return{component:s.default.resolve().then(function(){return p(i("ZOAN"))})}},PcScenePanel:function(){return{component:s.default.resolve().then(function(){return p(i("4iO0"))})}},PcLectureRoom:function(){return{component:s.default.resolve().then(function(){return p(i("H5gG"))})}},PcAllTagContainer:function(){return{component:s.default.resolve().then(function(){return p(i("g5jC"))})}},PcPanoSize:function(){return{component:s.default.resolve().then(function(){return p(i("AxMW"))})}},MobileHouseComponentContainer:function(){return{component:s.default.resolve().then(function(){return p(i("CFZ+"))})}},MobileTopComponent:function(){return{component:s.default.resolve().then(function(){return p(i("uiEf"))})}},MobileBigBaiduMap:function(){return{component:s.default.resolve().then(function(){return p(i("f3sb"))})}},MobileBigGoogleMap:function(){return{component:s.default.resolve().then(function(){return p(i("PqPp"))})}},MobileImgSwiper:function(){return{component:s.default.resolve().then(function(){return p(i("Fjm0"))})}},MobileCompanyLogo:function(){return{component:s.default.resolve().then(function(){return p(i("gDxV"))})}},MobileDisclaimerBtnComponent:function(){return{component:s.default.resolve().then(function(){return p(i("soKl"))})}},MobileDisclaimerContentComponent:function(){return{component:s.default.resolve().then(function(){return p(i("pE7W"))})}},MobileVrTip:function(){return{component:s.default.resolve().then(function(){return p(i("foYj"))})}},MobileHelpTip:function(){return{component:s.default.resolve().then(function(){return p(i("AS8M"))})}},MobileBottomComponent:function(){return{component:s.default.resolve().then(function(){return p(i("PCnJ"))})}},MobilePanoramaBtn:function(){return{component:s.default.resolve().then(function(){return p(i("KcU2"))})}},MobileModeBtn:function(){return{component:s.default.resolve().then(function(){return p(i("rjt4"))})}},MobileLoadingComponent:function(){return{component:s.default.resolve().then(function(){return p(i("JnZp"))})}},MobileFloorPlan:function(){return{component:s.default.resolve().then(function(){return p(i("Yp0v"))})}},MobileMiniFloorPlan:function(){return{component:s.default.resolve().then(function(){return p(i("Hzon"))})}},MobileFloorBar:function(){return{component:s.default.resolve().then(function(){return p(i("Wb9y"))})}},MobileMiddlemanTranspond:function(){return{component:s.default.resolve().then(function(){return p(i("IRJk"))})}},MobileCopySuccess:function(){return{component:s.default.resolve().then(function(){return p(i("wz6s"))})}},MobileScenePanel:function(){return{component:s.default.resolve().then(function(){return p(i("0axG"))})}},MobileLectureRoom:function(){return{component:s.default.resolve().then(function(){return p(i("wARy"))})}},MobileMiniMiddleman:function(){return{component:s.default.resolve().then(function(){return p(i("Uk6O"))})}},MobileAllTagContainer:function(){return{component:s.default.resolve().then(function(){return p(i("pTo5"))})}},MobilePanoSize:function(){return{component:s.default.resolve().then(function(){return p(i("ate9"))})}},MobileTakeLookPanel:function(){return{component:s.default.resolve().then(function(){return p(i("OJnf"))})}},MobileTakeLookTip:function(){return{component:s.default.resolve().then(function(){return p(i("a1tv"))})}},MobileRewardPanel:function(){return{component:s.default.resolve().then(function(){return p(i("glKE"))})}},MobileLandscapeTopComponent:function(){return{component:s.default.resolve().then(function(){return p(i("F7mN"))})}},MobileLandscapeHouseComponentContainer:function(){return{component:s.default.resolve().then(function(){return p(i("YwPD"))})}},MobileLandscapeBigBaiduMap:function(){return{component:s.default.resolve().then(function(){return p(i("d3JF"))})}},MobileLandscapeBigGoogleMap:function(){return{component:s.default.resolve().then(function(){return p(i("Kil6"))})}},MobileLandscapeImgSwiper:function(){return{component:s.default.resolve().then(function(){return p(i("ftK2"))})}},MobileLandscapeCompanyLogo:function(){return{component:s.default.resolve().then(function(){return p(i("BMMx"))})}},MobileLandscapeDisclaimerBtnComponent:function(){return{component:s.default.resolve().then(function(){return p(i("m/RU"))})}},MobileLandscapeDisclaimerContentComponent:function(){return{component:s.default.resolve().then(function(){return p(i("8Awl"))})}},MobileLandscapeVrTip:function(){return{component:s.default.resolve().then(function(){return p(i("zdtW"))})}},MobileLandscapeHelpTip:function(){return{component:s.default.resolve().then(function(){return p(i("D2Pc"))})}},MobileLandscapeBottomContainer:function(){return{component:s.default.resolve().then(function(){return p(i("/R/P"))})}},MobileLandscapePanoramaBtn:function(){return{component:s.default.resolve().then(function(){return p(i("vjUk"))})}},MobileLandscapeModeBtn:function(){return{component:s.default.resolve().then(function(){return p(i("VYXT"))})}},MobileLandscapeLoadingComponent:function(){return{component:s.default.resolve().then(function(){return p(i("Fm9k"))})}},MobileLandscapeFloorPlan:function(){return{component:s.default.resolve().then(function(){return p(i("r/pd"))})}},MobileLandscapeMiniFloorPlan:function(){return{component:s.default.resolve().then(function(){return p(i("NjpR"))})}},MobileLandscapeFloorBar:function(){return{component:s.default.resolve().then(function(){return p(i("TJI3"))})}},telDialog:function(){return{component:s.default.resolve().then(function(){return p(i("Gtpr"))})}},telTip:function(){return{component:s.default.resolve().then(function(){return p(i("P+uj"))})}},mobileSlideVerify:function(){return{component:s.default.resolve().then(function(){return p(i("R9i9"))})}},"google-map-sdk":{render:function(t){var e=this;return t("script",{attrs:{type:"text/javascript",src:this.src},on:{load:function(){e.$emit("load-js-finish")}}})},props:{src:{type:String,required:!0}}}},watch:{isEnterPage:function(t,e){!0===t&&(new u.default).getHouseInfo(this.modelSettings,this.generateHouseInfo)}},computed:(n={houseInfoData:function(){return this.$store.state.houseInfo},houseInfoIsShow:function(){return this.$store.state.houseInfoIsShow},titleIsShow:function(){return this.$store.state.titleIsShow},houseInfoImgSwiperIsShow:function(){return this.$store.state.showHouseInfoImgSwiper},disclaimerContentIsShow:function(){return this.$store.state.disclaimerContentIsShow},bigMapIsShow:function(){return this.$store.state.bigMapIsShow},currentClient:function(){return this.$store.state.currentClient},companyLogoUrl:function(){return this.$store.state.companyLogoUrl},measureIsActive:function(){return this.$store.state.measureIsActive},tagIsActive:function(){return this.$store.state.tagIsActive},vrTipIsShow:function(){return this.$store.state.vrTipIsShow},helpTipIsShow:function(){return this.$store.state.helpTipIsShow},currentMode:function(){return this.$store.state.currentMode},isEnterPage:function(){return this.$store.state.isEnterPage},floorPlanImageIsShow:function(){return this.$store.state.floorPlanImageIsShow},isMultiLayer:function(){return this.$store.state.isMultiLayer}},(0,a.default)(n,"floorPlanImageIsShow",function(){return this.$store.state.floorPlanImageIsShow}),(0,a.default)(n,"isLandscape",function(){return this.$store.state.isLandscape}),(0,a.default)(n,"middlemanTranspondIsShow",function(){return this.$store.state.middlemanTranspondIsShow}),(0,a.default)(n,"copyStatus",function(){return this.$store.state.copyStatus}),(0,a.default)(n,"sceneIsActive",function(){return this.$store.state.sceneIsActive}),(0,a.default)(n,"lectureIsActive",function(){return this.$store.state.lectureIsActive}),(0,a.default)(n,"sceneList",function(){return this.$store.state.sceneList}),(0,a.default)(n,"lectureList",function(){return this.$store.state.lectureList}),(0,a.default)(n,"currentTagData",function(){return this.$store.state.currentTagData}),(0,a.default)(n,"telDialogIsShow",function(){return this.$store.state.telDialogIsShow}),(0,a.default)(n,"telTipIsShow",function(){return this.$store.state.telTipIsShow}),(0,a.default)(n,"vrIsActive",function(){return this.$store.state.vrIsActive}),(0,a.default)(n,"slideVerifyIsShow",function(){return this.$store.state.slideVerifyIsShow}),(0,a.default)(n,"takeLookIsPlaying",function(){return this.$store.state.takeLookIsPlaying}),(0,a.default)(n,"takeLookTipIsShow",function(){return this.$store.state.takeLookTipIsShow}),(0,a.default)(n,"SpeakHouseState",function(){return this.$store.state.SpeakHouseState}),(0,a.default)(n,"MiddleManState",function(){return this.$store.state.MiddleManState}),(0,a.default)(n,"ShareFullState",function(){return this.$store.state.ShareFullState}),(0,a.default)(n,"FullScreenState",function(){return this.$store.state.FullScreenState}),(0,a.default)(n,"MultipleMeasureState",function(){return this.$store.state.MultipleMeasureState}),(0,a.default)(n,"MultipleTagState",function(){return this.$store.state.MultipleTagState}),(0,a.default)(n,"MultipleHelpState",function(){return this.$store.state.MultipleHelpState}),(0,a.default)(n,"MultipleVrState",function(){return this.$store.state.MultipleVrState}),(0,a.default)(n,"pcBottomShow",function(){return!!(this.MultipleMeasureState||this.MultipleTagState||this.MultipleHelpState||this.MiddleManState||this.ShareFullState||this.FullScreenState)}),n),created:function(){this.refreshIsLandscape();var t=this,e=void 0;window.addEventListener("onorientationchange"in window?"orientationchange":"resize",function(){clearTimeout(e),e=setTimeout(t.refreshIsLandscape,300)}),this.init()},methods:{refreshIsLandscape:function(){var t=this.CommonUtil.isMobile()?"mobile":"pc";if(this.$store.dispatch("changeCurrentClient",t),"mobile"===t){var e=!1;180==window.orientation||0==window.orientation?e=!1:90!=window.orientation&&-90!=window.orientation||(e=!0),document.documentElement.clientWidth>document.documentElement.clientHeight&&(e=!0),this.$store.dispatch("judgeIsLandscape",e)}},init:function(){var t=this;this.modelInfo.modelId="0dfa839a_2rCb_b6f9",this.getVisitStyle(),this.generateModelInfoUrl(this.modelInfo.currentVisitStyle);var e=Date.now(),i=this.modelInfo.versionpre+"version.txt?f="+e,n=void 0,o=void 0,r=this;(0,c.default)(i).then(function(e){n=e.data;var i=r.getSettingUrl(r.modelInfo.setpre,r.modelInfo.currentVisitStyle,n.version,n.setting);(0,c.default)(i).then(function(e){o=e.data;var i={type:r.modelInfo.currentVisitStyle,versionpre:r.modelInfo.versionpre,modelpre:r.modelInfo.modelpre,infopre:r.modelInfo.infopre,setpre:r.modelInfo.setpre};if(r.initLoadingSettings(o),r.initMiddleManState(o),r.initShareFullState(o),r.initFullScreenState(o),r.initSpeakHouseState(o),r.initMultipleMeasureState(o),r.initMultipleTagState(o),r.initMultipleHelpState(o),r.initMultipleVrState(o),r.modelInfo.companyId=parseInt(r.CommonUtil.getQueryString("g")||r.CommonUtil.getQueryString("gid")||1),o.basic&&o.basic.user&&o.basic.user.group&&(r.modelInfo.companyId=parseInt(o.basic.user.group)),t.$store.dispatch("initCompanyId",r.modelInfo.companyId),1!==r.modelInfo.companyId){var a=r.getCompanyUrl(r.modelInfo.companyId,i);(0,c.default)(a).then(function(t){var e=t.data,i=void 0,n=void 0;o.panorama_settings=e.panorama_settings,e&&e.basic&&e.basic.model&&e.basic.model.enter_type&&e.basic.model.enter_type,e&&e.basic&&e.basic.model&&e.basic.model.disclaimer&&e.basic.model.disclaimer.content?r.$store.dispatch("initDisclaimerContent",e.basic.model.disclaimer.content):o.basic.model&&o.basic.model.disclaimer&&o.basic.model.disclaimer.content&&r.$store.dispatch("initDisclaimerContent",e.basic.model.disclaimer.content),e&&e.basic&&e.basic.model&&e.basic.model.logo&&(i=e.basic.model.logo)&&r.$store.dispatch("changeCompanyLogoUrl",i),49===r.modelInfo.companyId?(n="https://template2.3dnest.cn/common/img/lizihang_logo.png",r.$store.dispatch("changeCompanyLoadingUrl",n)):e&&e.basic&&e.basic.model&&e.basic.model.loadingicon&&(n=e.basic.model.loadingicon)&&r.$store.dispatch("changeCompanyLoadingUrl",n),r.$store.dispatch("changeCompanySettingsIsLoaded",!0)})}else{var s=void 0,l=void 0;o.basic.model&&o.basic.model.disclaimer&&o.basic.model.disclaimer.content&&r.$store.dispatch("initDisclaimerContent",o.basic.model.disclaimer.content),o.basic&&o.basic.model&&o.basic.model.logo&&(s=o.basic.model.logo)&&r.$store.dispatch("changeCompanyLogoUrl",s),o.basic&&o.basic.model&&o.basic.model.loadingicon&&(l=o.basic.model.loadingicon)&&r.$store.dispatch("changeCompanyLoadingUrl",l),r.$store.dispatch("changeCompanySettingsIsLoaded",!0)}var u=void 0;"zh"===r.$i18n.locale?u=3:"en"===r.$i18n.locale?u=1:"ja"===r.$i18n.locale&&(u=2);var h={modelId:r.modelInfo.modelId,settings:o,version:n,siteConf:{type:r.modelInfo.currentVisitStyle,versionpre:r.modelInfo.versionpre,modelpre:r.modelInfo.modelpre,infopre:r.modelInfo.infopre,setpre:r.modelInfo.setpre},enterType:o.basic.model.enter_type||2,languageObj:{lang:u,currentLanguage:r.$i18n.messages[r.$i18n.locale]}};o.basic&&o.basic.menu&&3===o.basic.menu.startup_type?r.loadingFade="fade":r.loadingFade="fastfade",o.languageObj={lang:u,currentLanguage:r.$i18n.messages[r.$i18n.locale]},r.modelSettings=o,t.housePlayParams=h,t.showHousePlay=!0,t.statistic_utils.setCustomVar(r.modelInfo.modelId,r.modelInfo.companyId),t.statistic_utils.updatePageDuration(r.modelInfo.modelId,r.modelInfo.companyId);setInterval(function(){r.statistic_utils.updatePageDuration(r.modelInfo.modelId,r.modelInfo.companyId)},5e3);t.statistic_utils.trackEvent(9)}).catch(function(t){})}).catch(function(t){}).then(function(t){})},getversion:function(){var t=(0,r.default)(o.default.mark(function t(){var e;return o.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.default.get({url:versionUrl});case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getSettingUrl:function(t,e,i,n){var o="";switch(e){case"display":o=n?t+i+"/settings.txt?s="+n:t+i+"/settings.txt";break;case"sms":case"local":case"demo":o=t+"settings.txt";break;case"gjf":o=n?t+i+"/settings.txt?s="+n:t+i+"/settings.txt"}return o},getVisitStyle:function(){switch(this.CommonUtil.getQueryString("visitstyle")){case"1":this.modelInfo.currentVisitStyle="display";break;case"2":this.modelInfo.currentVisitStyle="sms";break;case"3":this.modelInfo.currentVisitStyle="demo";break;case"4":this.modelInfo.currentVisitStyle="local";break;case"5":this.modelInfo.currentVisitStyle="gjf";break;default:this.modelInfo.currentVisitStyle=this.getVisitStyleFromUrl()}return this.modelInfo.currentVisitStyle},getVisitStyleFromUrl:function(){return "display"},generateModelInfoUrl:function(t){switch(t){case"display":this.modelInfo.versionpre=this.urlBase.CDN+"/"+this.modelInfo.modelId+"/",this.modelInfo.modelpre=this.urlBase.CDN+"/"+this.modelInfo.modelId+"/",this.modelInfo.infopre=this.urlBase.ICDN+"/"+this.modelInfo.modelId+"/",this.modelInfo.setpre=this.urlBase.ICDN+"/"+this.modelInfo.modelId+"/";break;case"sms":this.modelInfo.versionpre=this.urlBase.CDN+"/"+this.modelInfo.modelId+"/",this.modelInfo.modelpre=this.urlBase.CDN+"/"+this.modelInfo.modelId+"/",this.modelInfo.infopre=this.urlBase.ICDN+"/"+this.modelInfo.modelId+"/",this.modelInfo.setpre=window.location.origin+this.urlBase.EDIT+this.modelInfo.modelId+"/";break;case"demo":this.modelInfo.modelpre=window.location.origin+"/play/data/"+this.modelInfo.modelId+"/",this.modelInfo.infopre=window.location.origin+"/play/data/"+this.modelInfo.modelId+"/",this.modelInfo.setpre=window.location.origin+"/play/data/"+this.modelInfo.modelId+"/";break;case"gjf":this.modelInfo.versionpre=window.location.origin+"/data/"+this.modelInfo.modelId+"/",this.modelInfo.modelpre=window.location.origin+"/data/"+this.modelInfo.modelId+"/",this.modelInfo.infopre=window.location.origin+"/data/"+this.modelInfo.modelId+"/",this.modelInfo.setpre=window.location.origin+"/data/"+this.modelInfo.modelId+"/";break;default:this.modelInfo.versionpre="./static/play/data/"+this.modelInfo.modelId+"/",this.modelInfo.modelpre="./static/play/data/",this.modelInfo.infopre="./static/play/data/",this.modelInfo.setpre="./static/play/data/"+this.modelInfo.modelId+"/"}},getCompanyUrl:function(t,e){var i;return i="sms"!==e.type?parseInt((new Date).getTime()/18e5):(new Date).getTime(),this.urlBase.TCDN+"/company/"+t+"/company.txt?t="+i},generateHouseInfo:function(t){var e=this;return(0,r.default)(o.default.mark(function i(){var n,r,a,s,l;return o.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!e.CommonUtil.getQueryString("middlemanShare")){i.next=10;break}return n=void 0,n="online"===m?"https://user.3dnest.cn/nest_house/verify_broker/":"https://allfun.3dnest.cn/nest_house/verify_broker/",r=e.CommonUtil.getQueryString("m"),a=e.CommonUtil.getQueryString("middlemanShare"),s={nest_id:r,pa:a},i.next=8,(0,c.default)({method:"GET",url:n+"?nest_id="+s.nest_id+"&pa="+s.pa,headers:{"Content-Type":"application/x-www-form-urlencoded"}});case 8:(l=i.sent)&&200===l.status&&1===l.data.code&&l.data.data&&(t.brokerInfo.enable=!0,t.brokerInfo.brokerName=l.data.data.name,t.brokerInfo.brokerPhone=l.data.data.phone,t.brokerInfo.brokerImage=l.data.data.avatar||f);case 10:e.$store.dispatch("changeHouseInfo",t),t.title?document.title=t.title:(document.title=e.$t("defaultTitle"),t.title=e.$t("defaultTitle")),t.share&&t.share.enable&&e.setShare(t.share,e.modelSettings);case 13:case"end":return i.stop()}},i,e)}))()},initLoadingSettings:function(t){var e=this.CommonUtil.getQueryString("m"),i=t.nestscenes.backgroundimgurl;if(e){var n=t.locations.orientations;if(null!=n&&void 0!=n)for(var o=n.length,r=0;r<o;r++)n[r].key==e&&n[r].preview_url&&(i=n[r].preview_url)}this.$store.dispatch("initLoadingBgUrl",i)},setShare:function(t,e){t.share_link=t.share_link||window.location.href,!t.share_img&&e.nestscenes&&e.nestscenes.backgroundimgurl&&(t.share_img=e.nestscenes.backgroundimgurl.replace("http:","https:")),t.share_context||(t.share_context=t.share_title),3!==e.languageObj.lang||(0,h.default)({imgUrl:t.share_img,shareTitle:t.share_title,descContent:t.share_context,link:t.share_link})},changeGoogleMapLoadStatus:function(){this.$store.dispatch("changeGoogleMapLoadStatus",!0)},initMiddleManState:function(t){var e=void 0;e=!t.basic.ui||t.basic.ui.broker,this.$store.dispatch("initMiddleManState",e)},initShareFullState:function(t){var e=void 0;e=!t.basic.ui||t.basic.ui.scan,this.$store.dispatch("initShareFullState",e)},initFullScreenState:function(t){var e=void 0;e=!t.basic.ui||t.basic.ui.zoom,this.$store.dispatch("initFullScreenState",e)},initSpeakHouseState:function(t){var e=void 0;e=!t.basic.ui||t.basic.ui.vr_speak,this.$store.dispatch("initSpeakHouseState",e)},initMultipleMeasureState:function(t){var e=void 0;e=!t.basic.ui||t.basic.ui.ruler,this.$store.dispatch("initMultipleMeasureState",e)},initMultipleTagState:function(t){var e=void 0;e=!t.basic.ui||t.basic.ui.tag,this.$store.dispatch("initMultipleTagState",e)},initMultipleHelpState:function(t){var e=void 0;e=!t.basic.ui||t.basic.ui.help,this.$store.dispatch("initMultipleHelpState",e)},initMultipleVrState:function(t){var e=void 0;e=!t.basic.ui||t.basic.ui.vr,this.$store.dispatch("initMultipleVrState",e)}},mounted:function(){document.οncοntextmenu=function(t){t.preventDefault()}}}},Hb4q:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"panorama-btn-container",on:{click:this.changeMode}},[e("i",{staticClass:"panorama-btn-icon"}),this._v(" "),e("span",{staticClass:"panorama-btn-text"},[this._v("\n         "+this._s(this.$t("panoramaText"))+"\n    ")])])},staticRenderFns:[]};e.a=n},HcVH:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("PVXw"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("1bJ3"),s=i("VU/8")(o.a,a.a,!1,null,null,null);e.default=s.exports},HdZj:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("K7Ql"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("qc+0");var s=function(t){i("wAtW")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-b8da17ba",null);e.default=l.exports},HeY9:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"lecture-panel-container"},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.lectureIsActive,expression:"!lectureIsActive"}],staticClass:"lecture-panel-bt",on:{click:t.showLecturePanelList}},[i("i",{staticClass:"bt-icon"}),t._v(" "),i("span",{staticClass:"bt-text"},[t._v(t._s(t.$t("lectureText")))])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.lectureIsActive,expression:"lectureIsActive"}],staticClass:"lecture-list-container"},[i("div",{staticClass:"lecture-pause-btn",on:{click:t.closeLecturePanelList}},[i("i",{staticClass:"lecture-pause-btn-icon"})]),t._v(" "),t.lectureList&&t.lectureList.length<=4?i("div",{ref:"lectureList",staticClass:"lecture-list"},t._l(t.lectureList,function(e,n){return i("div",{key:n,ref:"lectureItem"+n,refInFor:!0,staticClass:"lecture-item",class:{active:t.currentLectureIndex===n},attrs:{"data-index":n},on:{click:function(e){return t.selectLectureItem(n)}}},[t._v("\n        "+t._s(e.name)+"\n        "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.currentLectureIndex===n,expression:"currentLectureIndex === index"}],staticClass:"lecture-item-status-container"},[i("div",{staticClass:"lecture-item-status",style:{width:t.currentLecturePercent+"%"}})])])}),0):t.lectureList&&t.lectureList.length>4?i("div",{ref:"lectureList",staticClass:"lecture-list"},[i("swiper",{attrs:{options:t.swiperOption}},[i("div",{staticClass:"swiper-scrollbar",attrs:{slot:"scrollbar"},slot:"scrollbar"}),t._v(" "),t._l(t.lectureList,function(e,n){return i("swiper-slide",{key:n},[i("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"}),t._v(" "),i("div",{staticClass:"swiper-button-prev",attrs:{slot:"button-prev"},slot:"button-prev"}),t._v(" "),i("div",{staticClass:"swiper-button-next",attrs:{slot:"button-next"},slot:"button-next"}),t._v(" "),i("div",{ref:"lectureItem"+n,refInFor:!0,staticClass:"lecture-item",class:{active:t.currentLectureIndex===n},attrs:{"data-index":n},on:{click:function(e){return t.selectLectureItem(n)}}},[i("div",{staticClass:"lecture-item-text2"},[t._v(t._s(e.name))]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.currentLectureIndex===n,expression:"currentLectureIndex === index"}],staticClass:"lecture-item-status-container"},[i("div",{staticClass:"lecture-item-status",style:{width:t.currentLecturePercent+"%"}})])])])})],2)],1):t._e()])])},staticRenderFns:[]};e.a=n},Hzon:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("38pd"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("1hlY");var s=function(t){i("ZnAq")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-a7d7c1a0",null);e.default=l.exports},I7wt:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("3pLw"),r=(n=o)&&n.__esModule?n:{default:n};var a=i("2Uyi"),s=i("w1BD"),l=i("8eyn"),c="https://webapi.koofang.com/api/",u=[{Id:60,AreaName:"北京",SourceWay:10,DomainName:"bj.c21.com.cn",Pinyin:"beijing",AreaCode:"B025",TenantId:2},{Id:61,AreaName:"上海",SourceWay:10,DomainName:"sh.c21.com.cn",Pinyin:"shanghai",AreaCode:"B024",TenantId:3},{Id:64,AreaName:"成都",SourceWay:10,DomainName:"cd.c21.com.cn",Pinyin:"chengdu",AreaCode:"B144",TenantId:12},{Id:66,AreaName:"西安",SourceWay:10,DomainName:"xa.c21.com.cn",Pinyin:"xian",AreaCode:"B142",TenantId:10},{Id:68,AreaName:"青岛",SourceWay:10,DomainName:"qd.c21.com.cn",Pinyin:"qingdao",AreaCode:"B151",TenantId:9},{Id:70,AreaName:"南京",SourceWay:10,DomainName:"nj.c21.com.cn",Pinyin:"nanjing",AreaCode:"B155",TenantId:25},{Id:80,AreaName:"嘉兴",SourceWay:10,DomainName:"jx.c21.com.cn",Pinyin:"jiaxing",AreaCode:"B147",TenantId:15},{Id:72,AreaName:"苏州",SourceWay:10,DomainName:"sz.c21.com.cn",Pinyin:"suzhou",AreaCode:"B163",TenantId:33},{Id:74,AreaName:"无锡",SourceWay:10,DomainName:"wx.c21.com.cn",Pinyin:"wuxi",AreaCode:"B179",TenantId:50},{Id:76,AreaName:"常州",SourceWay:10,DomainName:"cz.c21.com.cn",Pinyin:"changzhou",AreaCode:"B175",TenantId:46},{Id:78,AreaName:"湖州",SourceWay:10,DomainName:"hz.c21.com.cn",Pinyin:"huzhou",AreaCode:"B180",TenantId:51},{Id:82,AreaName:"武汉",SourceWay:10,DomainName:"wh.c21.com.cn",Pinyin:"wuhan",AreaCode:"B115",TenantId:39},{Id:84,AreaName:"包头",SourceWay:10,DomainName:"bt.c21.com.cn",Pinyin:"baotou",AreaCode:"B157",TenantId:27},{Id:87,AreaName:"唐山",SourceWay:10,DomainName:"ts.c21.com.cn",Pinyin:"tangshan",AreaCode:"B187",TenantId:58},{Id:90,AreaName:"邯郸",SourceWay:10,DomainName:"hd.c21.com.cn",Pinyin:"handan",AreaCode:"B162",TenantId:32},{Id:93,AreaName:"洛阳",SourceWay:10,DomainName:"ly.c21.com.cn",Pinyin:"luoyang",AreaCode:"B186",TenantId:57},{Id:95,AreaName:"沧州",SourceWay:10,DomainName:"cangzhou.c21.com.cn",Pinyin:"cangzhou",AreaCode:"B166",TenantId:36},{Id:98,AreaName:"枣庄",SourceWay:10,DomainName:"zz.c21.com.cn",Pinyin:"zaozhuang",AreaCode:"B170",TenantId:41},{Id:100,AreaName:"呼和浩特",SourceWay:10,DomainName:"hhht.c21.com.cn",Pinyin:"huhehaote",AreaCode:"B192",TenantId:63},{Id:127,AreaName:"德州",SourceWay:10,DomainName:"dz.c21.com.cn",Pinyin:"dezhou",AreaCode:"B189",TenantId:60},{Id:129,AreaName:"濮阳",SourceWay:10,DomainName:"py.c21.com.cn",Pinyin:"puyang",AreaCode:"B176",TenantId:47},{Id:131,AreaName:"宝鸡",SourceWay:10,DomainName:"baoji.c21.com.cn",Pinyin:"baoji",AreaCode:"B167",TenantId:37},{Id:133,AreaName:"厦门",SourceWay:10,DomainName:"xm.c21.com.cn",Pinyin:"xiamen",AreaCode:"B190",TenantId:61},{Id:135,AreaName:"滨州",SourceWay:10,DomainName:"binzhou.c21.com.cn",Pinyin:"binzhou",AreaCode:"B182",TenantId:53},{Id:137,AreaName:"菏泽",SourceWay:10,DomainName:"heze.c21.com.cn",Pinyin:"heze",AreaCode:"B183",TenantId:54},{Id:139,AreaName:"邢台",SourceWay:10,DomainName:"xt.c21.com.cn",Pinyin:"xingtai",AreaCode:"B173",TenantId:44},{Id:141,AreaName:"绍兴",SourceWay:10,DomainName:"sx.c21.com.cn",Pinyin:"shaoxing",AreaCode:"B159",TenantId:29},{Id:143,AreaName:"徐州",SourceWay:10,DomainName:"xz.c21.com.cn",Pinyin:"xuzhou",AreaCode:"B138",TenantId:6},{Id:145,AreaName:"潍坊",SourceWay:10,DomainName:"wf.c21.com.cn",Pinyin:"weifang",AreaCode:"B172",TenantId:43},{Id:151,AreaName:"郑州",SourceWay:10,DomainName:"zhengzhou.c21.com.cn",Pinyin:"zhengzhou",AreaCode:"B117",TenantId:84}];e.default={load:function(t,e){var i={},n=a.getAllValueFromSearch(),o=n.cid,h=n.hid,d=""===n.sellflag?1:parseInt(n.sellflag),p=parseInt(n.shareType);if(o&&h){var f="",m="";d?(f=c+"Sale/SaleRealtyDetail",m=c+"Sale/SaleRealtyCommunityBrokerList"):(f=c+"Rent/RentRealtyDetail",m=c+"Rent/RentRealtyCommunityBrokerList");var g={PublicRequest:{AppVersion:"vr1",SourceWay:10},AreaCode:o,Search:{}};g.Search={},g.Search.RealtyNum=h,r.default.post({url:f,data:g}).then(function(n){if(n.PublicResponse&&1===n.PublicResponse.Code){var c=function(){if(v&&y){var i=function(t,e,i,n,o){var r,s,l,c;l=n?"/ershoufang/":"/zufang/";for(var u=0;u<t.length;u++)if(t[u].AreaCode===o){c=t[u],r=t[u].DomainName,a.isMobile()&&(r="m."+r);break}s=r,r&&(r="http://"+r,s="http://"+s+l+e+".html");var h="/pages/saleDetail/saleDetail?realtyId="+e+"&areaId="+c.Id+"&areaName="+c.AreaName+"&areaCode="+c.AreaCode+"&shareType="+i;return{homeLink:r,houseDetailLink:s,minienable:!!c,miniHomeLink:"/pages/index/index?resetCity="+c.AreaName+"&shareType="+i,miniHouseDetailLink:h}}(w,f,p,d,o),n={};n.title=h.CommunityName+h.RoomNum+"室"+h.LivingRoomNum+"厅 "+h.ConstructionArea+"㎡",n.houseInfo=s.generateHouseInfo(h,l.houseInfo),0===h.RealtyStatus&&1===h.ShowStatus||n.houseInfo.list.push({value:"已下架",name:"状态",widthStyle:2}),n.houseInfo.houseDetail=i.houseDetailLink,b&&(n.brokerInfo=s.getbrokerInfo(b,l.brokerInfo)),n.homeLink={enable:!0,link:i.homeLink},n.miniProgram={enable:i.minienable,shareType:p,houseDetailLink:i.miniHouseDetailLink,homeLink:i.miniHomeLink},n.share={enable:!0,share_link:window.location.href,share_context:n.title,share_img:t.nestscenes.backgroundimgurl.replace("http:","https:"),share_title:n.title},e(n)}},h=n.Data.DetailInfo,f=h.RealtyId;g.Search={},g.Search.RealtyId=f;var v=!1,y=!1,b=null,w=null;h.houseInfo_HouseType=d?"sale":"rent",r.default.post({url:m,data:g}).then(function(t){i.showbroker="show",i.brokerInfo={brokerImage:"./images/21_default_headIcon.png",brokerPhone:""},t.PublicResponse&&1===t.PublicResponse.Code&&(b=t.Data[0]),v=!0,c()}),r.default.post({url:"https://webapi.koofang.com/api/Common/GetAreaWebSites",data:{PublicRequest:{AppVersion:"vr1",SourceWay:10}}}).then(function(t){w=u,t.PublicResponse&&1===t.PublicResponse.Code&&(w=t.Data),i.showHomePage="show",y=!0,c()})}})}else i.title="3d看房"(i)}}},IGLE:function(t,e){},IRJk:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("1oy7"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("54WP");var s=function(t){i("H8wj")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-51df8e80",null);e.default=l.exports},ITjM:function(t,e){},IcnI:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(i("7+uW")),o=r(i("NYxO"));function r(t){return t&&t.__esModule?t:{default:t}}var a={changeTitleStatus:function(t,e){t.showTitle=e},changeHouseInfoPanel:function(t,e){t.houseInfoIsShow=e},changeHouseInfoImgSwiperStatus:function(t,e){t.showHouseInfoImgSwiper=e},changeToolsListStatus:function(t,e){t.toolsListIsShow=e},changeDisclaimerContentStatus:function(t,e){t.disclaimerContentIsShow=e,e&&(t.toolsListIsShow=!1)},changeDisclaimerContent:function(t,e){t.disclaimerContent=e},changeMapData:function(t,e){t.mapData=e},changeBigMapStatus:function(t,e){t.bigMapIsShow=e},changeFullScreenStatus:function(t,e){t.isFullScreen=e},changeCurrentClient:function(t,e){t.currentClient=e},changeVrTipStatus:function(t,e){t.vrTipIsShow=e},changeHelpTipStatus:function(t,e){t.helpTipIsShow=e},changeMeasureStatus:function(t,e){t.measureIsActive=e},changeTagIsUsed:function(t,e){t.tagIsUsed=e},changeVrStatus:function(t,e){t.vrIsActive=e},changeMode:function(t,e){t.currentMode=e},goMode:function(t,e){t.sceneIsActive||t.lectureIsActive||(t.goMode=e)},changeLoadingProgress:function(t,e){t.loadingProgress=e},initLoadingBgUrl:function(t,e){t.loadingBgUrl=e},changeEnterPageStatus:function(t,e){t.isEnterPage=e},changeFloorPlanImageUrl:function(t,e){t.floorPlanImageUrl=e},changeFloorPlanImageStatus:function(t,e){t.floorPlanImageIsShow=e},changeCurrentAngleValue:function(t,e){t.currentAngle=e},changeCurrentPosition:function(t,e){t.currentPosition.x=e.x,t.currentPosition.y=e.y,t.currentPosition.time=e.time},changeCurrentArea:function(t,e){t.currentArea=e},changeFloorPlanData:function(t,e){t.currentFloorPlanData=e},changeCurrentRoomList:function(t,e){t.currentRoomList=e},changeCurrentFloorPlanWidthHeight:function(t,e){t.currrentFloorPlanWidthHeightData=e},changeEntranceData:function(t,e){t.entranceData=e},changeRadarData:function(t,e){t.radarData=e},changeFloorList:function(t,e){t.floorList=e},changeCurrentFloorIndex:function(t,e){t.currentFloorIndex=e},judgeIsMultiLayer:function(t,e){t.isMultiLayer=e},judgeIsLandscape:function(t,e){t.isLandscape=e},changeMiddlemanTranspondStatus:function(t,e){t.middlemanTranspondIsShow=e,e&&(t.toolsListIsShow=!1)},changeMiddlemanTranspondStep:function(t,e){t.middlemanTranspondStep=e},changeCopyStatus:function(t,e){t.copyStatus=e},changeSceneStatus:function(t,e){t.sceneIsActive=e},changeLectureStatus:function(t,e){t.lectureIsActive=e},initSceneList:function(t,e){t.sceneList=e},initLectureList:function(t,e){t.lectureList=e},changeCurrentSceneIndex:function(t,e){t.currentSceneIndex=e},changeCurrentLectureIndex:function(t,e){t.currentLectureIndex=e},changeCurrentLecturePercent:function(t,e){t.currentLecturePercent=e},changeTagIsActive:function(t,e){t.tagIsActive=e},changeCurrentTagType:function(t,e){t.currentTagType=e},changeCurrentTagData:function(t,e){t.currentTagData=e},changeAudioStatus:function(t,e){t.audioStatus=e},changeSettings:function(t,e){t.settings=e},changeHouseInfo:function(t,e){t.houseInfo=e},changeTelDialogStatus:function(t,e){t.telDialogIsShow=e,e&&(t.toolsListIsShow=!1)},changeTelTipStatus:function(t,e){t.telTipIsShow=e,e&&(t.toolsListIsShow=!1)},changeCompanySettingsIsLoaded:function(t,e){t.companySettingsIsLoaded=e},changeCompanyLogoUrl:function(t,e){t.companyLogoUrl=e},changeCompanyLoadingUrl:function(t,e){t.companyLoadingUrl=e},changeLoadingSettingIsLoadedStatus:function(t,e){t.loaddingSettingIsLoaded=e},changeIsDragingMap:function(t,e){t.isDragingMap=e},changeOtherStatus:function(t,e){switch(e){case"mode":case"tag":t.toolsListIsShow=!1,t.houseInfoIsShow=!1,t.sceneIsActive=!1,t.lectureIsActive=!1;break;case"tools":t.houseInfoIsShow=!1,t.sceneIsActive=!1,t.lectureIsActive=!1;break;case"scene":t.toolsListIsShow=!1,t.houseInfoIsShow=!1,t.lectureIsActive=!1;break;case"lecture":t.toolsListIsShow=!1,t.houseInfoIsShow=!1,t.sceneIsActive=!1;break;case"houseinfo":t.toolsListIsShow=!1,t.sceneIsActive=!1,t.lectureIsActive=!1}},changePanoSizeLeftIsShow:function(t,e){t.panoSizeLeftIsShow=e},changePanoSizeLeftData:function(t,e){t.panoSizeLeftData=e},changePanoSizeRightIsShow:function(t,e){t.panoSizeRightIsShow=e},changePanoSizeRightData:function(t,e){t.panoSizeRightData=e},changePanoSizeHeightIsShow:function(t,e){t.panoSizeHeightIsShow=e},changePanoSizeHeightData:function(t,e){t.panoSizeHeightData=e},initCompanyId:function(t,e){t.companyId=e},changeShareComponentStatus:function(t,e){t.shareComponentIsShow=e},changeGoogleMapLoadStatus:function(t,e){t.googleMapLoadStatus=e},changeVirtualNumber:function(t,e){t.virtualNumberCount=null,e.unbindTime?(t.virtualNumber=e.virtualNumber,t.virtualNumberCount=setTimeout(function(){t.virtualNumber="",t.virtualNumberCount=null,t.telDialogIsShow&&(t.telDialogIsShow=!1)},e.unbindTime)):t.virtualNumber=null},changeSlideVerifyStatus:function(t,e){t.slideVerifyIsShow=e},changeSlideVerifyPicArray:function(t,e){t.slideVerifyPicArray=e},changeTakeLookStatus:function(t,e){t.takeLookIsPlaying=e},changeTakeLookActionState:function(t,e){t.takeLookActionState=e},changeTakeLookChatState:function(t,e){t.takeLookChatState=e},changeTakeLookInfo:function(t,e){t.takeLookInfo=e},changeTakeLookInfoStateIsUpdate:function(t,e){t.takeLookInfoStateIsUpdate=e},initTakeLookRole:function(t,e){t.takeLookRole=e},changeTakeLookOperation:function(t,e){t.takeLookOperation=e},changeTakeLookOperationIsBusy:function(t,e){t.takeLookOperation=e},changeTakeLookTip:function(t,e){t.takeLookTip=e,e&&(t.takeLookTipIsShow=!0,setTimeout(function(){t.takeLookTipIsShow=!1,t.takeLookTip=""},2500))},changeTakeLookTipStatus:function(t,e){t.takeLookTipIsShow=e},changeTakeLookCallingLeftTime:function(t,e){t.takeLookCallingLeftTime=e},initMiddleManState:function(t,e){t.MiddleManState=e},initShareFullState:function(t,e){t.ShareFullState=e},initFullScreenState:function(t,e){t.FullScreenState=e},initSpeakHouseState:function(t,e){t.SpeakHouseState=e},initMultipleMeasureState:function(t,e){t.MultipleMeasureState=e},initMultipleTagState:function(t,e){t.MultipleTagState=e},initMultipleHelpState:function(t,e){t.MultipleHelpState=e},initMultipleVrState:function(t,e){t.MultipleVrState=e}};n.default.use(o.default);var s=new o.default.Store({state:{titleIsShow:!0,vrTipIsShow:!1,helpTipIsShow:!1,houseInfoIsShow:!1,showHouseInfoImgSwiper:!1,toolsListIsShow:!1,disclaimerContentIsShow:!1,disclaimerContent:"",companyId:1,shareComponentIsShow:!1,bigMapIsShow:!1,isFullScreen:!1,currentClient:"",currentMode:"",goMode:"",measureIsActive:!1,tagIsUsed:!0,vrIsActive:!1,houseInfo:{},companySettingsIsLoaded:!1,companyLogoUrl:"",companyLoadingUrl:"",loadingProgress:0,loadingBgUrl:"",isEnterPage:!1,floorPlanImageUrl:"",floorPlanImageIsShow:!1,currentAngle:0,currentPosition:{x:0,y:0,time:""},currentArea:"",currentFloorPlanData:null,currentRoomList:null,currrentFloorPlanWidthHeightData:null,entranceData:null,radarData:null,floorList:null,currentFloorIndex:"",isMultiLayer:!1,isLandscape:!1,middlemanTranspondIsShow:!1,middlemanTranspondStep:"input",copyStatus:!1,sceneIsActive:!1,lectureIsActive:!1,sceneList:null,lectureList:null,currentSceneIndex:0,currentLectureIndex:0,currentLecturePercent:0,tagIsActive:!0,currentTagType:"",currentTagData:null,audioStatus:!0,settings:null,telDialogIsShow:!1,telTipIsShow:!1,loadingSettingIsLoaded:!1,isDragingMap:!1,panoSizeLeftIsShow:!1,panoSizeLeftData:null,panoSizeRightIsShow:!1,panoSizeRightData:null,panoSizeHeightIsShow:!1,panoSizeHeightData:null,googleMapLoadStatus:!1,virtualNumber:"",virtualNumberCount:"",slideVerifyIsShow:!1,slideVerifyPicArray:null,takeLookIsPlaying:!1,takeLookActionState:"",takeLookChatState:"",takeLookOperation:null,takeLookOperationIsBusy:!1,takeLookInfo:null,takeLookInfoStateIsUpdate:!1,takeLookCallingLeftTime:60,takeLookRole:"",takeLookTip:"",takeLookTipIsShow:!1,MiddleManState:!1,ShareFullState:!1,FullScreenState:!1,SpeakHouseState:!1,MultipleMeasureState:!0,MultipleTagState:!0,MultipleHelpState:!0,MultipleVrState:!0},getters:{},mutations:a,actions:{toggleTitle:function(t,e){t.commit("changeTitleStatus",e)},toggleHouseInfoPanel:function(t,e){t.commit("changeHouseInfoPanel",e),e&&t.commit("changeOtherStatus","houseinfo")},toggleHouseInfoImgSwiper:function(t,e){t.commit("changeHouseInfoImgSwiperStatus",e)},toggleToolsList:function(t,e){t.commit("changeToolsListStatus",e),e&&t.commit("changeOtherStatus","tools")},toggleDisclaimerContent:function(t,e){t.commit("changeDisclaimerContentStatus",e)},initDisclaimerContent:function(t,e){t.commit("changeDisclaimerContent",e)},initMapData:function(t,e){t.commit("changeMapData",e)},toggleBigMapStatus:function(t,e){t.commit("changeBigMapStatus",e)},toggleFullScreenStatus:function(t,e){t.commit("changeFullScreenStatus",e)},changeCurrentClient:function(t,e){t.commit("changeCurrentClient",e)},changeVrTipStatus:function(t,e){t.commit("changeVrTipStatus",e)},changeHelpTipStatus:function(t,e){t.commit("changeHelpTipStatus",e)},changeMeasureStatus:function(t,e){t.commit("changeMeasureStatus",e)},changeTagIsUsed:function(t,e){t.commit("changeTagIsUsed",e)},changeVrStatus:function(t,e){t.commit("changeVrStatus",e)},changeMode:function(t,e){t.commit("changeMode",e)},goMode:function(t,e){t.commit("goMode",e),t.commit("changeOtherStatus","mode")},changeLoadingProgress:function(t,e){t.commit("changeLoadingProgress",e)},initLoadingBgUrl:function(t,e){t.commit("initLoadingBgUrl",e)},changeEnterPageStatus:function(t,e){t.commit("changeEnterPageStatus",e)},changeFloorPlanImageUrl:function(t,e){t.commit("changeFloorPlanImageUrl",e)},changeFloorPlanImageStatus:function(t,e){t.commit("changeFloorPlanImageStatus",e)},changeCurrentAngleValue:function(t,e){t.commit("changeCurrentAngleValue",e)},changeCurrentPosition:function(t,e){t.commit("changeCurrentPosition",e)},changeCurrentArea:function(t,e){t.commit("changeCurrentArea",e)},changeFloorPlanData:function(t,e){t.commit("changeFloorPlanData",e)},changeCurrentRoomList:function(t,e){t.commit("changeCurrentRoomList",e)},changeCurrentFloorPlanWidthHeight:function(t,e){t.commit("changeCurrentFloorPlanWidthHeight",e)},changeEntranceData:function(t,e){t.commit("changeEntranceData",e)},changeRadarData:function(t,e){t.commit("changeRadarData",e)},changeFloorList:function(t,e){t.commit("changeFloorList",e)},changeCurrentFloorIndex:function(t,e){t.commit("changeCurrentFloorIndex",e)},judgeIsMultiLayer:function(t,e){t.commit("judgeIsMultiLayer",e)},judgeIsLandscape:function(t,e){t.commit("judgeIsLandscape",e)},changeMiddlemanTranspondStatus:function(t,e){t.commit("changeMiddlemanTranspondStatus",e)},changeMiddlemanTranspondStep:function(t,e){t.commit("changeMiddlemanTranspondStep",e)},changeCopyStatus:function(t,e){t.commit("changeCopyStatus",e)},changeSceneStatus:function(t,e){t.commit("changeSceneStatus",e),e&&t.commit("changeOtherStatus","scene")},changeLectureStatus:function(t,e){t.commit("changeLectureStatus",e),e&&t.commit("changeOtherStatus","lecture")},initSceneList:function(t,e){t.commit("initSceneList",e)},initLectureList:function(t,e){t.commit("initLectureList",e)},changeCurrentSceneIndex:function(t,e){t.commit("changeCurrentSceneIndex",e)},changeCurrentLectureIndex:function(t,e){t.commit("changeCurrentLectureIndex",e)},changeCurrentLecturePercent:function(t,e){t.commit("changeCurrentLecturePercent",e)},changeTagStatus:function(t,e){t.commit("changeTagIsActive",e),e&&t.commit("changeOtherStatus","tag")},changeCurrentTagType:function(t,e){t.commit("changeCurrentTagType",e)},changeCurrentTagData:function(t,e){t.commit("changeCurrentTagData",e)},changeAudioStatus:function(t,e){t.commit("changeAudioStatus",e)},changeSettings:function(t,e){t.commit("changeSettings",e)},changeHouseInfo:function(t,e){t.commit("changeHouseInfo",e)},changeTelDialogStatus:function(t,e){t.commit("changeTelDialogStatus",e)},changeTelTipStatus:function(t,e){t.commit("changeTelTipStatus",e)},changeCompanySettingsIsLoaded:function(t,e){t.commit("changeCompanySettingsIsLoaded",e)},changeCompanyLoadingUrl:function(t,e){t.commit("changeCompanyLoadingUrl",e)},changeCompanyLogoUrl:function(t,e){t.commit("changeCompanyLogoUrl",e)},changeIsDragingMap:function(t,e){t.commit("changeIsDragingMap",e)},changePanoSizeLeftIsShow:function(t,e){t.commit("changePanoSizeLeftIsShow",e)},changePanoSizeLeftData:function(t,e){t.commit("changePanoSizeLeftData",e)},changePanoSizeRightIsShow:function(t,e){t.commit("changePanoSizeRightIsShow",e)},changePanoSizeRightData:function(t,e){t.commit("changePanoSizeRightData",e)},changePanoSizeHeightIsShow:function(t,e){t.commit("changePanoSizeHeightIsShow",e)},changePanoSizeHeightData:function(t,e){t.commit("changePanoSizeHeightData",e)},initCompanyId:function(t,e){t.commit("initCompanyId",e)},changeShareComponentStatus:function(t,e){t.commit("changeShareComponentStatus",e)},changeGoogleMapLoadStatus:function(t,e){t.commit("changeGoogleMapLoadStatus",e)},changeVirtualNumber:function(t,e){t.commit("changeVirtualNumber",e)},changeSlideVerifyStatus:function(t,e){t.commit("changeSlideVerifyStatus",e)},changeSlideVerifyPicArray:function(t,e){t.commit("changeSlideVerifyPicArray",e)},changeTakeLookStatus:function(t,e){t.commit("changeTakeLookStatus",e)},changeTakeLookActionState:function(t,e){t.commit("changeTakeLookActionState",e)},changeTakeLookChatState:function(t,e){t.commit("changeTakeLookChatState",e)},changeTakeLookInfo:function(t,e){t.commit("changeTakeLookInfo",e)},changeTakeLookInfoStateIsUpdate:function(t,e){t.commit("changeTakeLookInfoStateIsUpdate",e)},initTakeLookRole:function(t,e){t.commit("initTakeLookRole",e)},changeTakeLookOperation:function(t,e){t.commit("changeTakeLookOperation",e)},changeTakeLookOperationIsBusy:function(t,e){t.commit("changeTakeLookOperationIsBusy",e)},changeTakeLookTip:function(t,e){t.commit("changeTakeLookTip",e)},changeTakeLookTipStatus:function(t,e){t.commit("changeTakeLookTipStatus",e)},changeTakeLookCallingLeftTime:function(t,e){t.commit("changeTakeLookCallingLeftTime",e)},initMiddleManState:function(t,e){t.commit("initMiddleManState",e)},initShareFullState:function(t,e){t.commit("initShareFullState",e)},initFullScreenState:function(t,e){t.commit("initFullScreenState",e)},initSpeakHouseState:function(t,e){t.commit("initSpeakHouseState",e)},initMultipleMeasureState:function(t,e){t.commit("initMultipleMeasureState",e)},initMultipleTagState:function(t,e){t.commit("initMultipleTagState",e)},initMultipleHelpState:function(t,e){t.commit("initMultipleHelpState",e)},initMultipleVrState:function(t,e){t.commit("initMultipleVrState",e)}}});e.default=s},Ilbg:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tel-tip-container"},[i("div",{staticClass:" tel-tip-content"},[i("div",{staticClass:"tel-tip-main"},[t._v("\n            "+t._s(t.$t("has_not_phone_tip"))+"\n        ")]),t._v(" "),i("div",{staticClass:"tel-tip-footer"},[i("div",{staticClass:"footer-cancel footer-item",on:{click:t.goCancel}},[t._v("\n                "+t._s(t.$t("mobile_contact_cancel_text"))+"\n            ")]),t._v(" "),i("div",{staticClass:"footer-confirm footer-item",on:{click:t.goConfirm}},[t._v("\n                "+t._s(t.$t("middle_verify_confirm_text"))+"\n            ")])])])])},staticRenderFns:[]};e.a=n},IoJs:function(t,e){},Ipmm:function(t,e){},IuSH:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i("v2ns");var n=i("7QTg");e.default={props:{},name:"house-info",data:function(){return{swiperOption:{loop:!0,loopAdditionalSlides:0,effect:"coverflow",grabCursor:!0,centeredSlides:!0,slidesPerView:"auto",spaceBetween:61,coverflowEffect:{rotate:0,stretch:.2,depth:100,modifier:1,slideShadows:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}},houseInfoData:this.$store.state.houseInfo}},computed:{},components:{swiper:n.swiper,swiperSlide:n.swiperSlide},created:function(){},mounted:function(){},methods:{closeImgSwiper:function(){this.statistic_utils.trackEvent(78),this.$store.dispatch("toggleHouseInfoImgSwiper",!1)}}}},J45D:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"title-component",data:function(){return{}},computed:{disclaimerContent:function(){return this.$store.state.disclaimerContent}},created:function(){},mounted:function(){},methods:{closeDisclaimer:function(){this.statistic_utils.trackEvent(49),this.$store.dispatch("toggleDisclaimerContent",!1)}}}},J6K5:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"pc-tool",data:function(){return{}},computed:{toolsListIsShow:function(){return this.$store.state.toolsListIsShow},measureIsActive:function(){return this.$store.state.measureIsActive},tagIsUsed:function(){return this.$store.state.tagIsUsed},MultipleMeasureState:function(){return this.$store.state.MultipleMeasureState},MultipleTagState:function(){return this.$store.state.MultipleTagState},MultipleHelpState:function(){return this.$store.state.MultipleHelpState}},created:function(){},mounted:function(){},methods:{toggleToolsList:function(){this.statistic_utils.trackEvent(21),this.$store.dispatch("toggleToolsList",!this.$store.state.toolsListIsShow)},toggleMeasureStatus:function(){this.statistic_utils.trackEvent(19),this.$store.dispatch("changeMeasureStatus",!this.$store.state.measureIsActive)},toggleTagStatus:function(){this.statistic_utils.trackEvent(16),this.$store.dispatch("changeTagIsUsed",!this.$store.state.tagIsUsed)},showVrTip:function(){this.statistic_utils.trackEvent(32),this.$store.dispatch("toggleToolsList",!1),this.$store.dispatch("changeVrTipStatus",!0)},showHelpTip:function(){this.statistic_utils.trackEvent(18),this.$store.dispatch("toggleToolsList",!1),this.$store.dispatch("changeHelpTipStatus",!0)}}}},"JI0+":function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"share-component-container"},[e("div",{staticClass:"share-list-arrow"}),this._v(" "),e("div",{staticClass:"share-component-list"},[e("div",{staticClass:"share-component-item",on:{click:this.fbShare}},[e("i",{staticClass:"share-component-icon facebook"})])])])},staticRenderFns:[]};e.a=n},JO2z:function(t,e){},JXbb:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("3pLw"),r=(n=o)&&n.__esModule?n:{default:n};var a="https://api.917.com/index.php";e.default={props:{},name:"slide-verify",data:function(){return{imgUrl:"https://pic.917.com",slideIsStart:!1,originalPosition:"",currentPosition:"",maxWidth:"",minWidth:"",scope:"",status:!1}},created:function(){},mounted:function(){},computed:{slideVerifyPicArray:function(){return this.$store.state.slideVerifyPicArray},slideImgParent:function(){return this.$store.state.slideVerifyPicArray.length>1?this.$store.state.slideVerifyPicArray[0].replace("/tncode/",""):""},slideImg:function(){return this.$store.state.slideVerifyPicArray.length>1?this.$store.state.slideVerifyPicArray[1].replace("/tncode/",""):""},houseInfoData:function(){return this.$store.state.houseInfo}},methods:{closeSlideVerify:function(){this.$store.dispatch("changeSlideVerifyStatus",!1)},slideStart:function(t,e){this.maxWidth=this.$refs.slidebg.clientWidth,this.minWidth=this.$refs.slideimg.clientWidth,this.scope=this.maxWidth-this.minWidth,this.status=!1;var i=t||window.event;this.originalPosition="mobile"===e?i.touches[0].pageX-i.target.offsetLeft:i.target.clientX-i.target.offsetLeft,this.slideIsStart=!0},slideMove:function(t,e){this.currentPosition="mobile"===e?t.touches[0].pageX-this.originalPosition:t.target.clientX-this.originalPosition,this.currentPosition<0?this.currentPosition=0:this.currentPosition>this.scope&&(this.currentPosition=this.scope)},slideEnd:function(t,e){this.slideIsStart&&this.checkStatus()},updateView:function(t){$slideStatus.css("width",t),$slideBtn.css("left",t),$slideImg.css("left",t)},refreshImg:function(){var t=this,e={command:"Global",action:"TnCode",city_id:this.CommonUtil.getQueryString("city")};r.default.get({url:a,data:e}).then(function(e){e&&200===e.status&&e.data&&e.data.feedback&&e.data.feedback.msg9006&&e.data.feedback.msg9006.length>1&&t.$store.dispatch("changeSlideVerifyPicArray",[e.data.feedback.msg9006[0],e.data.feedback.msg9006[1]])})},recoverSlide:function(){this.slideIsStart=!1,this.currentPosition=0},checkStatus:function(){var t,e=this,i=this.CommonUtil.getQueryString("city"),n=this.CommonUtil.getQueryString("hid"),o=this.CommonUtil.getQueryString("house_type"),s=this.houseInfoData.slideVerify.uid;"sell"===o?t=1:"loupan"===o?t=2:"chuzu"===o&&(t=3);var l={command:"Global",action:"TnCode",city_id:i,act:"check",bg:this.slideImgParent,sl:this.slideImg,offset:Math.floor(250*this.currentPosition/this.maxWidth)+3,uid:s,hid:n,type:t};r.default.get({url:a,data:l}).then(function(t){if(t&&200===t.status&&t.data&&t.data.feedback&&t.data.feedback.msg9006&&t.data.feedback.msg9006.msg&&t.data.feedback.msg9006.msg.virtual_number){var i=t.data.feedback.msg9006.msg.virtual_number,n=t.data.feedback.msg9006.msg.unbind_time;e.$store.dispatch("changeVirtualNumber",{virtualNumber:i,unbindTime:1e3*n}),e.status=!0,setTimeout(function(){e.$store.dispatch("changeSlideVerifyStatus",!1),e.recoverSlide(),e.$store.dispatch("changeTelDialogStatus",!0),e.status=!1},1500)}else e.recoverSlide()})}}}},JnZp:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("mYB8"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("rOXf");var s=function(t){i("Rz+S")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-145c1006",null);e.default=l.exports},"K+T/":function(t,e){},K26X:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(i("lvKI")),o=r(i("3pLw"));function r(t){return t&&t.__esModule?t:{default:t}}var a=i("2Uyi"),s=i("VXBq"),l=i("w1BD");e.default={load:function(t,e){var i=a.getQueryString("house_id"),r=a.getQueryString("city")||"",c=a.getQueryString("house_type")||"",u=n.default.hex_md5("e10adc3949ba59abbe56e057f20f883e"+i),h=(a.getQueryString("house_channel"),a.getQueryString("m"),{house_id:i,city:r,house_type:c,token:u});o.default.get({url:"https://newrent.house365.com/api/app/vr-house-info-new",data:h}).then(function(i){var n,o=null;200===i.status&&i.data&&1===i.data.code&&i.data.data?(o=l.replenishData(function(t,e){var i={};for(var n in e)switch(n){case"title":i.title=t.title;break;case"share":i.share=l.getTotalData(t.share_data,e.share);break;case"houseInfo":i.houseInfo=l.getTotalData(t,e.houseInfo);break;case"brokerInfo":i.brokerInfo=l.getTotalData(t.middle_person,e.brokerInfo);break;case"redPacket":i.redPacket=l.getTotalData(t.red_packet,e.redPacket);break;case"homeLink":i.homeLink=l.getTotalData(t,e.homeLink);break;case"panoramaLink":i.panoramaLink=l.getTotalData(t,e.panoramaLink);break;case"communityImages":i.communityImages=l.getTotalData(t,e.communityImages)}return i}(i.data.data,s),t),window.house365js||window.NativeClient||window.webkit&&(n=window.navigator.userAgent,/iPad|iPhone|iPod/.test(n))&&(window.webkit.messageHandlers&&window.webkit.messageHandlers.onHideTitleBar||window.webkit.messageHandlers.onClose)?o.platFormType="app":o.platFormType="web",e(o)):(o=l.replenishData(null,t),e(o))})}}},K7Pl:function(t,e){},K7Ql:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s(i("iitU")),o=s(i("syts")),r=s(i("5T7T")),a=s(i("7PBQ"));function s(t){return t&&t.__esModule?t:{default:t}}e.default={props:{},name:"house-component-container",data:function(){return{}},components:{houseInfo:n.default,smallBaiduMap:o.default,houseImgContainer:a.default,smallGoogleMap:r.default},computed:{isOpen:function(){return this.$store.state.houseInfoIsShow},houseInfoData:function(){return this.$store.state.houseInfo},isDragingMap:function(){return this.$store.state.isDragingMap}},created:function(){},mounted:function(){},methods:{closePanel:function(){this.isDragingMap||(this.statistic_utils.trackEvent(26),this.$store.dispatch("toggleHouseInfoPanel",!1))}}}},KI3t:function(t,e){},KOLw:function(t,e){},KcU2:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("6aHO"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("+bgK");var s=function(t){i("o86U")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-503f3ea6",null);e.default=l.exports},KiBx:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("Gl8h"),r=(n=o)&&n.__esModule?n:{default:n};e.default={components:{},props:{modelSettings:Object},name:"mobile-floor-plan",data:function(){return{locationgPointIcon:r.default}},computed:{currentFloorPlanData:function(){return this.$store.state.currentFloorPlanData},currentRoomList:function(){return this.$store.state.currentRoomList},whData:function(){return this.$store.state.currrentFloorPlanWidthHeightData},entranceData:function(){return this.$store.state.entranceData},radarData:function(){return this.$store.state.radarData},currentCompass:function(){var t=void 0,e={up:"",down:""};return t=this.modelSettings.basic.menu&&this.modelSettings.basic.menu.orientation_correct?this.modelSettings.basic.menu.orientation_correct:0,(t%=360)>=337.5||t<22.5?(e.up=this.$t("direction_n_text"),e.down=this.$t("direction_s_text")):t>=22.5&&t<67.5?(e.up=this.$t("direction_w_n_text"),e.down=this.$t("direction_e_s_text")):t>=67.5&&t<112.5?(e.up=this.$t("direction_w_text"),e.down=this.$t("direction_e_text")):t>=112.5&&t<157.5?(e.up=this.$t("direction_w_s_text"),e.down=this.$t("direction_e_n_text")):t>=157.5&&t<202.5?(e.up=this.$t("direction_s_text"),e.down=this.$t("direction_n_text")):t>=202.5&&t<247.5?(e.up=this.$t("direction_e_s_text"),e.down=this.$t("direction_w_n_text")):t>=247.5&&t<292.5?(e.up=this.$t("direction_e_text"),e.down=this.$t("direction_w_text")):t>=292.5&&t<337.5&&(e.up=this.$t("direction_e_n_text"),e.down=this.$t("direction_w_s_text")),e}},created:function(){},mounted:function(){this.modelSettings.basic.menu&&this.modelSettings.basic.menu.orientation_correct&&this.modelSettings.basic.menu.orientation_correct},methods:{}}},Kil6:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("cVOK"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("7YRv");var s=function(t){i("oV97")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-236e41d2",null);e.default=l.exports},L0sV:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.selfOpen?i("div",{staticClass:"reward-panel-container"},[i("img",{staticClass:"hongbao-open-btn",attrs:{src:t.rewardpic,alt:""},on:{click:t.openRewardPanel}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.hasRewardCover,expression:"hasRewardCover"}],staticClass:"hongbao-cover"},[t._v("\n         "+t._s(t.totalTime+t.$t("red_packet"))+"\n     ")]),t._v(" "),i("div",{staticClass:"hongbao-close-btn",on:{click:t.closeRewardPanel}})]):t._e()},staticRenderFns:[]};e.a=n},LCqT:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i("v2ns");var n=i("7QTg");e.default={props:{},name:"pc-scene-panel",components:{swiper:n.swiper,swiperSlide:n.swiperSlide},data:function(){return{swiperOption:{slidesPerView:4,spaceBetween:15,grabCursor:!0,scrollbar:{el:".swiper-scrollbar",draggable:!0,dragSize:"auto"},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}}}},created:function(){},computed:{sceneIsActive:function(){return this.$store.state.sceneIsActive},sceneList:function(){return this.$store.state.sceneList},currentSceneIndex:function(){return this.$store.state.currentSceneIndex},swiper:function(){return this.$refs.swiper.swiper}},watch:{currentSceneIndex:function(t,e){var i=this;if(this.sceneIsActive){var n="sceneItem"+t;this.$nextTick(function(){i.$refs[n][0].scrollIntoView&&i.$refs[n][0].scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),i.$refs[n][0].scrollIntoViewIfNeeded&&i.$refs[n][0].scrollIntoViewIfNeeded(!0),i.swiper.slideTo(e)})}}},mounted:function(){},methods:{showScenePanelList:function(){this.$store.dispatch("changeSceneStatus",!this.sceneIsActive)},closeScenePanelList:function(){this.$store.dispatch("changeSceneStatus",!1)},selectSceneItem:function(t){if("scene-item"===t.target.className&&t.target.dataset.index&&t.target.dataset.index!==this.currentSceneIndex){var e=parseInt(t.target.dataset.index);this.$store.dispatch("changeCurrentSceneIndex",e)}},selectSceneItem1:function(t){t=parseInt(t),this.swiper.slideTo(t),this.$store.dispatch("changeCurrentSceneIndex",t)},updateSceneItem:function(){}}}},LOM4:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mobile-bottom-container",class:{"has-take-look":t.hasTakeLook}},[t.houseInfoData.brokerInfo&&t.houseInfoData.brokerInfo.enable&&t.MiddleManState?i("middle-man"):t._e(),t._v(" "),t.MultipleMeasureState||t.MultipleTagState||t.MultipleHelpState||t.MultipleVrState?i("tool-component"):t._e(),t._v(" "),t.hasTakeLook?i("take-look"):t._e(),t._v(" "),49==t.companyId&&t.houseInfoData.miniChat&&t.houseInfoData.miniChat.enable?i("mini-chat"):t._e()],1)},staticRenderFns:[]};e.a=n},LRwE:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"midddle-man",data:function(){return{}},created:function(){},mounted:function(){},methods:{}}},LT4C:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("2Uyi"),o=i("nh8I"),r=i("w1BD"),a=(i("ynQN").getStyle(),i("hU7x"));e.default={load:function(t,e){var i=n.getQueryString("roomCode"),s=n.getQueryString("cameramanAccount"),l=n.getQueryString("m");a("https://saasjump.qfang.com/openApi/query/modelViewInfo/jsonp/ZHONGQU/?mid="+l+"&cameramanAccount="+s+"&roomCode="+i,{prefix:"callback",name:"callback"},function(i,n){var a=null;if(i||"V000"!==n.code)a=r.replenishData(null,t),e(a,t);else{if((a=r.replenishData(function(t,e){var i={};for(var n in e)switch(n){case"title":i.title=t.title;break;case"houseInfo":i.houseInfo=r.getTotalData(t,e.houseInfo);break;case"brokerInfo":i.brokerInfo=r.getTotalData(t,e.brokerInfo)}return i}(n.content,o),t)).houseInfo&&a.houseInfo.list&&a.houseInfo.list.length>0)for(var s=0;s<a.houseInfo.list.length;s++)a.houseInfo.list[s].value||(a.houseInfo.list.splice(s,1),s-=1);e(a)}})}}},LTEq:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("0fFI"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("Vfjo");var s=function(t){i("ZHH0")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-075cf32c",null);e.default=l.exports},LUue:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("gkRR"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("TJc1");var s=function(t){i("CvAU")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-1d0d7979",null);e.default=l.exports},LnMS:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s(i("CiM1")),o=s(i("XkyW")),r=s(i("vGXP")),a=s(i("wNIl"));function s(t){return t&&t.__esModule?t:{default:t}}e.default={components:{PictureTag:n.default,AudioTag:o.default,VideoTag:r.default,IframeTag:a.default},props:{},name:"all-tag-container",data:function(){return{}},computed:{currentTagType:function(){return this.$store.state.currentTagType}},created:function(){},mounted:function(){},methods:{}}},LvHn:function(t,e){},M1wL:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"house-info",data:function(){return{companyId:this.$store.state.companyId,houseInfoData:this.$store.state.houseInfo}},computed:{},created:function(){},mounted:function(){},methods:{goHouseInfoDetails:function(){if(this.statistic_utils.trackEvent(36),this.houseInfoData.houseInfo&&this.houseInfoData.houseInfo.houseDetail)if(14===this.companyId){var t={open:this.houseInfoData.houseInfo.houseDetail,down:this.houseInfoData.houseInfo.downUrl},e=document.createElement("iframe"),i=document.body;e.style.cssText="display:none;width=0;height=0";var n=null;document.addEventListener("visibilitychange",function(t){(document.hidden||document.webkitHidden)&&clearTimeout(n)},!1),document.addEventListener("webkitvisibilitychange",function(t){(document.hidden||document.webkitHidden)&&clearTimeout(n)},!1),window.addEventListener("pagehide",function(t){clearTimeout(n)}),/MicroMessenger/gi.test(navigator.userAgent)?window.location.href=t.down:(i.appendChild(e),e.src=t.open,n=setTimeout(function(){window.location.href=t.down},3e3))}else window.location.href=this.houseInfoData.houseInfo.houseDetail}}}},M5RC:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tel-dialog-container"},[i("div",{staticClass:" tel-dialog-content"},[i("div",{staticClass:"tel-dialog-main"},[i("div",{staticClass:"tel-dialog-number"},[t._v("\n                "+t._s(t.telNumber)+"\n            ")]),t._v(" "),i("div",{staticClass:"tel-dialog-desc"},[t._v("\n                "+t._s(t.$t("mobile_contact_desc_text"))+"\n            ")])]),t._v(" "),i("div",{staticClass:"tel-dialog-footer"},[i("div",{staticClass:"footer-cancel footer-item",on:{click:t.cancelCall}},[t._v("\n                "+t._s(t.$t("mobile_contact_cancel_text"))+"\n            ")]),t._v(" "),i("div",{staticClass:"footer-confirm footer-item",on:{click:t.goCall}},[t._v("\n                "+t._s(t.$t("mobile_contact_call_text"))+"\n            ")])])])])},staticRenderFns:[]};e.a=n},M77R:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.floorPlanImageUrl?i("div",{staticClass:"mini-floor-plan-container"},[i("div",{staticClass:"floor-plan-content",on:{click:function(e){return t.changeMode("floorplan")}}},[i("div",{staticClass:"floor-plan-area",domProps:{innerHTML:t._s(t.currentArea)}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.floorPlanImageUrl,expression:"floorPlanImageUrl"}],staticClass:"floor-plan-compass"},[i("span",{staticClass:"floor-plan-compass-text"},[t._v("\n                "+t._s(this.currentCompass.up)+"\n            ")]),t._v(" "),i("i",{staticClass:"floor-plan-compass-arrow"})]),t._v(" "),i("div",{staticClass:"floor-plan-img-container"},[i("img",{staticClass:"floor-plan-img",style:{width:t.miniFloorPlanWidth,height:t.miniFloorPlanHeight},attrs:{src:t.floorPlanImageUrl,alt:""}}),t._v(" "),i("img",{directives:[{name:"show",rawName:"v-show",value:t.floorPlanImageUrl,expression:"floorPlanImageUrl"}],staticClass:"locating-point",style:{left:"calc("+t.currentPosition.x+" - 0.11rem)",top:"calc("+t.currentPosition.y+" - 0.11rem)",transform:"rotate("+t.currentAngle+"deg)",transition:"left "+t.currentPosition.time/1e3+"s ease,top "+t.currentPosition.time/1e3+"s ease"},attrs:{src:t.locationgPointIcon,alt:""}})])])]):t._e()},staticRenderFns:[]};e.a=n},M93x:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("xJD8"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("yJN4");var s=function(t){i("7qWM")},l=i("VU/8")(o.a,a.a,!1,s,null,null);e.default=l.exports},MKGR:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s(i("hJgp")),o=s(i("TM4O")),r=s(i("j+vV")),a=s(i("eNGq"));function s(t){return t&&t.__esModule?t:{default:t}}e.default={components:{MiddleMan:n.default,multipleFun:o.default,shareFull:r.default,fullScreen:a.default},props:{},name:"pc-switch",data:function(){return{isShowMiddleMan:!0,isShowLecture:!0,isShowShareFull:!0,isTooLang:!1}},computed:{houseInfoData:function(){return this.$store.state.houseInfo},toolsListIsShow:function(){return this.$store.state.titleIsShow},companyId:function(){return this.$store.state.companyId},MiddleManState:function(){return this.$store.state.MiddleManState},ShareFullState:function(){return this.$store.state.ShareFullState},FullScreenState:function(){return this.$store.state.FullScreenState},MultipleMeasureState:function(){return this.$store.state.MultipleMeasureState},MultipleTagState:function(){return this.$store.state.MultipleTagState},MultipleHelpState:function(){return this.$store.state.MultipleHelpState}},created:function(){},mounted:function(){this.judgeLength()},methods:{judgeLength:function(){window.location.href.length>145?this.isTooLang=!0:this.isTooLang=!1}}}},MmMS:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("MJLE"),r=(n=o)&&n.__esModule?n:{default:n};e.default={props:{componentParams:{type:String}},name:"pc-share-panel",data:function(){return{measureIsActive:!0,tagIsActive:!0,vrIsActive:!0,helpIsActive:!0,wechatQrcode:""}},computed:{MultipleMeasureState:function(){return this.$store.state.MultipleMeasureState},MultipleTagState:function(){return this.$store.state.MultipleTagState},MultipleHelpState:function(){return this.$store.state.MultipleHelpState}},created:function(){},mounted:function(){this.$nextTick(function(){this.bindQRCode()})},methods:{bindQRCode:function(){new r.default(this.$refs.qrCodeDiv,{text:window.location.href,width:90,height:90,colorDark:"#000000",colorLight:"#ffffff",correctLevel:r.default.CorrectLevel.L})}}}},MuF7:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("/fLj"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("FBD6");var s=function(t){i("Q+ST")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-75ca92b1",null);e.default=l.exports},MvI0:function(t,e){t.exports={defaultTitle:"3D看房",panoramaText:"全景",dollhouseText:"3D模型",floorplanText:"户型图",sceneText:"导览",lectureText:"讲房",playText:"播放",pauseText:"暂停",middleManTitle:"经纪人",takeLookText:"VR带看",miniChatText:"微聊",toolsText:"工具",measureText:"标尺",tagText:"标签",vrText:"VR",helpText:"帮助",wechatTipTitle:"微信扫一扫",wechatTipDesc:"快分享给朋友吧!",disclaimerBtnText:"免责声明",houseInfoTitle:"房源信息",houseInfoMoreBtnText:"查看更多信息",goAerialUrl:"查看航拍",lookMapMore:"查看小区及周边",vrTipTitle:"vr模式",vrTipDesc1:"1.请将手机解锁自动旋转后放入VR眼镜中",vrTipDesc2:"2.将视野中白色圆点瞄准蓝色方块后即可前进",helpTipTitle:"帮助",helpTipWalk:"点击行走",helpTipSlide:"滑动转向",helpTipMagnify:"两指放大",helpTipShrink:"两指缩小",telText:"电话",wifiTipText:"推荐在WIFI环境下观看",look3DDesc:"3D模型",direction_s_text:"南",direction_n_text:"北",direction_w_text:"西",direction_e_text:"东",direction_e_n_text:"东北",direction_e_s_text:"东南",direction_w_n_text:"西北",direction_w_s_text:"西南",approximate_text:"约",unit_text:"m",double_unit_text:"m²",entry_text:"入口",floorLevel:"层",floorAll:"整体",mobile_num_not_empty:"电话号码不能为空",middle_verify_input_incorrect_format:"格式有误，请重新输入",mobile_num_not_match:"号码不匹配，请重新输入！",middle_verify_input_title:"输入号码",middle_verify_input_lable:"电话:",middle_verify_input_placeholder:"请输入电话号码",middle_verify_confirm_text:"确认",middle_verify_cancel_text:"取消",middle_verify_open_text:"打开",middle_verify_generate_link_title:"生成链接",middle_verify_tip_title:"提示",middle_verify_tip_modify_text:"返回修改",middle_verify_copy_success_tip:"链接已经复制到剪贴板",middle_verify_copy_text:"复制",middle_verify_tip_content:"您输入的电话'number'不在白名单内请联系管理人员添加到白名单中！",middle_verify_correct_tip:"请输入正确的手机号",tagLookDetails:"查看详情",mobile_contact_desc_text:"(部分号码需要手动拨打分机号)",mobile_contact_cancel_text:"取消",mobile_contact_call_text:"拨打",has_not_phone_tip:"尚未提供电话",slide_verify_desc:" 向右拖动滑块填充拼图",slide_verify_success:"验证通过",take_look_end_text:" 结束",red_packet:"秒后可拆"}},MxLZ:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"middle-man-container"},[i("div",{directives:[{name:"longpress",rawName:"v-longpress",value:t.openMiddlemanTranspond,expression:"openMiddlemanTranspond"}],staticClass:"middle-man-avatar",style:{backgroundImage:"url("+(t.brokerImage||t.defaultBg)+")"}}),t._v(" "),i("div",{staticClass:"middle-man-tel-box",on:{click:t.showTelDialog}},[i("i",{staticClass:"middle-man-tel-icon"}),t._v(" "),i("span",{staticClass:"middle-man-tel-text"},[t._v("\n            "+t._s(t.$t("telText"))+"\n        ")])])])},staticRenderFns:[]};e.a=n},N1bY:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i("3F2w")),r=i("awxD");(n=r)&&n.__esModule;window.G={},window.TWEEN=o.default,G.conf={isNewServerPreviewVersion:!1,isNewEditVersion:!1,isCleanUI:0,jfedit:!1,screenshot:!1};var a=i("HLxu").HousePlay,s=i("HLxu").Config,l=null;e.default={props:{componentParams:{type:Object}},name:"house-play",data:function(){return{currentSceneIndex:"",currentLectureIndex:"",currentFloorIndex:"",SpeakHouseState:""}},computed:{getGoMode:function(){return this.$store.state.goMode},getCurrentMeasureStatus:function(){return this.$store.state.measureIsActive},getTagIsUsed:function(){return this.$store.state.tagIsUsed},getCurrentTagStatus:function(){return this.$store.state.tagIsActive},VRState:function(){return this.$store.state.isLandscape&&this.$store.state.vrTipIsShow},getCurrentFloorIndex:function(){return this.$store.state.currentFloorIndex},getCurrentSceneIndex:function(){return this.$store.state.currentSceneIndex},getSceneIsActive:function(){return this.$store.state.sceneIsActive},getCurrentLectureIndex:function(){return this.$store.state.currentLectureIndex},getLectureIsActive:function(){return this.$store.state.lectureIsActive},getTakeLookActionState:function(){return this.$store.state.takeLookActionState},getTakeLookOperation:function(){return this.$store.state.getTakeLookOperation}},watch:{getGoMode:function(t,e){t&&"transitioning"!==this.$store.state.currentMode&&t!==this.$store.state.currentMode&&(this.$store.dispatch("goMode",""),l.changeMode(t))},getCurrentMeasureStatus:function(t,e){switch(t){case!0:"panorama"===this.$store.state.currentMode&&l.enablePanramaSize();break;case!1:"panorama"===this.$store.state.currentMode&&l.disablePanramaSize()}},getTagIsUsed:function(t,e){switch(t){case!0:l.enableTag();break;case!1:l.disableTag()}},VRState:function(t,e){switch(t){case!0:l.enterVR(),this.$store.dispatch("changeVrStatus",!0);break;case!1:l.exitVR(),this.$store.dispatch("changeVrStatus",!1)}},getCurrentFloorIndex:function(t,e){t!==this.currentFloorIndex&&(this.currentFloorIndex=t,l.gotoFloor(t))},getCurrentSceneIndex:function(t,e){t===this.currentSceneIndex&&this.getSceneIsActive||e&&l.gotoScenebyId(t)},getSceneIsActive:function(t,e){switch(t){case!0:l.play();break;case!1:l.pause(),this.getCurrentMeasureStatus&&l.enablePanramaSize()}},getCurrentLectureIndex:function(t,e){""!==e&&(t===this.currentLectureIndex&&this.getLectureIsActive||(0===t||t)&&l.play(t))},getLectureIsActive:function(t,e){switch(t){case!0:l.play();break;case!1:l.pause(),this.getCurrentMeasureStatus&&l.enablePanramaSize()}},getTakeLookActionState:function(t,e){switch(t){case 1:l.startTakeLook(),this.$store.dispatch("changeTakeLookActionState","");break;case 2:l.takeLookCall();break;case 3:l.hangupTakeLook()}},getTakeLookOperation:function(t,e){t&&l.sendUIOperation(t)}},created:function(){this.SpeakHouseState=this.$store.state.SpeakHouseState},mounted:function(){this.initHousePlay(this.componentParams)},methods:{initHousePlay:function(t){var e=this;(l=new a(t)).on("endLoading",function(t){}),l.on("enterPoint",function(t){}),l.on("initLoading",function(){}),l.on("load_progress",function(t){t=Math.max(Math.min(t,100),0);var i=Math.floor(t);e.$store.dispatch("changeLoadingProgress",i);100===i&&setTimeout(function(){e.$store.dispatch("changeEnterPageStatus",!0),null,e.componentParams.settings.jf&&e.componentParams.settings.jf.enable&&e.componentParams.settings.jf.dataset.length&&e.SpeakHouseState&&"1"===e.CommonUtil.getQueryString("lecture")&&e.$store.dispatch("changeLectureStatus",!0)},200)}),l.on("init_UI",function(t){var i=t.getCurrentHouseTypeImage();i&&e.$store.dispatch("changeFloorPlanImageUrl",i),e.$store.dispatch("changeFloorPlanImageStatus",!0),e.initFloorData(t),t.settings.jf&&t.settings.jf.enable&&t.settings.jf.dataset.length?e.initLectureData(t):e.initSceneData(t)}),l.on("highLightsBarChange",function(t,e){}),l.on("stopTour",function(){e.$store.dispatch("changeSceneStatus",!1)}),l.on("updateTour",function(t){e.getSceneIsActive&&(e.currentSceneIndex=t.destinationItem,e.$store.dispatch("changeCurrentSceneIndex",t.destinationItem))}),l.on("panoChosen",function(t){}),l.on("flyingEnd",function(t){e.updateDirection(t.pano,null)}),l.on("lecture",function(t){switch(t){case"stop":e.$store.dispatch("changeLectureStatus",!1)}}),l.on("lectureUpdate",function(t,i){e.currentLectureIndex=t,e.$store.dispatch("changeCurrentLectureIndex",t),e.$store.dispatch("changeCurrentLecturePercent",i)}),l.on("lecutreUI",function(t,e){}),l.on("modeChange",function(t,i){var n;switch(e.$store.dispatch("changeMode",i),"panorama"!==i&&"floorplan"!==i||(n=l.getFloorPlanParam()),i){case"panorama":n.model.getCurrentHouseTypeImage()&&e.$store.dispatch("changeFloorPlanImageUrl",n.model.getCurrentHouseTypeImage()),e.getCurrentMeasureStatus&&l.enablePanramaSize();break;case"floorplan":e.updateFloorPlan(n,1)}}),l.on("panoChange",function(t){e.updateDirection(t.pano,t.time)}),l.on("spinner",function(t){}),l.on("floorChange",function(t){e.updateFloorPlan(t,1),"panorama"===t.mode&&t.imageUrl&&e.$store.dispatch("changeFloorPlanImageUrl",t.imageUrl)}),l.on("move",function(t){e.clearMode()}),l.on("compass",function(t){e.$store.dispatch("changeCurrentAngleValue",-t.director)}),l.on("updatePanoSize",function(t,i,n){switch(t){case"left":e.$store.dispatch("changePanoSizeLeftIsShow",i),e.$store.dispatch("changePanoSizeLeftData",n);break;case"height":e.$store.dispatch("changePanoSizeHeightIsShow",i),e.$store.dispatch("changePanoSizeHeightData",n);break;case"right":e.$store.dispatch("changePanoSizeRightIsShow",i),e.$store.dispatch("changePanoSizeRightData",n)}}),l.on("tag.active",function(t){e.showTag(t)}),l.on("tag.dismiss",function(t){e.hideTag(t)}),l.on("connect_call_success",function(){e.$store.dispatch("changeTakeLookStatus",!0),e.$store.dispatch("changeTakeLookChatState",1)}),l.on("connect_init_done",function(){}),l.on("connect_calling",function(){e.$store.dispatch("changeTakeLookStatus",!0),e.$store.dispatch("changeTakeLookChatState",2)}),l.on("connect_calling_left_time",function(t){e.$store.dispatch("changeTakeLookCallingLeftTime",t)}),l.on("connect_call_again",function(){e.$store.dispatch("changeTakeLookChatState",3)}),l.on("connect_close",function(){e.$store.dispatch("changeTakeLookChatState",4)}),l.on("connect_call_refuse",function(){e.$store.dispatch("changeTakeLookChatState",4),e.$store.dispatch("changeTakeLookTip","对方已拒接")}),l.on("connect_remote_operate_busy",function(){e.$store.dispatch("changeTakeLookTip","对方正在操作请稍后再试")}),l.on("connect_busyline",function(){e.$store.dispatch("changeTakeLookChatState",4),e.$store.dispatch("changeTakeLookTip","经纪人占线中")}),l.on("connect_identity_update",function(t){e.initTakeLook(t)}),l.on("connect_ui_operation",function(t){"UI"===t.type&&("houseInfo"===t.target?this.$store.dispatch("toggleHouseInfoPanel",t.action):"shareComponent"===acton.target?this.$store.dispatch("changeShareComponentStatus",t.action):"floorBar"===acton.target?this.$store.dispatch("changeCurrentFloorIndex",t.action):"bigMap"===t.target?this.$store.dispatch("toggleBigMapStatus",t.action):"disclaimer"===t.target&&this.$store.dispatch("toggleDisclaimerContent",t.action))}),"on"===this.CommonUtil.getQueryString("takelook")?l.start("guid"):l.start()},updateDirection:function(t,e){if(t){if(t.areaName){var i=t.areaName;if(t.areaSize&&this.componentParams&&this.componentParams.settings&&this.componentParams.settings.basic&&this.componentParams.settings.basic.menu&&this.componentParams.settings.basic.menu.floorplan_enable)i+="&nbsp&nbsp"+this.$t("approximate_text")+(t.areaSize*s.unit_conversion_value*s.unit_conversion_value).toFixed(1)+s.unit_sq_name;this.$store.dispatch("changeCurrentArea",i)}if(t.u&&t.v){var n={x:100*t.u+"%",y:100*t.v+"%",time:e};this.$store.dispatch("changeCurrentPosition",n)}}},updateFloorPlan:function(t,e){if(1===e){var i=(x=t.model).getCurrentHouseTypeImage(),n=t.floorIndex,o={imageUrl:i,width:(_=t.project).width,height:_.height,top:_.top,left:_.left};this.$store.dispatch("changeFloorPlanData",o),this.currentFloorIndex=n,this.$store.dispatch("changeCurrentFloorIndex",n);var r=null;if(x.entrance)r=this.getEntrance(x.entrance.screen);var a=x.currentFloor.floorIndex,l=this.getRoomName(a,x,_);if(this.$store.dispatch("changeCurrentRoomList",l),!1!==x.floorplan_enable&&i){var c=_.top+_.height+30,u=_.left,h=_.width,d=_.height,p={wData:{wDataTop:c,wDataLeft:u,width:h,height:d,wDataText:this.$t("approximate_text")+(x.size.x*s.unit_conversion_value).toFixed(1)+s.unit_name},hData:{hDataTop:_.top,hDataLeft:_.left-30,width:h,height:d,hDataText:this.$t("approximate_text")+(x.size.z*s.unit_conversion_value).toFixed(1)+s.unit_name}};this.$store.dispatch("changeCurrentFloorPlanWidthHeight",p)}if(r){var f=_.top+r.ep.y*_.height-r.deviationTop,m=_.left+r.ep.x*_.width-r.deviationLeft,g=r.angle.toFixed(2),v=!0;a!==x.settings.building.house.flooridx&&(v=!1);var y={isShow:v,top:f,left:m,angle:g};this.$store.dispatch("changeEntranceData",y)}var b=t.radar;if(b){var w={top:_.top+_.height*b.uv.v,left:_.left+_.width*b.uv.u,angle:-b.angle,isShow:!0};this.$store.dispatch("changeRadarData",w)}}else if(2===e){var x=t.model,_=(i=t.imageUrl,n=t.floorIndex,t.project);if(i){o={imageUrl:i,width:_.width,height:_.height,top:_.top,left:_.left};this.$store.dispatch("changeFloorPlanData",o)}var S=x.currentFloor.floorIndex,T=this.getRoomName(S,x,_);this.$store.dispatch("changeCurrentRoomList",T),this.currentFloorIndex=n,this.$store.dispatch("changeCurrentFloorIndex",n);var M=null;if(x.entrance)M=this.getEntrance(x.entrance.screen);if(M){var I=_.top+M.ep.y*_.height-M.deviationTop,P=_.left+M.ep.x*_.width-M.deviationLeft,C=M.angle.toFixed(2),A=!0;S!==x.settings.building.house.flooridx&&(A=!1);var E={isShow:A,top:I,left:P,angle:C};this.$store.dispatch("changeEntranceData",E)}}},subVectors:function(t,e){var i={x:"",y:"",length:""};return i.x=t.x-e.x,i.y=t.y-e.y,i.length=Math.sqrt(i.x*i.x+i.y*i.y),i},getEntrance:function(t){var e=t.ep,i=t.sp,n=null,o=this.subVectors(e,i),r=o.length,a=Math.acos(o.x/r);o.y<0&&(a*=-1);var s=180*a/Math.PI,l=0,c=7*window.devicePixelRatio;s>-45&&s<45?(n="left",l=42*window.devicePixelRatio,c=7*window.devicePixelRatio):s>=45&&s<=135?(l=21*window.devicePixelRatio,c=21*window.devicePixelRatio):s>=-135&&s<=-45&&(l=21*window.devicePixelRatio,c=-14*window.devicePixelRatio);var u={};return u.deviationLeft=l,u.deviationTop=c,u.state=n,u.angle=s,u.ep=e,u},getRoomName:function(t,e,i){var n=[];return e.buildFloors.floors&&e.buildFloors.floors[t]?e.buildFloors.floors[t].roomidxs.forEach(function(t){for(var o=e.settings.building.rooms,r=0;r<o.length;r++)if(o[r].roomidx===t){var a=i.top+i.height*o[r].ny,s=i.left+i.width*o[r].nx;n.push({top:a,left:s,roomname:o[r].roomname})}}):e.rooms_real&&e.rooms_real.forEach(function(t){var e=i.top+i.height*t.ny,o=i.left+i.width*t.nx;n.push({top:e,left:o,roomname:t.roomname})}),n},initFloorData:function(t){if(t.floors&&t.floors.length>1){this.$store.dispatch("judgeIsMultiLayer",!0);for(var e=[],i=0;i<t.floors.length;i++){var n=void 0;t.buildFloors.floors&&t.buildFloors.floors[i]&&t.buildFloors.floors[i].name?n=t.buildFloors.floors[i].name:(n=t.floors.get(i).name,"zh"===this.$i18n.locale?n+=this.$t("floorLevel"):n=this.$t("floorLevel")+n),e.push({floorIndex:i,floorName:n})}this.$store.dispatch("changeFloorList",e)}else this.$store.dispatch("judgeIsMultiLayer",!1)},initSceneData:function(t){var e=t.heroLocations,i=[];if(0===e.length)return i;for(var n=0;n<e.length;n++){var o=e[n];o.name&&"总述"!==o.name&&1!==o.script&&i.push({name:o.name,index:n})}this.$store.dispatch("initSceneList",i)},initLectureData:function(t){this.$store.dispatch("initLectureList",t.settings.jf.dataset)},showTag:function(t){"hover"!==t.mode&&(t.detail.tagId=t.tagId,"TextAudio"===t.detail.type&&t.detail.imageurl&&(t.type="ImageText"),"click"===t.mode&&"TextAudio"===t.detail.type&&this.$store.state.currentTagData&&this.$store.state.currentTagData.tagId&&this.$store.state.currentTagData.tagId===t.detail.tagId&&this.$store.state.tagIsActive&&!0===this.$store.state.audioStatus?this.$store.dispatch("changeAudioStatus",!1):this.$store.dispatch("changeAudioStatus",!0),this.$store.dispatch("changeTagStatus",!0),this.$store.dispatch("changeCurrentTagType",t.type),this.$store.dispatch("changeCurrentTagData",t.detail))},hideTag:function(t){},clearMode:function(){this.$store.state.houseInfoIsShow&&this.$store.dispatch("toggleHouseInfoPanel",!1),this.$store.state.toolsListIsShow&&this.$store.dispatch("toggleToolsList",!1),this.$store.state.tagIsActive&&this.$store.dispatch("changeTagStatus",!1)},initTakeLook:function(t){this.$store.dispatch("initTakeLookRole",t.identity),this.$store.dispatch("changeTakeLookInfo",t),this.$store.dispatch("changeTakeLookInfoStateIsUpdate",!0)}}}},NE2i:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},components:{},name:"big-google-map",data:function(){return{}},computed:{houseInfoData:function(){return this.$store.state.houseInfo},getGoogleMapLoadStatus:function(){return this.$store.state.googleMapLoadStatus}},created:function(){},mounted:function(){google&&this.mapInit()},watch:{getGoogleMapLoadStatus:function(t,e){t&&this.mapInit()}},methods:{mapInit:function(){var t={zoom:15,center:{lat:Number(this.houseInfoData.houseInfo.map.lat),lng:Number(this.houseInfoData.houseInfo.map.lon)},mapTypeId:"roadmap"},e=new google.maps.Map(document.getElementById("big-mobile-google-map"),t);new google.maps.Marker({position:t.center,map:e,animation:google.maps.Animation.BOUNCE})},closeBigMapContent:function(){this.statistic_utils.trackEvent(77),this.$store.dispatch("toggleBigMapStatus",!1)}}}},NHnr:function(t,e,i){"use strict";var n=g(i("5dBV")),o=g(i("gBtx"));i("9mmO"),i("52Wt"),i("TFWu"),i("MyjO"),i("qtRy"),i("THnP"),i("K0JP"),i("NfZy"),i("dTzs"),i("+vXH"),i("MsuQ"),i("dSUw"),i("ZDXm"),i("V/H1"),i("CVR+"),i("vmSu"),i("4ZU1"),i("yx1U"),i("SPtU"),i("A52B"),i("PuTd"),i("dm+7"),i("JG34"),i("Rw4K"),i("9mGU"),i("bUY0"),i("mTp7"),i("y9m4"),i("A0n/"),i("VTn2"),i("W/IU"),i("Y5ex"),i("WpPb"),i("+yjc"),i("gPva"),i("C+4B"),i("W4Z6"),i("tJwI"),i("eC2H"),i("n12u"),i("nRs1"),i("jrHM"),i("EuXz"),i("F3sI"),i("bqOW"),i("Racj"),i("tqSY"),i("CvWX"),i("Y1S0"),i("Gh7F"),i("pd+2"),i("MfeA"),i("VjuZ"),i("mJx5"),i("qwQ3"),i("beEN"),i("xMpm"),i("9vc3"),i("WpTh"),i("U6qc"),i("No4x"),i("WgSQ"),i("yuXV"),i("XtiL"),i("A1ng"),i("LG56"),i("Stuz"),i("aJ2J"),i("WiIn"),i("v2lb"),i("7Jvp"),i("lyhN"),i("kBOG"),i("xONB"),i("LlNE"),i("9xIj"),i("m6Yj"),i("wrs0"),i("Lqg1"),i("pWGb"),i("1ip3"),i("N4KQ"),i("Hl+4"),i("MjHD"),i("SRCy"),i("H0mh"),i("gbyG"),i("YVn/"),i("FKfb"),i("zmx7"),i("smQ+"),i("m8F4"),i("v8VU"),i("dich"),i("fx22"),i("SldL");var r=g(i("hKoQ")),a=g(i("7+uW")),s=g(i("M93x")),l=g(i("YaEn")),c=g(i("mWYR")),u=(g(i("3pLw")),g(i("2Uyi")));i("E82V");var h=g(i("lTH1")),d=g(i("8R19")),p=g(i("IcnI")),f=g(i("wPdZ")),m=g(i("wvfG"));function g(t){return t&&t.__esModule?t:{default:t}}void 0===o.default&&(Number.parseInt=window.parseInt),void 0===n.default&&(Number.parseFloat=window.parseFloat),r.default.polyfill(),a.default.use(m.default),a.default.prototype.statistic_utils=f.default,a.default.prototype.urlBase=h.default,a.default.prototype.urlConfig=d.default,a.default.prototype.CommonUtil=u.default,a.default.config.productionTip=!1,a.default.directive("longpress",{bind:function(t,e,i){if("function"!=typeof e.value){var n=i.context.name;e.expression;n&&"Found in component '"+n+"' "}var o=null,r=function(t){"click"===t.type&&0!==t.button||null===o&&(o=setTimeout(function(){s()},2500))},a=function(t){null!==o&&(clearTimeout(o),o=null)},s=function(t){e.value(t)};t.addEventListener("mousedown",r),t.addEventListener("touchstart",r),t.addEventListener("click",a),t.addEventListener("mouseout",a),t.addEventListener("touchend",a),t.addEventListener("touchcancel",a),t.addEventListener("contextmenu",function(t){t.preventDefault()})}}),new a.default({el:"#app",router:l.default,i18n:c.default,store:p.default,components:{App:s.default},template:"<App/>"})},NSWm:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"small-map-container"},[i("baidu-map",{staticClass:"map",style:{width:t.map.width,height:t.map.height},attrs:{ak:"UYtXGSLnxZGtjQ0rj58LWvTFivB4aHIF",zoom:15,center:{lng:t.houseInfoData.houseInfo.map.lon,lat:t.houseInfoData.houseInfo.map.lat},"scroll-wheel-zoom":!1,dragging:!1}},[i("bm-marker",{attrs:{position:{lng:t.houseInfoData.houseInfo.map.lon,lat:t.houseInfoData.houseInfo.map.lat}}})],1),t._v(" "),i("div",{staticClass:"small-baidu-map-footer",on:{click:t.showBigMap}},[i("span",{staticClass:"small-baidu-map-footer-text"},[t._v(t._s(t.$t("lookMapMore")))]),t._v(" "),i("i",{staticClass:"small-baidu-map-footer-icon"})])],1)},staticRenderFns:[]};e.a=n},NZKl:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s(i("LUue")),o=s(i("NuEN")),r=s(i("iROj")),a=s(i("DJny"));function s(t){return t&&t.__esModule?t:{default:t}}e.default={components:{MiddleMan:n.default,ToolComponent:o.default,TakeLook:r.default,MiniChat:a.default},props:{},name:"mobile-bottom",data:function(){return{hasTakeLook:!1}},computed:{houseInfoData:function(){return this.$store.state.houseInfo},companyId:function(){return this.$store.state.companyId},MiddleManState:function(){return this.$store.state.MiddleManState},MultipleMeasureState:function(){return this.$store.state.MultipleMeasureState},MultipleTagState:function(){return this.$store.state.MultipleTagState},MultipleHelpState:function(){return this.$store.state.MultipleHelpState},MultipleVrState:function(){return this.$store.state.MultipleVrState}},created:function(){"on"===this.CommonUtil.getQueryString("showtakelook")?this.hasTakeLook=!0:this.hasTakeLook=!1},mounted:function(){},methods:{}}},NjpR:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("qcWP"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("XRKD");var s=function(t){i("IGLE")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-1b57b3fb",null);e.default=l.exports},NuEN:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("SgUQ"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("sskn");var s=function(t){i("Y/CI")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-23bc0065",null);e.default=l.exports},Nul3:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("3sn9"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("yYZK");var s=function(t){i("Ipmm")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-6ac7ddd3",null);e.default=l.exports},OJnf:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("e8WS"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("1Caf");var s=function(t){i("+3NN")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-4490ca45",null);e.default=l.exports},OMII:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"big-map-container",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeBigMapContent(e)},touchmove:function(t){t.preventDefault()},scroll:function(t){t.preventDefault()},mousewheel:function(t){t.preventDefault()}}},[i("div",{staticClass:"big-map-content"},[i("div",{staticClass:"big-map-close",on:{click:t.closeBigMapContent}}),t._v(" "),i("div",{staticClass:"big-google-map",attrs:{id:"big-google-map"}})])])},staticRenderFns:[]};e.a=n},ORrC:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i("v2ns");var n=i("7QTg");e.default={props:{componentParams:{type:String}},name:"pc-switch",components:{swiper:n.swiper,swiperSlide:n.swiperSlide},data:function(){return{swiperOption:{slidesPerView:4,spaceBetween:15,slideToClickedSlide:!0,scrollbar:{el:".swiper-scrollbar",draggable:!0,dragSize:80}}}},computed:{lectureIsActive:function(){return this.$store.state.lectureIsActive},lectureList:function(){return this.$store.state.lectureList},currentLectureIndex:function(){return this.$store.state.currentLectureIndex},currentLecturePercent:function(){return this.$store.state.currentLecturePercent}},watch:{currentLectureIndex:function(t,e){var i=this,n="lectureItem"+t;this.$nextTick(function(){i.$refs[n][0].scrollIntoView&&i.$refs[n][0].scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),i.$refs[n][0].scrollIntoViewIfNeeded&&i.$refs[n][0].scrollIntoViewIfNeeded(!0)})}},created:function(){},mounted:function(){},methods:{toggleLectureList:function(){this.$store.dispatch("changeLectureStatus",!this.$store.state.lectureIsActive)},selectLectureItem:function(t){t=parseInt(t),this.$store.dispatch("changeCurrentLectureIndex",t)}}}},Oe0U:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"vr-tip-container"},[i("div",{staticClass:"vr-tip-title"},[i("i",{staticClass:"vr-tip-title-icon",on:{click:t.closeVrTip}}),t._v(" "),i("span",{staticClass:"vr-tip-title-text"},[t._v(t._s(t.$t("vrTipTitle")))])]),t._v(" "),i("div",{staticClass:"vr-tip-enter",on:{click:t.enterVr}},[i("i",{staticClass:"vr-tip-enter-icon"})]),t._v(" "),i("div",{staticClass:"vr-tip-desc"},[i("i",{staticClass:"vr-tip-desc-item"},[t._v("\n             "+t._s(t.$t("vrTipDesc1"))+"\n        ")]),t._v(" "),i("i",{staticClass:"vr-tip-desc-item"},[t._v("\n             "+t._s(t.$t("vrTipDesc2"))+" \n        ")])])])},staticRenderFns:[]};e.a=n},On2s:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={components:{},props:{},name:"mobile-panorama-btn",data:function(){return{}},computed:{},created:function(){},mounted:function(){},methods:{changeMode:function(t){this.statistic_utils.trackEvent(3),this.$store.dispatch("goMode","panorama")}}}},OrYe:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("3pLw"),r=(n=o)&&n.__esModule?n:{default:n};var a=i("2Uyi"),s=i("8gmc"),l=i("w1BD"),c=(i("ynQN").getStyle(),a.isMobile()),u=a.getQueryString("isinapp"),h=a.getQueryString("hide400"),d=a.getQueryString("hideWeChat"),p=a.getQueryString("hideLook"),f=a.getQueryString("type");e.default={load:function(t,e){var i,n=a.getQueryString("adsno"),o=a.getQueryString("staffno"),m={adsno:n,staffno:o};if(!n){var g=l.replenishData(null,t);return g.brokerInfo.hideBrokerInfo=!0,g.showWechat=!1,g.showLook=!1,e(g,t),!1}r.default.get({url:"https://a.sh.centanet.com/api/VRPostInfoRequest",data:m}).then(function(n){if(200===n.status&&0===n.data.ResultNo){var r,a,m,g=n.data.Result,v=null;"S"===(i=g.PostType)?(i="sell",g.shareTitle="VR看房|"+g.RoomAndHall,g.shareDesc=g.RoomAndHall+"  "+g.Area+"                    总价  "+g.SalePrice):"R"===i?(i="rent",g.shareTitle="VR看房|"+g.RoomAndHall,g.shareDesc=g.RoomAndHall+"  "+g.Area+"                    租金  "+g.RentPrice):"XF"===i&&(i="xinfang",g.shareTitle="VR看房|"+g.EstateName,g.shareDesc=g.PropertyType+"  "+g.NewPropStatus+"                      均价  "+g.UnitPrice),g.title=g.EstateName+"     "+g.RoomAndHall,i&&(g.houseInfo_HouseType=i,v=function(t,e){var i={};for(var n in e)switch(n){case"title":i.title=t.title;break;case"share":i.share=l.getLinkData(t,e.share);break;case"houseInfo":i.houseInfo=l.generateHouseInfo(t,e.houseInfo);break;case"brokerInfo":i.brokerInfo=l.getbrokerInfo(t,e.brokerInfo);break;case"homeLink":i.homeLink=l.getLinkData(t,e.homeLink);break;case"panoramaLink":i.panoramaLink=l.getLinkData(t,e.panoramaLink);break;case"commonJsonData":i.commonJsonData=l.getHouseInfoJsonData(t,e.commonJsonData)}return i}(g,s),u&&o?(v.houseInfo.houseDetail="1"===u?g.WapUrl+"?utm_source=android":g.WapUrl+"?utm_source=ios","true"===d?v.showWechat=!1:(v.showWechat=!0,v.showWechatType=1),v.showLook="true"!==p):c?v.houseInfo.houseDetail=g.WapUrl+"?utm_source=wap":(v.houseInfo.houseDetail=g.PostUrl+"?utm_source=pc",v.brokerInfo.brokerStyle=2)),"true"===h&&(v.brokerInfo.hideBrokerInfo=!0),"wap"===f&&o&&c&&(v.showWechat=!0,v.showWechatType=2,"sell"===i?(r="ershoufang",a=g.SalePrice,m=g.EstateName+"Ď"+g.RoomAndHall+" "+g.Area+" "+g.SalePrice+"Ď"+g.StaffName+"Ď"+g.Staff400):"rent"===i?(r="zufang",a=g.RentPrice,m=g.EstateName+"Ď"+g.RoomAndHall+" "+g.Area+" "+g.RentPrice+"Ď"+g.StaffName+"Ď"+g.Staff400):"xinfang"===i&&(a=g.UnitPrice,m=g.EstateName+"Ď"+g.UnitPrice+"Ď"+g.StaffName+"Ď"+g.Staff400),v.passParameter={houseType:r,currentPrice:a,middleManName:g.StaffName,middleManPhone:g.Staff400,estateName:g.EstateName,msgContent:m,defaultImage:g.DefaultImage}),v.hideArea=!0,v.commonJsonData,v.houseInfo.map.hasMapNearby=!0,e(v)}else(v=l.replenishData(null,t)).title="VR看房|"+v.title,u&&o&&(v.showWechat="true"!==d,v.showLook="true"!==p),"true"===h&&(v.brokerInfo.hideBrokerInfo=!0),e(v,t)})}}},Owni:function(t,e){},"P+uj":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("wuc/"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("Ilbg");var s=function(t){i("WjXX")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-0541eea0",null);e.default=l.exports},P36U:function(t,e){},P86r:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"floor-bar-container",on:{click:function(e){return e.stopPropagation(),t.selectFloor(e)}}},[i("span",{directives:[{name:"show",rawName:"v-show",value:"dollhouse"===t.currentMode,expression:"currentMode === 'dollhouse'"}],staticClass:"floor-bar-item",class:{active:"all"===t.currentFloorIndex},attrs:{"data-index":"all"}},[t._v(t._s(t.$t("floorAll")))]),t._v(" "),t._l(t.floorList,function(e,n){return i("span",{key:n,staticClass:"floor-bar-item",class:{active:e.floorIndex==t.currentFloorIndex},attrs:{"data-index":e.floorIndex}},[t._v("\n         "+t._s(e.floorName)+"\n     ")])})],2)},staticRenderFns:[]};e.a=n},PCnJ:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("NZKl"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("LOM4");var s=function(t){i("Z9DN")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-22084e2f",null);e.default=l.exports},PJic:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"big-map-container",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeBigMapContent(e)},touchmove:function(t){t.preventDefault()},scroll:function(t){t.preventDefault()},mousewheel:function(t){t.preventDefault()}}},[i("div",{staticClass:"big-map-content"},[i("baidu-map",{staticClass:"map",style:{width:t.map.width,height:t.map.height},attrs:{ak:"UYtXGSLnxZGtjQ0rj58LWvTFivB4aHIF",zoom:15,center:{lng:t.houseInfoData.houseInfo.map.lon,lat:t.houseInfoData.houseInfo.map.lat},"scroll-wheel-zoom":!0}},[i("bm-marker",{staticClass:"big-map-marker",attrs:{position:{lng:t.houseInfoData.houseInfo.map.lon,lat:t.houseInfoData.houseInfo.map.lat},animation:"BMAP_ANIMATION_BOUNCE"}})],1),t._v(" "),i("div",{staticClass:"big-map-close",on:{click:t.closeBigMapContent}})],1)])},staticRenderFns:[]};e.a=n},PLin:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("AWye"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("hV0J");var s=function(t){i("AMeh")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-b9e65b0c",null);e.default=l.exports},PVXw:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=a(i("9LO+")),o=a(i("HpPs")),r=i("Brla");function a(t){return t&&t.__esModule?t:{default:t}}e.default={name:"bm-marker",mixins:[(0,n.default)("overlay")],props:{position:{},offset:{},icon:{},massClear:{type:Boolean,default:!0},dragging:{type:Boolean,default:!1},clicking:{type:Boolean,default:!0},raiseOnDrag:{type:Boolean,default:!1},draggingCursor:{type:String},rotation:{type:Number},shadow:{type:Object},title:{type:String},label:{type:Object},animation:{type:String},top:{type:Boolean,default:!1},zIndex:{type:Number,default:0}},watch:{"position.lng":function(t,e){var i=this.BMap,n=this.originInstance,o=this.position,a=this.renderByParent,s=this.$parent;t!==e&&t>=-180&&t<=180&&n.setPosition((0,r.createPoint)(i,{lng:t,lat:o.lat})),a&&s.reload()},"position.lat":function(t,e){var i=this.BMap,n=this.originInstance,o=this.position,a=this.renderByParent,s=this.$parent;t!==e&&t>=-74&&t<=74&&n.setPosition((0,r.createPoint)(i,{lng:o.lng,lat:t})),a&&s.reload()},"offset.width":function(t,e){var i=this.BMap,n=this.originInstance;t!==e&&n.setOffset(new i.Size(t,this.offset.height))},"offset.height":function(t,e){var i=this.BMap,n=this.originInstance;t!==e&&n.setOffset(new i.Size(this.offset.width,t))},icon:{deep:!0,handler:function(t){var e=this.BMap,i=this.originInstance,n=this.rotation;i&&i.setIcon((0,r.createIcon)(e,t)),n&&i&&i.setRotation(n)}},massClear:function(t){t?this.originInstance.enableMassClear():this.originInstance.disableMassClear()},dragging:function(t){t?this.originInstance.enableDragging():this.originInstance.disableDragging()},clicking:function(){this.reload()},raiseOnDrag:function(){this.reload()},draggingCursor:function(t){this.originInstance.setDraggingCursor(t)},rotation:function(t){this.originInstance.setRotation(t)},shadow:function(t){this.originInstance.setShadow(t)},title:function(t){this.originInstance.setTitle(t)},label:function(t){this.reload()},animation:function(e){this.originInstance.setAnimation(t[e])},top:function(t){this.originInstance.setTop(t)},zIndex:function(t){this.originInstance.setZIndex(t)}},methods:{load:function(){var e=this.BMap,i=this.map,n=this.position,a=this.offset,s=this.icon,l=this.massClear,c=this.dragging,u=this.clicking,h=this.raiseOnDrag,d=this.draggingCursor,p=this.rotation,f=this.shadow,m=this.title,g=this.label,v=this.animation,y=this.top,b=this.renderByParent,w=this.$parent,x=this.zIndex,_=new e.Marker(new e.Point(n.lng,n.lat),{offset:a,icon:s&&(0,r.createIcon)(e,s),enableMassClear:l,enableDragging:c,enableClicking:u,raiseOnDrag:h,draggingCursor:d,rotation:p,shadow:f,title:m});this.originInstance=_,g&&_&&_.setLabel((0,r.createLabel)(e,g)),_.setTop(y),_.setZIndex(x),o.default.call(this,_),b?w.reload():i.addOverlay(_),_.setAnimation(t[v])}}}}).call(e,i("DuR2"))},Pl6d:function(t,e){},PqPp:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("NE2i"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("Q8yd");var s=function(t){i("Acam")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-42fa159e",null);e.default=l.exports},Pqhg:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={components:{"remote-js":{render:function(t){var e=this;return t("script",{attrs:{type:"text/javascript",src:this.src},on:{load:function(){e.$emit("load-js-finish")}}})},props:{src:{type:String,required:!0}}}},props:{jsUrl:{type:String,required:!0},jsLoadCallBack:Function}}},PsWa:function(t,e){},Pv1i:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("rPfl"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("MxLZ");var s=function(t){i("iOR3")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-3a2fdb02",null);e.default=l.exports},"Q+ST":function(t,e){},Q3Qn:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mode-btn-container"},[i("div",{staticClass:"mode-btn-item floorplan",class:{active:"floorplan"===t.currentMode},on:{click:function(e){return t.changeMode("floorplan")}}},[i("i",{staticClass:"mode-btn-icon"}),t._v(" "),i("span",{staticClass:"mode-btn-text"},[t._v("\n            "+t._s(t.$t("floorplanText"))+"\n        ")])]),t._v(" "),i("div",{staticClass:"mode-btn-item dollhouse",class:{active:"dollhouse"===t.currentMode},on:{click:function(e){return t.changeMode("dollhouse")}}},[i("i",{staticClass:"mode-btn-icon"}),t._v(" "),i("span",{staticClass:"mode-btn-text"},[t._v("\n            "+t._s(t.$t("dollhouseText"))+"\n        ")])])])},staticRenderFns:[]};e.a=n},Q8yd:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"big-map-container",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeBigMapContent(e)},touchmove:function(t){t.preventDefault()},scroll:function(t){t.preventDefault()},mousewheel:function(t){t.preventDefault()}}},[t._m(0),t._v(" "),i("div",{staticClass:"big-map-close",on:{click:t.closeBigMapContent}})])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"big-map-content"},[e("div",{staticClass:"big-mobile-google-map",attrs:{id:"big-mobile-google-map"}})])}]};e.a=n},QHh5:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"all-tag-container"},["ImageText"===t.currentTagType?i("picture-tag"):t._e(),t._v(" "),"Video"===t.currentTagType?i("video-tag"):t._e(),t._v(" "),"IFrame"===t.currentTagType?i("iframe-tag"):t._e(),t._v(" "),"TextAudio"===t.currentTagType?i("audio-tag"):t._e()],1)},staticRenderFns:[]};e.a=n},QcG6:function(t,e){},Qd86:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"all-tag-container"},[e("picture-tag",{directives:[{name:"show",rawName:"v-show",value:"ImageText"===this.currentTagType,expression:"currentTagType === 'ImageText'"}]}),this._v(" "),e("video-tag",{directives:[{name:"show",rawName:"v-show",value:"Video"===this.currentTagType,expression:"currentTagType === 'Video'"}]}),this._v(" "),e("iframe-tag",{directives:[{name:"show",rawName:"v-show",value:"IFrame"===this.currentTagType,expression:"currentTagType === 'IFrame'"}]}),this._v(" "),e("audio-tag",{directives:[{name:"show",rawName:"v-show",value:"TextAudio"===this.currentTagType,expression:"currentTagType === 'TextAudio'"}]})],1)},staticRenderFns:[]};e.a=n},QhOe:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("v4HC"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("eoK6");var s=function(t){i("8ErW")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-ce7bf8fa",null);e.default=l.exports},"R+JH":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});o(i("mvHQ"));var n=o(i("3pLw"));function o(t){return t&&t.__esModule?t:{default:t}}e.default=function(t){n.default.get({url:"https://devnest.3dnest.cn/php/weixin.class.php"}).then(function(i){i&&200===i.status&&e(i.data,t)});var e=function(t,e){t.debug=!1,t.jsApiList=["checkJsApi","updateAppMessageShareData","updateTimelineShareData"],wx.config(t),wx.ready(function(){var t=e.link;t.indexOf("#")&&(t=t.split("#")[0]);var i={title:e.shareTitle,desc:e.descContent,imgUrl:e.imgUrl,link:t,success:function(){},cancel:function(){}};wx.updateAppMessageShareData(i),wx.updateTimelineShareData(i)}),wx.error(function(t){})}}},R9i9:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("JXbb"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("0k8j");var s=function(t){i("IoJs")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-6e15b186",null);e.default=l.exports},REwT:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"page-container"}},[t.showHousePlay?i("house-play-component",{attrs:{componentParams:t.housePlayParams}}):t._e(),t._v(" "),t._m(0),t._v(" "),i("div",{ref:"tagbillboards",staticStyle:{position:"fixed"},attrs:{id:"tag-billboards"}}),t._v(" "),i("div",{staticStyle:{position:"fixed"},attrs:{id:"audio-tag"}}),t._v(" "),i("div",{staticStyle:{position:"fixed"},attrs:{id:"video-tag"}}),t._v(" "),i("div",{staticStyle:{position:"fixed"},attrs:{id:"pano-size"}}),t._v(" "),t.isEnterPage&&"pc"===t.currentClient?i("pc-right-component"):t._e(),t._v(" "),t.isEnterPage&&"pc"===t.currentClient&&t.pcBottomShow?i("pc-bottom-panel"):t._e(),t._v(" "),t.isEnterPage&&t.titleIsShow&&"pc"===t.currentClient&&(t.houseInfoData.houseInfo&&t.houseInfoData.houseInfo.houseDetail||t.houseInfoData.houseInfo&&t.houseInfoData.houseInfo.map)?i("pc-title-component"):t._e(),t._v(" "),t.isEnterPage&&t.houseInfoIsShow&&"pc"===t.currentClient?i("pc-house-component-container"):t._e(),t._v(" "),t.isEnterPage&&"pc"===t.currentClient?i("pc-disclaimer-btn-component"):t._e(),t._v(" "),t.isEnterPage&&t.disclaimerContentIsShow&&"pc"===t.currentClient?i("pc-disclaimer-content-component"):t._e(),t._v(" "),t.isEnterPage&&t.houseInfoImgSwiperIsShow&&"pc"===t.currentClient?i("pc-img-swiper"):t._e(),t._v(" "),t.isEnterPage&&t.bigMapIsShow&&"pc"===t.currentClient&&1!==this.houseInfoData.houseInfo.map_type?i("pc-big-baidu-map"):t._e(),t._v(" "),t.isEnterPage&&t.bigMapIsShow&&"pc"===t.currentClient&&1===this.houseInfoData.houseInfo.map_type?i("pc-big-google-map"):t._e(),t._v(" "),t.isEnterPage&&t.companyLogoUrl&&"pc"===t.currentClient?i("pc-company-logo"):t._e(),t._v(" "),!t.isEnterPage||"pc"!==t.currentClient||"floorplan"!==t.currentMode&&"dollhouse"!==t.currentMode?t._e():i("pc-panorama-btn"),t._v(" "),i("keep-alive",[t.isEnterPage&&"pc"===t.currentClient&&"panorama"===t.currentMode?i("pc-mini-floor-plan",{attrs:{modelSettings:t.modelSettings}}):t._e()],1),t._v(" "),i("keep-alive",[t.isEnterPage&&"pc"===t.currentClient&&"floorplan"===t.currentMode?i("pc-floor-plan",{attrs:{modelSettings:t.modelSettings}}):t._e()],1),t._v(" "),i("keep-alive",[t.isEnterPage&&"pc"===t.currentClient&&"panorama"!==t.currentMode&&t.isMultiLayer?i("pc-floor-bar"):t._e()],1),t._v(" "),i("transition",{attrs:{name:t.loadingFade}},[t.isEnterPage||"pc"!==t.currentClient?t._e():i("pc-loading-component")],1),t._v(" "),t.isEnterPage&&t.helpTipIsShow&&"pc"===t.currentClient?i("pc-help-tip"):t._e(),t._v(" "),t.isEnterPage&&"pc"===t.currentClient&&t.sceneList&&t.sceneList.length>0&&t.SpeakHouseState?i("pc-scene-panel"):t._e(),t._v(" "),t.isEnterPage&&"pc"===t.currentClient&&t.lectureList&&t.lectureList.length>0&&t.SpeakHouseState?i("pc-lecture-room"):t._e(),t._v(" "),t.isEnterPage&&"pc"===t.currentClient&&t.tagIsActive&&t.currentTagData?i("pc-all-tag-container"):t._e(),t._v(" "),t.isEnterPage&&"pc"===t.currentClient&&t.measureIsActive&&"panorama"===t.currentMode&&!t.sceneIsActive&&!t.lectureIsActive?i("pc-pano-size"):t._e(),t._v(" "),!t.isLandscape&&t.isEnterPage&&"mobile"===t.currentClient&&(t.houseInfoData.houseInfo&&t.houseInfoData.houseInfo.houseDetail||t.houseInfoData.houseInfo&&t.houseInfoData.houseInfo.map)&&!t.vrIsActive?i("mobile-top-component"):t._e(),t._v(" "),!t.isLandscape&&t.isEnterPage&&t.houseInfoIsShow&&"mobile"===t.currentClient?i("mobile-house-component-container"):t._e(),t._v(" "),!t.isLandscape&&t.isEnterPage&&t.bigMapIsShow&&"mobile"===t.currentClient&&1!==t.houseInfoData.houseInfo.map_type?i("mobile-big-baidu-map"):t._e(),t._v(" "),!t.isLandscape&&t.isEnterPage&&t.bigMapIsShow&&"mobile"===t.currentClient&&1===t.houseInfoData.houseInfo.map_type?i("mobile-big-google-map"):t._e(),t._v(" "),!t.isLandscape&&t.isEnterPage&&t.houseInfoImgSwiperIsShow&&"mobile"===t.currentClient?i("mobile-img-swiper"):t._e(),t._v(" "),!t.isLandscape&&t.isEnterPage&&t.companyLogoUrl&&"mobile"===t.currentClient&&!t.vrIsActive?i("mobile-company-logo"):t._e(),t._v(" "),t.isLandscape||!t.isEnterPage||"mobile"!==t.currentClient||t.vrIsActive?t._e():i("mobile-disclaimer-btn-component"),t._v(" "),!t.isLandscape&&t.isEnterPage&&t.disclaimerContentIsShow&&"mobile"===t.currentClient?i("mobile-disclaimer-content-component"):t._e(),t._v(" "),!t.isLandscape&&t.isEnterPage&&t.vrTipIsShow&&"mobile"===t.currentClient?i("mobile-vr-tip"):t._e(),t._v(" "),!t.isLandscape&&t.isEnterPage&&t.helpTipIsShow&&"mobile"===t.currentClient?i("mobile-help-tip"):t._e(),t._v(" "),t.isLandscape||!t.isEnterPage||"mobile"!==t.currentClient||"panorama"!==t.currentMode||t.sceneIsActive||t.lectureIsActive||t.vrIsActive||t.takeLookIsPlaying||!(t.MiddleManState||t.MultipleMeasureState||t.MultipleTagState||t.MultipleHelpState||t.MultipleVrState)?t._e():i("mobile-bottom-component"),t._v(" "),t.isLandscape||!t.isEnterPage||"mobile"!==t.currentClient||"floorplan"!==t.currentMode&&"dollhouse"!==t.currentMode?t._e():i("mobile-panorama-btn"),t._v(" "),t.isLandscape||!t.isEnterPage||"mobile"!==t.currentClient||"panorama"===t.currentMode||t.lectureIsActive||t.sceneIsActive?t._e():i("mobile-mode-btn"),t._v(" "),i("transition",{attrs:{name:t.loadingFade}},[t.isLandscape||t.isEnterPage||"mobile"!==t.currentClient?t._e():i("mobile-loading-component")],1),t._v(" "),i("keep-alive",[!t.isLandscape&&t.isEnterPage&&"mobile"===t.currentClient&&"panorama"===t.currentMode&&t.floorPlanImageIsShow&&!t.vrIsActive?i("mobile-mini-floor-plan",{attrs:{modelSettings:t.modelSettings}}):t._e()],1),t._v(" "),i("keep-alive",[!t.isLandscape&&t.isEnterPage&&"mobile"===t.currentClient&&"floorplan"===t.currentMode?i("mobile-floor-plan",{attrs:{modelSettings:t.modelSettings}}):t._e()],1),t._v(" "),i("keep-alive",[!t.isLandscape&&t.isEnterPage&&"mobile"===t.currentClient&&"panorama"!==t.currentMode&&t.isMultiLayer?i("mobile-floor-bar"):t._e()],1),t._v(" "),t.isEnterPage&&"mobile"===t.currentClient&&t.middlemanTranspondIsShow?i("mobile-middleman-transpond"):t._e(),t._v(" "),t.isEnterPage&&"mobile"===t.currentClient&&t.copyStatus?i("mobile-copy-success"):t._e(),t._v(" "),!t.isLandscape&&t.isEnterPage&&"mobile"===t.currentClient&&t.sceneList&&t.sceneList.length>0&&!t.vrIsActive&&!t.takeLookIsPlaying&&t.SpeakHouseState?i("mobile-scene-panel"):t._e(),t._v(" "),!t.isLandscape&&t.isEnterPage&&"mobile"===t.currentClient&&t.lectureList&&t.lectureList.length>0&&!t.vrIsActive&&!t.takeLookIsPlaying&&t.SpeakHouseState?i("mobile-lecture-room"):t._e(),t._v(" "),!t.isLandscape&&t.isEnterPage&&"mobile"===t.currentClient&&(t.sceneIsActive||t.lectureIsActive)&&!t.vrIsActive&&t.MiddleManState?i("mobile-mini-middleman"):t._e(),t._v(" "),!t.isLandscape&&t.isEnterPage&&"mobile"===t.currentClient&&t.tagIsActive&&t.currentTagData?i("mobile-all-tag-container"):t._e(),t._v(" "),t.isEnterPage&&"mobile"===t.currentClient&&t.measureIsActive&&"panorama"===t.currentMode&&!t.sceneIsActive&&!t.lectureIsActive?i("mobile-pano-size"):t._e(),t._v(" "),t.takeLookIsPlaying?i("mobile-take-look-panel"):t._e(),t._v(" "),t.takeLookTipIsShow?i("mobile-take-look-Tip"):t._e(),t._v(" "),t.isEnterPage&&"mobile"===t.currentClient&&"panorama"===t.currentMode&&t.houseInfoData&&"app"===t.houseInfoData.platFormType&&t.houseInfoData.redPacket&&t.houseInfoData.redPacket.rewardid&&t.houseInfoData.redPacket.rewardpic&&t.houseInfoData.redPacket.rewardid&&1===t.houseInfoData.redPacket.showreward?i("mobile-reward-panel"):t._e(),t._v(" "),t.isLandscape&&t.isEnterPage&&"mobile"===t.currentClient&&(t.houseInfoData.houseInfo&&t.houseInfoData.houseInfo.houseDetail||t.houseInfoData.houseInfo&&t.houseInfoData.houseInfo.map)&&!t.vrIsActive?i("mobile-landscape-top-component"):t._e(),t._v(" "),t.isLandscape&&t.isEnterPage&&t.houseInfoIsShow&&"mobile"===t.currentClient&&!t.vrIsActive?i("mobile-landscape-house-component-container"):t._e(),t._v(" "),t.isLandscape&&t.isEnterPage&&t.bigMapIsShow&&"mobile"===t.currentClient&&1!==t.houseInfoData.houseInfo.map_type?i("mobile-landscape-big-baidu-map"):t._e(),t._v(" "),t.isLandscape&&t.isEnterPage&&t.bigMapIsShow&&"mobile"===t.currentClient&&1===t.houseInfoData.houseInfo.map_type?i("mobile-landscape-big-google-map"):t._e(),t._v(" "),t.isLandscape&&t.isEnterPage&&t.houseInfoImgSwiperIsShow&&"mobile"===t.currentClient?i("mobile-landscape-img-swiper"):t._e(),t._v(" "),t.isLandscape&&t.isEnterPage&&t.companyLogoUrl&&"mobile"===t.currentClient&&!t.vrIsActive?i("mobile-landscape-company-logo"):t._e(),t._v(" "),t.isLandscape&&t.isEnterPage&&"mobile"===t.currentClient&&!t.vrIsActive?i("mobile-landscape-disclaimer-btn-component"):t._e(),t._v(" "),t.isLandscape&&t.isEnterPage&&t.disclaimerContentIsShow&&"mobile"===t.currentClient?i("mobile-landscape-disclaimer-content-component"):t._e(),t._v(" "),t.isLandscape&&t.isEnterPage&&t.helpTipIsShow&&"mobile"===t.currentClient?i("mobile-landscape-help-tip"):t._e(),t._v(" "),t.isLandscape&&t.isEnterPage&&"mobile"===t.currentClient&&!t.vrIsActive&&(t.MiddleManState||t.MultipleMeasureState||t.MultipleTagState||t.MultipleHelpState||t.MultipleVrState)?i("mobile-landscape-bottom-container"):t._e(),t._v(" "),t.isLandscape&&t.isEnterPage&&"mobile"===t.currentClient&&("floorplan"===t.currentMode||"dollhouse"===t.currentMode)?i("mobile-landscape-panorama-btn"):t._e(),t._v(" "),i("transition",{attrs:{name:t.loadingFade}},[t.isLandscape&&!t.isEnterPage&&"mobile"===t.currentClient?i("mobile-landscape-loading-component"):t._e()],1),t._v(" "),i("keep-alive",[t.isLandscape&&t.isEnterPage&&"mobile"===t.currentClient&&"panorama"===t.currentMode&&t.floorPlanImageIsShow&&!t.vrIsActive?i("mobile-landscape-mini-floor-plan",{attrs:{modelSettings:t.modelSettings}}):t._e()],1),t._v(" "),i("keep-alive",[t.isLandscape&&t.isEnterPage&&"mobile"===t.currentClient&&"floorplan"===t.currentMode?i("mobile-landscape-floor-plan",{attrs:{modelSettings:t.modelSettings}}):t._e()],1),t._v(" "),i("keep-alive",[t.isLandscape&&t.isEnterPage&&"mobile"===t.currentClient&&"panorama"!==t.currentMode&&t.isMultiLayer?i("mobile-landscape-floor-bar"):t._e()],1),t._v(" "),t.isEnterPage&&t.houseInfoData.houseInfo&&t.houseInfoData.houseInfo.map&&t.houseInfoData.houseInfo.map.lat&&t.houseInfoData.houseInfo.map.lon&&1===t.houseInfoData.houseInfo.map_type?i("google-map-sdk",{attrs:{src:"https://maps.google.cn/maps/api/js?v=3&key=AIzaSyBiE9NYPCyPkknmRyZ1mOKyog8Qk75Dli8&callback=initializeGoogleMap"},on:{"load-js-finish":t.changeGoogleMapLoadStatus}}):t._e(),t._v(" "),t.isEnterPage&&t.telDialogIsShow?i("tel-dialog"):t._e(),t._v(" "),t.isEnterPage&&t.telTipIsShow?i("tel-tip"):t._e(),t._v(" "),t.isEnterPage&&t.slideVerifyIsShow?i("mobile-slide-verify"):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{display:"none"},attrs:{id:"debug-panel"}},[e("div",{attrs:{id:"debug-content"}})])}]};e.a=n},RNrm:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mobile-bottom-container"},[i("mini-middleman",{directives:[{name:"show",rawName:"v-show",value:"panorama"!==t.currentMode||(t.sceneIsActive||t.lectureIsActive)&&t.MiddleManState,expression:" currentMode !== 'panorama'|| (sceneIsActive || lectureIsActive)&&MiddleManState"}]}),t._v(" "),i("mode-btn",{directives:[{name:"show",rawName:"v-show",value:"panorama"!==t.currentMode&&!t.sceneIsActive&&!t.lectureIsActive,expression:"currentMode !== 'panorama'&& !sceneIsActive && !lectureIsActive"}]}),t._v(" "),i("bottom-component",{directives:[{name:"show",rawName:"v-show",value:"panorama"===t.currentMode&&!t.sceneIsActive&&!t.lectureIsActive,expression:"currentMode === 'panorama'&& !sceneIsActive && !lectureIsActive"}]}),t._v(" "),i("scene-panel",{directives:[{name:"show",rawName:"v-show",value:t.sceneList&&t.sceneList.length>0&&t.SpeakHouseState,expression:"sceneList&&sceneList.length>0&&SpeakHouseState"}]}),t._v(" "),i("lecture-room",{directives:[{name:"show",rawName:"v-show",value:t.lectureList&&t.lectureList.length>0&&t.SpeakHouseState,expression:"lectureList&&lectureList.length>0&&SpeakHouseState"}]})],1)},staticRenderFns:[]};e.a=n},RQJ0:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("3pLw"),r=(n=o)&&n.__esModule?n:{default:n};var a=i("2Uyi"),s=i("aPOO"),l=i("w1BD");i("ynQN").getStyle();e.default={load:function(t,e){var i=a.getQueryString("house_type"),n=a.getQueryString("house_id"),o=a.getQueryString("city"),c=a.getQueryString("m_name"),u=a.getQueryString("m_tel"),h=a.getQueryString("m_img");if(h&&(h=decodeURIComponent(h)),!(n&&i&&o)){var d=l.replenishData(null,t);e(d)}var p={house_id:n,house_type:i,city:o};r.default.get({url:"http://3dnest.fangbohu.cn",data:p}).then(function(i){var n=null;200===i.status&&i.data&&0==i.data.code?(n=l.replenishData(function(t,e){var i={};for(var n in e)switch(n){case"title":i.title=t.title;break;case"share":i.share=l.getTotalData(t,e.share);break;case"houseInfo":i.houseInfo=l.getTotalData(t,e.houseInfo);break;case"brokerInfo":i.brokerInfo=l.getTotalData(t,e.brokerInfo);break;case"homeLink":i.homeLink=l.getTotalData(t,e.homeLink);break;case"panoramaLink":i.panoramaLink=l.getTotalData(t,e.panoramaLink)}return i}(i.data.house_info,s),t),h&&u&&c&&(n.brokerInfo={enable:!0,brokerImage:h,brokerPhone:u,brokerName:c}),n=l.replenishData(n,t),e(n)):(n=l.replenishData(null,t),h&&u&&c&&(n.brokerInfo={enable:!0,brokerImage:h,brokerPhone:u,brokerName:c}),e(n))})}}},RbAI:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("LCqT"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("y/0k");var s=function(t){i("yqz8")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-31e46a11",null);e.default=l.exports},RuwO:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("lvKI"),r=(n=o)&&n.__esModule?n:{default:n};var a=i("2Uyi"),s=i("jbDv"),l=i("w1BD"),c=(i("ynQN").getStyle(),{url:"http://kg-dc.iok.la:40864/House/getHouseInfo",key:"DkNvH2nG3E6UOfCSg5YWbw"}),u={url:"https://appoa.kegoa.com/House/getHouseInfo",key:"tnH9Avok2TVo9PK2vw"};e.default={load:function(e,i){a.getQueryString("house_type"),a.getQueryString("house_id");var n=a.getQueryString("houseCode"),o=a.getQueryString("dev"),h=a.getQueryString("m_name"),d=a.getQueryString("m_tel"),p=a.getQueryString("m_img");p&&(p=decodeURIComponent(p));var f=new Date,m=f.getMonth()+1<10?"0"+(f.getMonth()+1):f.getMonth()+1,g=f.getDate()<10?"0"+f.getDate():f.getDate(),v=f.getFullYear()+"-"+m+"-"+g,y="",b="";o?(y=c.url,b=c.key):(y=u.url,b=u.key);var w=n,x=r.default.hex_md5(n+"_"+b+v);t.post(y+"?houseCode="+w+"&Md5="+x,function(t){var n=null;1==t.code?(n=l.replenishData(function(t,e){var i={};for(var n in e)switch(n){case"title":i.title=t.title;break;case"share":i.share=l.getTotalData(t,e.share);break;case"houseInfo":i.houseInfo=l.getTotalData(t,e.houseInfo);break;case"brokerInfo":i.brokerInfo=l.getTotalData(t,e.brokerInfo);break;case"homeLink":i.homeLink=l.getTotalData(t,e.homeLink);break;case"panoramaLink":i.panoramaLink=l.getTotalData(t,e.panoramaLink)}return i}(t.house_info,s),e),p&&d&&h&&(n.brokerInfo={enable:!0,brokerImage:p,brokerPhone:d,brokerName:h}),n=l.replenishData(n,e),i(n)):(n=l.replenishData(null,e),p&&d&&h&&(n.brokerInfo={enable:!0,brokerImage:p,brokerPhone:d,brokerName:h}),i(n))})}}}).call(e,i("awxD"))},Rw5l:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"iframe-tag-container",data:function(){return{}},computed:{currentTagData:function(){return this.$store.state.currentTagData}},created:function(){},mounted:function(){},methods:{closeTagContainer:function(){this.statistic_utils.trackEvent(79),this.$store.dispatch("changeTagStatus",!1)}}}},"Rz+S":function(t,e){},S0Ex:function(t,e){},S1Oq:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={components:{},props:{},name:"mobile-panorama-btn",data:function(){return{}},computed:{},created:function(){},mounted:function(){},methods:{changeMode:function(t){this.statistic_utils.trackEvent(3),this.$store.dispatch("goMode","panorama")}}}},S57i:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"midddle-man",data:function(){return{}},created:function(){},mounted:function(){},methods:{openTakeLook:function(){this.$store.dispatch("changeTakeLookActionState",1)}}}},"Sg+Z":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("cTmK"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("81jq");var s=function(t){i("TRlD")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-1c445350",null);e.default=l.exports},SgUQ:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"pc-switch",data:function(){return{}},computed:{toolsListIsShow:function(){return this.$store.state.toolsListIsShow},measureIsActive:function(){return this.$store.state.measureIsActive},tagIsUsed:function(){return this.$store.state.tagIsUsed},MultipleMeasureState:function(){return this.$store.state.MultipleMeasureState},MultipleTagState:function(){return this.$store.state.MultipleTagState},MultipleHelpState:function(){return this.$store.state.MultipleHelpState},MultipleVrState:function(){return this.$store.state.MultipleVrState},MiddleManState:function(){return this.$store.state.MiddleManState}},created:function(){},mounted:function(){},methods:{toggleToolsList:function(){this.statistic_utils.trackEvent(21),this.$store.dispatch("toggleToolsList",!this.$store.state.toolsListIsShow)},toggleMeasureStatus:function(){this.statistic_utils.trackEvent(19),this.$store.dispatch("changeMeasureStatus",!this.$store.state.measureIsActive)},toggleTagStatus:function(){this.statistic_utils.trackEvent(16),this.$store.dispatch("changeTagIsUsed",!this.$store.state.tagIsUsed)},showVrTip:function(){this.statistic_utils.trackEvent(32),this.$store.dispatch("toggleToolsList",!1),this.$store.dispatch("changeVrTipStatus",!0)},showHelpTip:function(){this.statistic_utils.trackEvent(18),this.$store.dispatch("toggleToolsList",!1),this.$store.dispatch("changeHelpTipStatus",!0)},toggleDisclaimerContent:function(){this.statistic_utils.trackEvent(48),this.$store.dispatch("toggleDisclaimerContent",!this.$store.state.disclaimerContentIsShow)}}}},SmVX:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"loading-component-container",style:{backgroundImage:"url("+t.loadingBgUrl+")"}},[t.companySettingsIsLoaded&&49!==t.companyId?i("img",{staticClass:"loading-logo",attrs:{src:t.companyLogoUrl,alt:""}}):t._e(),t._v(" "),t.companySettingsIsLoaded?i("img",{staticClass:"loading-img",class:{lizihang:49===t.companyId},attrs:{src:t.companyLoadingUrl||t.defaultLoadingUrl,alt:""}}):t._e(),t._v(" "),t.companySettingsIsLoaded?i("div",{staticClass:"loading-progress-container"},[i("div",{staticClass:"loading-progress",style:{width:t.loadingProgress+"%"}}),t._v(" "),i("span",{staticClass:"loading-progress-number",style:{left:"50%"}},[t._v("\n            "+t._s(t.loadingProgress+"%")+"\n        ")])]):t._e()])},staticRenderFns:[]};e.a=n},SnEr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(i("YFyo")),o=r(i("HcVH"));function r(t){return t&&t.__esModule?t:{default:t}}e.default={props:{},components:{BaiduMap:n.default,BmMarker:o.default},name:"big-baidu-map",data:function(){return{map:{width:"100%",height:"100%"}}},computed:{houseInfoData:function(){return this.$store.state.houseInfo}},created:function(){},mounted:function(){},methods:{closeBigMapContent:function(){this.statistic_utils.trackEvent(77),this.$store.dispatch("toggleBigMapStatus",!1)},syncCenterAndZoom:function(t){},lookDetail:function(t,e){var i=this;if(this.infoWindow.show=!0,this.infoWindow.info=t,this.activeName=t.name,this.$nextTick(function(){document.querySelector(".BMap_bubble_title").title=i.activeName}),"left"==e)return this.map.center={lng:t.lng,lat:t.lat},void(this.map.zoom=15);this.$nextTick(function(){var t=document.querySelector(".active").offsetTop;i.$refs.box.scrollTop=t-180})}}}},SqvG:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("Cg2r"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("SmVX");var s=function(t){i("0aIv")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-a8dbb054",null);e.default=l.exports},"T//p":function(t,e){},T0Bi:function(t,e){},TAVT:function(t,e){},TAmv:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"picture-tag-container",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeTagContainer(e)}}},[i("div",{staticClass:"picture-tag-content"},[i("div",{staticClass:"picture-close-btn",on:{click:t.closeTagContainer}}),t._v(" "),t.currentTagData&&t.currentTagData.imageurl&&"string"==typeof t.currentTagData.imageurl?i("div",{staticClass:"picture-list"},[i("div",{staticClass:"picture-item"},[i("img",{staticClass:"picture-item-img",attrs:{src:t.currentTagData.imageurl,alt:""}})])]):t.currentTagData&&t.currentTagData.imageurl&&"object"==typeof t.currentTagData.imageurl?i("div",{staticClass:"picture-list"},[i("swiper",{attrs:{options:t.swiperOption}},[t._l(t.currentTagData.imageurl,function(t,e){return i("swiper-slide",{key:e,style:{backgroundImage:"url("+t+")"}})}),t._v(" "),i("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"}),t._v(" "),i("div",{staticClass:"swiper-button-prev",attrs:{slot:"button-prev"},slot:"button-prev"}),t._v(" "),i("div",{staticClass:"swiper-button-next",attrs:{slot:"button-next"},slot:"button-next"})],2)],1):t._e(),t._v(" "),t.currentTagData.audiourl&&t.currentTagData.imageurl?i("audio",{ref:"audioTag",staticClass:"audio-tag",attrs:{src:t.currentTagData.audiourl,autoplay:"autoplay"}}):t._e(),t._v(" "),i("div",{staticClass:"picture-desc-container"},[i("div",{staticClass:"picture-desc-title"},[t._v("\n               "+t._s(t.currentTagData.title)+"\n           ")]),t._v(" "),i("div",{staticClass:"picture-desc-content scroll_content ",domProps:{innerHTML:t._s(t.currentTagData.description)}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:this.currentTagData.url,expression:"this.currentTagData.url"}],staticClass:"picture-desc-btn-container"},[i("div",{staticClass:"picture-desc-btn",on:{click:t.lookDetails}},[t._v("\n                   "+t._s(t.$t("tagLookDetails"))+"\n               ")])])])])])},staticRenderFns:[]};e.a=n},TJI3:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("2NXV"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("P86r");var s=function(t){i("UqtY")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-0406627e",null);e.default=l.exports},TJc1:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"middle-man-container"},[i("div",{directives:[{name:"longpress",rawName:"v-longpress",value:t.openMiddlemanTranspond,expression:"openMiddlemanTranspond"}],staticClass:"middle-man-avatar",style:{backgroundImage:"url("+t.brokerImage+")"}}),t._v(" "),i("div",{staticClass:"middle-man-tel-box",on:{click:t.showTelDialog}},[i("i",{staticClass:"middle-man-tel-icon"}),t._v(" "),i("span",{staticClass:"middle-man-tel-text"},[t._v(t._s(t.$t("telText")))])])])},staticRenderFns:[]};e.a=n},TM4O:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("CnPV"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("Z0Xs");var s=function(t){i("z4Ha")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-591d87dc",null);e.default=l.exports},TPSR:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"pano-size-container"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.panoSizeLeftIsShow&&t.panoSizeLeftData,expression:"panoSizeLeftIsShow&&panoSizeLeftData"}],staticClass:"pano-size-line",class:{reverse:t.panoSizeLeftIsShow&&t.panoSizeLeftData},style:{display:t.panoSizeLeftIsShow&&t.panoSizeLeftData?"block":"none",top:t.panoSizeLeftData.point.y+"px",left:t.panoSizeLeftData.point.x+"px",width:t.panoSizeLeftData.dis+"px",transform:"rotate("+t.panoSizeLeftData.angle+"deg)"}},[i("em"),t._v(" "),i("div",{staticClass:"pano-size-label"},[i("div",{staticClass:"pano-size-label-point"}),t._v(" "),i("div",{staticClass:"pano-size-label-name left"},[t._v(t._s(t.$t("approximate_text")+t.panoSizeLeftData.length.toFixed(2)+t.$t("unit_text")))])])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.panoSizeRightIsShow&&t.panoSizeRightData,expression:"panoSizeRightIsShow&&panoSizeRightData"}],staticClass:"pano-size-line",style:{display:t.panoSizeRightIsShow&&t.panoSizeRightData?"block":"none",top:t.panoSizeRightData.point.y+"px",left:t.panoSizeRightData.point.x+"px",width:t.panoSizeRightData.dis+"px",transform:"rotate("+t.panoSizeRightData.angle+"deg)"}},[i("em"),t._v(" "),i("div",{staticClass:"pano-size-label"},[i("div",{staticClass:"pano-size-label-point"}),t._v(" "),i("div",{staticClass:"pano-size-label-name right"},[t._v(t._s(t.$t("approximate_text")+t.panoSizeRightData.length.toFixed(2)+t.$t("unit_text")))])])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.panoSizeHeightIsShow&&t.panoSizeHeightData,expression:"panoSizeHeightIsShow&&panoSizeHeightData"}],staticClass:"pano-size-line ",class:{around:t.panoSizeHeightIsShow&&t.panoSizeHeightData},style:{display:t.panoSizeHeightIsShow&&t.panoSizeHeightData?"block":"none",top:t.panoSizeHeightData.point.y+"px",left:t.panoSizeHeightData.point.x+"px",width:t.panoSizeHeightData.dis+"px",transform:"rotate("+t.panoSizeHeightData.angle+"deg)"}},[i("em"),t._v(" "),i("div",{staticClass:"pano-size-label"},[i("div",{staticClass:"pano-size-label-point"}),t._v(" "),i("div",{staticClass:"pano-size-label-name height"},[t._v(t._s(t.$t("approximate_text")+t.panoSizeHeightData.length.toFixed(2)+t.$t("unit_text")))])])])])},staticRenderFns:[]};e.a=n},TPyT:function(t,e,i){"use strict";t.exports={title:"Title",share:{enable:!0,share_link:"href",share_context:"shareDesc",share_img:"shareImgUrl",share_title:"shareTitle"},offline:{text:"该房源已下架，您可以联系下方经纪人为您推荐其他优质房源！",houseDetail:""},uniId:"",houseInfo:{enable:!0,version:0,list:{loupan:[{value:"junjia",name:"均价",widthStyle:"1"},{value:"houseType",name:"类型",widthStyle:"1"},{value:"quyu",name:"区域",widthStyle:"1"},{value:"zhuangxiu",name:"装修",widthStyle:"1"},{value:"zhulihuxing",name:"户型",linkname:"查看详情",link:"PCHuXingUrl",widthStyle:"1"},{value:"kaifashang",name:"开发商",widthStyle:"1"},{value:"dizhi",name:"地址",widthStyle:"1"}],sell:[{value:"zongjia",name:"总价",widthStyle:"1"},{value:"huxing",name:"户型",widthStyle:"1"},{value:"danjia",name:"单价",widthStyle:"1"},{value:"jzmj",name:"面积",widthStyle:"1"},{value:"chaoxiang",name:"朝向",widthStyle:"1"},{value:"houseType",name:"类型",widthStyle:"1"},{value:"louceng",name:"楼层",widthStyle:"1"},{value:"niandai",name:"建筑年代",widthStyle:"1"},{value:"zhuangxiu",name:"装修",widthStyle:"1"},{value:"quyu",name:"区域",widthStyle:"1"}],chuzu:[{value:"zujin",name:"租金",widthStyle:"1"},{value:"huxing",name:"户型",widthStyle:"1"},{value:"zjfs",name:"押金方式",widthStyle:"1"},{value:"mj",name:"面积",widthStyle:1},{value:"chaoxiang",name:"朝向",widthStyle:"1"},{value:"houseType",name:"类型",widthStyle:"1"},{value:"louceng",name:"楼层",widthStyle:"1"},{value:"zhuangxiu",name:"装修",widthStyle:"1"},{value:"quyu",name:"区域",widthStyle:"1"}]},map:{lon:"longitude",lat:"latitude"}},brokerInfo:{enable:!0,brokerImage:"photo",brokerPhone:"mobile",brokerName:"username",PcPhoneTip:{sale:"请拨打(brokerName)电话咨询",rent:"(brokerName):请拨打以下电话咨询"},hasVirtualNumber:!1},homeLink:{enable:!1,link:"indexUrl"},panoramaLink:{enable:!0,link:"xqAerialUrl"},slideVerify:{enable:!0,uid:""},commonJsonData:{area_text:"",district_text:"quyu",purpose_text:"houseType",house_type:"huxing",acreage_value:"jzmj",orientation_text:"chaoxiang",decoration_type:"zhuangxiu",floor_text:"louceng",complation_date:"niandai",total_price:"zongjia",address_details:"dizhi",house_status:"",longitude_value:"longitude",latitude_value:"latitude",more_details_address:"",community_name:"",unit_price:"junjia",sell_type:"",city_text:"",developer_name:"kaifashang",elevator_issupport:"",listing_time:"",rent_price:"",hangpaiurl:""}}},TRlD:function(t,e){},Txow:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=s(i("//Fk")),o=s(i("BO1k")),r=s(i("HpPs")),a=i("S4eb");function s(t){return t&&t.__esModule?t:{default:t}}e.default={name:"bm-map",props:{ak:{type:String},center:{type:[Object,String]},zoom:{type:Number},minZoom:{type:Number},maxZoom:{type:Number},highResolution:{type:Boolean,default:!0},mapClick:{type:Boolean,default:!0},mapType:{type:String},dragging:{type:Boolean,default:!0},scrollWheelZoom:{type:Boolean,default:!1},doubleClickZoom:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},inertialDragging:{type:Boolean,default:!0},continuousZoom:{type:Boolean,default:!0},pinchToZoom:{type:Boolean,default:!0},autoResize:{type:Boolean,default:!0},theme:{type:Array},mapStyle:{type:Object}},watch:{center:function(t,e){var i=this.map,n=this.zoom;"String"===(0,a.checkType)(t)&&t!==e&&i.centerAndZoom(t,n)},"center.lng":function(t,e){var i=this.BMap,n=this.map,o=this.zoom,r=this.center;t!==e&&t>=-180&&t<=180&&n.centerAndZoom(new i.Point(t,r.lat),o)},"center.lat":function(t,e){var i=this.BMap,n=this.map,o=this.zoom,r=this.center;t!==e&&t>=-74&&t<=74&&n.centerAndZoom(new i.Point(r.lng,t),o)},zoom:function(t,e){var i=this.map;t!==e&&t>=3&&t<=19&&i.setZoom(t)},minZoom:function(t){this.map.setMinZoom(t)},maxZoom:function(t){this.map.setMaxZoom(t)},highResolution:function(){this.reset()},mapClick:function(){this.reset()},mapType:function(e){this.map.setMapType(t[e])},dragging:function(t){var e=this.map;t?e.enableDragging():e.disableDragging()},scrollWheelZoom:function(t){var e=this.map;t?e.enableScrollWheelZoom():e.disableScrollWheelZoom()},doubleClickZoom:function(t){var e=this.map;t?e.enableDoubleClickZoom():e.disableDoubleClickZoom()},keyboard:function(t){var e=this.map;t?e.enableKeyboard():e.disableKeyboard()},inertialDragging:function(t){var e=this.map;t?e.enableInertialDragging():e.disableInertialDragging()},continuousZoom:function(t){var e=this.map;t?e.enableContinuousZoom():e.disableContinuousZoom()},pinchToZoom:function(t){var e=this.map;t?e.enablePinchToZoom():e.disablePinchToZoom()},autoResize:function(t){var e=this.map;t?e.enableAutoResize():e.disableAutoResize()},theme:function(t){this.map.setMapStyle({styleJson:t})},"mapStyle.features":{handler:function(t,e){var i=this.map,n=this.mapStyle,o=n.style,r=n.styleJson;i.setMapStyle({styleJson:r,features:t,style:o})},deep:!0},"mapStyle.style":function(t,e){var i=this.map,n=this.mapStyle,o=n.features,r=n.styleJson;i.setMapStyle({styleJson:r,features:o,style:t})},"mapStyle.styleJson":{handler:function(t,e){var i=this.map,n=this.mapStyle,o=n.features,r=n.style;i.setMapStyle({styleJson:t,features:o,style:r})},deep:!0},mapStyle:function(t){var e=this.map;!this.theme&&e.setMapStyle(t)}},methods:{setMapOptions:function(){var e=this.map,i=this.minZoom,n=this.maxZoom,o=this.mapType,r=this.dragging,a=this.scrollWheelZoom,s=this.doubleClickZoom,l=this.keyboard,c=this.inertialDragging,u=this.continuousZoom,h=this.pinchToZoom,d=this.autoResize;i&&e.setMinZoom(i),n&&e.setMaxZoom(n),o&&e.setMapType(t[o]),r?e.enableDragging():e.disableDragging(),a?e.enableScrollWheelZoom():e.disableScrollWheelZoom(),s?e.enableDoubleClickZoom():e.disableDoubleClickZoom(),l?e.enableKeyboard():e.disableKeyboard(),c?e.enableInertialDragging():e.disableInertialDragging(),u?e.enableContinuousZoom():e.disableContinuousZoom(),h?e.enablePinchToZoom():e.disablePinchToZoom(),d?e.enableAutoResize():e.disableAutoResize()},init:function(t){if(!this.map){var e=this.$refs.view,i=!0,n=!1,a=void 0;try{for(var s,l=(0,o.default)(this.$slots.default||[]);!(i=(s=l.next()).done);i=!0){var c=s.value;c.componentOptions&&"bm-view"===c.componentOptions.tag&&(this.hasBmView=!0,e=c.elm)}}catch(t){n=!0,a=t}finally{try{!i&&l.return&&l.return()}finally{if(n)throw a}}var u=new t.Map(e,{enableHighResolution:this.highResolution,enableMapClick:this.mapClick});this.map=u;var h=this.setMapOptions,d=this.zoom,p=this.getCenterPoint,f=this.theme,m=this.mapStyle;f?u.setMapStyle({styleJson:f}):u.setMapStyle(m),h(),r.default.call(this,u),u.reset(),u.centerAndZoom(p(),d),this.$emit("ready",{BMap:t,map:u})}},getCenterPoint:function(){var t=this.center,e=this.BMap;switch((0,a.checkType)(t)){case"String":return t;case"Object":return new e.Point(t.lng,t.lat);default:return new e.Point}},initMap:function(t){this.BMap=t,this.init(t)},getMapScript:function(){if(t.BMap)return t.BMap._preloader?t.BMap._preloader:n.default.resolve(t.BMap);var e=this.ak||this._BMap().ak;return t.BMap={},t.BMap._preloader=new n.default(function(i,n){t._initBaiduMap=function(){i(t.BMap),t.document.body.removeChild(o),t.BMap._preloader=null,t._initBaiduMap=null};var o=document.createElement("script");t.document.body.appendChild(o),o.src="https://api.map.baidu.com/api?v=2.0&ak="+e+"&callback=_initBaiduMap"}),t.BMap._preloader},reset:function(){var t=this.getMapScript,e=this.initMap;t().then(e)}},mounted:function(){this.reset()},data:function(){return{hasBmView:!1}}}}).call(e,i("DuR2"))},"U/sn":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={components:{},props:{},name:"mobile-company-logo",data:function(){return{}},computed:{companyLogoUrl:function(){return this.$store.state.companyLogoUrl}},created:function(){},mounted:function(){},methods:{}}},U39E:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"audio-tag-container",data:function(){return{}},computed:{currentTagData:function(){return this.$store.state.currentTagData},currentTagType:function(){return this.$store.state.currentTagType},tagIsShow:function(){return this.$store.state.tagIsShow},getAudioTagIsPlay:function(){return this.$store.state.audioStatus}},watch:{getAudioTagIsPlay:function(t,e){!0===t?this.$nextTick(function(){this.$refs.audioTag.play()}):!1===t&&this.$nextTick(function(){this.$refs.audioTag.pause()})}},created:function(){},mounted:function(){},methods:{endPlay:function(){this.$store.dispatch("changeAudioStatus",!1)}}}},UPpq:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"disclaimer-content-container",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeDisclaimer(e)},touchmove:function(t){if(t.target!==t.currentTarget)return null;t.preventDefault()},scroll:function(t){if(t.target!==t.currentTarget)return null;t.preventDefault()},mousewheel:function(t){if(t.target!==t.currentTarget)return null;t.preventDefault()}}},[i("div",{staticClass:"disclaimer-content"},[i("div",{staticClass:"disclaimer-close",on:{click:t.closeDisclaimer}}),t._v(" "),i("div",{staticClass:"disclaimer-header"},[i("span",{staticClass:"disclaimer-title"},[t._v(t._s(t.$t("disclaimerBtnText")))])]),t._v(" "),i("div",{staticClass:"disclaimer-main scroll_content mobile-landscape",domProps:{innerHTML:t._s(t.disclaimerContent)}})])])},staticRenderFns:[]};e.a=n},UciY:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"midddle-man",data:function(){return{}},computed:{houseInfoData:function(){return this.$store.state.houseInfo}},created:function(){},mounted:function(){},methods:{goChat:function(){"web"===this.houseInfoData.miniChat.style?window.location.href=this.houseInfoData.miniChat.params:"miniapp"===this.houseInfoData.miniChat.style?wx&&wx.miniProgram&&wx.miniProgram.redirectTo({url:this.houseInfoData.miniChat.params}):"app"===this.houseInfoData.miniChat.style&&("ios"===this.CommonUtil.detectDevice()?window.webkit.messageHandlers.nativeInterfaceRunner.postMessage(this.houseInfoData.miniChat.params):window.WebBridge.nativeInterfaceRunner(this.houseInfoData.miniChat.params))}}}},UjGr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"title-component",data:function(){return{}},computed:{isOpen:function(){return this.$store.state.houseInfoIsShow},houseInfo:function(){return this.$store.state.houseInfo}},created:function(){},mounted:function(){},methods:{toggleHouseInfo:function(){this.statistic_utils.trackEvent(25),(this.houseInfo.houseInfo&&this.houseInfo.houseInfo.enable||this.houseInfo.houseInfo&&this.houseInfo.houseInfo.map)&&this.$store.dispatch("toggleHouseInfoPanel",!this.$store.state.houseInfoIsShow)}}}},Uk6O:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("zlT9"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("jVxu");var s=function(t){i("flsx")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-34e47d26",null);e.default=l.exports},UpdR:function(t,e){t.exports={defaultTitle:"3D View",panoramaText:"Back",dollhouseText:"3D",floorplanText:"Plan",sceneText:"NAVI",lectureText:"Guide",play_text:"PLAY",pause_text:"PAUSE",middleManTitle:"Agent",takeLookText:"Collab",miniChatText:"miniChat",toolsText:"Tools",measureText:"Measure",tagText:"Tag",vrText:"VR",helpText:"Help",wechatTipTitle:"QR Code",wechatTipDesc:"Scan to view Copy to share ",disclaimerBtnText:"Disclaimer",houseInfoTitle:"Property Info",houseInfoMoreBtnText:"More",goAerialUrl:"Drone View",looMapMore:"Surroundings",vrTipTitle:"VR Mode",vrTipDesc1:"Please unlock the portrait-lock feature and put mobile phone into VR glasses.",vrTipDesc2:"Focus the white dot on blue crystal to move forward. ",helpTipTitle:"HELP",helpTipWalk:"Move",helpTipSlide:"Rotate",helpTipMagnify:"Zoom Out",helpTipShrink:"Zoom In",telText:"TEL",wifiTipText:"WIFI connection is recommended",look3DDesc:"3D Model",direction_s_text:"S",direction_n_text:"N",direction_w_text:"W",direction_e_text:"E",direction_e_n_text:"NE",direction_e_s_text:"SE",direction_w_n_text:"NW",direction_w_s_text:"SW",approximate_text:"~",unit_text:"ft",double_unit_text:"ftÂ²",entry_text:"Enter",floorLevel:"F",floorAll:"All",mobile_num_not_empty:"Number cannot be empty ",mobile_num_not_match:"Phone does not match ",middle_verify_input_title:"Enter number ",middle_verify_input_lable:" TEL:",middle_verify_input_placeholder:"Please enter your phone number",middle_verify_confirm_text:" Confirm ",middle_verify_cancel_text:"Cancel ",middle_verify_open_text:"Open ","middle_verify_input_incorrect_format ":"Format error, please re - enter ",middle_verify_generate_link_title:"Generate link ",middle_verify_copy_text:"Copy ",middle_verify_tip_modify_text:"Return ",middle_verify_copy_success_tip:"The link has been copied to the clipboard ",middle_verify_tip_title:"TIP ",middle_verify_tip_content:"'number'is not in the whitelist, please contact the management to add it to the whitelist! ",middle_verify_correct_tip:"Please enter the correct cell phone number",tagLookDetails:"More",mobile_contact_desc_text:"(Some extension numbers need to be dialed manually.)",mobile_contact_cancel_text:"CANCEL",mobile_contact_call_text:"CALL",has_not_phone_tip:"Telephone not provided",slide_verify_desc:" Drag the slider to the right",slide_verify_success:"Verification passed",take_look_end_text:" END",red_packet:"????"}},UqtY:function(t,e){},V5ks:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(i("YFyo")),o=r(i("HcVH"));function r(t){return t&&t.__esModule?t:{default:t}}e.default={props:{},components:{BaiduMap:n.default,BmMarker:o.default},name:"small-baidu-map",data:function(){return{map:{width:"100%",height:"100%"},mapData:{zoom:15},isDrag:!1}},computed:{houseInfoData:function(){return this.$store.state.houseInfo}},created:function(){},mounted:function(){},methods:{showBigMap:function(t){this.statistic_utils.trackEvent(8),this.$store.dispatch("toggleHouseInfoPanel",!1),this.$store.dispatch("toggleBigMapStatus",!0)},syncCenterAndZoom:function(t){},lookDetail:function(t,e){var i=this;if(this.infoWindow.show=!0,this.infoWindow.info=t,this.activeName=t.name,this.$nextTick(function(){document.querySelector(".BMap_bubble_title").title=i.activeName}),"left"==e)return this.map.center={lng:t.lng,lat:t.lat},void(this.map.zoom=15);this.$nextTick(function(){var t=document.querySelector(".active").offsetTop;i.$refs.box.scrollTop=t-180})},cleanEvent:function(){var t=this;setTimeout(function(){t.$store.dispatch("changeIsDragingMap",!1),null},100)},goDrag:function(){this.$store.dispatch("changeIsDragingMap",!0)}}}},VXBq:function(t,e,i){"use strict";t.exports={title:"title",share:{enable:!0,share_link:"share_link",share_context:"share_desc",share_img:"share_img",share_title:"share_title"},offline:{text:"该房源已下架，您可以联系下方经纪人为您推荐其他优质房源！",houseDetail:""},houseInfo:{enable:!0,version:0,list:"menu_info",map:{lon:"address_x",lat:"address_y"},houseDetail:"jump_url"},communityImages:{enable:!1,images:"images"},brokerInfo:{enable:!0,brokerImage:"head_pic",brokerPhone:"contactphone",brokerName:"contactname",PcPhoneTip:""},redPacket:{enable:!0,rewardid:"rewardid",rewardpic:"rewardpic",showreward:"showreward",waittime:"waittime"},homeLink:{enable:!1,link:""},panoramaLink:{enable:!1,link:""},miniChat:{enable:!1,params:""},platFormType:""}},VYXT:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("C3Qg"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("Q3Qn");var s=function(t){i("dwfi")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-243c4be6",null);e.default=l.exports},Vfjo:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"picture-tag-container"},[i("div",{staticClass:"picture-tag-content"},[i("div",{staticClass:"picture-close-btn",on:{click:t.closeTagContainer}}),t._v(" "),t.currentTagData&&t.currentTagData.imageurl&&"string"==typeof t.currentTagData.imageurl?i("div",{staticClass:"picture-list"},[i("div",{staticClass:"picture-item"},[i("img",{staticClass:"picture-item-img",attrs:{src:t.currentTagData.imageurl,alt:""}}),t._v(" "),i("span",{staticClass:"picture-index"})])]):t.currentTagData&&t.currentTagData.imageurl&&"object"==typeof t.currentTagData.imageurl?i("div",{staticClass:"picture-list"},[i("swiper",{attrs:{options:t.swiperOption}},[t._l(t.currentTagData.imageurl,function(t,e){return i("swiper-slide",{key:e,style:{backgroundImage:"url("+t+")"}})}),t._v(" "),i("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"}),t._v(" "),i("div",{staticClass:"swiper-button-prev",attrs:{slot:"button-prev"},slot:"button-prev"}),t._v(" "),i("div",{staticClass:"swiper-button-next",attrs:{slot:"button-next"},slot:"button-next"})],2)],1):t._e(),t._v(" "),t.currentTagData.audiourl&&t.currentTagData.imageurl?i("audio",{ref:"audioTag",staticClass:"audio-tag",attrs:{src:t.currentTagData.audiourl,autoplay:"autoplay"}}):t._e(),t._v(" "),i("div",{staticClass:"picture-desc-container"},[i("div",{staticClass:"picture-desc-title"},[t._v("\n               "+t._s(t.currentTagData.title)+"\n           ")]),t._v(" "),i("div",{staticClass:"picture-desc-content  scroll_content",domProps:{innerHTML:t._s(t.currentTagData.description)}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:this.currentTagData.url,expression:"this.currentTagData.url"}],staticClass:"picture-desc-btn-container"},[i("div",{staticClass:"picture-desc-btn",on:{click:t.lookDetails}},[t._v("\n                   "+t._s(t.$t("tagLookDetails"))+"\n               ")])])])])])},staticRenderFns:[]};e.a=n},"VgN/":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("MKGR"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("6dQP");var s=function(t){i("gvt3")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-12b129a0",null);e.default=l.exports},Voun:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("shi+"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("Aw0X");var s=function(t){i("wnCe")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-7e490b99",null);e.default=l.exports},"W/Op":function(t,e){t.exports={floorplan:"FLOORPLAN",dollhouse:"DOLLHOUSE"}},"W/qc":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"help-tip-container"},[i("div",{staticClass:"help-tip-content"},[i("i",{staticClass:"help-tip-close",on:{click:t.closeHelpTip}}),t._v(" "),i("div",{staticClass:"help-tip-title"},[t._v("\n           "+t._s(t.$t("helpTipTitle"))+"\n       ")]),t._v(" "),i("div",{staticClass:"help-tip-main"},[i("div",{staticClass:"help-tip-item"},[i("i",{staticClass:"help-tip-item-icon walk"}),t._v(" "),i("span",{staticClass:"help-tip-item-text"},[t._v("\n                    "+t._s(t.$t("helpTipWalk"))+"\n                ")])]),t._v(" "),i("div",{staticClass:"help-tip-item"},[i("i",{staticClass:"help-tip-item-icon slide"}),t._v(" "),i("span",{staticClass:"help-tip-item-text"},[t._v("\n                    "+t._s(t.$t("helpTipSlide"))+"\n                ")])]),t._v(" "),i("div",{staticClass:"help-tip-item"},[i("i",{staticClass:"help-tip-item-icon magnify"}),t._v(" "),i("span",{staticClass:"help-tip-item-text"},[t._v("\n                    "+t._s(t.$t("helpTipMagnify"))+"\n                ")])]),t._v(" "),i("div",{staticClass:"help-tip-item"},[i("i",{staticClass:"help-tip-item-icon shrink"}),t._v(" "),i("span",{staticClass:"help-tip-item-text"},[t._v("\n                    "+t._s(t.$t("helpTipShrink"))+"\n                ")])])])])])},staticRenderFns:[]};e.a=n},WLav:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"house-info",data:function(){return{companyId:this.$store.state.companyId,houseInfoData:this.$store.state.houseInfo}},computed:{},created:function(){},mounted:function(){},methods:{goHouseInfoDetails:function(){if(this.statistic_utils.trackEvent(28),this.houseInfoData.houseInfo&&this.houseInfoData.houseInfo.houseDetail)if(14===this.companyId){var t={open:this.houseInfoData.houseInfo.houseDetail,down:this.houseInfoData.houseInfo.downUrl},e=document.createElement("iframe"),i=document.body;e.style.cssText="display:none;width=0;height=0";var n=null;/MicroMessenger/gi.test(navigator.userAgent)?window.location.href=t.down:(i.appendChild(e),e.src=t.open,n=setTimeout(function(){window.location.href=t.down},3e3)),document.addEventListener("visibilitychange",function(t){(document.hidden||document.webkitHidden)&&clearTimeout(n)},!1),document.addEventListener("webkitvisibilitychange",function(t){(document.hidden||document.webkitHidden)&&clearTimeout(n)},!1),window.addEventListener("pagehide",function(t){clearTimeout(n)})}else window.location.href=this.houseInfoData.houseInfo.houseDetail}}}},WU1G:function(t,e,i){"use strict";t.exports={deviceInfo:function(){return{deviceType:(e=window.navigator.userAgent.toLowerCase(),i="ipad"==e.match(/(ipad)/i),n="iphone os"==e.match(/iphone os/i),o="midp"==e.match(/midp/i),r="rv:1.2.3.4"==e.match(/rv:1.2.3.4/i),a="ucweb"==e.match(/ucweb/i),s="android"==e.match(/android/i),l="windows ce"==e.match(/windows ce/i),c="windows mobile"==e.match(/windows mobile/i),i||n||o||r||a||s||l||c?n||o||r||a||s||l||c?"Phone":i?"ipad":"未知":"PC"),OS:window.navigator.userAgent.indexOf("Android")>-1||window.navigator.userAgent.indexOf("Linux")>-1?"Android":window.navigator.userAgent.indexOf("iPhone")>-1?"iOS":window.navigator.userAgent.indexOf("Windows Phone")>-1?"WP":"Others",OSVersion:function(){var t="1.0",e=window.navigator.userAgent,i=e.indexOf("Android")>-1||e.indexOf("Linux")>-1,n=!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);if(i){var o=e.match(/android [\d._]+/gi);o&&(t=(o+"").replace(/[^0-9|_.]/gi,"").replace(/_/gi,"."),t=parseInt(t.split(".")[0]))}return n&&(t=window.navigator.userAgent.split(";")[1].match(/(\d+)_(\d+)_?(\d+)?/)[0]),t}(),userAgent:window.navigator.userAgent,appVersion:window.navigator.appVersion,screenHeight:window.screen.height,screenWidth:window.screen.width,language:window.navigator.language,netWork:function(){var t;if(!window.navigator.connection)return"未知";switch(window.navigator.connection.effectiveType){case"wifi":t="wifi";break;case"4g":t="4G";break;case"2g":t="2G";break;case"3g":t="3G";break;case"ethernet":t="以太网";break;case"default":t="未知"}return t}(),orientation:(window.screen&&window.screen.orientation&&window.screen.orientation.angle?(180!=window.screen.orientation.angle&&0!=window.screen.orientation.angle||(t="竖屏"),90!=window.screen.orientation.angle&&-90!=window.screen.orientation.angle||(t="横屏")):t="未知",t)};var t,e,i,n,o,r,a,s,l,c}}},WUBG:function(t,e){},Wb9y:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("8cTK"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("9lYI");var s=function(t){i("59XI")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-58e1b4ca",null);e.default=l.exports},WdZV:function(t,e){},WjXX:function(t,e){},WnMO:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("jFy3"),r=(n=o)&&n.__esModule?n:{default:n};var a=void 0;e.default={props:{},name:"reward-panel",data:function(){return{totalTime:60,rewardpic:"http://img32.house365.com/M02/FE/5E/rBEBYV0bHkWAfyFGAACK2T7c2d4052.jpg",hasRewardCover:!0,selfOpen:!0,houseInfoData:null}},created:function(){this.totalTime=parseInt(this.$store.state.houseInfo.redPacket.waittime),this.rewardpic=this.$store.state.houseInfo.redPacket.rewardpic,this.houseInfoData=this.$store.state.houseInfo},mounted:function(){this.rewardCountDown()},computed:{},methods:{rewardCountDown:function(){var t=this;return!!t.totalTime&&(t.totalTime=parseInt(t.totalTime),0===t.totalTime?(t.hasRewardCover=!1,!1):void(a=setInterval(function(){t.totalTime<=0?(clearInterval(a),t.hasRewardCover=!1):t.totalTime--},1e3)))},openRewardPanel:function(){if(clearInterval(a),"app"===this.houseInfoData.platFormType){var e,i=this.CommonUtil.getQueryString("m"),n=this.CommonUtil.getQueryString("house_id"),o=this.CommonUtil.getQueryString("house_type");"xf"===o?e="newhouse":"sell"===o?e="oldhouse":"jiaju"===o&&(e="jiaju"),"newhouse"===e?r.default.openRedPacket(String(this.houseInfoData.redPacket.rewardid),i):"oldhouse"===e&&r.default.openEsfRedPacket(String(this.houseInfoData.redPacket.rewardid),n)}else{!function(e,i){var n=document.createElement("iframe"),o=navigator.userAgent,r=o.toLowerCase(),a={platform:"android",agentform:"normal",ios9above:!1,apikey:"cp"};if("weibo"==r.match(/WeiBo/i)?a.agentform="sina":"micromessenger"==r.match(/MicroMessenger/i)?a.agentform="weixin":"qq"==r.match(/QQ/i)&&(a.agentform="qq"),null!=o.match(/iPhone|iPod|iPad/i)?(a.platform="ios",o.match(/OS [0-8]_\d[_\d]* like Mac OS X/gi)||(a.ios9above=!0),a.isIpad=null!=o.match(/iPad/i),a.isSafari=null!=o.match(/Safari/i)):null!=o.match(/Android/i)&&null!=o.match(/Mobile/i)&&(a.isChrome=null!=o.match(/Chrome/i)&&null==o.match(/Version\/\d+\.\d+(\.\d+)?\sChrome\//i),-1!==o.indexOf("qhbrowser")&&(a.isChrome=!1),a.platform=a.isChrome?"":"android"),"weibo"==r.match(/WeiBo/i))return window.open(e),!1;if("qq"==r.match(/QQ/i))return window.open(e),!1;if(1==a.isweixin)return window.open(e),!1;if("ios"==a.platform)try{n.src=i,n.style.display="none",document.body.appendChild(n)}catch(t){window.location.href=e}else if(a.isChrome||a.ios9above&&!a.isSafari)location.href=i;else try{n.src=i,n.style.display="none",document.body.appendChild(n)}catch(t){window.location.href=e}"weixin"==a.agentform?e="http://a.app.qq.com/o/simple.jsp?pkgname=com.house365.newhouse&ckey=CK1376404680618":"ios"==a.platform&&(e="https://itunes.apple.com/app/apple-store/id543472063?pt=1383608&ct=wap&mt=8");var s=Date.now(),l=setTimeout(function(){window.open(e);var t=Date.now();!s||t-s<3e3?window.location.href=e:(window.opener=null,window.location.href="about:blank",window.close())},2500);window.onblur=function(){clearTimeout(l)},t(document).on("visibilitychange webkitvisibilitychange",function(){(document.hidden||document.webkitHidden)&&clearTimeout(l)}),t(window).on("pagehide",function(){clearTimeout(l)})}("https://m.house365.com/index.php?m=Home&c=Render&a=index&city=nj&load=1","taofang://house365.app/?city="+this.CommonUtil.getQueryString("city")+"&TFRouteType=1001&TFRouteParm="+encodeURIComponent(window.location.href))}},closeRewardPanel:function(){clearInterval(a),this.selfOpen=!1}}}}).call(e,i("awxD"))},WnXe:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={components:{},props:{},name:"mobile-pano-size",data:function(){return{}},computed:{panoSizeLeftIsShow:function(){return this.$store.state.panoSizeLeftIsShow},panoSizeLeftData:function(){return this.$store.state.panoSizeLeftData},panoSizeHeightIsShow:function(){return this.$store.state.panoSizeHeightIsShow},panoSizeHeightData:function(){return this.$store.state.panoSizeHeightData},panoSizeRightIsShow:function(){return this.$store.state.panoSizeRightIsShow},panoSizeRightData:function(){return this.$store.state.panoSizeRightData}},created:function(){},mounted:function(){},methods:{}}},WoLW:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"help-tip-container"},[i("div",{staticClass:"help-tip-content"},[i("i",{staticClass:"help-tip-close",on:{click:t.closeHelpTip}}),t._v(" "),i("div",{staticClass:"help-tip-title"},[t._v("\n           "+t._s(t.$t("helpTipTitle"))+"\n       ")]),t._v(" "),i("div",{staticClass:"help-tip-main"},[i("div",{staticClass:"help-tip-item"},[i("i",{staticClass:"help-tip-item-icon walk"}),t._v(" "),i("span",{staticClass:"help-tip-item-text"},[t._v("\n                    "+t._s(t.$t("helpTipWalk"))+"\n                ")])]),t._v(" "),i("div",{staticClass:"help-tip-item"},[i("i",{staticClass:"help-tip-item-icon slide"}),t._v(" "),i("span",{staticClass:"help-tip-item-text"},[t._v("\n                    "+t._s(t.$t("helpTipSlide"))+"\n                ")])]),t._v(" "),i("div",{staticClass:"help-tip-item"},[i("i",{staticClass:"help-tip-item-icon magnify"}),t._v(" "),i("span",{staticClass:"help-tip-item-text"},[t._v("\n                    "+t._s(t.$t("helpTipMagnify"))+"\n                ")])]),t._v(" "),i("div",{staticClass:"help-tip-item"},[i("i",{staticClass:"help-tip-item-icon shrink"}),t._v(" "),i("span",{staticClass:"help-tip-item-text"},[t._v("\n                    "+t._s(t.$t("helpTipShrink"))+"\n                ")])])])])])},staticRenderFns:[]};e.a=n},XRKD:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mini-floor-plan-container"},[i("div",{staticClass:"floor-plan-content",on:{click:function(e){return t.changeMode("floorplan")}}},[i("div",{staticClass:"floor-plan-area",domProps:{innerHTML:t._s(t.currentArea)}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.floorPlanImageUrl,expression:"floorPlanImageUrl"}],staticClass:"floor-plan-compass"},[i("span",{staticClass:"floor-plan-compass-text"},[t._v("\n                "+t._s(this.currentCompass.up)+"\n            ")]),t._v(" "),i("i",{staticClass:"floor-plan-compass-arrow"})]),t._v(" "),i("div",{staticClass:"floor-plan-img-container-box"},[i("div",{staticClass:"floor-plan-img-container"},[i("img",{staticClass:"floor-plan-img",style:{width:t.miniFloorPlanWidth,height:t.miniFloorPlanHeight},attrs:{src:t.floorPlanImageUrl,alt:""}}),t._v(" "),i("img",{directives:[{name:"show",rawName:"v-show",value:t.floorPlanImageUrl,expression:"floorPlanImageUrl"}],staticClass:"locating-point",style:{left:"calc("+t.currentPosition.x+" - 1.1rem)",top:"calc("+t.currentPosition.y+" - 1.1rem)",transform:"rotate("+t.currentAngle+"deg)",transition:"left "+t.currentPosition.time/1e3+"s,top "+t.currentPosition.time/1e3+"s"},attrs:{src:t.locationgPointIcon,alt:""}})])])]),t._v(" "),i("div",{staticClass:"doll-house-container",on:{click:function(e){return t.changeMode("dollhouse")}}},[i("i",{staticClass:"doll-house-icon"}),t._v(" "),i("span",{staticClass:"doll-house-text"},[t._v("\n            "+t._s(t.$t("look3DDesc"))+"\n        ")])])])},staticRenderFns:[]};e.a=n},"Xes+":function(t,e){},Xkrt:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"disclaimer-content-container",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeDisclaimer(e)},touchmove:function(t){if(t.target!==t.currentTarget)return null;t.preventDefault()},scroll:function(t){if(t.target!==t.currentTarget)return null;t.preventDefault()},mousewheel:function(t){if(t.target!==t.currentTarget)return null;t.preventDefault()}}},[i("div",{staticClass:"disclaimer-content"},[i("div",{staticClass:"disclaimer-header"},[i("span",{staticClass:"disclaimer-title"},[t._v(t._s(t.$t("disclaimerBtnText")))]),t._v(" "),i("div",{staticClass:"disclaimer-close",on:{click:t.closeDisclaimer}})]),t._v(" "),i("div",{staticClass:"disclaimer-main scroll_content pc",domProps:{innerHTML:t._s(t.disclaimerContent)}})])])},staticRenderFns:[]};e.a=n},XkyW:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("DXAO"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("5fTZ");var s=function(t){i("3lr+")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-50e132ea",null);e.default=l.exports},Xq9B:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"floor-plan-container not-event"},[i("img",{directives:[{name:"show",rawName:"v-show",value:t.currentFloorPlanData,expression:"currentFloorPlanData"}],staticClass:"floor-plan-img not-event",style:{top:t.currentFloorPlanData.top+"px",left:t.currentFloorPlanData.left+"px",width:t.currentFloorPlanData.width+"px",height:t.currentFloorPlanData.height+"px"},attrs:{src:t.currentFloorPlanData.imageUrl,alt:""}}),t._v(" "),t._l(t.currentRoomList,function(e,n){return i("span",{key:n,staticClass:"floor-plan-room",style:{top:e.top+"px",left:e.left+"px",transform:"translate(-50%,-50%)"}},[t._v("\n         "+t._s(e.roomname)+"\n     ")])}),t._v(" "),t.whData&&t.whData.wData&&t.modelSettings.basic&&t.modelSettings.basic.menu&&t.modelSettings.basic.menu.floorplan_enable?i("div",{staticClass:"floor-plan-width",style:{top:t.whData.wData.wDataTop+"px",left:t.whData.wData.wDataLeft+"px",width:t.whData.wData.width+"px"}},[i("span",{staticClass:"floor-plan-width-text"},[t._v("\n             "+t._s(t.whData.wData.wDataText)+"\n         ")])]):t._e(),t._v(" "),t.whData&&t.whData.hData&&t.modelSettings.basic&&t.modelSettings.basic.menu&&t.modelSettings.basic.menu.floorplan_enable?i("div",{staticClass:"floor-plan-height",style:{top:t.whData.hData.hDataTop+"px",left:t.whData.hData.hDataLeft+"px",height:t.whData.hData.height+"px"}},[i("span",{staticClass:"floor-plan-height-text"},[t._v("\n             "+t._s(t.whData.hData.hDataText)+"\n         ")])]):t._e(),t._v(" "),t.entranceData&&t.entranceData.isShow?i("div",{staticClass:"entry-point",style:{top:t.entranceData.top+"px",left:t.entranceData.left+"px"}},[i("p",{staticClass:"entry-img",class:{class:t.entranceData.state},style:{transform:"rotate("+t.entranceData.angle+"deg)"}})]):t._e(),t._v(" "),i("img",{directives:[{name:"show",rawName:"v-show",value:t.radarData&&t.radarData.isShow,expression:"radarData&&radarData.isShow"}],staticClass:"locating-point",style:{top:t.radarData.top+"px",left:t.radarData.left+"px",transform:"translate(-50%,-50%) rotate("+t.radarData.angle+"deg)"},attrs:{src:t.locationgPointIcon,alt:""}}),t._v(" "),t.whData&&t.whData.hData?i("div",{staticClass:"compass-north-container",style:{top:t.whData.hData.hDataTop-140+"px"}},[i("span",{staticClass:"compass-north-text"},[t._v("\n             "+t._s(this.currentCompass.up)+"\n         ")]),t._v(" "),i("i",{staticClass:"compass-north-icon"})]):t._e(),t._v(" "),t.whData&&t.whData.wData?i("div",{staticClass:"compass-south-container",style:{top:t.whData.wData.wDataTop+70+"px"}},[i("i",{staticClass:"compass-south-icon"}),t._v(" "),i("span",{staticClass:"compass-south-text"},[t._v("\n             "+t._s(this.currentCompass.down)+"\n         ")])]):t._e()],2)},staticRenderFns:[]};e.a=n},XulS:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=l(i("BfP+")),o=l(i("/8EQ")),r=l(i("1hEm")),a=l(i("e4Gv")),s=l(i("VYXT"));function l(t){return t&&t.__esModule?t:{default:t}}e.default={components:{BottomComponent:n.default,MiniMiddleman:o.default,LectureRoom:r.default,ScenePanel:a.default,ModeBtn:s.default},props:{},name:"mobile-bottom-container",data:function(){return{}},computed:{currentMode:function(){return this.$store.state.currentMode},sceneIsActive:function(){return this.$store.state.sceneIsActive},lectureIsActive:function(){return this.$store.state.lectureIsActive},sceneList:function(){return this.$store.state.sceneList},lectureList:function(){return this.$store.state.lectureList},MiddleManState:function(){return this.$store.state.MiddleManState},SpeakHouseState:function(){return this.$store.state.SpeakHouseState}},created:function(){},mounted:function(){},methods:{}}},"Y/CI":function(t,e){},Y0xb:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"video-tag-container",data:function(){return{}},computed:{currentTagData:function(){return this.$store.state.currentTagData}},created:function(){},mounted:function(){},methods:{closeTagContainer:function(){this.statistic_utils.trackEvent(79),this.$store.dispatch("changeTagStatus",!1)}}}},YFyo:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("Txow"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("CERm"),s=i("VU/8")(o.a,a.a,!1,null,null,null);e.default=s.exports},YaEn:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(i("//Fk")),o=a(i("7+uW")),r=a(i("/ocq"));function a(t){return t&&t.__esModule?t:{default:t}}var s,l=function(){return n.default.resolve().then(function(){return function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i("h3k4"))})};o.default.use(r.default),e.default=new r.default({mode:"history",base:(s=location.pathname,s.substring(0,s.lastIndexOf("/")+1)),routes:[{path:"/",name:"Index",component:l},{path:"/index",name:"Index",component:l},{path:"/index.html",name:"Index",component:l},{path:"/house",name:"House",component:l}]})},YhjZ:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"company-logo-container"},[e("img",{staticClass:"company-logo-content",attrs:{src:this.companyLogoUrl,alt:""}})])},staticRenderFns:[]};e.a=n},Yp0v:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("KiBx"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("Xq9B");var s=function(t){i("u62a")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-9b375e60",null);e.default=l.exports},YwPD:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("tzae"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("CqPc");var s=function(t){i("5NOO")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-7422bcf8",null);e.default=l.exports},"Z/uV":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"house-component-mask",on:{click:function(e){return e.target!==e.currentTarget?null:t.closePanel(e)},blur:t.blurEvent}},[i("transition",{attrs:{name:"page-turnning"}},[t.isOpen?i("div",{staticClass:"house-component-container"},[i("swiper",{attrs:{options:t.swiperOption}},t._l(t.houseInfoArr,function(t,e){return i("swiper-slide",{key:e},[i(t.template,{tag:"component"})],1)}),1)],1):t._e()])],1)},staticRenderFns:[]};e.a=n},Z0Xs:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"multiple-fun-container",class:{"multiple-icon":this.MiddleManState}},[e("single-feature",{staticClass:"single-feature-container",staticStyle:{display:"none"}},[e("i",{staticClass:"single-feature-icon take-look-icon",attrs:{slot:"feature-icon"},slot:"feature-icon"}),this._v(" "),e("span",{staticClass:"single-feature-text take-look-text",attrs:{slot:"feature-icon"},slot:"feature-icon"},[this._v(this._s(this.$t("takeLookText")))])]),this._v(" "),e("tool-component")],1)},staticRenderFns:[]};e.a=n},Z9DN:function(t,e){},ZHH0:function(t,e){},ZOAN:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("2p3U"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("5e1Z");var s=function(t){i("nY2A")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-0524aefd",null);e.default=l.exports},"ZR+X":function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"full-screen-container",class:{active:this.isFull,"full-icon":this.ShareFullState},on:{click:this.toggleFull}},[e("div",{staticClass:"full-screen-content"})])},staticRenderFns:[]};e.a=n},ZTVv:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"house-info",data:function(){return{companyId:this.$store.state.companyId,houseInfoData:this.$store.state.houseInfo}},computed:{},created:function(){},mounted:function(){},methods:{goHouseInfoDetails:function(){if(this.statistic_utils.trackEvent(28),this.houseInfoData.houseInfo&&this.houseInfoData.houseInfo.houseDetail)if(14===this.companyId){var t={open:this.houseInfoData.houseInfo.houseDetail,down:this.houseInfoData.houseInfo.downUrl},e=document.createElement("iframe"),i=document.body;e.style.cssText="display:none;width=0;height=0";var n=null;document.addEventListener("visibilitychange",function(t){(document.hidden||document.webkitHidden)&&clearTimeout(n)},!1),document.addEventListener("webkitvisibilitychange",function(t){(document.hidden||document.webkitHidden)&&clearTimeout(n)},!1),window.addEventListener("pagehide",function(t){clearTimeout(n)}),/MicroMessenger/gi.test(navigator.userAgent)?window.location.href=t.down:(i.appendChild(e),e.src=t.open,n=setTimeout(function(){window.location.href=t.down},3e3))}else window.location.href=this.houseInfoData.houseInfo.houseDetail}}}},ZUlf:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(i("YFyo")),o=r(i("HcVH"));function r(t){return t&&t.__esModule?t:{default:t}}e.default={props:{},components:{BaiduMap:n.default,BmMarker:o.default},name:"big-baidu-map",data:function(){return{map:{width:"100%",height:"100%"}}},computed:{houseInfoData:function(){return this.$store.state.houseInfo}},created:function(){},mounted:function(){},methods:{closeBigMapContent:function(){this.statistic_utils.trackEvent(77),this.$store.dispatch("toggleBigMapStatus",!1),!this.$store.state.takeLookInfoStateIsUpdate||"1"!==this.$store.state.takeLookRole&&"2"!==this.$store.state.takeLookRole&&"3"!==this.$store.state.takeLookRole||this.$store.dispatch("changeTakeLookOperation",{type:"UI",target:"bigMap",action:!1})},syncCenterAndZoom:function(t){},lookDetail:function(t,e){var i=this;if(this.infoWindow.show=!0,this.infoWindow.info=t,this.activeName=t.name,this.$nextTick(function(){document.querySelector(".BMap_bubble_title").title=i.activeName}),"left"==e)return this.map.center={lng:t.lng,lat:t.lat},void(this.map.zoom=15);this.$nextTick(function(){var t=document.querySelector(".active").offsetTop;i.$refs.box.scrollTop=t-180})}}}},ZbBr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(i("YFyo")),o=r(i("HcVH"));function r(t){return t&&t.__esModule?t:{default:t}}e.default={props:{},components:{BaiduMap:n.default,BmMarker:o.default},name:"small-baidu-map",data:function(){return{map:{width:"87%",height:"82.15%"}}},computed:{houseInfoData:function(){return this.$store.state.houseInfo}},created:function(){},mounted:function(){},methods:{showBigMap:function(t){this.statistic_utils.trackEvent(8),this.$store.dispatch("toggleHouseInfoPanel",!1),this.$store.dispatch("toggleBigMapStatus",!0),!this.$store.state.takeLookInfoStateIsUpdate||"1"!==this.$store.state.takeLookRole&&"2"!==this.$store.state.takeLookRole&&"3"!==this.$store.state.takeLookRole||(this.$store.dispatch("changeTakeLookOperation",{type:"UI",target:"houseInfo",action:!1}),this.$store.dispatch("changeTakeLookOperation",{type:"UI",target:"bigMap",action:!0}))},syncCenterAndZoom:function(t){},lookDetail:function(t,e){var i=this;if(this.infoWindow.show=!0,this.infoWindow.info=t,this.activeName=t.name,this.$nextTick(function(){document.querySelector(".BMap_bubble_title").title=i.activeName}),"left"==e)return this.map.center={lng:t.lng,lat:t.lat},void(this.map.zoom=15);this.$nextTick(function(){var t=document.querySelector(".active").offsetTop;i.$refs.box.scrollTop=t-180})}}}},Zcgf:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.houseInfoData&&t.houseInfoData.brokerInfo&&t.houseInfoData.brokerInfo.enable&&t.MiddleManState?i("div",{staticClass:"mini-middle-man-container"},[i("div",{directives:[{name:"longpress",rawName:"v-longpress",value:t.openMiddlemanTranspond,expression:"openMiddlemanTranspond"}],staticClass:"mini-middle-man-bg-container",on:{click:t.showTelDialog}},[i("div",{staticClass:"middle-man-bg",style:{backgroundImage:"url("+(t.brokerImage||t.defaultBg)+")"}}),t._v(" "),i("i",{staticClass:"middle-man-tel"})])]):t._e()},staticRenderFns:[]};e.a=n},ZkrG:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"take-look-container",on:{click:this.openTakeLook}},[e("i",{staticClass:"take-look-icon"}),this._v(" "),e("span",{staticClass:"take-look-text"},[this._v("\n       "+this._s(this.$t("takeLookText"))+"\n   ")])])},staticRenderFns:[]};e.a=n},ZnAq:function(t,e){},a1tv:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("dT/n"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("sANT");var s=function(t){i("gzC7")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-1904a3c3",null);e.default=l.exports},aDho:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mini-chat-container",on:{click:function(e){return e.stopPropagation(),t.goChat(e)}}},[i("i",{staticClass:"mini-chat-icon"}),t._v(" "),i("span",{staticClass:"mini-chat-text"},[t._v("\n       "+t._s(t.$t("miniChatText"))+"\n   ")])])},staticRenderFns:[]};e.a=n},aNZS:function(t,e){},aPJZ:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={components:{},props:{},name:"mobile-company-logo",data:function(){return{}},computed:{companyLogoUrl:function(){return this.$store.state.companyLogoUrl}},created:function(){},mounted:function(){},methods:{}}},aPOO:function(t,e,i){"use strict";t.exports={title:"title",share:{enable:!0,share_link:"",share_context:"title",share_img:"",share_title:"title"},offline:{text:"该房源已下架，您可以联系下方经纪人为您推荐其他优质房源！",houseDetail:""},houseInfo:{enable:!0,version:0,list:"menu_info",map:{lon:"address_x",lat:"address_y"},houseDetail:"jump_url"},brokerInfo:{enable:!0,brokerImage:"middleman_img",brokerPhone:"middleman_tel",brokerName:"middleman",PcPhoneTip:""},homeLink:{enable:!1,link:""},panoramaLink:{enable:!1,link:""},commonJsonData:{area_text:"",district_text:"",purpose_text:"",house_type:"户型",acreage_value:"建筑面积",orientation_text:"朝向",decoration_type:"装修",floor_text:"楼层",complation_date:"建筑年代",total_price:"售价",address_details:"",house_status:"",longitude_value:"address_x",latitude_value:"address_y",more_details_address:"jump_url",community_name:"小区",unit_price:"",sell_type:"",city_text:"",developer_name:"",elevator_issupport:"",listing_time:"",rent_price:"",hangpaiurl:""}}},al0r:function(t,e){},ate9:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("WnXe"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("qLlL");var s=function(t){i("Xes+")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-cb19bbac",null);e.default=l.exports},avSM:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"video-tag-container",data:function(){return{}},computed:{currentTagData:function(){return this.$store.state.currentTagData}},created:function(){},mounted:function(){},methods:{closeTagContainer:function(){this.statistic_utils.trackEvent(79),this.$store.dispatch("changeTagStatus",!1)}}}},awxD:function(t,e,i){var n,o,r;o="undefined"!=typeof window?window:this,r=function(o,r){var a=[],s=a.slice,l=a.concat,c=a.push,u=a.indexOf,h={},d=h.toString,p=h.hasOwnProperty,f={},m=o.document,g="2.1.1",v=function(t,e){return new v.fn.init(t,e)},y=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,b=/^-ms-/,w=/-([\da-z])/gi,x=function(t,e){return e.toUpperCase()};function _(t){var e=t.length,i=v.type(t);return"function"!==i&&!v.isWindow(t)&&(!(1!==t.nodeType||!e)||("array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t))}v.fn=v.prototype={jquery:g,constructor:v,selector:"",length:0,toArray:function(){return s.call(this)},get:function(t){return null!=t?0>t?this[t+this.length]:this[t]:s.call(this)},pushStack:function(t){var e=v.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return v.each(this,t,e)},map:function(t){return this.pushStack(v.map(this,function(e,i){return t.call(e,i,e)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(0>t?e:0);return this.pushStack(i>=0&&e>i?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:c,sort:a.sort,splice:a.splice},v.extend=v.fn.extend=function(){var t,e,i,n,o,r,a=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[s]||{},s++),"object"==typeof a||v.isFunction(a)||(a={}),s===l&&(a=this,s--);l>s;s++)if(null!=(t=arguments[s]))for(e in t)i=a[e],a!==(n=t[e])&&(c&&n&&(v.isPlainObject(n)||(o=v.isArray(n)))?(o?(o=!1,r=i&&v.isArray(i)?i:[]):r=i&&v.isPlainObject(i)?i:{},a[e]=v.extend(c,r,n)):void 0!==n&&(a[e]=n));return a},v.extend({expando:"jQuery"+(g+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===v.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){return!v.isArray(t)&&t-parseFloat(t)>=0},isPlainObject:function(t){return"object"===v.type(t)&&!t.nodeType&&!v.isWindow(t)&&!(t.constructor&&!p.call(t.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?h[d.call(t)]||"object":typeof t},globalEval:function(t){var e,i=eval;(t=v.trim(t))&&(1===t.indexOf("use strict")?((e=m.createElement("script")).text=t,m.head.appendChild(e).parentNode.removeChild(e)):i(t))},camelCase:function(t){return t.replace(b,"ms-").replace(w,x)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,i){var n=0,o=t.length,r=_(t);if(i){if(r)for(;o>n&&!1!==e.apply(t[n],i);n++);else for(n in t)if(!1===e.apply(t[n],i))break}else if(r)for(;o>n&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},trim:function(t){return null==t?"":(t+"").replace(y,"")},makeArray:function(t,e){var i=e||[];return null!=t&&(_(Object(t))?v.merge(i,"string"==typeof t?[t]:t):c.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:u.call(e,t,i)},merge:function(t,e){for(var i=+e.length,n=0,o=t.length;i>n;n++)t[o++]=e[n];return t.length=o,t},grep:function(t,e,i){for(var n=[],o=0,r=t.length,a=!i;r>o;o++)!e(t[o],o)!==a&&n.push(t[o]);return n},map:function(t,e,i){var n,o=0,r=t.length,a=[];if(_(t))for(;r>o;o++)null!=(n=e(t[o],o,i))&&a.push(n);else for(o in t)null!=(n=e(t[o],o,i))&&a.push(n);return l.apply([],a)},guid:1,proxy:function(t,e){var i,n,o;return"string"==typeof e&&(i=t[e],e=t,t=i),v.isFunction(t)?(n=s.call(arguments,2),(o=function(){return t.apply(e||this,n.concat(s.call(arguments)))}).guid=t.guid=t.guid||v.guid++,o):void 0},now:Date.now,support:f}),v.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){h["[object "+e+"]"]=e.toLowerCase()});var S=function(t){var e,i,n,o,r,a,s,l,c,u,h,d,p,f,m,g,v,y,b,w="sizzle"+-new Date,x=t.document,_=0,S=0,T=rt(),M=rt(),I=rt(),P=function(t,e){return t===e&&(h=!0),0},C="undefined",A=1<<31,E={}.hasOwnProperty,L=[],D=L.pop,k=L.push,R=L.push,O=L.slice,F=L.indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(this[e]===t)return e;return-1},N="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",U="[\\x20\\t\\r\\n\\f]",B="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",z=B.replace("w","w#"),V="\\["+U+"*("+B+")(?:"+U+"*([*^$|!~]?=)"+U+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+z+"))|)"+U+"*\\]",G=":("+B+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+V+")*)|.*)\\)|)",j=new RegExp("^"+U+"+|((?:^|[^\\\\])(?:\\\\.)*)"+U+"+$","g"),H=new RegExp("^"+U+"*,"+U+"*"),W=new RegExp("^"+U+"*([>+~]|"+U+")"+U+"*"),q=new RegExp("="+U+"*([^\\]'\"]*?)"+U+"*\\]","g"),$=new RegExp(G),Y=new RegExp("^"+z+"$"),X={ID:new RegExp("^#("+B+")"),CLASS:new RegExp("^\\.("+B+")"),TAG:new RegExp("^("+B.replace("w","w*")+")"),ATTR:new RegExp("^"+V),PSEUDO:new RegExp("^"+G),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+U+"*(even|odd|(([+-]|)(\\d*)n|)"+U+"*(?:([+-]|)"+U+"*(\\d+)|))"+U+"*\\)|)","i"),bool:new RegExp("^(?:"+N+")$","i"),needsContext:new RegExp("^"+U+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+U+"*((?:-\\d)?\\d*)"+U+"*\\)|)(?=[^-]|$)","i")},Q=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,K=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=/'|\\/g,it=new RegExp("\\\\([\\da-f]{1,6}"+U+"?|("+U+")|.)","ig"),nt=function(t,e,i){var n="0x"+e-65536;return n!=n||i?e:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)};try{R.apply(L=O.call(x.childNodes),x.childNodes),L[x.childNodes.length].nodeType}catch(t){R={apply:L.length?function(t,e){k.apply(t,O.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}function ot(t,e,n,o){var r,s,c,u,h,f,v,y,_,S;if((e?e.ownerDocument||e:x)!==p&&d(e),e=e||p,n=n||[],!t||"string"!=typeof t)return n;if(1!==(u=e.nodeType)&&9!==u)return[];if(m&&!o){if(r=J.exec(t))if(c=r[1]){if(9===u){if(!(s=e.getElementById(c))||!s.parentNode)return n;if(s.id===c)return n.push(s),n}else if(e.ownerDocument&&(s=e.ownerDocument.getElementById(c))&&b(e,s)&&s.id===c)return n.push(s),n}else{if(r[2])return R.apply(n,e.getElementsByTagName(t)),n;if((c=r[3])&&i.getElementsByClassName&&e.getElementsByClassName)return R.apply(n,e.getElementsByClassName(c)),n}if(i.qsa&&(!g||!g.test(t))){if(y=v=w,_=e,S=9===u&&t,1===u&&"object"!==e.nodeName.toLowerCase()){for(f=a(t),(v=e.getAttribute("id"))?y=v.replace(et,"\\$&"):e.setAttribute("id",y),y="[id='"+y+"'] ",h=f.length;h--;)f[h]=y+mt(f[h]);_=tt.test(t)&&pt(e.parentNode)||e,S=f.join(",")}if(S)try{return R.apply(n,_.querySelectorAll(S)),n}catch(t){}finally{v||e.removeAttribute("id")}}}return l(t.replace(j,"$1"),e,n,o)}function rt(){var t=[];return function e(i,o){return t.push(i+" ")>n.cacheLength&&delete e[t.shift()],e[i+" "]=o}}function at(t){return t[w]=!0,t}function st(t){var e=p.createElement("div");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function lt(t,e){for(var i=t.split("|"),o=t.length;o--;)n.attrHandle[i[o]]=e}function ct(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||A)-(~t.sourceIndex||A);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function ut(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function ht(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function dt(t){return at(function(e){return e=+e,at(function(i,n){for(var o,r=t([],i.length,e),a=r.length;a--;)i[o=r[a]]&&(i[o]=!(n[o]=i[o]))})})}function pt(t){return t&&typeof t.getElementsByTagName!==C&&t}for(e in i=ot.support={},r=ot.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},d=ot.setDocument=function(t){var e,o=t?t.ownerDocument||t:x,a=o.defaultView;return o!==p&&9===o.nodeType&&o.documentElement?(p=o,f=o.documentElement,m=!r(o),a&&a!==a.top&&(a.addEventListener?a.addEventListener("unload",function(){d()},!1):a.attachEvent&&a.attachEvent("onunload",function(){d()})),i.attributes=st(function(t){return t.className="i",!t.getAttribute("className")}),i.getElementsByTagName=st(function(t){return t.appendChild(o.createComment("")),!t.getElementsByTagName("*").length}),i.getElementsByClassName=K.test(o.getElementsByClassName)&&st(function(t){return t.innerHTML="<div class='a'></div><div class='a i'></div>",t.firstChild.className="i",2===t.getElementsByClassName("i").length}),i.getById=st(function(t){return f.appendChild(t).id=w,!o.getElementsByName||!o.getElementsByName(w).length}),i.getById?(n.find.ID=function(t,e){if(typeof e.getElementById!==C&&m){var i=e.getElementById(t);return i&&i.parentNode?[i]:[]}},n.filter.ID=function(t){var e=t.replace(it,nt);return function(t){return t.getAttribute("id")===e}}):(delete n.find.ID,n.filter.ID=function(t){var e=t.replace(it,nt);return function(t){var i=typeof t.getAttributeNode!==C&&t.getAttributeNode("id");return i&&i.value===e}}),n.find.TAG=i.getElementsByTagName?function(t,e){return typeof e.getElementsByTagName!==C?e.getElementsByTagName(t):void 0}:function(t,e){var i,n=[],o=0,r=e.getElementsByTagName(t);if("*"===t){for(;i=r[o++];)1===i.nodeType&&n.push(i);return n}return r},n.find.CLASS=i.getElementsByClassName&&function(t,e){return typeof e.getElementsByClassName!==C&&m?e.getElementsByClassName(t):void 0},v=[],g=[],(i.qsa=K.test(o.querySelectorAll))&&(st(function(t){t.innerHTML="<select msallowclip=''><option selected=''></option></select>",t.querySelectorAll("[msallowclip^='']").length&&g.push("[*^$]="+U+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||g.push("\\["+U+"*(?:value|"+N+")"),t.querySelectorAll(":checked").length||g.push(":checked")}),st(function(t){var e=o.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&g.push("name"+U+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||g.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),g.push(",.*:")})),(i.matchesSelector=K.test(y=f.matches||f.webkitMatchesSelector||f.mozMatchesSelector||f.oMatchesSelector||f.msMatchesSelector))&&st(function(t){i.disconnectedMatch=y.call(t,"div"),y.call(t,"[s!='']:x"),v.push("!=",G)}),g=g.length&&new RegExp(g.join("|")),v=v.length&&new RegExp(v.join("|")),e=K.test(f.compareDocumentPosition),b=e||K.test(f.contains)?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},P=e?function(t,e){if(t===e)return h=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n||(1&(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!i.sortDetached&&e.compareDocumentPosition(t)===n?t===o||t.ownerDocument===x&&b(x,t)?-1:e===o||e.ownerDocument===x&&b(x,e)?1:u?F.call(u,t)-F.call(u,e):0:4&n?-1:1)}:function(t,e){if(t===e)return h=!0,0;var i,n=0,r=t.parentNode,a=e.parentNode,s=[t],l=[e];if(!r||!a)return t===o?-1:e===o?1:r?-1:a?1:u?F.call(u,t)-F.call(u,e):0;if(r===a)return ct(t,e);for(i=t;i=i.parentNode;)s.unshift(i);for(i=e;i=i.parentNode;)l.unshift(i);for(;s[n]===l[n];)n++;return n?ct(s[n],l[n]):s[n]===x?-1:l[n]===x?1:0},o):p},ot.matches=function(t,e){return ot(t,null,null,e)},ot.matchesSelector=function(t,e){if((t.ownerDocument||t)!==p&&d(t),e=e.replace(q,"='$1']"),!(!i.matchesSelector||!m||v&&v.test(e)||g&&g.test(e)))try{var n=y.call(t,e);if(n||i.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(t){}return ot(e,p,null,[t]).length>0},ot.contains=function(t,e){return(t.ownerDocument||t)!==p&&d(t),b(t,e)},ot.attr=function(t,e){(t.ownerDocument||t)!==p&&d(t);var o=n.attrHandle[e.toLowerCase()],r=o&&E.call(n.attrHandle,e.toLowerCase())?o(t,e,!m):void 0;return void 0!==r?r:i.attributes||!m?t.getAttribute(e):(r=t.getAttributeNode(e))&&r.specified?r.value:null},ot.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},ot.uniqueSort=function(t){var e,n=[],o=0,r=0;if(h=!i.detectDuplicates,u=!i.sortStable&&t.slice(0),t.sort(P),h){for(;e=t[r++];)e===t[r]&&(o=n.push(r));for(;o--;)t.splice(n[o],1)}return u=null,t},o=ot.getText=function(t){var e,i="",n=0,r=t.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=o(t)}else if(3===r||4===r)return t.nodeValue}else for(;e=t[n++];)i+=o(e);return i},(n=ot.selectors={cacheLength:50,createPseudo:at,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(it,nt),t[3]=(t[3]||t[4]||t[5]||"").replace(it,nt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||ot.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&ot.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return X.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&$.test(i)&&(e=a(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(it,nt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=T[t+" "];return e||(e=new RegExp("(^|"+U+")"+t+"("+U+"|$)"))&&T(t,function(t){return e.test("string"==typeof t.className&&t.className||typeof t.getAttribute!==C&&t.getAttribute("class")||"")})},ATTR:function(t,e,i){return function(n){var o=ot.attr(n,t);return null==o?"!="===e:!e||(o+="","="===e?o===i:"!="===e?o!==i:"^="===e?i&&0===o.indexOf(i):"*="===e?i&&o.indexOf(i)>-1:"$="===e?i&&o.slice(-i.length)===i:"~="===e?(" "+o+" ").indexOf(i)>-1:"|="===e&&(o===i||o.slice(0,i.length+1)===i+"-"))}},CHILD:function(t,e,i,n,o){var r="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===n&&0===o?function(t){return!!t.parentNode}:function(e,i,l){var c,u,h,d,p,f,m=r!==a?"nextSibling":"previousSibling",g=e.parentNode,v=s&&e.nodeName.toLowerCase(),y=!l&&!s;if(g){if(r){for(;m;){for(h=e;h=h[m];)if(s?h.nodeName.toLowerCase()===v:1===h.nodeType)return!1;f=m="only"===t&&!f&&"nextSibling"}return!0}if(f=[a?g.firstChild:g.lastChild],a&&y){for(p=(c=(u=g[w]||(g[w]={}))[t]||[])[0]===_&&c[1],d=c[0]===_&&c[2],h=p&&g.childNodes[p];h=++p&&h&&h[m]||(d=p=0)||f.pop();)if(1===h.nodeType&&++d&&h===e){u[t]=[_,p,d];break}}else if(y&&(c=(e[w]||(e[w]={}))[t])&&c[0]===_)d=c[1];else for(;(h=++p&&h&&h[m]||(d=p=0)||f.pop())&&((s?h.nodeName.toLowerCase()!==v:1!==h.nodeType)||!++d||(y&&((h[w]||(h[w]={}))[t]=[_,d]),h!==e)););return(d-=o)===n||d%n==0&&d/n>=0}}},PSEUDO:function(t,e){var i,o=n.pseudos[t]||n.setFilters[t.toLowerCase()]||ot.error("unsupported pseudo: "+t);return o[w]?o(e):o.length>1?(i=[t,t,"",e],n.setFilters.hasOwnProperty(t.toLowerCase())?at(function(t,i){for(var n,r=o(t,e),a=r.length;a--;)t[n=F.call(t,r[a])]=!(i[n]=r[a])}):function(t){return o(t,0,i)}):o}},pseudos:{not:at(function(t){var e=[],i=[],n=s(t.replace(j,"$1"));return n[w]?at(function(t,e,i,o){for(var r,a=n(t,null,o,[]),s=t.length;s--;)(r=a[s])&&(t[s]=!(e[s]=r))}):function(t,o,r){return e[0]=t,n(e,null,r,i),!i.pop()}}),has:at(function(t){return function(e){return ot(t,e).length>0}}),contains:at(function(t){return function(e){return(e.textContent||e.innerText||o(e)).indexOf(t)>-1}}),lang:at(function(t){return Y.test(t||"")||ot.error("unsupported lang: "+t),t=t.replace(it,nt).toLowerCase(),function(e){var i;do{if(i=m?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(i=i.toLowerCase())===t||0===i.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===f},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return!1===t.disabled},disabled:function(t){return!0===t.disabled},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!n.pseudos.empty(t)},header:function(t){return Z.test(t.nodeName)},input:function(t){return Q.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:dt(function(){return[0]}),last:dt(function(t,e){return[e-1]}),eq:dt(function(t,e,i){return[0>i?i+e:i]}),even:dt(function(t,e){for(var i=0;e>i;i+=2)t.push(i);return t}),odd:dt(function(t,e){for(var i=1;e>i;i+=2)t.push(i);return t}),lt:dt(function(t,e,i){for(var n=0>i?i+e:i;--n>=0;)t.push(n);return t}),gt:dt(function(t,e,i){for(var n=0>i?i+e:i;++n<e;)t.push(n);return t})}}).pseudos.nth=n.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})n.pseudos[e]=ut(e);for(e in{submit:!0,reset:!0})n.pseudos[e]=ht(e);function ft(){}function mt(t){for(var e=0,i=t.length,n="";i>e;e++)n+=t[e].value;return n}function gt(t,e,i){var n=e.dir,o=i&&"parentNode"===n,r=S++;return e.first?function(e,i,r){for(;e=e[n];)if(1===e.nodeType||o)return t(e,i,r)}:function(e,i,a){var s,l,c=[_,r];if(a){for(;e=e[n];)if((1===e.nodeType||o)&&t(e,i,a))return!0}else for(;e=e[n];)if(1===e.nodeType||o){if((s=(l=e[w]||(e[w]={}))[n])&&s[0]===_&&s[1]===r)return c[2]=s[2];if(l[n]=c,c[2]=t(e,i,a))return!0}}}function vt(t){return t.length>1?function(e,i,n){for(var o=t.length;o--;)if(!t[o](e,i,n))return!1;return!0}:t[0]}function yt(t,e,i,n,o){for(var r,a=[],s=0,l=t.length,c=null!=e;l>s;s++)(r=t[s])&&(!i||i(r,n,o))&&(a.push(r),c&&e.push(s));return a}function bt(t,e,i,n,o,r){return n&&!n[w]&&(n=bt(n)),o&&!o[w]&&(o=bt(o,r)),at(function(r,a,s,l){var c,u,h,d=[],p=[],f=a.length,m=r||function(t,e,i){for(var n=0,o=e.length;o>n;n++)ot(t,e[n],i);return i}(e||"*",s.nodeType?[s]:s,[]),g=!t||!r&&e?m:yt(m,d,t,s,l),v=i?o||(r?t:f||n)?[]:a:g;if(i&&i(g,v,s,l),n)for(c=yt(v,p),n(c,[],s,l),u=c.length;u--;)(h=c[u])&&(v[p[u]]=!(g[p[u]]=h));if(r){if(o||t){if(o){for(c=[],u=v.length;u--;)(h=v[u])&&c.push(g[u]=h);o(null,v=[],c,l)}for(u=v.length;u--;)(h=v[u])&&(c=o?F.call(r,h):d[u])>-1&&(r[c]=!(a[c]=h))}}else v=yt(v===a?v.splice(f,v.length):v),o?o(null,a,v,l):R.apply(a,v)})}function wt(t){for(var e,i,o,r=t.length,a=n.relative[t[0].type],s=a||n.relative[" "],l=a?1:0,u=gt(function(t){return t===e},s,!0),h=gt(function(t){return F.call(e,t)>-1},s,!0),d=[function(t,i,n){return!a&&(n||i!==c)||((e=i).nodeType?u(t,i,n):h(t,i,n))}];r>l;l++)if(i=n.relative[t[l].type])d=[gt(vt(d),i)];else{if((i=n.filter[t[l].type].apply(null,t[l].matches))[w]){for(o=++l;r>o&&!n.relative[t[o].type];o++);return bt(l>1&&vt(d),l>1&&mt(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(j,"$1"),i,o>l&&wt(t.slice(l,o)),r>o&&wt(t=t.slice(o)),r>o&&mt(t))}d.push(i)}return vt(d)}function xt(t,e){var i=e.length>0,o=t.length>0,r=function(r,a,s,l,u){var h,d,f,m=0,g="0",v=r&&[],y=[],b=c,w=r||o&&n.find.TAG("*",u),x=_+=null==b?1:Math.random()||.1,S=w.length;for(u&&(c=a!==p&&a);g!==S&&null!=(h=w[g]);g++){if(o&&h){for(d=0;f=t[d++];)if(f(h,a,s)){l.push(h);break}u&&(_=x)}i&&((h=!f&&h)&&m--,r&&v.push(h))}if(m+=g,i&&g!==m){for(d=0;f=e[d++];)f(v,y,a,s);if(r){if(m>0)for(;g--;)v[g]||y[g]||(y[g]=D.call(l));y=yt(y)}R.apply(l,y),u&&!r&&y.length>0&&m+e.length>1&&ot.uniqueSort(l)}return u&&(_=x,c=b),v};return i?at(r):r}return ft.prototype=n.filters=n.pseudos,n.setFilters=new ft,a=ot.tokenize=function(t,e){var i,o,r,a,s,l,c,u=M[t+" "];if(u)return e?0:u.slice(0);for(s=t,l=[],c=n.preFilter;s;){for(a in(!i||(o=H.exec(s)))&&(o&&(s=s.slice(o[0].length)||s),l.push(r=[])),i=!1,(o=W.exec(s))&&(i=o.shift(),r.push({value:i,type:o[0].replace(j," ")}),s=s.slice(i.length)),n.filter)!(o=X[a].exec(s))||c[a]&&!(o=c[a](o))||(i=o.shift(),r.push({value:i,type:a,matches:o}),s=s.slice(i.length));if(!i)break}return e?s.length:s?ot.error(t):M(t,l).slice(0)},s=ot.compile=function(t,e){var i,n=[],o=[],r=I[t+" "];if(!r){for(e||(e=a(t)),i=e.length;i--;)(r=wt(e[i]))[w]?n.push(r):o.push(r);(r=I(t,xt(o,n))).selector=t}return r},l=ot.select=function(t,e,o,r){var l,c,u,h,d,p="function"==typeof t&&t,f=!r&&a(t=p.selector||t);if(o=o||[],1===f.length){if((c=f[0]=f[0].slice(0)).length>2&&"ID"===(u=c[0]).type&&i.getById&&9===e.nodeType&&m&&n.relative[c[1].type]){if(!(e=(n.find.ID(u.matches[0].replace(it,nt),e)||[])[0]))return o;p&&(e=e.parentNode),t=t.slice(c.shift().value.length)}for(l=X.needsContext.test(t)?0:c.length;l--&&(u=c[l],!n.relative[h=u.type]);)if((d=n.find[h])&&(r=d(u.matches[0].replace(it,nt),tt.test(c[0].type)&&pt(e.parentNode)||e))){if(c.splice(l,1),!(t=r.length&&mt(c)))return R.apply(o,r),o;break}}return(p||s(t,f))(r,e,!m,o,tt.test(t)&&pt(e.parentNode)||e),o},i.sortStable=w.split("").sort(P).join("")===w,i.detectDuplicates=!!h,d(),i.sortDetached=st(function(t){return 1&t.compareDocumentPosition(p.createElement("div"))}),st(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||lt("type|href|height|width",function(t,e,i){return i?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),i.attributes&&st(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||lt("value",function(t,e,i){return i||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue}),st(function(t){return null==t.getAttribute("disabled")})||lt(N,function(t,e,i){var n;return i?void 0:!0===t[e]?e.toLowerCase():(n=t.getAttributeNode(e))&&n.specified?n.value:null}),ot}(o);v.find=S,v.expr=S.selectors,v.expr[":"]=v.expr.pseudos,v.unique=S.uniqueSort,v.text=S.getText,v.isXMLDoc=S.isXML,v.contains=S.contains;var T=v.expr.match.needsContext,M=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,I=/^.[^:#\[\.,]*$/;function P(t,e,i){if(v.isFunction(e))return v.grep(t,function(t,n){return!!e.call(t,n,t)!==i});if(e.nodeType)return v.grep(t,function(t){return t===e!==i});if("string"==typeof e){if(I.test(e))return v.filter(e,t,i);e=v.filter(e,t)}return v.grep(t,function(t){return u.call(e,t)>=0!==i})}v.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?v.find.matchesSelector(n,t)?[n]:[]:v.find.matches(t,v.grep(e,function(t){return 1===t.nodeType}))},v.fn.extend({find:function(t){var e,i=this.length,n=[],o=this;if("string"!=typeof t)return this.pushStack(v(t).filter(function(){for(e=0;i>e;e++)if(v.contains(o[e],this))return!0}));for(e=0;i>e;e++)v.find(t,o[e],n);return(n=this.pushStack(i>1?v.unique(n):n)).selector=this.selector?this.selector+" "+t:t,n},filter:function(t){return this.pushStack(P(this,t||[],!1))},not:function(t){return this.pushStack(P(this,t||[],!0))},is:function(t){return!!P(this,"string"==typeof t&&T.test(t)?v(t):t||[],!1).length}});var C,A=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(v.fn.init=function(t,e){var i,n;if(!t)return this;if("string"==typeof t){if(!(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:A.exec(t))||!i[1]&&e)return!e||e.jquery?(e||C).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof v?e[0]:e,v.merge(this,v.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:m,!0)),M.test(i[1])&&v.isPlainObject(e))for(i in e)v.isFunction(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(n=m.getElementById(i[2]))&&n.parentNode&&(this.length=1,this[0]=n),this.context=m,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):v.isFunction(t)?void 0!==C.ready?C.ready(t):t(v):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),v.makeArray(t,this))}).prototype=v.fn,C=v(m);var E=/^(?:parents|prev(?:Until|All))/,L={children:!0,contents:!0,next:!0,prev:!0};function D(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}v.extend({dir:function(t,e,i){for(var n=[],o=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(o&&v(t).is(i))break;n.push(t)}return n},sibling:function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}}),v.fn.extend({has:function(t){var e=v(t,this),i=e.length;return this.filter(function(){for(var t=0;i>t;t++)if(v.contains(this,e[t]))return!0})},closest:function(t,e){for(var i,n=0,o=this.length,r=[],a=T.test(t)||"string"!=typeof t?v(t,e||this.context):0;o>n;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(a?a.index(i)>-1:1===i.nodeType&&v.find.matchesSelector(i,t))){r.push(i);break}return this.pushStack(r.length>1?v.unique(r):r)},index:function(t){return t?"string"==typeof t?u.call(v(t),this[0]):u.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(v.unique(v.merge(this.get(),v(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),v.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return v.dir(t,"parentNode")},parentsUntil:function(t,e,i){return v.dir(t,"parentNode",i)},next:function(t){return D(t,"nextSibling")},prev:function(t){return D(t,"previousSibling")},nextAll:function(t){return v.dir(t,"nextSibling")},prevAll:function(t){return v.dir(t,"previousSibling")},nextUntil:function(t,e,i){return v.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return v.dir(t,"previousSibling",i)},siblings:function(t){return v.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return v.sibling(t.firstChild)},contents:function(t){return t.contentDocument||v.merge([],t.childNodes)}},function(t,e){v.fn[t]=function(i,n){var o=v.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(o=v.filter(n,o)),this.length>1&&(L[t]||v.unique(o),E.test(t)&&o.reverse()),this.pushStack(o)}});var k,R=/\S+/g,O={};function F(){m.removeEventListener("DOMContentLoaded",F,!1),o.removeEventListener("load",F,!1),v.ready()}v.Callbacks=function(t){var e,i,n,o,r,a,s=[],l=!(t="string"==typeof t?O[t]||function(t){var e=O[t]={};return v.each(t.match(R)||[],function(t,i){e[i]=!0}),e}(t):v.extend({},t)).once&&[],c=function(h){for(e=t.memory&&h,i=!0,a=o||0,o=0,r=s.length,n=!0;s&&r>a;a++)if(!1===s[a].apply(h[0],h[1])&&t.stopOnFalse){e=!1;break}n=!1,s&&(l?l.length&&c(l.shift()):e?s=[]:u.disable())},u={add:function(){if(s){var i=s.length;!function e(i){v.each(i,function(i,n){var o=v.type(n);"function"===o?t.unique&&u.has(n)||s.push(n):n&&n.length&&"string"!==o&&e(n)})}(arguments),n?r=s.length:e&&(o=i,c(e))}return this},remove:function(){return s&&v.each(arguments,function(t,e){for(var i;(i=v.inArray(e,s,i))>-1;)s.splice(i,1),n&&(r>=i&&r--,a>=i&&a--)}),this},has:function(t){return t?v.inArray(t,s)>-1:!(!s||!s.length)},empty:function(){return s=[],r=0,this},disable:function(){return s=l=e=void 0,this},disabled:function(){return!s},lock:function(){return l=void 0,e||u.disable(),this},locked:function(){return!l},fireWith:function(t,e){return!s||i&&!l||(e=[t,(e=e||[]).slice?e.slice():e],n?l.push(e):c(e)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!i}};return u},v.extend({Deferred:function(t){var e=[["resolve","done",v.Callbacks("once memory"),"resolved"],["reject","fail",v.Callbacks("once memory"),"rejected"],["notify","progress",v.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var t=arguments;return v.Deferred(function(i){v.each(e,function(e,r){var a=v.isFunction(t[e])&&t[e];o[r[1]](function(){var t=a&&a.apply(this,arguments);t&&v.isFunction(t.promise)?t.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[r[0]+"With"](this===n?i.promise():this,a?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?v.extend(t,n):n}},o={};return n.pipe=n.then,v.each(e,function(t,r){var a=r[2],s=r[3];n[r[1]]=a.add,s&&a.add(function(){i=s},e[1^t][2].disable,e[2][2].lock),o[r[0]]=function(){return o[r[0]+"With"](this===o?n:this,arguments),this},o[r[0]+"With"]=a.fireWith}),n.promise(o),t&&t.call(o,o),o},when:function(t){var e,i,n,o=0,r=s.call(arguments),a=r.length,l=1!==a||t&&v.isFunction(t.promise)?a:0,c=1===l?t:v.Deferred(),u=function(t,i,n){return function(o){i[t]=this,n[t]=arguments.length>1?s.call(arguments):o,n===e?c.notifyWith(i,n):--l||c.resolveWith(i,n)}};if(a>1)for(e=new Array(a),i=new Array(a),n=new Array(a);a>o;o++)r[o]&&v.isFunction(r[o].promise)?r[o].promise().done(u(o,n,r)).fail(c.reject).progress(u(o,i,e)):--l;return l||c.resolveWith(n,r),c.promise()}}),v.fn.ready=function(t){return v.ready.promise().done(t),this},v.extend({isReady:!1,readyWait:1,holdReady:function(t){t?v.readyWait++:v.ready(!0)},ready:function(t){(!0===t?--v.readyWait:v.isReady)||(v.isReady=!0,!0!==t&&--v.readyWait>0||(k.resolveWith(m,[v]),v.fn.triggerHandler&&(v(m).triggerHandler("ready"),v(m).off("ready"))))}}),v.ready.promise=function(t){return k||(k=v.Deferred(),"complete"===m.readyState?setTimeout(v.ready):(m.addEventListener("DOMContentLoaded",F,!1),o.addEventListener("load",F,!1))),k.promise(t)},v.ready.promise();var N=v.access=function(t,e,i,n,o,r,a){var s=0,l=t.length,c=null==i;if("object"===v.type(i))for(s in o=!0,i)v.access(t,e,s,i[s],!0,r,a);else if(void 0!==n&&(o=!0,v.isFunction(n)||(a=!0),c&&(a?(e.call(t,n),e=null):(c=e,e=function(t,e,i){return c.call(v(t),i)})),e))for(;l>s;s++)e(t[s],i,a?n:n.call(t[s],s,e(t[s],i)));return o?t:c?e.call(t):l?e(t[0],i):r};function U(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=v.expando+Math.random()}v.acceptData=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType},U.uid=1,U.accepts=v.acceptData,U.prototype={key:function(t){if(!U.accepts(t))return 0;var e={},i=t[this.expando];if(!i){i=U.uid++;try{e[this.expando]={value:i},Object.defineProperties(t,e)}catch(n){e[this.expando]=i,v.extend(t,e)}}return this.cache[i]||(this.cache[i]={}),i},set:function(t,e,i){var n,o=this.key(t),r=this.cache[o];if("string"==typeof e)r[e]=i;else if(v.isEmptyObject(r))v.extend(this.cache[o],e);else for(n in e)r[n]=e[n];return r},get:function(t,e){var i=this.cache[this.key(t)];return void 0===e?i:i[e]},access:function(t,e,i){var n;return void 0===e||e&&"string"==typeof e&&void 0===i?void 0!==(n=this.get(t,e))?n:this.get(t,v.camelCase(e)):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n,o,r=this.key(t),a=this.cache[r];if(void 0===e)this.cache[r]={};else{v.isArray(e)?n=e.concat(e.map(v.camelCase)):(o=v.camelCase(e),e in a?n=[e,o]:n=(n=o)in a?[n]:n.match(R)||[]),i=n.length;for(;i--;)delete a[n[i]]}},hasData:function(t){return!v.isEmptyObject(this.cache[t[this.expando]]||{})},discard:function(t){t[this.expando]&&delete this.cache[t[this.expando]]}};var B=new U,z=new U,V=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,G=/([A-Z])/g;function j(t,e,i){var n;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(G,"-$1").toLowerCase(),"string"==typeof(i=t.getAttribute(n))){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:V.test(i)?v.parseJSON(i):i)}catch(t){}z.set(t,e,i)}else i=void 0;return i}v.extend({hasData:function(t){return z.hasData(t)||B.hasData(t)},data:function(t,e,i){return z.access(t,e,i)},removeData:function(t,e){z.remove(t,e)},_data:function(t,e,i){return B.access(t,e,i)},_removeData:function(t,e){B.remove(t,e)}}),v.fn.extend({data:function(t,e){var i,n,o,r=this[0],a=r&&r.attributes;if(void 0===t){if(this.length&&(o=z.get(r),1===r.nodeType&&!B.get(r,"hasDataAttrs"))){for(i=a.length;i--;)a[i]&&(0===(n=a[i].name).indexOf("data-")&&(n=v.camelCase(n.slice(5)),j(r,n,o[n])));B.set(r,"hasDataAttrs",!0)}return o}return"object"==typeof t?this.each(function(){z.set(this,t)}):N(this,function(e){var i,n=v.camelCase(t);if(r&&void 0===e){if(void 0!==(i=z.get(r,t)))return i;if(void 0!==(i=z.get(r,n)))return i;if(void 0!==(i=j(r,n,void 0)))return i}else this.each(function(){var i=z.get(this,n);z.set(this,n,e),-1!==t.indexOf("-")&&void 0!==i&&z.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){z.remove(this,t)})}}),v.extend({queue:function(t,e,i){var n;return t?(e=(e||"fx")+"queue",n=B.get(t,e),i&&(!n||v.isArray(i)?n=B.access(t,e,v.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(t,e){e=e||"fx";var i=v.queue(t,e),n=i.length,o=i.shift(),r=v._queueHooks(t,e);"inprogress"===o&&(o=i.shift(),n--),o&&("fx"===e&&i.unshift("inprogress"),delete r.stop,o.call(t,function(){v.dequeue(t,e)},r)),!n&&r&&r.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return B.get(t,i)||B.access(t,i,{empty:v.Callbacks("once memory").add(function(){B.remove(t,[e+"queue",i])})})}}),v.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?v.queue(this[0],t):void 0===e?this:this.each(function(){var i=v.queue(this,t,e);v._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&v.dequeue(this,t)})},dequeue:function(t){return this.each(function(){v.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,o=v.Deferred(),r=this,a=this.length,s=function(){--n||o.resolveWith(r,[r])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(i=B.get(r[a],t+"queueHooks"))&&i.empty&&(n++,i.empty.add(s));return s(),o.promise(e)}});var H=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,W=["Top","Right","Bottom","Left"],q=function(t,e){return t=e||t,"none"===v.css(t,"display")||!v.contains(t.ownerDocument,t)},$=/^(?:checkbox|radio)$/i;!function(){var t=m.createDocumentFragment().appendChild(m.createElement("div")),e=m.createElement("input");e.setAttribute("type","radio"),e.setAttribute("checked","checked"),e.setAttribute("name","t"),t.appendChild(e),f.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",f.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var Y="undefined";f.focusinBubbles="onfocusin"in o;var X=/^key/,Q=/^(?:mouse|pointer|contextmenu)|click/,Z=/^(?:focusinfocus|focusoutblur)$/,K=/^([^.]*)(?:\.(.+)|)$/;function J(){return!0}function tt(){return!1}function et(){try{return m.activeElement}catch(t){}}v.event={global:{},add:function(t,e,i,n,o){var r,a,s,l,c,u,h,d,p,f,m,g=B.get(t);if(g)for(i.handler&&(i=(r=i).handler,o=r.selector),i.guid||(i.guid=v.guid++),(l=g.events)||(l=g.events={}),(a=g.handle)||(a=g.handle=function(e){return typeof v!==Y&&v.event.triggered!==e.type?v.event.dispatch.apply(t,arguments):void 0}),c=(e=(e||"").match(R)||[""]).length;c--;)p=m=(s=K.exec(e[c])||[])[1],f=(s[2]||"").split(".").sort(),p&&(h=v.event.special[p]||{},p=(o?h.delegateType:h.bindType)||p,h=v.event.special[p]||{},u=v.extend({type:p,origType:m,data:n,handler:i,guid:i.guid,selector:o,needsContext:o&&v.expr.match.needsContext.test(o),namespace:f.join(".")},r),(d=l[p])||((d=l[p]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(t,n,f,a)||t.addEventListener&&t.addEventListener(p,a,!1)),h.add&&(h.add.call(t,u),u.handler.guid||(u.handler.guid=i.guid)),o?d.splice(d.delegateCount++,0,u):d.push(u),v.event.global[p]=!0)},remove:function(t,e,i,n,o){var r,a,s,l,c,u,h,d,p,f,m,g=B.hasData(t)&&B.get(t);if(g&&(l=g.events)){for(c=(e=(e||"").match(R)||[""]).length;c--;)if(p=m=(s=K.exec(e[c])||[])[1],f=(s[2]||"").split(".").sort(),p){for(h=v.event.special[p]||{},d=l[p=(n?h.delegateType:h.bindType)||p]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=r=d.length;r--;)u=d[r],!o&&m!==u.origType||i&&i.guid!==u.guid||s&&!s.test(u.namespace)||n&&n!==u.selector&&("**"!==n||!u.selector)||(d.splice(r,1),u.selector&&d.delegateCount--,h.remove&&h.remove.call(t,u));a&&!d.length&&(h.teardown&&!1!==h.teardown.call(t,f,g.handle)||v.removeEvent(t,p,g.handle),delete l[p])}else for(p in l)v.event.remove(t,p+e[c],i,n,!0);v.isEmptyObject(l)&&(delete g.handle,B.remove(t,"events"))}},trigger:function(t,e,i,n){var r,a,s,l,c,u,h,d=[i||m],f=p.call(t,"type")?t.type:t,g=p.call(t,"namespace")?t.namespace.split("."):[];if(a=s=i=i||m,3!==i.nodeType&&8!==i.nodeType&&!Z.test(f+v.event.triggered)&&(f.indexOf(".")>=0&&(f=(g=f.split(".")).shift(),g.sort()),c=f.indexOf(":")<0&&"on"+f,(t=t[v.expando]?t:new v.Event(f,"object"==typeof t&&t)).isTrigger=n?2:3,t.namespace=g.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+g.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:v.makeArray(e,[t]),h=v.event.special[f]||{},n||!h.trigger||!1!==h.trigger.apply(i,e))){if(!n&&!h.noBubble&&!v.isWindow(i)){for(l=h.delegateType||f,Z.test(l+f)||(a=a.parentNode);a;a=a.parentNode)d.push(a),s=a;s===(i.ownerDocument||m)&&d.push(s.defaultView||s.parentWindow||o)}for(r=0;(a=d[r++])&&!t.isPropagationStopped();)t.type=r>1?l:h.bindType||f,(u=(B.get(a,"events")||{})[t.type]&&B.get(a,"handle"))&&u.apply(a,e),(u=c&&a[c])&&u.apply&&v.acceptData(a)&&(t.result=u.apply(a,e),!1===t.result&&t.preventDefault());return t.type=f,n||t.isDefaultPrevented()||h._default&&!1!==h._default.apply(d.pop(),e)||!v.acceptData(i)||c&&v.isFunction(i[f])&&!v.isWindow(i)&&((s=i[c])&&(i[c]=null),v.event.triggered=f,i[f](),v.event.triggered=void 0,s&&(i[c]=s)),t.result}},dispatch:function(t){t=v.event.fix(t);var e,i,n,o,r,a=[],l=s.call(arguments),c=(B.get(this,"events")||{})[t.type]||[],u=v.event.special[t.type]||{};if(l[0]=t,t.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,t)){for(a=v.event.handlers.call(this,t,c),e=0;(o=a[e++])&&!t.isPropagationStopped();)for(t.currentTarget=o.elem,i=0;(r=o.handlers[i++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(r.namespace))&&(t.handleObj=r,t.data=r.data,void 0!==(n=((v.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,l))&&!1===(t.result=n)&&(t.preventDefault(),t.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,t),t.result}},handlers:function(t,e){var i,n,o,r,a=[],s=e.delegateCount,l=t.target;if(s&&l.nodeType&&(!t.button||"click"!==t.type))for(;l!==this;l=l.parentNode||this)if(!0!==l.disabled||"click"!==t.type){for(n=[],i=0;s>i;i++)void 0===n[o=(r=e[i]).selector+" "]&&(n[o]=r.needsContext?v(o,this).index(l)>=0:v.find(o,this,null,[l]).length),n[o]&&n.push(r);n.length&&a.push({elem:l,handlers:n})}return s<e.length&&a.push({elem:this,handlers:e.slice(s)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var i,n,o,r=e.button;return null==t.pageX&&null!=e.clientX&&(n=(i=t.target.ownerDocument||m).documentElement,o=i.body,t.pageX=e.clientX+(n&&n.scrollLeft||o&&o.scrollLeft||0)-(n&&n.clientLeft||o&&o.clientLeft||0),t.pageY=e.clientY+(n&&n.scrollTop||o&&o.scrollTop||0)-(n&&n.clientTop||o&&o.clientTop||0)),t.which||void 0===r||(t.which=1&r?1:2&r?3:4&r?2:0),t}},fix:function(t){if(t[v.expando])return t;var e,i,n,o=t.type,r=t,a=this.fixHooks[o];for(a||(this.fixHooks[o]=a=Q.test(o)?this.mouseHooks:X.test(o)?this.keyHooks:{}),n=a.props?this.props.concat(a.props):this.props,t=new v.Event(r),e=n.length;e--;)t[i=n[e]]=r[i];return t.target||(t.target=m),3===t.target.nodeType&&(t.target=t.target.parentNode),a.filter?a.filter(t,r):t},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==et()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===et()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&v.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(t){return v.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i,n){var o=v.extend(new v.Event,i,{type:t,isSimulated:!0,originalEvent:{}});n?v.event.trigger(o,null,e):v.event.dispatch.call(e,o),o.isDefaultPrevented()&&i.preventDefault()}},v.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)},v.Event=function(t,e){return this instanceof v.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?J:tt):this.type=t,e&&v.extend(this,e),this.timeStamp=t&&t.timeStamp||v.now(),void(this[v.expando]=!0)):new v.Event(t,e)},v.Event.prototype={isDefaultPrevented:tt,isPropagationStopped:tt,isImmediatePropagationStopped:tt,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=J,t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=J,t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=J,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},v.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){v.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=t.relatedTarget,o=t.handleObj;return(!n||n!==this&&!v.contains(this,n))&&(t.type=o.origType,i=o.handler.apply(this,arguments),t.type=e),i}}}),f.focusinBubbles||v.each({focus:"focusin",blur:"focusout"},function(t,e){var i=function(t){v.event.simulate(e,t.target,v.event.fix(t),!0)};v.event.special[e]={setup:function(){var n=this.ownerDocument||this,o=B.access(n,e);o||n.addEventListener(t,i,!0),B.access(n,e,(o||0)+1)},teardown:function(){var n=this.ownerDocument||this,o=B.access(n,e)-1;o?B.access(n,e,o):(n.removeEventListener(t,i,!0),B.remove(n,e))}}}),v.fn.extend({on:function(t,e,i,n,o){var r,a;if("object"==typeof t){for(a in"string"!=typeof e&&(i=i||e,e=void 0),t)this.on(a,e,i,t[a],o);return this}if(null==i&&null==n?(n=e,i=e=void 0):null==n&&("string"==typeof e?(n=i,i=void 0):(n=i,i=e,e=void 0)),!1===n)n=tt;else if(!n)return this;return 1===o&&(r=n,(n=function(t){return v().off(t),r.apply(this,arguments)}).guid=r.guid||(r.guid=v.guid++)),this.each(function(){v.event.add(this,t,n,i,e)})},one:function(t,e,i,n){return this.on(t,e,i,n,1)},off:function(t,e,i){var n,o;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,v(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(o in t)this.off(o,e,t[o]);return this}return(!1===e||"function"==typeof e)&&(i=e,e=void 0),!1===i&&(i=tt),this.each(function(){v.event.remove(this,t,i,e)})},trigger:function(t,e){return this.each(function(){v.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];return i?v.event.trigger(t,e,i,!0):void 0}});var it=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,nt=/<([\w:]+)/,ot=/<|&#?\w+;/,rt=/<(?:script|style|link)/i,at=/checked\s*(?:[^=]|=\s*.checked.)/i,st=/^$|\/(?:java|ecma)script/i,lt=/^true\/(.*)/,ct=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ut={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ht(t,e){return v.nodeName(t,"table")&&v.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function dt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function pt(t){var e=lt.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function ft(t,e){for(var i=0,n=t.length;n>i;i++)B.set(t[i],"globalEval",!e||B.get(e[i],"globalEval"))}function mt(t,e){var i,n,o,r,a,s,l,c;if(1===e.nodeType){if(B.hasData(t)&&(r=B.access(t),a=B.set(e,r),c=r.events))for(o in delete a.handle,a.events={},c)for(i=0,n=c[o].length;n>i;i++)v.event.add(e,o,c[o][i]);z.hasData(t)&&(s=z.access(t),l=v.extend({},s),z.set(e,l))}}function gt(t,e){var i=t.getElementsByTagName?t.getElementsByTagName(e||"*"):t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&v.nodeName(t,e)?v.merge([t],i):i}function vt(t,e){var i=e.nodeName.toLowerCase();"input"===i&&$.test(t.type)?e.checked=t.checked:("input"===i||"textarea"===i)&&(e.defaultValue=t.defaultValue)}ut.optgroup=ut.option,ut.tbody=ut.tfoot=ut.colgroup=ut.caption=ut.thead,ut.th=ut.td,v.extend({clone:function(t,e,i){var n,o,r,a,s=t.cloneNode(!0),l=v.contains(t.ownerDocument,t);if(!(f.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||v.isXMLDoc(t)))for(a=gt(s),n=0,o=(r=gt(t)).length;o>n;n++)vt(r[n],a[n]);if(e)if(i)for(r=r||gt(t),a=a||gt(s),n=0,o=r.length;o>n;n++)mt(r[n],a[n]);else mt(t,s);return(a=gt(s,"script")).length>0&&ft(a,!l&&gt(t,"script")),s},buildFragment:function(t,e,i,n){for(var o,r,a,s,l,c,u=e.createDocumentFragment(),h=[],d=0,p=t.length;p>d;d++)if((o=t[d])||0===o)if("object"===v.type(o))v.merge(h,o.nodeType?[o]:o);else if(ot.test(o)){for(r=r||u.appendChild(e.createElement("div")),a=(nt.exec(o)||["",""])[1].toLowerCase(),s=ut[a]||ut._default,r.innerHTML=s[1]+o.replace(it,"<$1></$2>")+s[2],c=s[0];c--;)r=r.lastChild;v.merge(h,r.childNodes),(r=u.firstChild).textContent=""}else h.push(e.createTextNode(o));for(u.textContent="",d=0;o=h[d++];)if((!n||-1===v.inArray(o,n))&&(l=v.contains(o.ownerDocument,o),r=gt(u.appendChild(o),"script"),l&&ft(r),i))for(c=0;o=r[c++];)st.test(o.type||"")&&i.push(o);return u},cleanData:function(t){for(var e,i,n,o,r=v.event.special,a=0;void 0!==(i=t[a]);a++){if(v.acceptData(i)&&((o=i[B.expando])&&(e=B.cache[o]))){if(e.events)for(n in e.events)r[n]?v.event.remove(i,n):v.removeEvent(i,n,e.handle);B.cache[o]&&delete B.cache[o]}delete z.cache[i[z.expando]]}}}),v.fn.extend({text:function(t){return N(this,function(t){return void 0===t?v.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=t)})},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||ht(this,t).appendChild(t)})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=ht(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var i,n=t?v.filter(t,this):this,o=0;null!=(i=n[o]);o++)e||1!==i.nodeType||v.cleanData(gt(i)),i.parentNode&&(e&&v.contains(i.ownerDocument,i)&&ft(gt(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(v.cleanData(gt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return v.clone(this,t,e)})},html:function(t){return N(this,function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!rt.test(t)&&!ut[(nt.exec(t)||["",""])[1].toLowerCase()]){t=t.replace(it,"<$1></$2>");try{for(;n>i;i++)1===(e=this[i]||{}).nodeType&&(v.cleanData(gt(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,function(e){t=this.parentNode,v.cleanData(gt(this)),t&&t.replaceChild(e,this)}),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e){t=l.apply([],t);var i,n,o,r,a,s,c=0,u=this.length,h=this,d=u-1,p=t[0],m=v.isFunction(p);if(m||u>1&&"string"==typeof p&&!f.checkClone&&at.test(p))return this.each(function(i){var n=h.eq(i);m&&(t[0]=p.call(this,i,n.html())),n.domManip(t,e)});if(u&&(n=(i=v.buildFragment(t,this[0].ownerDocument,!1,this)).firstChild,1===i.childNodes.length&&(i=n),n)){for(r=(o=v.map(gt(i,"script"),dt)).length;u>c;c++)a=i,c!==d&&(a=v.clone(a,!0,!0),r&&v.merge(o,gt(a,"script"))),e.call(this[c],a,c);if(r)for(s=o[o.length-1].ownerDocument,v.map(o,pt),c=0;r>c;c++)a=o[c],st.test(a.type||"")&&!B.access(a,"globalEval")&&v.contains(s,a)&&(a.src?v._evalUrl&&v._evalUrl(a.src):v.globalEval(a.textContent.replace(ct,"")))}return this}}),v.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){v.fn[t]=function(t){for(var i,n=[],o=v(t),r=o.length-1,a=0;r>=a;a++)i=a===r?this:this.clone(!0),v(o[a])[e](i),c.apply(n,i.get());return this.pushStack(n)}});var yt,bt={};function wt(t,e){var i,n=v(e.createElement(t)).appendTo(e.body),r=o.getDefaultComputedStyle&&(i=o.getDefaultComputedStyle(n[0]))?i.display:v.css(n[0],"display");return n.detach(),r}function xt(t){var e=m,i=bt[t];return i||("none"!==(i=wt(t,e))&&i||((e=(yt=(yt||v("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement))[0].contentDocument).write(),e.close(),i=wt(t,e),yt.detach()),bt[t]=i),i}var _t=/^margin/,St=new RegExp("^("+H+")(?!px)[a-z%]+$","i"),Tt=function(t){return t.ownerDocument.defaultView.getComputedStyle(t,null)};function Mt(t,e,i){var n,o,r,a,s=t.style;return(i=i||Tt(t))&&(a=i.getPropertyValue(e)||i[e]),i&&(""!==a||v.contains(t.ownerDocument,t)||(a=v.style(t,e)),St.test(a)&&_t.test(e)&&(n=s.width,o=s.minWidth,r=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=i.width,s.width=n,s.minWidth=o,s.maxWidth=r)),void 0!==a?a+"":a}function It(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}!function(){var t,e,i=m.documentElement,n=m.createElement("div"),r=m.createElement("div");if(r.style){function a(){r.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",r.innerHTML="",i.appendChild(n);var a=o.getComputedStyle(r,null);t="1%"!==a.top,e="4px"===a.width,i.removeChild(n)}r.style.backgroundClip="content-box",r.cloneNode(!0).style.backgroundClip="",f.clearCloneStyle="content-box"===r.style.backgroundClip,n.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",n.appendChild(r),o.getComputedStyle&&v.extend(f,{pixelPosition:function(){return a(),t},boxSizingReliable:function(){return null==e&&a(),e},reliableMarginRight:function(){var t,e=r.appendChild(m.createElement("div"));return e.style.cssText=r.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",r.style.width="1px",i.appendChild(n),t=!parseFloat(o.getComputedStyle(e,null).marginRight),i.removeChild(n),t}})}}(),v.swap=function(t,e,i,n){var o,r,a={};for(r in e)a[r]=t.style[r],t.style[r]=e[r];for(r in o=i.apply(t,n||[]),e)t.style[r]=a[r];return o};var Pt=/^(none|table(?!-c[ea]).+)/,Ct=new RegExp("^("+H+")(.*)$","i"),At=new RegExp("^([+-])=("+H+")","i"),Et={position:"absolute",visibility:"hidden",display:"block"},Lt={letterSpacing:"0",fontWeight:"400"},Dt=["Webkit","O","Moz","ms"];function kt(t,e){if(e in t)return e;for(var i=e[0].toUpperCase()+e.slice(1),n=e,o=Dt.length;o--;)if((e=Dt[o]+i)in t)return e;return n}function Rt(t,e,i){var n=Ct.exec(e);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):e}function Ot(t,e,i,n,o){for(var r=i===(n?"border":"content")?4:"width"===e?1:0,a=0;4>r;r+=2)"margin"===i&&(a+=v.css(t,i+W[r],!0,o)),n?("content"===i&&(a-=v.css(t,"padding"+W[r],!0,o)),"margin"!==i&&(a-=v.css(t,"border"+W[r]+"Width",!0,o))):(a+=v.css(t,"padding"+W[r],!0,o),"padding"!==i&&(a+=v.css(t,"border"+W[r]+"Width",!0,o)));return a}function Ft(t,e,i){var n=!0,o="width"===e?t.offsetWidth:t.offsetHeight,r=Tt(t),a="border-box"===v.css(t,"boxSizing",!1,r);if(0>=o||null==o){if((0>(o=Mt(t,e,r))||null==o)&&(o=t.style[e]),St.test(o))return o;n=a&&(f.boxSizingReliable()||o===t.style[e]),o=parseFloat(o)||0}return o+Ot(t,e,i||(a?"border":"content"),n,r)+"px"}function Nt(t,e){for(var i,n,o,r=[],a=0,s=t.length;s>a;a++)(n=t[a]).style&&(r[a]=B.get(n,"olddisplay"),i=n.style.display,e?(r[a]||"none"!==i||(n.style.display=""),""===n.style.display&&q(n)&&(r[a]=B.access(n,"olddisplay",xt(n.nodeName)))):(o=q(n),"none"===i&&o||B.set(n,"olddisplay",o?i:v.css(n,"display"))));for(a=0;s>a;a++)(n=t[a]).style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?r[a]||"":"none"));return t}function Ut(t,e,i,n,o){return new Ut.prototype.init(t,e,i,n,o)}v.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=Mt(t,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,r,a,s=v.camelCase(e),l=t.style;return e=v.cssProps[s]||(v.cssProps[s]=kt(l,s)),a=v.cssHooks[e]||v.cssHooks[s],void 0===i?a&&"get"in a&&void 0!==(o=a.get(t,!1,n))?o:l[e]:("string"===(r=typeof i)&&(o=At.exec(i))&&(i=(o[1]+1)*o[2]+parseFloat(v.css(t,e)),r="number"),void(null!=i&&i==i&&("number"!==r||v.cssNumber[s]||(i+="px"),f.clearCloneStyle||""!==i||0!==e.indexOf("background")||(l[e]="inherit"),a&&"set"in a&&void 0===(i=a.set(t,i,n))||(l[e]=i))))}},css:function(t,e,i,n){var o,r,a,s=v.camelCase(e);return e=v.cssProps[s]||(v.cssProps[s]=kt(t.style,s)),(a=v.cssHooks[e]||v.cssHooks[s])&&"get"in a&&(o=a.get(t,!0,i)),void 0===o&&(o=Mt(t,e,n)),"normal"===o&&e in Lt&&(o=Lt[e]),""===i||i?(r=parseFloat(o),!0===i||v.isNumeric(r)?r||0:o):o}}),v.each(["height","width"],function(t,e){v.cssHooks[e]={get:function(t,i,n){return i?Pt.test(v.css(t,"display"))&&0===t.offsetWidth?v.swap(t,Et,function(){return Ft(t,e,n)}):Ft(t,e,n):void 0},set:function(t,i,n){var o=n&&Tt(t);return Rt(0,i,n?Ot(t,e,n,"border-box"===v.css(t,"boxSizing",!1,o),o):0)}}}),v.cssHooks.marginRight=It(f.reliableMarginRight,function(t,e){return e?v.swap(t,{display:"inline-block"},Mt,[t,"marginRight"]):void 0}),v.each({margin:"",padding:"",border:"Width"},function(t,e){v.cssHooks[t+e]={expand:function(i){for(var n=0,o={},r="string"==typeof i?i.split(" "):[i];4>n;n++)o[t+W[n]+e]=r[n]||r[n-2]||r[0];return o}},_t.test(t)||(v.cssHooks[t+e].set=Rt)}),v.fn.extend({css:function(t,e){return N(this,function(t,e,i){var n,o,r={},a=0;if(v.isArray(e)){for(n=Tt(t),o=e.length;o>a;a++)r[e[a]]=v.css(t,e[a],!1,n);return r}return void 0!==i?v.style(t,e,i):v.css(t,e)},t,e,arguments.length>1)},show:function(){return Nt(this,!0)},hide:function(){return Nt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){q(this)?v(this).show():v(this).hide()})}}),v.Tween=Ut,Ut.prototype={constructor:Ut,init:function(t,e,i,n,o,r){this.elem=t,this.prop=i,this.easing=o||"swing",this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=r||(v.cssNumber[i]?"":"px")},cur:function(){var t=Ut.propHooks[this.prop];return t&&t.get?t.get(this):Ut.propHooks._default.get(this)},run:function(t){var e,i=Ut.propHooks[this.prop];return this.pos=e=this.options.duration?v.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):Ut.propHooks._default.set(this),this}},Ut.prototype.init.prototype=Ut.prototype,Ut.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=v.css(t.elem,t.prop,""))&&"auto"!==e?e:0:t.elem[t.prop]},set:function(t){v.fx.step[t.prop]?v.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[v.cssProps[t.prop]]||v.cssHooks[t.prop])?v.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},Ut.propHooks.scrollTop=Ut.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},v.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},v.fx=Ut.prototype.init,v.fx.step={};var Bt,zt,Vt=/^(?:toggle|show|hide)$/,Gt=new RegExp("^(?:([+-])=|)("+H+")([a-z%]*)$","i"),jt=/queueHooks$/,Ht=[function(t,e,i){var n,o,r,a,s,l,c,u=this,h={},d=t.style,p=t.nodeType&&q(t),f=B.get(t,"fxshow");for(n in i.queue||(null==(s=v._queueHooks(t,"fx")).unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,u.always(function(){u.always(function(){s.unqueued--,v.queue(t,"fx").length||s.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[d.overflow,d.overflowX,d.overflowY],c=v.css(t,"display"),"inline"===("none"===c?B.get(t,"olddisplay")||xt(t.nodeName):c)&&"none"===v.css(t,"float")&&(d.display="inline-block")),i.overflow&&(d.overflow="hidden",u.always(function(){d.overflow=i.overflow[0],d.overflowX=i.overflow[1],d.overflowY=i.overflow[2]})),e)if(o=e[n],Vt.exec(o)){if(delete e[n],r=r||"toggle"===o,o===(p?"hide":"show")){if("show"!==o||!f||void 0===f[n])continue;p=!0}h[n]=f&&f[n]||v.style(t,n)}else c=void 0;if(v.isEmptyObject(h))"inline"===("none"===c?xt(t.nodeName):c)&&(d.display=c);else for(n in f?"hidden"in f&&(p=f.hidden):f=B.access(t,"fxshow",{}),r&&(f.hidden=!p),p?v(t).show():u.done(function(){v(t).hide()}),u.done(function(){var e;for(e in B.remove(t,"fxshow"),h)v.style(t,e,h[e])}),h)a=Yt(p?f[n]:0,n,u),n in f||(f[n]=a.start,p&&(a.end=a.start,a.start="width"===n||"height"===n?1:0))}],Wt={"*":[function(t,e){var i=this.createTween(t,e),n=i.cur(),o=Gt.exec(e),r=o&&o[3]||(v.cssNumber[t]?"":"px"),a=(v.cssNumber[t]||"px"!==r&&+n)&&Gt.exec(v.css(i.elem,t)),s=1,l=20;if(a&&a[3]!==r){r=r||a[3],o=o||[],a=+n||1;do{a/=s=s||".5",v.style(i.elem,t,a+r)}while(s!==(s=i.cur()/n)&&1!==s&&--l)}return o&&(a=i.start=+a||+n||0,i.unit=r,i.end=o[1]?a+(o[1]+1)*o[2]:+o[2]),i}]};function qt(){return setTimeout(function(){Bt=void 0}),Bt=v.now()}function $t(t,e){var i,n=0,o={height:t};for(e=e?1:0;4>n;n+=2-e)o["margin"+(i=W[n])]=o["padding"+i]=t;return e&&(o.opacity=o.width=t),o}function Yt(t,e,i){for(var n,o=(Wt[e]||[]).concat(Wt["*"]),r=0,a=o.length;a>r;r++)if(n=o[r].call(i,e,t))return n}function Xt(t,e,i){var n,o,r=0,a=Ht.length,s=v.Deferred().always(function(){delete l.elem}),l=function(){if(o)return!1;for(var e=Bt||qt(),i=Math.max(0,c.startTime+c.duration-e),n=1-(i/c.duration||0),r=0,a=c.tweens.length;a>r;r++)c.tweens[r].run(n);return s.notifyWith(t,[c,n,i]),1>n&&a?i:(s.resolveWith(t,[c]),!1)},c=s.promise({elem:t,props:v.extend({},e),opts:v.extend(!0,{specialEasing:{}},i),originalProperties:e,originalOptions:i,startTime:Bt||qt(),duration:i.duration,tweens:[],createTween:function(e,i){var n=v.Tween(t,c.opts,e,i,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(n),n},stop:function(e){var i=0,n=e?c.tweens.length:0;if(o)return this;for(o=!0;n>i;i++)c.tweens[i].run(1);return e?s.resolveWith(t,[c,e]):s.rejectWith(t,[c,e]),this}}),u=c.props;for(function(t,e){var i,n,o,r,a;for(i in t)if(o=e[n=v.camelCase(i)],r=t[i],v.isArray(r)&&(o=r[1],r=t[i]=r[0]),i!==n&&(t[n]=r,delete t[i]),(a=v.cssHooks[n])&&"expand"in a)for(i in r=a.expand(r),delete t[n],r)i in t||(t[i]=r[i],e[i]=o);else e[n]=o}(u,c.opts.specialEasing);a>r;r++)if(n=Ht[r].call(c,t,u,c.opts))return n;return v.map(u,Yt,c),v.isFunction(c.opts.start)&&c.opts.start.call(t,c),v.fx.timer(v.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}v.Animation=v.extend(Xt,{tweener:function(t,e){v.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var i,n=0,o=t.length;o>n;n++)i=t[n],Wt[i]=Wt[i]||[],Wt[i].unshift(e)},prefilter:function(t,e){e?Ht.unshift(t):Ht.push(t)}}),v.speed=function(t,e,i){var n=t&&"object"==typeof t?v.extend({},t):{complete:i||!i&&e||v.isFunction(t)&&t,duration:t,easing:i&&e||e&&!v.isFunction(e)&&e};return n.duration=v.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in v.fx.speeds?v.fx.speeds[n.duration]:v.fx.speeds._default,(null==n.queue||!0===n.queue)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){v.isFunction(n.old)&&n.old.call(this),n.queue&&v.dequeue(this,n.queue)},n},v.fn.extend({fadeTo:function(t,e,i,n){return this.filter(q).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var o=v.isEmptyObject(t),r=v.speed(e,i,n),a=function(){var e=Xt(this,v.extend({},t),r);(o||B.get(this,"finish"))&&e.stop(!0)};return a.finish=a,o||!1===r.queue?this.each(a):this.queue(r.queue,a)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each(function(){var e=!0,o=null!=t&&t+"queueHooks",r=v.timers,a=B.get(this);if(o)a[o]&&a[o].stop&&n(a[o]);else for(o in a)a[o]&&a[o].stop&&jt.test(o)&&n(a[o]);for(o=r.length;o--;)r[o].elem!==this||null!=t&&r[o].queue!==t||(r[o].anim.stop(i),e=!1,r.splice(o,1));(e||!i)&&v.dequeue(this,t)})},finish:function(t){return!1!==t&&(t=t||"fx"),this.each(function(){var e,i=B.get(this),n=i[t+"queue"],o=i[t+"queueHooks"],r=v.timers,a=n?n.length:0;for(i.finish=!0,v.queue(this,t,[]),o&&o.stop&&o.stop.call(this,!0),e=r.length;e--;)r[e].elem===this&&r[e].queue===t&&(r[e].anim.stop(!0),r.splice(e,1));for(e=0;a>e;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish})}}),v.each(["toggle","show","hide"],function(t,e){var i=v.fn[e];v.fn[e]=function(t,n,o){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate($t(e,!0),t,n,o)}}),v.each({slideDown:$t("show"),slideUp:$t("hide"),slideToggle:$t("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){v.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),v.timers=[],v.fx.tick=function(){var t,e=0,i=v.timers;for(Bt=v.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||v.fx.stop(),Bt=void 0},v.fx.timer=function(t){v.timers.push(t),t()?v.fx.start():v.timers.pop()},v.fx.interval=13,v.fx.start=function(){zt||(zt=setInterval(v.fx.tick,v.fx.interval))},v.fx.stop=function(){clearInterval(zt),zt=null},v.fx.speeds={slow:600,fast:200,_default:400},v.fn.delay=function(t,e){return t=v.fx&&v.fx.speeds[t]||t,e=e||"fx",this.queue(e,function(e,i){var n=setTimeout(e,t);i.stop=function(){clearTimeout(n)}})},function(){var t=m.createElement("input"),e=m.createElement("select"),i=e.appendChild(m.createElement("option"));t.type="checkbox",f.checkOn=""!==t.value,f.optSelected=i.selected,e.disabled=!0,f.optDisabled=!i.disabled,(t=m.createElement("input")).value="t",t.type="radio",f.radioValue="t"===t.value}();var Qt,Zt=v.expr.attrHandle;v.fn.extend({attr:function(t,e){return N(this,v.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){v.removeAttr(this,t)})}}),v.extend({attr:function(t,e,i){var n,o,r=t.nodeType;if(t&&3!==r&&8!==r&&2!==r)return typeof t.getAttribute===Y?v.prop(t,e,i):(1===r&&v.isXMLDoc(t)||(e=e.toLowerCase(),n=v.attrHooks[e]||(v.expr.match.bool.test(e)?Qt:void 0)),void 0===i?n&&"get"in n&&null!==(o=n.get(t,e))?o:null==(o=v.find.attr(t,e))?void 0:o:null!==i?n&&"set"in n&&void 0!==(o=n.set(t,i,e))?o:(t.setAttribute(e,i+""),i):void v.removeAttr(t,e))},removeAttr:function(t,e){var i,n,o=0,r=e&&e.match(R);if(r&&1===t.nodeType)for(;i=r[o++];)n=v.propFix[i]||i,v.expr.match.bool.test(i)&&(t[n]=!1),t.removeAttribute(i)},attrHooks:{type:{set:function(t,e){if(!f.radioValue&&"radio"===e&&v.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}}}),Qt={set:function(t,e,i){return!1===e?v.removeAttr(t,i):t.setAttribute(i,i),i}},v.each(v.expr.match.bool.source.match(/\w+/g),function(t,e){var i=Zt[e]||v.find.attr;Zt[e]=function(t,e,n){var o,r;return n||(r=Zt[e],Zt[e]=o,o=null!=i(t,e,n)?e.toLowerCase():null,Zt[e]=r),o}});var Kt=/^(?:input|select|textarea|button)$/i;v.fn.extend({prop:function(t,e){return N(this,v.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[v.propFix[t]||t]})}}),v.extend({propFix:{for:"htmlFor",class:"className"},prop:function(t,e,i){var n,o,r=t.nodeType;if(t&&3!==r&&8!==r&&2!==r)return(1!==r||!v.isXMLDoc(t))&&(e=v.propFix[e]||e,o=v.propHooks[e]),void 0!==i?o&&"set"in o&&void 0!==(n=o.set(t,i,e))?n:t[e]=i:o&&"get"in o&&null!==(n=o.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){return t.hasAttribute("tabindex")||Kt.test(t.nodeName)||t.href?t.tabIndex:-1}}}}),f.optSelected||(v.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null}}),v.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){v.propFix[this.toLowerCase()]=this});var Jt=/[\t\r\n\f]/g;v.fn.extend({addClass:function(t){var e,i,n,o,r,a,s="string"==typeof t&&t,l=0,c=this.length;if(v.isFunction(t))return this.each(function(e){v(this).addClass(t.call(this,e,this.className))});if(s)for(e=(t||"").match(R)||[];c>l;l++)if(n=1===(i=this[l]).nodeType&&(i.className?(" "+i.className+" ").replace(Jt," "):" ")){for(r=0;o=e[r++];)n.indexOf(" "+o+" ")<0&&(n+=o+" ");a=v.trim(n),i.className!==a&&(i.className=a)}return this},removeClass:function(t){var e,i,n,o,r,a,s=0===arguments.length||"string"==typeof t&&t,l=0,c=this.length;if(v.isFunction(t))return this.each(function(e){v(this).removeClass(t.call(this,e,this.className))});if(s)for(e=(t||"").match(R)||[];c>l;l++)if(n=1===(i=this[l]).nodeType&&(i.className?(" "+i.className+" ").replace(Jt," "):"")){for(r=0;o=e[r++];)for(;n.indexOf(" "+o+" ")>=0;)n=n.replace(" "+o+" "," ");a=t?v.trim(n):"",i.className!==a&&(i.className=a)}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):this.each(v.isFunction(t)?function(i){v(this).toggleClass(t.call(this,i,this.className,e),e)}:function(){if("string"===i)for(var e,n=0,o=v(this),r=t.match(R)||[];e=r[n++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else(i===Y||"boolean"===i)&&(this.className&&B.set(this,"__className__",this.className),this.className=this.className||!1===t?"":B.get(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(Jt," ").indexOf(e)>=0)return!0;return!1}});var te=/\r/g;v.fn.extend({val:function(t){var e,i,n,o=this[0];return arguments.length?(n=v.isFunction(t),this.each(function(i){var o;1===this.nodeType&&(null==(o=n?t.call(this,i,v(this).val()):t)?o="":"number"==typeof o?o+="":v.isArray(o)&&(o=v.map(o,function(t){return null==t?"":t+""})),(e=v.valHooks[this.type]||v.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,o,"value")||(this.value=o))})):o?(e=v.valHooks[o.type]||v.valHooks[o.nodeName.toLowerCase()])&&"get"in e&&void 0!==(i=e.get(o,"value"))?i:"string"==typeof(i=o.value)?i.replace(te,""):null==i?"":i:void 0}}),v.extend({valHooks:{option:{get:function(t){var e=v.find.attr(t,"value");return null!=e?e:v.trim(v.text(t))}},select:{get:function(t){for(var e,i,n=t.options,o=t.selectedIndex,r="select-one"===t.type||0>o,a=r?null:[],s=r?o+1:n.length,l=0>o?s:r?o:0;s>l;l++)if(!(!(i=n[l]).selected&&l!==o||(f.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&v.nodeName(i.parentNode,"optgroup"))){if(e=v(i).val(),r)return e;a.push(e)}return a},set:function(t,e){for(var i,n,o=t.options,r=v.makeArray(e),a=o.length;a--;)((n=o[a]).selected=v.inArray(n.value,r)>=0)&&(i=!0);return i||(t.selectedIndex=-1),r}}}}),v.each(["radio","checkbox"],function(){v.valHooks[this]={set:function(t,e){return v.isArray(e)?t.checked=v.inArray(v(t).val(),e)>=0:void 0}},f.checkOn||(v.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),v.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){v.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),v.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}});var ee=v.now(),ie=/\?/;v.parseJSON=function(t){return JSON.parse(t+"")},v.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return(!e||e.getElementsByTagName("parsererror").length)&&v.error("Invalid XML: "+t),e};var ne,oe,re=/#.*$/,ae=/([?&])_=[^&]*/,se=/^(.*?):[ \t]*([^\r\n]*)$/gm,le=/^(?:GET|HEAD)$/,ce=/^\/\//,ue=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,he={},de={},pe="*/".concat("*");try{oe=location.href}catch(t){(oe=m.createElement("a")).href="",oe=oe.href}function fe(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,o=0,r=e.toLowerCase().match(R)||[];if(v.isFunction(i))for(;n=r[o++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function me(t,e,i,n){var o={},r=t===de;function a(s){var l;return o[s]=!0,v.each(t[s]||[],function(t,s){var c=s(e,i,n);return"string"!=typeof c||r||o[c]?r?!(l=c):void 0:(e.dataTypes.unshift(c),a(c),!1)}),l}return a(e.dataTypes[0])||!o["*"]&&a("*")}function ge(t,e){var i,n,o=v.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((o[i]?t:n||(n={}))[i]=e[i]);return n&&v.extend(!0,t,n),t}ne=ue.exec(oe.toLowerCase())||[],v.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:oe,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(ne[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":pe,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":v.parseJSON,"text xml":v.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?ge(ge(t,v.ajaxSettings),e):ge(v.ajaxSettings,t)},ajaxPrefilter:fe(he),ajaxTransport:fe(de),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var i,n,o,r,a,s,l,c,u=v.ajaxSetup({},e),h=u.context||u,d=u.context&&(h.nodeType||h.jquery)?v(h):v.event,p=v.Deferred(),f=v.Callbacks("once memory"),m=u.statusCode||{},g={},y={},b=0,w="canceled",x={readyState:0,getResponseHeader:function(t){var e;if(2===b){if(!r)for(r={};e=se.exec(o);)r[e[1].toLowerCase()]=e[2];e=r[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===b?o:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return b||(t=y[i]=y[i]||t,g[t]=e),this},overrideMimeType:function(t){return b||(u.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>b)for(e in t)m[e]=[m[e],t[e]];else x.always(t[x.status]);return this},abort:function(t){var e=t||w;return i&&i.abort(e),_(0,e),this}};if(p.promise(x).complete=f.add,x.success=x.done,x.error=x.fail,u.url=((t||u.url||oe)+"").replace(re,"").replace(ce,ne[1]+"//"),u.type=e.method||e.type||u.method||u.type,u.dataTypes=v.trim(u.dataType||"*").toLowerCase().match(R)||[""],null==u.crossDomain&&(s=ue.exec(u.url.toLowerCase()),u.crossDomain=!(!s||s[1]===ne[1]&&s[2]===ne[2]&&(s[3]||("http:"===s[1]?"80":"443"))===(ne[3]||("http:"===ne[1]?"80":"443")))),u.data&&u.processData&&"string"!=typeof u.data&&(u.data=v.param(u.data,u.traditional)),me(he,u,e,x),2===b)return x;for(c in(l=u.global)&&0==v.active++&&v.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!le.test(u.type),n=u.url,u.hasContent||(u.data&&(n=u.url+=(ie.test(n)?"&":"?")+u.data,delete u.data),!1===u.cache&&(u.url=ae.test(n)?n.replace(ae,"$1_="+ee++):n+(ie.test(n)?"&":"?")+"_="+ee++)),u.ifModified&&(v.lastModified[n]&&x.setRequestHeader("If-Modified-Since",v.lastModified[n]),v.etag[n]&&x.setRequestHeader("If-None-Match",v.etag[n])),(u.data&&u.hasContent&&!1!==u.contentType||e.contentType)&&x.setRequestHeader("Content-Type",u.contentType),x.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+pe+"; q=0.01":""):u.accepts["*"]),u.headers)x.setRequestHeader(c,u.headers[c]);if(u.beforeSend&&(!1===u.beforeSend.call(h,x,u)||2===b))return x.abort();for(c in w="abort",{success:1,error:1,complete:1})x[c](u[c]);if(i=me(de,u,e,x)){x.readyState=1,l&&d.trigger("ajaxSend",[x,u]),u.async&&u.timeout>0&&(a=setTimeout(function(){x.abort("timeout")},u.timeout));try{b=1,i.send(g,_)}catch(t){if(!(2>b))throw t;_(-1,t)}}else _(-1,"No Transport");function _(t,e,r,s){var c,g,y,w,_,S=e;2!==b&&(b=2,a&&clearTimeout(a),i=void 0,o=s||"",x.readyState=t>0?4:0,c=t>=200&&300>t||304===t,r&&(w=function(t,e,i){for(var n,o,r,a,s=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(o in s)if(s[o]&&s[o].test(n)){l.unshift(o);break}if(l[0]in i)r=l[0];else{for(o in i){if(!l[0]||t.converters[o+" "+l[0]]){r=o;break}a||(a=o)}r=r||a}return r?(r!==l[0]&&l.unshift(r),i[r]):void 0}(u,x,r)),w=function(t,e,i,n){var o,r,a,s,l,c={},u=t.dataTypes.slice();if(u[1])for(a in t.converters)c[a.toLowerCase()]=t.converters[a];for(r=u.shift();r;)if(t.responseFields[r]&&(i[t.responseFields[r]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=r,r=u.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(!(a=c[l+" "+r]||c["* "+r]))for(o in c)if((s=o.split(" "))[1]===r&&(a=c[l+" "+s[0]]||c["* "+s[0]])){!0===a?a=c[o]:!0!==c[o]&&(r=s[0],u.unshift(s[1]));break}if(!0!==a)if(a&&t.throws)e=a(e);else try{e=a(e)}catch(t){return{state:"parsererror",error:a?t:"No conversion from "+l+" to "+r}}}return{state:"success",data:e}}(u,w,x,c),c?(u.ifModified&&((_=x.getResponseHeader("Last-Modified"))&&(v.lastModified[n]=_),(_=x.getResponseHeader("etag"))&&(v.etag[n]=_)),204===t||"HEAD"===u.type?S="nocontent":304===t?S="notmodified":(S=w.state,g=w.data,c=!(y=w.error))):(y=S,(t||!S)&&(S="error",0>t&&(t=0))),x.status=t,x.statusText=(e||S)+"",c?p.resolveWith(h,[g,S,x]):p.rejectWith(h,[x,S,y]),x.statusCode(m),m=void 0,l&&d.trigger(c?"ajaxSuccess":"ajaxError",[x,u,c?g:y]),f.fireWith(h,[x,S]),l&&(d.trigger("ajaxComplete",[x,u]),--v.active||v.event.trigger("ajaxStop")))}return x},getJSON:function(t,e,i){return v.get(t,e,i,"json")},getScript:function(t,e){return v.get(t,void 0,e,"script")}}),v.each(["get","post"],function(t,e){v[e]=function(t,i,n,o){return v.isFunction(i)&&(o=o||n,n=i,i=void 0),v.ajax({url:t,type:e,dataType:o,data:i,success:n})}}),v.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){v.fn[e]=function(t){return this.on(e,t)}}),v._evalUrl=function(t){return v.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},v.fn.extend({wrapAll:function(t){var e;return v.isFunction(t)?this.each(function(e){v(this).wrapAll(t.call(this,e))}):(this[0]&&(e=v(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(t){return this.each(v.isFunction(t)?function(e){v(this).wrapInner(t.call(this,e))}:function(){var e=v(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=v.isFunction(t);return this.each(function(i){v(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(){return this.parent().each(function(){v.nodeName(this,"body")||v(this).replaceWith(this.childNodes)}).end()}}),v.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0},v.expr.filters.visible=function(t){return!v.expr.filters.hidden(t)};var ve=/%20/g,ye=/\[\]$/,be=/\r?\n/g,we=/^(?:submit|button|image|reset|file)$/i,xe=/^(?:input|select|textarea|keygen)/i;function _e(t,e,i,n){var o;if(v.isArray(e))v.each(e,function(e,o){i||ye.test(t)?n(t,o):_e(t+"["+("object"==typeof o?e:"")+"]",o,i,n)});else if(i||"object"!==v.type(e))n(t,e);else for(o in e)_e(t+"["+o+"]",e[o],i,n)}v.param=function(t,e){var i,n=[],o=function(t,e){e=v.isFunction(e)?e():null==e?"":e,n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=v.ajaxSettings&&v.ajaxSettings.traditional),v.isArray(t)||t.jquery&&!v.isPlainObject(t))v.each(t,function(){o(this.name,this.value)});else for(i in t)_e(i,t[i],e,o);return n.join("&").replace(ve,"+")},v.fn.extend({serialize:function(){return v.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=v.prop(this,"elements");return t?v.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!v(this).is(":disabled")&&xe.test(this.nodeName)&&!we.test(t)&&(this.checked||!$.test(t))}).map(function(t,e){var i=v(this).val();return null==i?null:v.isArray(i)?v.map(i,function(t){return{name:e.name,value:t.replace(be,"\r\n")}}):{name:e.name,value:i.replace(be,"\r\n")}}).get()}}),v.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(t){}};var Se=0,Te={},Me={0:200,1223:204},Ie=v.ajaxSettings.xhr();o.ActiveXObject&&v(o).on("unload",function(){for(var t in Te)Te[t]()}),f.cors=!!Ie&&"withCredentials"in Ie,f.ajax=Ie=!!Ie,v.ajaxTransport(function(t){var e;return f.cors||Ie&&!t.crossDomain?{send:function(i,n){var o,r=t.xhr(),a=++Se;if(r.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(o in t.xhrFields)r[o]=t.xhrFields[o];for(o in t.mimeType&&r.overrideMimeType&&r.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),i)r.setRequestHeader(o,i[o]);e=function(t){return function(){e&&(delete Te[a],e=r.onload=r.onerror=null,"abort"===t?r.abort():"error"===t?n(r.status,r.statusText):n(Me[r.status]||r.status,r.statusText,"string"==typeof r.responseText?{text:r.responseText}:void 0,r.getAllResponseHeaders()))}},r.onload=e(),r.onerror=e("error"),e=Te[a]=e("abort");try{r.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}:void 0}),v.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return v.globalEval(t),t}}}),v.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),v.ajaxTransport("script",function(t){var e,i;if(t.crossDomain)return{send:function(n,o){e=v("<script>").prop({async:!0,charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&o("error"===t.type?404:200,t.type)}),m.head.appendChild(e[0])},abort:function(){i&&i()}}});var Pe=[],Ce=/(=)\?(?=&|$)|\?\?/;v.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Pe.pop()||v.expando+"_"+ee++;return this[t]=!0,t}}),v.ajaxPrefilter("json jsonp",function(t,e,i){var n,r,a,s=!1!==t.jsonp&&(Ce.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ce.test(t.data)&&"data");return s||"jsonp"===t.dataTypes[0]?(n=t.jsonpCallback=v.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(Ce,"$1"+n):!1!==t.jsonp&&(t.url+=(ie.test(t.url)?"&":"?")+t.jsonp+"="+n),t.converters["script json"]=function(){return a||v.error(n+" was not called"),a[0]},t.dataTypes[0]="json",r=o[n],o[n]=function(){a=arguments},i.always(function(){o[n]=r,t[n]&&(t.jsonpCallback=e.jsonpCallback,Pe.push(n)),a&&v.isFunction(r)&&r(a[0]),a=r=void 0}),"script"):void 0}),v.parseHTML=function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||m;var n=M.exec(t),o=!i&&[];return n?[e.createElement(n[1])]:(n=v.buildFragment([t],e,o),o&&o.length&&v(o).remove(),v.merge([],n.childNodes))};var Ae=v.fn.load;v.fn.load=function(t,e,i){if("string"!=typeof t&&Ae)return Ae.apply(this,arguments);var n,o,r,a=this,s=t.indexOf(" ");return s>=0&&(n=v.trim(t.slice(s)),t=t.slice(0,s)),v.isFunction(e)?(i=e,e=void 0):e&&"object"==typeof e&&(o="POST"),a.length>0&&v.ajax({url:t,type:o,dataType:"html",data:e}).done(function(t){r=arguments,a.html(n?v("<div>").append(v.parseHTML(t)).find(n):t)}).complete(i&&function(t,e){a.each(i,r||[t.responseText,e,t])}),this},v.expr.filters.animated=function(t){return v.grep(v.timers,function(e){return t===e.elem}).length};var Ee=o.document.documentElement;function Le(t){return v.isWindow(t)?t:9===t.nodeType&&t.defaultView}v.offset={setOffset:function(t,e,i){var n,o,r,a,s,l,c=v.css(t,"position"),u=v(t),h={};"static"===c&&(t.style.position="relative"),s=u.offset(),r=v.css(t,"top"),l=v.css(t,"left"),("absolute"===c||"fixed"===c)&&(r+l).indexOf("auto")>-1?(a=(n=u.position()).top,o=n.left):(a=parseFloat(r)||0,o=parseFloat(l)||0),v.isFunction(e)&&(e=e.call(t,i,s)),null!=e.top&&(h.top=e.top-s.top+a),null!=e.left&&(h.left=e.left-s.left+o),"using"in e?e.using.call(t,h):u.css(h)}},v.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){v.offset.setOffset(this,t,e)});var e,i,n=this[0],o={top:0,left:0},r=n&&n.ownerDocument;return r?(e=r.documentElement,v.contains(e,n)?(typeof n.getBoundingClientRect!==Y&&(o=n.getBoundingClientRect()),i=Le(r),{top:o.top+i.pageYOffset-e.clientTop,left:o.left+i.pageXOffset-e.clientLeft}):o):void 0},position:function(){if(this[0]){var t,e,i=this[0],n={top:0,left:0};return"fixed"===v.css(i,"position")?e=i.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),v.nodeName(t[0],"html")||(n=t.offset()),n.top+=v.css(t[0],"borderTopWidth",!0),n.left+=v.css(t[0],"borderLeftWidth",!0)),{top:e.top-n.top-v.css(i,"marginTop",!0),left:e.left-n.left-v.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||Ee;t&&!v.nodeName(t,"html")&&"static"===v.css(t,"position");)t=t.offsetParent;return t||Ee})}}),v.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var i="pageYOffset"===e;v.fn[t]=function(n){return N(this,function(t,n,r){var a=Le(t);return void 0===r?a?a[e]:t[n]:void(a?a.scrollTo(i?o.pageXOffset:r,i?r:o.pageYOffset):t[n]=r)},t,n,arguments.length,null)}}),v.each(["top","left"],function(t,e){v.cssHooks[e]=It(f.pixelPosition,function(t,i){return i?(i=Mt(t,e),St.test(i)?v(t).position()[e]+"px":i):void 0})}),v.each({Height:"height",Width:"width"},function(t,e){v.each({padding:"inner"+t,content:e,"":"outer"+t},function(i,n){v.fn[n]=function(n,o){var r=arguments.length&&(i||"boolean"!=typeof n),a=i||(!0===n||!0===o?"margin":"border");return N(this,function(e,i,n){var o;return v.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===n?v.css(e,i,a):v.style(e,i,n,a)},e,r?n:void 0,r,null)}})}),v.fn.size=function(){return this.length},v.fn.andSelf=v.fn.addBack,i("nErl")&&(void 0===(n=function(){return v}.apply(e,[]))||(t.exports=n));var De=o.jQuery,ke=o.$;return v.noConflict=function(t){return o.$===v&&(o.$=ke),t&&o.jQuery===v&&(o.jQuery=De),v},typeof r===Y&&(o.jQuery=o.$=v),v},"object"==typeof t&&"object"==typeof t.exports?t.exports=o.document?r(o,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return r(t)}:r(o)},azXA:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tools-component-container",class:{"tools-icon":t.MiddleManState}},[i("div",{staticClass:"tools-btn-content",on:{click:function(e){return e.preventDefault(),t.toggleToolsList(e)}}},[i("i",{staticClass:"tools-btn-icon"}),t._v(" "),i("span",{staticClass:"tools-btn-text"},[t._v(t._s(t.$t("toolsText")))])]),t._v(" "),t.toolsListIsShow?i("div",{staticClass:"tools-list-container"},[i("div",{staticClass:"tools-list-content"},[t.MultipleMeasureState?i("div",{staticClass:"tools-item",class:{active:t.measureIsActive},on:{click:t.toggleMeasureStatus}},[i("span",{staticClass:"tools-item-icon measure-icon"}),t._v(" "),i("span",{staticClass:"tools-item-text"},[t._v(t._s(t.$t("measureText")))])]):t._e(),t._v(" "),t.MultipleTagState?i("div",{staticClass:"tools-item",class:{active:t.tagIsUsed},on:{click:t.toggleTagStatus}},[i("span",{staticClass:"tools-item-icon tag-icon"}),t._v(" "),i("span",{staticClass:"tools-item-text"},[t._v(t._s(t.$t("tagText")))])]):t._e(),t._v(" "),t.MultipleVrState?i("div",{staticClass:"tools-item active",on:{click:t.showVrTip}},[i("span",{staticClass:"tools-item-icon vr-icon"}),t._v(" "),i("span",{staticClass:"tools-item-text"},[t._v(t._s(t.$t("vrText")))])]):t._e(),t._v(" "),t.MultipleHelpState?i("div",{staticClass:"tools-item active",on:{click:t.showHelpTip}},[i("span",{staticClass:"tools-item-icon help-icon"}),t._v(" "),i("span",{staticClass:"tools-item-text"},[t._v(t._s(t.$t("helpText")))])]):t._e()]),t._v(" "),i("div",{staticClass:"tools-list-arrow"})]):t._e()])},staticRenderFns:[]};e.a=n},bPd3:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("xD1l"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("JI0+");var s=function(t){i("C8U4")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-76181360",null);e.default=l.exports},bTSe:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s(i("LTEq")),o=s(i("7kBY")),r=s(i("z30g")),a=s(i("Sg+Z"));function s(t){return t&&t.__esModule?t:{default:t}}e.default={components:{PictureTag:n.default,AudioTag:o.default,VideoTag:r.default,IframeTag:a.default},props:{},name:"all-tag-container",data:function(){return{}},computed:{currentTagType:function(){return this.$store.state.currentTagType},tagIsShow:function(){return this.$store.tagIsShow}},created:function(){},mounted:function(){},methods:{}}},bWA0:function(t,e){},bf3z:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("9X3O");e.default={components:{},props:{},name:"loading-component",data:function(){return{defaultLoadingUrl:n}},computed:{companyId:function(){return this.$store.state.companyId},companyLogoUrl:function(){return this.$store.state.companyLogoUrl},companyLoadingUrl:function(){return this.$store.state.companyLoadingUrl},loadingBgUrl:function(){return this.$store.state.loadingBgUrl},loadingProgress:function(){return this.$store.state.loadingProgress},companySettingsIsLoaded:function(){return this.$store.state.companySettingsIsLoaded}},created:function(){},mounted:function(){},methods:{}}},blGk:function(t,e){},br1f:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"share-full-container",class:{"share-icon":t.MultipleMeasureState||t.MultipleTagState||t.MultipleHelpState}},[i("div",{staticClass:"share-container"},[i("div",{staticClass:"share-wechat-content share-content",class:[t.$i18n.locale]}),t._v(" "),i("div",{staticClass:"share-wechat-tip-container"},[i("div",{staticClass:"share-wechat-tip-content"},[i("div",{staticClass:"share-wechat-qrcode-container"},[i("div",{ref:"qrCodeDiv",staticClass:"share-wechat-qrcode"})]),t._v(" "),i("div",{staticClass:"share-wechat-desc-container"},[i("div",{staticClass:"share-wechat-tip-title"},[t._v(t._s(t.$t("wechatTipTitle")))]),t._v(" "),i("div",{staticClass:"share-wechat-tip-desc"},[t._v(t._s(t.$t("wechatTipDesc")))])])])])]),t._v(" "),t._e()])},staticRenderFns:[]};e.a=n},cCTi:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("ZTVv"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("BWAX");var s=function(t){i("j0n3")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-1da32029",null);e.default=l.exports},cFjv:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mini-chat-container",on:{click:function(e){return e.stopPropagation(),t.goChat(e)}}},[i("i",{staticClass:"mini-chat-icon"}),t._v(" "),i("span",{staticClass:"mini-chat-text"},[t._v("\n       "+t._s(t.$t("miniChatText"))+"\n   ")])])},staticRenderFns:[]};e.a=n},cLSN:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"disclaimer-content-container",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeDisclaimer(e)},touchmove:function(t){if(t.target!==t.currentTarget)return null;t.preventDefault()},scroll:function(t){if(t.target!==t.currentTarget)return null;t.preventDefault()},mousewheel:function(t){if(t.target!==t.currentTarget)return null;t.preventDefault()}}},[i("div",{staticClass:"disclaimer-content"},[i("div",{staticClass:"disclaimer-close",on:{click:t.closeDisclaimer}}),t._v(" "),i("div",{staticClass:"disclaimer-header"},[i("span",{staticClass:"disclaimer-title"},[t._v(t._s(t.$t("disclaimerBtnText")))])]),t._v(" "),i("div",{staticClass:"disclaimer-main scroll_content mobile",domProps:{innerHTML:t._s(t.disclaimerContent)}})])])},staticRenderFns:[]};e.a=n},cTmK:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"iframe-tag-container",data:function(){return{}},computed:{currentTagData:function(){return this.$store.state.currentTagData}},created:function(){},mounted:function(){},methods:{closeTagContainer:function(){this.statistic_utils.trackEvent(79),this.$store.dispatch("changeTagStatus",!1)}}}},cVOK:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},components:{},name:"big-baidu-map",data:function(){return{}},computed:{houseInfoData:function(){return this.$store.state.houseInfo},getGoogleMapLoadStatus:function(){return this.$store.state.googleMapLoadStatus}},created:function(){},mounted:function(){google&&this.mapInit()},watch:{getGoogleMapLoadStatus:function(t,e){t&&this.mapInit()}},methods:{mapInit:function(){var t={zoom:15,center:{lat:Number(this.houseInfoData.houseInfo.map.lat),lng:Number(this.houseInfoData.houseInfo.map.lon)},mapTypeId:"roadmap"},e=new google.maps.Map(document.getElementById("big-mobile-landscape-google-map"),t);new google.maps.Marker({position:t.center,map:e,animation:google.maps.Animation.BOUNCE})},closeBigMapContent:function(){this.statistic_utils.trackEvent(77),this.$store.dispatch("toggleBigMapStatus",!1)}}}},cmTr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"pc-switch",data:function(){return{}},computed:{toolsListIsShow:function(){return this.$store.state.toolsListIsShow},measureIsActive:function(){return this.$store.state.measureIsActive},tagIsUsed:function(){return this.$store.state.tagIsUsed},MultipleMeasureState:function(){return this.$store.state.MultipleMeasureState},MultipleTagState:function(){return this.$store.state.MultipleTagState},MultipleHelpState:function(){return this.$store.state.MultipleHelpState},MultipleVrState:function(){return this.$store.state.MultipleVrState},MiddleManState:function(){return this.$store.state.MiddleManState}},created:function(){},mounted:function(){},methods:{toggleToolsList:function(){this.$store.dispatch("toggleToolsList",!this.$store.state.toolsListIsShow),this.statistic_utils.trackEvent(21)},toggleMeasureStatus:function(){this.statistic_utils.trackEvent(19),this.$store.dispatch("changeMeasureStatus",!this.$store.state.measureIsActive)},toggleTagStatus:function(){this.statistic_utils.trackEvent(16),this.$store.dispatch("changeTagIsUsed",!this.$store.state.tagIsUsed)},showVrTip:function(){this.statistic_utils.trackEvent(81),this.$store.dispatch("toggleToolsList",!1),this.$store.dispatch("changeVrTipStatus",!0)},showHelpTip:function(){this.statistic_utils.trackEvent(18),this.$store.dispatch("toggleToolsList",!1),this.$store.dispatch("changeHelpTipStatus",!0)},toggleDisclaimerContent:function(){this.statistic_utils.trackEvent(48),this.$store.dispatch("toggleDisclaimerContent",!this.$store.state.disclaimerContentIsShow)}}}},cslE:function(t,e){},d3JF:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("SnEr"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("PJic");var s=function(t){i("fNWt")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-34da2582",null);e.default=l.exports},dA04:function(t,e){},dFT8:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"company-logo-container"},[e("img",{staticClass:"company-logo-content",attrs:{src:this.companyLogoUrl,alt:""}})])},staticRenderFns:[]};e.a=n},dGOZ:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"img-swiper-container"},[i("div",{staticClass:"img-swiper-content"},[i("i",{staticClass:"img-swiper-close",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeImgSwiper(e)}}}),t._v(" "),i("swiper",{attrs:{options:t.swiperOption}},[t._l(t.houseInfoData.communityImages.images,function(t,e){return i("swiper-slide",{key:e,style:{backgroundImage:"url("+t+")"}})}),t._v(" "),i("div",{staticClass:"swiper-button-next swiper-button-white",attrs:{slot:"button-next"},slot:"button-next"}),t._v(" "),i("div",{staticClass:"swiper-button-prev swiper-button-white",attrs:{slot:"button-prev"},slot:"button-prev"})],2)],1)])},staticRenderFns:[]};e.a=n},"dT/n":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"take-look-tip",data:function(){return{}},computed:{takeLookTip:function(){return this.$store.state.takeLookTip}},created:function(){},mounted:function(){},methods:{}}},dUJX:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("3pLw"),r=(n=o)&&n.__esModule?n:{default:n};var a,s=i("2Uyi"),l=i("/9mg"),c=i("w1BD");"online"===i("ynQN").getStyle()?a="https://user.3dnest.cn/nest_house/new_detail/":a="https://allfun.3dnest.cn/nest_house/new_detail/";e.default={load:function(t,e,i){var n=s.getQueryString("m"),o=(s.getQueryString("middlemanShare"),{m:n,lang:t.languageObj.lang});r.default.get({url:a,data:o}).then(function(n){if(n&&200===n.status&&1===n.data.code){var o=function(t,e,i){var n={};for(var o in e)switch(o){case"title":n.title=t[o]||"";break;case"share":n.share=c.getLinkData(t,e.share);break;case"houseInfo":n.houseInfo=c.generateHouseInfo(t,e.houseInfo),n.houseInfo.list=t.menu_info;break;case"brokerInfo":n.brokerInfo=c.getbrokerInfo(t,e.brokerInfo);break;case"homeLink":n.homeLink=c.getLinkData(t,e.homeLink);break;case"panoramaLink":n.panoramaLink=c.getLinkData(t,e.panoramaLink)}return n=c.replenishData(n,i)}(n.data.house_info,l,t);o=c.replenishData(o,t)}else o=function(t){return c.replenishData(null,t)}(t);e(o,t,i)})}}},dg6q:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"video-tag-container",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeTagContainer(e)},touchmove:function(t){t.preventDefault()},scroll:function(t){t.preventDefault()},mousewheel:function(t){t.preventDefault()}}},[i("div",{staticClass:"video-tag-content"},[i("div",{staticClass:"video-close-btn",on:{click:t.closeTagContainer}}),t._v(" "),t.currentTagData&&t.currentTagData.videourl&&"string"==typeof t.currentTagData.videourl?i("div",{staticClass:"video-content"},[i("video",{staticClass:"video-ele",attrs:{src:t.currentTagData.videourl,controls:""}})]):t._e(),t._v(" "),i("div",{staticClass:"video-desc-container"},[i("div",{staticClass:"video-desc-title"},[t._v("\n               "+t._s(t.currentTagData.title)+"\n             ")]),t._v(" "),i("div",{staticClass:"video-desc-content",domProps:{innerHTML:t._s(t.currentTagData.description)}})])])])},staticRenderFns:[]};e.a=n},dwfi:function(t,e){},e4Gv:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("0F+u"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("p/md");var s=function(t){i("r1dK")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-1b2b7573",null);e.default=l.exports},e6sy:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i("v2ns");var n=i("7QTg");e.default={props:{},name:"picture-tag-container",components:{swiper:n.swiper,swiperSlide:n.swiperSlide},data:function(){return{swiperOption:{pagination:{el:".swiper-pagination",type:"fraction"},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},loop:!0,loopAdditionalSlides:0}}},computed:{currentTagData:function(){return this.$store.state.currentTagData}},created:function(){},mounted:function(){},methods:{closeTagContainer:function(){this.statistic_utils.trackEvent(79),this.$store.dispatch("changeTagStatus",!1)},lookDetails:function(){this.currentTagData.url&&(window.location.href=this.currentTagData.url)}}}},e8WS:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("xiRS"),o=null;e.default={props:{},name:"take-look-panel",data:function(){return{takeLookProgress:1,currentTime:60,brokerName:"",brokerBg:n,brokerTitle:"",userName:"",userBg:n,userTitle:""}},created:function(){},mounted:function(){this.switchMode(this.$store.state.takeLookChatState)},computed:{getTakeLookChatState:function(){return this.$store.state.takeLookChatState},getTakeLookInfoStateIsUpdate:function(){return this.$store.state.takeLookInfoStateIsUpdate},getTakeLookCallingLeftTime:function(){return this.$store.state.takeLookCallingLeftTime},takeLookRole:function(){return this.$store.state.takeLookRole},currentMode:function(){return this.$store.state.currentMode},getTakeLookUserInfo:function(){return this.$store.state.takeLookInfo}},watch:{getTakeLookChatState:function(t,e){this.switchMode(t)},getTakeLookUserInfo:function(){this.updateTakeLookInfo()},getTakeLookCallingLeftTime:function(t,e){this.currentTime=t}},methods:{switchMode:function(t){switch(t){case 1:this.takeLookProgress=3,this.stopTimeCount(),this.updateTakeLookInfo();break;case 2:case 3:this.takeLookProgress=1,this.startTimeCount();break;case 4:this.$store.dispatch("changeTakeLookStatus",!1),this.takeLookProgress=1,this.stopTimeCount()}this.$store.dispatch("changeTakeLookActionState","")},closeTakeLook:function(){this.$store.dispatch("changeTakeLookActionState",3)},callAgain:function(){this.takeLookProgress=1,this.$store.dispatch("changeTakeLookActionState",2)},takeLookStart:function(){this.takeLookProgress=1,this.$store.dispatch("changeTakeLookActionState",1)},startTimeCount:function(){var t=this;this.takeLookProgress=1,this.stopTimeCount(),o=setInterval(function(){if(t.currentTime<=1)return clearInterval(o),t.takeLookProgress=2,void t.$store.dispatch("changeTakeLookChatState","");t.currentTime=t.currentTime-1},1e3)},stopTimeCount:function(){this.currentTime=60,clearInterval(o),o=null},updateTakeLookInfo:function(){this.brokerBg=this.$store.state.takeLookInfo.bussiness.headImg||n,this.userBg=this.$store.state.takeLookInfo.customer.headImg||n,this.brokerName=this.$store.state.takeLookInfo.bussiness.nickName,this.userName=this.$store.state.takeLookInfo.customer.nickName,this.brokerTitle=this.$store.state.takeLookInfo.bussiness.role||"顾问",this.userTitle=this.$store.state.takeLookInfo.customer.role||"客户"}}}},eHk0:function(t,e){},eNGq:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("2HrB"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("ZR+X");var s=function(t){i("sfpZ")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-68067854",null);e.default=l.exports},eoK6:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"floor-bar-container-box",class:{sceneorlecture:t.sceneList||t.lectureList}},[i("div",{staticClass:"floor-bar-container",on:{click:function(e){return e.stopPropagation(),t.selectFloor(e)}}},["dollhouse"===t.currentMode?i("span",{staticClass:"floor-bar-item",class:{active:"all"===t.currentFloorIndex},attrs:{"data-index":"all"}},[t._v(t._s(t.$t("floorAll")))]):t._e(),t._v(" "),t._l(t.floorList,function(e,n){return i("span",{key:n,staticClass:"floor-bar-item",class:{active:e.floorIndex==t.currentFloorIndex},attrs:{"data-index":e.floorIndex}},[t._v("\n            "+t._s(e.floorName)+"\n        ")])})],2)])},staticRenderFns:[]};e.a=n},ezZF:function(t,e){},f3sb:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("ZUlf"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("rC5B");var s=function(t){i("Owni")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-64c35c38",null);e.default=l.exports},f5WC:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(i("YFyo")),o=r(i("HcVH"));function r(t){return t&&t.__esModule?t:{default:t}}e.default={props:{},components:{BaiduMap:n.default,BmMarker:o.default},name:"big-baidu-map",data:function(){return{map:{width:"100%",height:"100%"}}},computed:{houseInfoData:function(){return this.$store.state.houseInfo},isDragingMap:function(){return this.$store.state.isDragingMap}},created:function(){},mounted:function(){},methods:{closeBigMapContent:function(){this.isDragingMap||(this.statistic_utils.trackEvent(77),this.$store.dispatch("toggleBigMapStatus",!1))},cleanEvent:function(){var t=this;setTimeout(function(){t.$store.dispatch("changeIsDragingMap",!1),null},100)},goDrag:function(){this.$store.dispatch("changeIsDragingMap",!0)}}}},fBLG:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{on:{click:this.changeMode}},[this._t("mode-btn-slot")],2)},staticRenderFns:[]};e.a=n},fNWt:function(t,e){},flsx:function(t,e){},foAD:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s(i("Pv1i")),o=s(i("z7S7")),r=s(i("7gkt")),a=s(i("9+Zl"));function s(t){return t&&t.__esModule?t:{default:t}}e.default={components:{MiddleMan:n.default,ToolComponent:o.default,TakeLook:r.default,MiniChat:a.default},props:{},name:"mobile-mini-chat",data:function(){return{}},computed:{houseInfoData:function(){return this.$store.state.houseInfo},companyId:function(){return this.$store.state.companyId},MiddleManState:function(){return this.$store.state.MiddleManState},MultipleMeasureState:function(){return this.$store.state.MultipleMeasureState},MultipleTagState:function(){return this.$store.state.MultipleTagState},MultipleHelpState:function(){return this.$store.state.MultipleHelpState},MultipleVrState:function(){return this.$store.state.MultipleVrState}},created:function(){},mounted:function(){},methods:{}}},foYj:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("G5w5"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("1m9V");var s=function(t){i("BaDW")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-3473f061",null);e.default=l.exports},fpjm:function(t,e){},ftK2:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("IuSH"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("dGOZ");var s=function(t){i("fpjm")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-68b11a3a",null);e.default=l.exports},g5jC:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("LnMS"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("Qd86");var s=function(t){i("blGk")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-29d0ef5e",null);e.default=l.exports},gDxV:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("aPJZ"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("dFT8");var s=function(t){i("ytEo")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-8f42277e",null);e.default=l.exports},gLWB:function(t,e){},gPlk:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s(i("RbAI")),o=s(i("CcYH")),r=s(i("+Wo4")),a=s(i("W/Op"));function s(t){return t&&t.__esModule?t:{default:t}}e.default={components:{scenePanel:n.default,lectureRoomPanel:o.default,modeButton:r.default},props:{component:{type:Object}},name:"pc-switch",data:function(){return{baseConst:a.default}},created:function(){},computed:{currentMode:function(){return this.$store.state.currentMode},sceneList:function(){return this.$store.state.sceneList},lectureList:function(){return this.$store.state.lectureList}},mounted:function(){},methods:{changeMode:function(t){switch(t){case a.default.floorplan:if("floorplan"===this.currentMode||"transitioning"===this.currentMode)return!1;this.statistic_utils.trackEvent(2),this.$store.dispatch("goMode","floorplan");break;case a.default.dollhouse:if("dollhouse"===this.currentMode||"transitioning"===this.currentMode)return!1;this.statistic_utils.trackEvent(2),this.$store.dispatch("goMode","dollhouse")}}}}},ggQo:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"house-info-container"},[i("div",{staticClass:"house-info-title"},[t._v("\n        "+t._s(t.$t("houseInfoTitle"))+"\n    ")]),t._v(" "),i("div",{staticClass:"house-info-main-container"},[i("div",{staticClass:"house-info-main scroll_content"},t._l(t.houseInfoData.houseInfo.list,function(e,n){return i("div",{key:n,staticClass:"house-info-item",class:{style1:1==e.widthStyle,style2:1!=e.widthStyle},style:{display:e.is_show&&"1"===e.is_show||!e.name&&!e.value?"none":"flex"}},[i("div",{staticClass:"house-info-item-name only-line1"},[t._v(t._s(e.name))]),t._v(" "),i("div",{staticClass:"house-info-item-content only-line1"},[t._v(t._s(e.value))])])}),0)]),t._v(" "),i("div",{staticClass:"house-info-more-container"},[t.houseInfoData.houseInfo.houseDetail?i("div",{staticClass:"house-info-more-btn",on:{click:t.goHouseInfoDetails}},[i("span",{staticClass:"house-info-more-text"},[t._v(t._s(t.$t("houseInfoMoreBtnText")))]),t._v(" "),i("i",{staticClass:"house-info-more-icon"})]):t._e()])])},staticRenderFns:[]};e.a=n},gimj:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("bPd3"),r=(n=o)&&n.__esModule?n:{default:n};e.default={components:{ShareComponent:r.default},props:{},name:"mobile-top-component",data:function(){return{}},computed:{houseInfoIsShow:function(){return this.$store.state.houseInfoIsShow},houseInfoData:function(){return this.$store.state.houseInfo},shareComponentIsShow:function(){return this.$store.state.shareComponentIsShow}},created:function(){},mounted:function(){},methods:{toggleHouseInfoPanel:function(){this.statistic_utils.trackEvent(25),(this.houseInfoData.houseInfo&&this.houseInfoData.houseInfo.enable||this.houseInfoData.houseInfo&&this.houseInfoData.houseInfo.map)&&(this.$store.dispatch("toggleHouseInfoPanel",!this.$store.state.houseInfoIsShow),!this.$store.state.takeLookInfoStateIsUpdate||"1"!==this.$store.state.takeLookRole&&"2"!==this.$store.state.takeLookRole&&"3"!==this.$store.state.takeLookRole||this.$store.dispatch("changeTakeLookOperation",{type:"UI",target:"houseInfo",action:!this.$store.state.houseInfoIsShow}))},toggleShareComponent:function(){this.$store.dispatch("changeShareComponentStatus",!this.shareComponentIsShow),!this.$store.state.takeLookInfoStateIsUpdate||"1"!==this.$store.state.takeLookRole&&"2"!==this.$store.state.takeLookRole&&"3"!==this.$store.state.takeLookRole||this.$store.dispatch("changeTakeLookOperation",{type:"UI",target:"shareComponent",action:!this.shareComponentIsShow})}}}},gj31:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{currentButtonMode:{type:String}},name:"pc-switch",data:function(){return{}},created:function(){},mounted:function(){},methods:{changeMode:function(){this.$emit("changeMode",this.currentButtonMode)}}}},gkRR:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("3pLw"),r=(n=o)&&n.__esModule?n:{default:n};var a=i("xiRS");e.default={props:{},name:"midddle-man",data:function(){return{defaultBg:a}},computed:{houseInfoData:function(){return this.$store.state.houseInfo},brokerImage:function(){var t=this.$store.state.houseInfo;return t&&t.brokerInfo&&t.brokerInfo.brokerImage?t.brokerInfo.brokerImage:a}},created:function(){},mounted:function(){},methods:{openMiddlemanTranspond:function(){this.$store.dispatch("changeMiddlemanTranspondStatus",!0)},showTelDialog:function(){this.statistic_utils.trackEvent(22),this.houseInfoData&&this.houseInfoData.slideVerify&&this.houseInfoData.slideVerify.enable&&this.houseInfoData.slideVerify.uid?this.getVirtualNumber(this.houseInfoData.slideVerify.uid):!(this.houseInfoData&&this.houseInfoData.brokerInfo&&this.houseInfoData.brokerInfo.brokerPhone)||this.houseInfoData.slideVerify&&this.houseInfoData.slideVerify.enable?this.$store.dispatch("changeTelTipStatus",!0):this.$store.dispatch("changeTelDialogStatus",!0)},getVirtualNumber:function(t){var e=this.CommonUtil.getQueryString("city"),i={command:"Global",action:"VirtualCheckType",city_id:e,uid:t},n="https://api.917.com/index.php",o=this;r.default.post({url:n,data:i}).then(function(i){var a;if((a=i.feedback)&&a.msg9006&&1==a.msg9006.type){var s={command:"Global",action:"VirtualCheckType",city_id:e,uid:t,act:"check",ts:a.msg9006.msg.ts,sec:a.msg9006.msg.secret};r.default.post({url:n,data:s}).then(function(t){var e;if((e=t.feedback)&&e.msg9006&&200==e.msg9006.status){var i=e.msg9006.msg._virtual_number,n=e.msg9006.msg.unbind_time;o.$store.dispatch("changeVirtualNumber",{virtualNumber:i,unbindTime:1e3*n}),o.$store.dispatch("changeTelDialogStatus",!0)}else o.$store.dispatch("changeTelTipStatus",!0)})}else a&&a.msg9006&&2==a.msg9006.type&&a.msg9006[0]&&a.msg9006[1]?(o.$store.dispatch("changeSlideVerifyPicArray",[a.msg9006[0],a.msg9006[1]]),o.$store.dispatch("changeSlideVerifyStatus",!0)):a&&a.msg9006})}}}},glKE:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("WnMO"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("L0sV");var s=function(t){i("FtqT")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-5452f25c",null);e.default=l.exports},gqX1:function(t,e){},gvt3:function(t,e){},gzC7:function(t,e){},h3k4:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("HPFS"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("REwT");var s=function(t){i("qOd3")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-de86c8a0",null);e.default=l.exports},h8mS:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=l(i("+Th0")),o=l(i("9icC")),r=l(i("ncoA")),a=l(i("MuF7"));i("v2ns");var s=i("7QTg");function l(t){return t&&t.__esModule?t:{default:t}}e.default={props:{},name:"mobile-house-component-container",data:function(){return{swiperOption:{loop:!1,loopAdditionalSlides:1,effect:"coverflow",grabCursor:!0,centeredSlides:!0,slidesPerView:"auto",slideBetween:10,coverflowEffect:{rotate:0,stretch:180,depth:800,modifier:1,slideShadows:!0},observer:!0,observeParents:!0,observeSlideChildren:!0},houseInfo:n.default,smallBaiduMap:o.default,smallGoogleMap:r.default,houseImgContainer:a.default}},components:{houseInfo:n.default,smallBaiduMap:o.default,houseImgContainer:a.default,swiper:s.swiper,swiperSlide:s.swiperSlide,isLoop:!0},computed:{isOpen:function(){return this.$store.state.houseInfoIsShow},houseInfoData:function(){return this.$store.state.houseInfo},houseInfoArr:function(){var t=[];return(this.$store.state.houseInfo.communityImages&&this.$store.state.houseInfo.communityImages.enable&&this.$store.state.houseInfo.communityImages.images&&this.$store.state.houseInfo.communityImages.images.length>0||this.$store.state.houseInfo.panoramaLink&&this.$store.state.houseInfo.panoramaLink.enable&&this.$store.state.houseInfo.panoramaLink.link)&&t.push({template:this.houseImgContainer}),this.$store.state.houseInfo.houseInfo&&this.$store.state.houseInfo.houseInfo.enable&&(t.push({template:this.houseInfo}),this.swiperOption.initialSlide=t.length-1),this.$store.state.houseInfo.houseInfo&&this.$store.state.houseInfo.houseInfo.map&&this.$store.state.houseInfo.houseInfo.map.lat&&this.$store.state.houseInfo.houseInfo.map.lon&&1!==this.$store.state.houseInfo.houseInfo.map_type?t.push({template:this.smallBaiduMap}):this.$store.state.houseInfo.houseInfo&&this.$store.state.houseInfo.houseInfo.map&&this.$store.state.houseInfo.houseInfo.map.lat&&this.$store.state.houseInfo.houseInfo.map.lon&&1===this.$store.state.houseInfo.houseInfo.map_type&&t.push({template:this.smallGoogleMap}),t}},created:function(){},mounted:function(){},methods:{closePanel:function(){this.statistic_utils.trackEvent(26),this.$store.dispatch("toggleHouseInfoPanel",!1),!this.$store.state.takeLookInfoStateIsUpdate||"1"!==this.$store.state.takeLookRole&&"2"!==this.$store.state.takeLookRole&&"3"!==this.$store.state.takeLookRole||this.$store.dispatch("changeTakeLookOperation",{type:"UI",target:"houseInfo",action:!1})},blurEvent:function(){}}}},hA7x:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"lecture-panel-container"},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.lectureIsActive,expression:"!lectureIsActive"}],staticClass:"lecture-panel-bt",on:{click:t.showLecturePanelList}},[i("i",{staticClass:"bt-icon"}),t._v(" "),i("span",{staticClass:"bt-text"},[t._v(t._s(t.$t("lectureText")))])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.lectureIsActive,expression:"lectureIsActive"}],staticClass:"lecture-list-container"},[i("div",{staticClass:"lecture-pause-btn",on:{click:t.closeLecturePanelList}},[i("i",{staticClass:"lecture-pause-btn-icon"})]),t._v(" "),t.lectureList&&t.lectureList.length<=4?i("div",{ref:"lectureList",staticClass:"lecture-list"},t._l(t.lectureList,function(e,n){return i("div",{key:n,ref:"lectureItem"+n,refInFor:!0,staticClass:"lecture-item",class:{active:t.currentLectureIndex===n},attrs:{"data-index":n},on:{click:function(e){return t.selectLectureItem(n)}}},[t._v("\n        "+t._s(e.name)+"\n        "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.currentLectureIndex===n,expression:"currentLectureIndex === index"}],staticClass:"lecture-item-status-container"},[i("div",{staticClass:"lecture-item-status",style:{width:t.currentLecturePercent+"%"}})])])}),0):t.lectureList&&t.lectureList.length>4?i("div",{ref:"lectureList",staticClass:"lecture-list"},[i("swiper",{attrs:{options:t.swiperOption}},[i("div",{staticClass:"swiper-scrollbar",attrs:{slot:"scrollbar"},slot:"scrollbar"}),t._v(" "),t._l(t.lectureList,function(e,n){return i("swiper-slide",{key:n},[i("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"}),t._v(" "),i("div",{staticClass:"swiper-button-prev",attrs:{slot:"button-prev"},slot:"button-prev"}),t._v(" "),i("div",{staticClass:"swiper-button-next",attrs:{slot:"button-next"},slot:"button-next"}),t._v(" "),i("div",{ref:"lectureItem"+n,refInFor:!0,staticClass:"lecture-item",class:{active:t.currentLectureIndex===n},attrs:{"data-index":n},on:{click:function(e){return t.selectLectureItem(n)}}},[i("div",{staticClass:"lecture-item-text2"},[t._v(t._s(e.name))]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.currentLectureIndex===n,expression:"currentLectureIndex === index"}],staticClass:"lecture-item-status-container"},[i("div",{staticClass:"lecture-item-status",style:{width:t.currentLecturePercent+"%"}})])])])})],2)],1):t._e()])])},staticRenderFns:[]};e.a=n},hEHR:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});o(i("EybN"));var n=o(i("Gl8h"));function o(t){return t&&t.__esModule?t:{default:t}}e.default={components:{},props:{modelSettings:Object},name:"mobile-mini-floor-plan",data:function(){return{miniFloorPlanWidth:"",miniFloorPlanHeight:"",locationgPointIcon:n.default,currentTop:0,currentLeft:0}},computed:{floorPlanImageUrl:function(){return this.$store.state.floorPlanImageUrl},currentAngle:function(){return this.$store.state.currentAngle},currentPosition:function(){return this.$store.state.currentPosition},currentArea:function(){return this.$store.state.currentArea},currentCompass:function(){var t=void 0,e={up:"",down:""};return t=this.modelSettings&&this.modelSettings.basic&&this.modelSettings.basic.menu&&this.modelSettings.basic.menu.orientation_correct?this.modelSettings.basic.menu.orientation_correct:0,(t%=360)>=337.5||t<22.5?(e.up=this.$t("direction_n_text"),e.down=this.$t("direction_s_text")):t>=22.5&&t<67.5?(e.up=this.$t("direction_w_n_text"),e.down=this.$t("direction_e_s_text")):t>=67.5&&t<112.5?(e.up=this.$t("direction_w_text"),e.down=this.$t("direction_e_text")):t>=112.5&&t<157.5?(e.up=this.$t("direction_w_s_text"),e.down=this.$t("direction_e_n_text")):t>=157.5&&t<202.5?(e.up=this.$t("direction_s_text"),e.down=this.$t("direction_n_text")):t>=202.5&&t<247.5?(e.up=this.$t("direction_e_s_text"),e.down=this.$t("direction_w_n_text")):t>=247.5&&t<292.5?(e.up=this.$t("direction_e_text"),e.down=this.$t("direction_w_text")):t>=292.5&&t<337.5&&(e.up=this.$t("direction_e_n_text"),e.down=this.$t("direction_w_s_text")),e}},watch:{floorPlanImageUrl:function(t,e){this.updateFloorPlan(t)}},created:function(){this.updateFloorPlan(this.floorPlanImageUrl)},mounted:function(){},methods:{changeMode:function(t){this.statistic_utils.trackEvent(43),this.$store.dispatch("goMode",t)},updateFloorPlan:function(t){if(!t)return!1;var e=t.split("_"),i=1.4,n=1.4;if(e&&e.length>0){var o=parseInt(e[e.length-2]),r=parseInt(e[e.length-1]);o>r?(n=r/o*1.4,i=1.4):(i=o/r*1.4,n=1.4)}this.miniFloorPlanWidth=i+"rem",this.miniFloorPlanHeight=n+"rem"}}}},hFDk:function(t,e,i){"use strict";t.exports={title:"title",share:{enable:!0,share_link:"share_link",share_context:"share_describe",share_img:"share_pic",share_title:"share_title"},houseInfo:{enable:!0,version:0,list:"menu_info",map:{lon:"address_x",lat:"address_y"},houseDetail:"jump_url"},brokerInfo:{enable:!0,brokerImage:"middleman_img",brokerName:"middleman",brokerPhone:"middleman_tel",PcPhoneTip:""},homeLink:{enable:!1,link:"indexUrl"},panoramaLink:{enable:!1,link:"hangpaiUrl"},commonJsonData:{area_text:"区域",district_text:"",purpose_text:"物业类型",house_type:"",acreage_value:"",orientation_text:"",decoration_type:"装修",floor_text:"",complation_date:"",total_price:"",address_details:"地址",house_status:"",longitude_value:"address_x",latitude_value:"address_y",more_details_address:"",community_name:"",unit_price:"价格",sell_type:"",city_text:"",developer_name:"开发商",elevator_issupport:"",listing_time:"",rent_price:"",hangpaiurl:""}}},hJgp:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("4wcH"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("x/qA");var s=function(t){i("0MTW")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-640d5fda",null);e.default=l.exports},hV0J:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"small-map-container"},[this._m(0),this._v(" "),e("div",{staticClass:"small-baidu-map-footer",on:{click:this.showBigMap}},[e("span",{staticClass:"small-baidu-map-footer-text"},[this._v(this._s(this.$t("lookMapMore")))]),this._v(" "),e("i",{staticClass:"small-baidu-map-footer-icon"})])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"small-mobile-landscape-google-map-box"},[e("div",{staticClass:"small-mobile-landscape-google-map",attrs:{id:"small-mobile-landscape-google-map"}})])}]};e.a=n},hah5:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("hEHR"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("M77R");var s=function(t){i("vWp6")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-2878c68c",null);e.default=l.exports},i6sq:function(t,e){},iA8k:function(t,e){},iOR3:function(t,e){},iROj:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("S57i"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("ZkrG");var s=function(t){i("z+oM")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-61945b7a",null);e.default=l.exports},iitU:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("M1wL"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("ggQo");var s=function(t){i("0pt3")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-6bb3986a",null);e.default=l.exports},"j+vV":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("MmMS"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("br1f");var s=function(t){i("sC8N")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-b1a85f2e",null);e.default=l.exports},j0n3:function(t,e){},j1M8:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"help-tip-component",data:function(){return{}},created:function(){},mounted:function(){},methods:{closeHelpTip:function(){this.statistic_utils.trackEvent(76),this.$store.dispatch("changeHelpTipStatus",!1)}}}},j5L1:function(t,e){},jFy3:function(t,e,i){"use strict";var n=null,o=function(){return null!==n?n:(t=window.navigator.userAgent,/iPad|iPhone|iPod/.test(t)&&window.NativeClient?n="ios":-1!==window.navigator.userAgent.indexOf("Android")&&window.house365js&&(n="android"),n);var t};t.exports.sendVRCard=function(t){var e=!1,i=o();return"ios"===i&&window.NativeClient.sendVRCard?(window.NativeClient.sendVRCard(t),e=!0):"android"===i&&window.house365js.sendVRCard&&(window.house365js.sendVRCard(t),e=!0),e},t.exports.closeWindow=function(){var t=!1,e=o();return this.hangup(),"ios"===e&&window.NativeClient.onClose?(window.NativeClient.onClose(),t=!0):"android"===e&&window.house365js.onClose?(window.house365js.onClose(),t=!0):window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.onClose&&(window.webkit.messageHandlers.onClose.postMessage({}),t=!0),t},t.exports.hideTitleBar=function(){var t=!1,e=o();return"ios"===e&&window.NativeClient.onHideTitleBar?(window.NativeClient.onHideTitleBar(1),t=!0):"android"===e&&window.house365js.onHideTitleBar?(window.house365js.onHideTitleBar(1),t=!0):window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.onHideTitleBar&&(window.webkit.messageHandlers.onHideTitleBar.postMessage({hidden:!0}),t=!0),t},t.exports.share=function(t){var e=!1,i=o();return"ios"===i&&window.NativeClient.share?(window.NativeClient.share(t.share_title,t.share_describe,t.share_link,t.share_pic),e=!0):"android"===i&&window.house365js.onShare&&window.house365js.openShareView?(window.house365js.onShare(t.share_title,t.share_pic,t.share_describe,t.share_link),window.house365js.openShareView(),e=!0):window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.share&&window.webkit.messageHandlers.share.postMessage({title:t.share_title,content:t.share_describe,targetUrl:t.share_link,iconUrl:t.share_pic}),e},t.exports.getUserInfo=function(t){var e=null,i=setTimeout(function(){t()},200),n=o();"ios"==n&&window.NativeClient?window.NativeClient.getUserInfo&&(e=window.NativeClient.getUserInfo(function(n){e=JSON.parse(n),clearTimeout(i),t(e)})):"android"==n&&window.house365js&&window.house365js.getUserInfo&&(clearTimeout(i),e=window.house365js.getUserInfo(),e=JSON.parse(e),t(e))},t.exports.sendData=function(t){var e=!1,i=o();return"ios"===i&&window.NativeClient.sendData?(window.NativeClient.sendData(t),e=!0):"android"===i&&window.house365js.sendData&&(window.house365js.sendData(t),e=!0),e},t.exports.openRedPacket=function(t,e){var i=!1,n=o();return"ios"===n&&window.NativeClient.openRedPacket?(window.NativeClient.openRedPacket(t,e),i=!0):"android"===n&&window.house365js.openRedPacket?(window.house365js.openRedPacket(t,e),i=!0):alert("当前版本不支持该活动，请升级到最新版本!"),i},t.exports.openEsfRedPacket=function(t,e){var i=!1,n=o();return"ios"===n&&window.NativeClient.openEsfRedPacket?(window.NativeClient.openEsfRedPacket(t,e),i=!0):"android"===n&&window.house365js.openEsfRedPacket?(window.house365js.openEsfRedPacket(t,e),i=!0):alert("当前版本不支持该活动，请升级到最新版本!"),i},t.exports.call=function(){var t=!1,e=o();return"ios"===e&&window.NativeClient.call?window.NativeClient.call():"android"===e&&window.house365js.call&&(window.house365js.call(),t=!0),t},t.exports.mute=function(){var t=!1,e=o();return"ios"===e&&window.NativeClient.mute?window.NativeClient.mute():"android"===e&&window.house365js.mute&&(window.house365js.mute(),t=!0),t},t.exports.unmute=function(){var t=!1,e=o();return"ios"===e&&window.NativeClient.unmute?window.NativeClient.unmute():"android"===e&&window.house365js.unmute&&(window.house365js.unmute(),t=!0),t},t.exports.hangup=function(){var t=!1,e=o();return"ios"===e&&window.NativeClient.hangup?window.NativeClient.hangup():"android"===e&&window.house365js.hangup&&(window.house365js.hangup(),t=!0),t},t.exports.refuse=function(){var t=!1,e=o();return"ios"===e&&window.NativeClient.refuse?window.NativeClient.refuse():"android"===e&&window.house365js.refuse&&(window.house365js.refuse(),t=!0),t},t.exports.accept=function(){var t=!1,e=o();return"ios"===e&&window.NativeClient.accept?window.NativeClient.accept():"android"===e&&window.house365js.accept&&(window.house365js.accept(),t=!0),t},t.exports.timeout=function(){var t=!1,e=o();return"ios"===e&&window.NativeClient.timeout?window.NativeClient.timeout():"android"===e&&window.house365js.timeout&&(window.house365js.timeout(),t=!0),t}},jVxu:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.houseInfoData&&t.houseInfoData.brokerInfo&&t.houseInfoData.brokerInfo.enable?i("div",{staticClass:"mini-middle-man-container"},[i("div",{directives:[{name:"longpress",rawName:"v-longpress",value:t.openMiddlemanTranspond,expression:"openMiddlemanTranspond"}],staticClass:"mini-middle-man-bg-container",on:{click:t.showTelDialog}},[i("div",{staticClass:"middle-man-bg",style:{backgroundImage:"url("+(t.brokerImage||t.defaultBg)+")"}}),t._v(" "),i("i",{staticClass:"middle-man-tel"})])]):t._e()},staticRenderFns:[]};e.a=n},jbDv:function(t,e,i){"use strict";t.exports={title:"title",share:{enable:!0,share_link:"share_link",share_context:"share_desc",share_img:"share_img",share_title:"share_title"},offline:{text:"该房源已下架，您可以联系下方经纪人为您推荐其他优质房源！",houseDetail:""},houseInfo:{enable:!0,version:0,list:"menu_info",map:{lon:"address_x",lat:"address_y"},houseDetail:"jump_url"},brokerInfo:{enable:!0,brokerImage:"middleman_img",brokerPhone:"middleman_tel",brokerName:"middleman",PcPhoneTip:""},homeLink:{enable:!1,link:""},panoramaLink:{enable:!1,link:""},commonJsonData:{area_text:"",district_text:"",purpose_text:"",house_type:"房型",acreage_value:"建筑面积",orientation_text:"朝向",decoration_type:"装修",floor_text:"楼层",complation_date:"建筑年代",total_price:"售价",address_details:"",house_status:"",longitude_value:"address_x",latitude_value:"address_y",more_details_address:"jump_url",community_name:"小区",unit_price:"",sell_type:"",city_text:"",developer_name:"",elevator_issupport:"",listing_time:"",rent_price:"",hangpaiurl:""}}},"kB+G":function(t,e){},kNSG:function(t,e){},kjdN:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("mvHQ"),r=(n=o)&&n.__esModule?n:{default:n};var a=i("2Uyi"),s=i("0iLD"),l=i("w1BD"),c=(i("ynQN").getStyle(),i("hU7x"));e.default={load:function(t,e){var i={json:{SN:a.getQueryString("SN")},sign:""};c("https://nantonghms.erp.axfc.cn/vrApi/HouseSource/findHeadPortraitUrl?json="+(0,r.default)(i),{prefix:"callback",name:"callback"},function(i,n){n=JSON.parse(n);var o=null;i||1!==n.code?(o=l.replenishData(null,t),e(o)):(o=l.replenishData(function(t,e){var i={};for(var n in e)switch(n){case"title":i.title=t.title;break;case"houseInfo":i.houseInfo=l.getTotalData(t,e.houseInfo);break;case"brokerInfo":i.brokerInfo=l.getTotalData(t,e.brokerInfo)}return i}(n.data.houseSourceOwner,s),t),e(o))})}}},ktka:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("1CD3"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("+NqR");var s=function(t){i("+GI9")},l=i("VU/8")(o.a,a.a,!1,s,null,null);e.default=l.exports},"l4+t":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"title-component",data:function(){return{disclaimerContent:this.$store.state.disclaimerContent}},computed:{},created:function(){},mounted:function(){},methods:{closeDisclaimer:function(){this.statistic_utils.trackEvent(49),this.$store.dispatch("toggleDisclaimerContent",!1)}}}},l96b:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"img-swiper-container",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeImgSwiper(e)}}},[i("div",{staticClass:"img-swiper-content"},[i("i",{staticClass:"img-swiper-close",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeImgSwiper(e)}}}),t._v(" "),i("swiper",{ref:"swiperTop",staticClass:"gallery-top",attrs:{options:t.swiperOptionTop}},[t._l(t.houseInfoData.communityImages.images,function(t,e){return i("swiper-slide",{key:e,style:{backgroundImage:"url("+t+")"}})}),t._v(" "),i("div",{staticClass:"swiper-button-next swiper-button-white",attrs:{slot:"button-next"},slot:"button-next"}),t._v(" "),i("div",{staticClass:"swiper-button-prev swiper-button-white",attrs:{slot:"button-prev"},slot:"button-prev"})],2),t._v(" "),i("swiper",{ref:"swiperThumbs",staticClass:"gallery-thumbs",attrs:{options:t.swiperOptionThumbs}},t._l(t.houseInfoData.communityImages.images,function(t,e){return i("swiper-slide",{key:e},[i("div",{staticClass:"swiper-slide-content",style:{backgroundImage:"url("+t+")"}})])}),1)],1)])},staticRenderFns:[]};e.a=n},lAej:function(t,e){},lIcg:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={components:{},props:{},name:"mobile-panorama-btn",data:function(){return{}},computed:{currentMode:function(){return this.$store.state.currentMode}},created:function(){},mounted:function(){},methods:{changeMode:function(t){t!==this.currentMode&&"transitioning"!==this.currentMode&&(this.statistic_utils.trackEvent(2),this.$store.dispatch("goMode",t))}}}},lTH1:function(t,e){t.exports={OSS:"https://bucket-model.oss-cn-beijing.aliyuncs.com",CDN:"https://modelcdn2.3dnest.cn",ICDN:"https://infocdn2.3dnest.cn",TCDN:"https://template2.3dnest.cn",EDIT:"/manager_house/model/rtiframedata/"}},locS:function(t,e){},lvKI:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=0,o=8;function r(t){return f(a(p(t),t.length*o))}function a(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var i=1732584193,n=-271733879,o=-1732584194,r=271733878,a=0;a<t.length;a+=16){var s=i,p=n,f=o,m=r;n=h(n=h(n=h(n=h(n=u(n=u(n=u(n=u(n=c(n=c(n=c(n=c(n=l(n=l(n=l(n=l(n,o=l(o,r=l(r,i=l(i,n,o,r,t[a+0],7,-680876936),n,o,t[a+1],12,-389564586),i,n,t[a+2],17,606105819),r,i,t[a+3],22,-1044525330),o=l(o,r=l(r,i=l(i,n,o,r,t[a+4],7,-176418897),n,o,t[a+5],12,1200080426),i,n,t[a+6],17,-1473231341),r,i,t[a+7],22,-45705983),o=l(o,r=l(r,i=l(i,n,o,r,t[a+8],7,1770035416),n,o,t[a+9],12,-1958414417),i,n,t[a+10],17,-42063),r,i,t[a+11],22,-1990404162),o=l(o,r=l(r,i=l(i,n,o,r,t[a+12],7,1804603682),n,o,t[a+13],12,-40341101),i,n,t[a+14],17,-1502002290),r,i,t[a+15],22,1236535329),o=c(o,r=c(r,i=c(i,n,o,r,t[a+1],5,-165796510),n,o,t[a+6],9,-1069501632),i,n,t[a+11],14,643717713),r,i,t[a+0],20,-373897302),o=c(o,r=c(r,i=c(i,n,o,r,t[a+5],5,-701558691),n,o,t[a+10],9,38016083),i,n,t[a+15],14,-660478335),r,i,t[a+4],20,-405537848),o=c(o,r=c(r,i=c(i,n,o,r,t[a+9],5,568446438),n,o,t[a+14],9,-1019803690),i,n,t[a+3],14,-187363961),r,i,t[a+8],20,1163531501),o=c(o,r=c(r,i=c(i,n,o,r,t[a+13],5,-1444681467),n,o,t[a+2],9,-51403784),i,n,t[a+7],14,1735328473),r,i,t[a+12],20,-1926607734),o=u(o,r=u(r,i=u(i,n,o,r,t[a+5],4,-378558),n,o,t[a+8],11,-2022574463),i,n,t[a+11],16,1839030562),r,i,t[a+14],23,-35309556),o=u(o,r=u(r,i=u(i,n,o,r,t[a+1],4,-1530992060),n,o,t[a+4],11,1272893353),i,n,t[a+7],16,-155497632),r,i,t[a+10],23,-1094730640),o=u(o,r=u(r,i=u(i,n,o,r,t[a+13],4,681279174),n,o,t[a+0],11,-358537222),i,n,t[a+3],16,-722521979),r,i,t[a+6],23,76029189),o=u(o,r=u(r,i=u(i,n,o,r,t[a+9],4,-640364487),n,o,t[a+12],11,-421815835),i,n,t[a+15],16,530742520),r,i,t[a+2],23,-995338651),o=h(o,r=h(r,i=h(i,n,o,r,t[a+0],6,-198630844),n,o,t[a+7],10,1126891415),i,n,t[a+14],15,-1416354905),r,i,t[a+5],21,-57434055),o=h(o,r=h(r,i=h(i,n,o,r,t[a+12],6,1700485571),n,o,t[a+3],10,-1894986606),i,n,t[a+10],15,-1051523),r,i,t[a+1],21,-2054922799),o=h(o,r=h(r,i=h(i,n,o,r,t[a+8],6,1873313359),n,o,t[a+15],10,-30611744),i,n,t[a+6],15,-1560198380),r,i,t[a+13],21,1309151649),o=h(o,r=h(r,i=h(i,n,o,r,t[a+4],6,-145523070),n,o,t[a+11],10,-1120210379),i,n,t[a+2],15,718787259),r,i,t[a+9],21,-343485551),i=d(i,s),n=d(n,p),o=d(o,f),r=d(r,m)}return Array(i,n,o,r)}function s(t,e,i,n,o,r){return d((a=d(d(e,t),d(n,r)))<<(s=o)|a>>>32-s,i);var a,s}function l(t,e,i,n,o,r,a){return s(e&i|~e&n,t,e,o,r,a)}function c(t,e,i,n,o,r,a){return s(e&n|i&~n,t,e,o,r,a)}function u(t,e,i,n,o,r,a){return s(e^i^n,t,e,o,r,a)}function h(t,e,i,n,o,r,a){return s(i^(e|~n),t,e,o,r,a)}function d(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function p(t){for(var e=Array(),i=(1<<o)-1,n=0;n<t.length*o;n+=o)e[n>>5]|=(t.charCodeAt(n/o)&i)<<n%32;return e}function f(t){for(var e=n?"0123456789ABCDEF":"0123456789abcdef",i="",o=0;o<4*t.length;o++)i+=e.charAt(t[o>>2]>>o%4*8+4&15)+e.charAt(t[o>>2]>>o%4*8&15);return i}e.default={hex_md5:r}},"m/7e":function(t,e){},"m/RU":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("8+mH"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("Co/y");var s=function(t){i("/Hj1")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-dedb4b9c",null);e.default=l.exports},m4ZJ:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("n0NB"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("OMII");var s=function(t){i("+zAU")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-60112464",null);e.default=l.exports},mA03:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},components:{},name:"small-google-map",data:function(){return{map:{width:"100%",height:"100%"},mapData:{zoom:15},isDrag:!1,center:{lat:10,lng:10},markers:[{position:{lat:10,lng:10}},{position:{lat:11,lng:11}}]}},computed:{houseInfoData:function(){return this.$store.state.houseInfo},getGoogleMapLoadStatus:function(){return this.$store.state.googleMapLoadStatus}},created:function(){},mounted:function(){google&&this.mapInit()},watch:{getGoogleMapLoadStatus:function(t,e){t&&this.mapInit()}},methods:{mapInit:function(){var t={zoom:15,center:{lat:Number(this.houseInfoData.houseInfo.map.lat),lng:Number(this.houseInfoData.houseInfo.map.lon)},mapTypeId:"roadmap"},e=new google.maps.Map(document.getElementById("small-google-map"),t);new google.maps.Marker({position:t.center,map:e,animation:google.maps.Animation.BOUNCE})},showBigMap:function(t){this.statistic_utils.trackEvent(8),this.$store.dispatch("toggleHouseInfoPanel",!1),this.$store.dispatch("toggleBigMapStatus",!0)},syncCenterAndZoom:function(t){},lookDetail:function(t,e){var i=this;if(this.infoWindow.show=!0,this.infoWindow.info=t,this.activeName=t.name,this.$nextTick(function(){document.querySelector(".BMap_bubble_title").title=i.activeName}),"left"==e)return this.map.center={lng:t.lng,lat:t.lat},void(this.map.zoom=15);this.$nextTick(function(){var t=document.querySelector(".active").offsetTop;i.$refs.box.scrollTop=t-180})},cleanEvent:function(){var t=this;setTimeout(function(){t.$store.dispatch("changeIsDragingMap",!1),null},100)},goDrag:function(){this.$store.dispatch("changeIsDragingMap",!0)}}}},mWYR:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setup=void 0;var n=s(i("fZjL")),o=s(i("7+uW")),r=s(i("TXmL")),a=s(i("2Uyi"));function s(t){return t&&t.__esModule?t:{default:t}}o.default.use(r.default);var l={zh:i("MvI0"),en:i("UpdR"),ja:i("1ccB")},c=new r.default({locale:"en",messages:l});(e.setup=function(){var t=a.default.getQueryString("lang"),e=void 0;e=t?"1"===t?"en":"2"===t?"ja":"3"===t?"zh":"en":function(){var t,e=null;switch(t=window.navigator.userLanguage?window.navigator.userLanguage.substring(0,2).toLowerCase():window.navigator.language.substring(0,2).toLowerCase()){case"zh":case"en":case"ja":default:e=t}return e}(),(0,n.default)(l).forEach(function(t){document.body.classList.remove("lang-"+t)}),document.body.classList.add("lang-"+e),document.body.setAttribute("lang",e),o.default.config.lang=e,c.locale=e})(),window.i18n=c,e.default=c},mYB8:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("9X3O");e.default={components:{},props:{},name:"loading-component",data:function(){return{defaultLoadingUrl:n}},computed:{companyId:function(){return this.$store.state.companyId},companyLogoUrl:function(){return this.$store.state.companyLogoUrl},companyLoadingUrl:function(){return this.$store.state.companyLoadingUrl},loadingBgUrl:function(){return this.$store.state.loadingBgUrl},loadingProgress:function(){return this.$store.state.loadingProgress},companySettingsIsLoaded:function(){return this.$store.state.companySettingsIsLoaded}},created:function(){},mounted:function(){},methods:{}}},n0NB:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},components:{},name:"big-google-map",data:function(){return{}},computed:{houseInfoData:function(){return this.$store.state.houseInfo},isDragingMap:function(){return this.$store.state.isDragingMap},getGoogleMapLoadStatus:function(){return this.$store.state.googleMapLoadStatus}},created:function(){},mounted:function(){google&&this.mapInit()},watch:{getGoogleMapLoadStatus:function(t,e){t&&this.mapInit()}},methods:{mapInit:function(){var t={zoom:15,center:{lat:Number(this.houseInfoData.houseInfo.map.lat),lng:Number(this.houseInfoData.houseInfo.map.lon)},mapTypeId:"roadmap"},e=new google.maps.Map(document.getElementById("big-google-map"),t);new google.maps.Marker({position:t.center,map:e,animation:google.maps.Animation.BOUNCE})},closeBigMapContent:function(){this.isDragingMap||(this.statistic_utils.trackEvent(77),this.$store.dispatch("toggleBigMapStatus",!1))},cleanEvent:function(){var t=this;setTimeout(function(){t.$store.dispatch("changeIsDragingMap",!1),null},100)},goDrag:function(){this.$store.dispatch("changeIsDragingMap",!0)}}}},n32a:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("bPd3"),r=(n=o)&&n.__esModule?n:{default:n};e.default={components:{ShareComponent:r.default},props:{},name:"mobile-top-component",data:function(){return{}},computed:{houseInfoIsShow:function(){return this.$store.state.houseInfoIsShow},houseInfoData:function(){return this.$store.state.houseInfo},shareComponentIsShow:function(){return this.$store.state.shareComponentIsShow}},created:function(){},mounted:function(){},methods:{toggleHouseInfoPanel:function(){this.statistic_utils.trackEvent(25),(this.houseInfoData.houseInfo&&this.houseInfoData.houseInfo.enable||this.houseInfoData.houseInfo&&this.houseInfoData.houseInfo.map)&&this.$store.dispatch("toggleHouseInfoPanel",!this.$store.state.houseInfoIsShow)},toggleShareComponent:function(){this.$store.dispatch("changeShareComponentStatus",!this.$store.state.shareComponentIsShow)}}}},nBmZ:function(t,e){},"nK/Z":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("tElg"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("pwG3");var s=function(t){i("KI3t")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-c76c58de",null);e.default=l.exports},nUgN:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"small-map-container"},[this._m(0),this._v(" "),e("div",{staticClass:"small-baidu-map-footer",on:{click:this.showBigMap}},[e("span",{staticClass:"small-baidu-map-footer-text"},[this._v(this._s(this.$t("lookMapMore")))]),this._v(" "),e("i",{staticClass:"small-baidu-map-footer-icon"})])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"small-mobile-google-map-box"},[e("div",{staticClass:"small-mobile-google-map",attrs:{id:"small-mobile-google-map"}})])}]};e.a=n},nWSc:function(t,e){},nY2A:function(t,e){},ncoA:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("CnUl"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("nUgN");var s=function(t){i("WUBG")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-5a4f65e2",null);e.default=l.exports},nh8I:function(t,e,i){"use strict";t.exports={title:"title",houseInfo:{enable:!0,version:0,list:"menuInfo",map:{lon:"addressX",lat:"addressY"},houseDetail:"jumpUrl"},brokerInfo:{enable:!0,brokerImage:"middlemanImg",brokerPhone:"middlemanTel",brokerName:"middleman",PcPhoneTip:""},commonJsonData:{area_text:"",district_text:"",purpose_text:"",house_type:"户型",acreage_value:"建筑面积",orientation_text:"朝向",decoration_type:"装修",floor_text:"楼层",complation_date:"建筑年代",total_price:"售价",address_details:"",house_status:"",longitude_value:"address_x",latitude_value:"address_y",more_details_address:"jump_url",community_name:"小区",unit_price:"",sell_type:"",city_text:"",developer_name:"",elevator_issupport:"",listing_time:"",rent_price:"",hangpaiurl:""}}},o86U:function(t,e){},oBCU:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement;return(this._self._c||t)("remote-js",{attrs:{src:this.jsUrl},on:{"load-js-finish":this.jsLoadCallBack}})},staticRenderFns:[]};e.a=n},oCf1:function(t,e){},oV97:function(t,e){},oXFx:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("3pLw"),r=(n=o)&&n.__esModule?n:{default:n};var a=i("2Uyi"),s=i("TPyT"),l=i("w1BD"),c=function(t,e){var i={};for(var n in e)switch(n){case"title":var o=t.jzmj||t.mj||"--";i.title=t.biaoti+o;break;case"share":i.share=l.getLinkData(t,e.share);break;case"houseInfo":i.houseInfo=l.generateHouseInfo(t,e.houseInfo);break;case"brokerInfo":i.brokerInfo=l.getbrokerInfo(t,e.brokerInfo);break;case"homeLink":i.homeLink=l.getLinkData(t,e.homeLink);break;case"panoramaLink":i.panoramaLink=l.getLinkData(t,e.panoramaLink);break;case"commonJsonData":i.commonJsonData=l.getHouseInfoJsonData(t,e.commonJsonData)}return i};e.default={load:function(t,e){var i=a.getQueryString("house_type"),n=i+"_"+a.getQueryString("hid"),o=a.getQueryString("city"),u={hid:n,city_id:o,command:"House",action:"GetVROne"};if(!n||!o){var h=l.replenishData(null,t);return h.title="917·VR看房|"+h.title,e(h,t),!1}r.default.get({url:"https://api.917.com/index.php",data:u}).then(function(n){if(200===n.status&&n.data.feedback.msg301&&n.data.feedback.msg301.houseData){var o=n.data.feedback.msg301.houseData,r=a.isMobile()?o.MobileDetailUrl:o.PCDetailUrl,u=null;if("sell"===i?(o.houseInfo_HouseType="sell",(u=c(o,s)).houseInfo.houseDetail=r):"loupan"===i?(o.houseInfo_HouseType="loupan",(u=c(o,s)).houseInfo.houseDetail=r):"chuzu"===i?(o.houseInfo_HouseType="chuzu",(u=c(o,s)).houseInfo.houseDetail=r):(u=function(t,e){var i={};for(var n in e)switch(n){case"title":var o=t.jzmj||t.mj||"--";i.title=t.biaoti+o;break;case"share":i.share=l.getLinkData(t,e.share);break;case"offline":i.offline=e.offline;break;case"brokerInfo":i.brokerInfo=l.getbrokerInfo(t.EmpInfo,e.brokerInfo);break;case"commonJsonData":i.commonJsonData=l.getHouseInfoJsonData(t,e.commonJsonData)}return i}(o,s)).offline.houseDetail=r,u.share.share_link=window.location.href,(u=l.replenishData(u,t)).title="917·VR看房|"+u.title,"1"===a.getQueryString("issupporthomelink")){var h=a.isMobile()?o.MobileIndexUrl:o.PCIndexUrl;u.homeLink={enable:!0,link:h}}u.commonJsonData,"--"===o.mobile&&(u.slideVerify={enable:!0,uid:o.uid}),e(u)}else(u=l.replenishData(null,t)).title="917·VR看房|"+u.title,e(u,t)})}}},"p/md":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"scene-panel-container",class:{active:t.sceneIsActive}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.sceneIsActive,expression:"!sceneIsActive"}],staticClass:"scene-panel-bt",class:{active:t.sceneIsActive},on:{click:t.showScenePanelList}},[i("i",{staticClass:"bt-icon"}),t._v(" "),i("span",{staticClass:"bt-text"},[t._v(t._s(t.$t("sceneText")))])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.sceneIsActive,expression:"sceneIsActive"}],staticClass:"scene-list-container"},[i("div",{staticClass:"scene-pause-btn",on:{click:t.closeScenePanelList}},[i("i",{staticClass:"scene-pause-btn-icon"})]),t._v(" "),t.sceneList&&t.sceneList.length<=4?i("div",{ref:"sceneList",staticClass:"scene-list",on:{click:t.selectSceneItem}},t._l(t.sceneList,function(e,n){return i("div",{key:n,ref:"sceneItem"+e.index,refInFor:!0,staticClass:"scene-item",class:{active:t.currentSceneIndex===e.index},attrs:{"data-index":e.index}},[t._v("\n        "+t._s(e.name)+"\n        ")])}),0):t.sceneList&&t.sceneList.length>4?i("div",{ref:"sceneList",staticClass:"scene-list"},[i("swiper",{attrs:{options:t.swiperOption}},[i("div",{staticClass:"swiper-scrollbar",attrs:{slot:"scrollbar"},slot:"scrollbar"}),t._v(" "),t._l(t.sceneList,function(e,n){return i("swiper-slide",{key:n},[i("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"}),t._v(" "),i("div",{staticClass:"swiper-button-prev",attrs:{slot:"button-prev"},slot:"button-prev"}),t._v(" "),i("div",{staticClass:"swiper-button-next",attrs:{slot:"button-next"},slot:"button-next"}),t._v(" "),i("div",{ref:"sceneItem"+n,refInFor:!0,staticClass:"scene-item",class:{active:t.currentSceneIndex===e.index},attrs:{"data-index":n},on:{click:function(i){return t.selectSceneItem1(e.index)}}},[i("div",{staticClass:"scene-item-text2"},[t._v(t._s(e.name))])])])})],2)],1):t._e()])])},staticRenderFns:[]};e.a=n},pE7W:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("wJaE"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("cLSN");var s=function(t){i("3llQ")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-1ae2ec38",null);e.default=l.exports},pGBC:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("S1Oq"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("Hb4q");var s=function(t){i("eHk0")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-f97bb65c",null);e.default=l.exports},pTo5:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("bTSe"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("QHh5");var s=function(t){i("K+T/")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-f9d0962c",null);e.default=l.exports},pYtu:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("Gl8h"),r=(n=o)&&n.__esModule?n:{default:n};e.default={components:{},props:{modelSettings:Object},name:"mobile-floor-plan",data:function(){return{locationgPointIcon:r.default}},computed:{currentFloorPlanData:function(){return this.$store.state.currentFloorPlanData},currentRoomList:function(){return this.$store.state.currentRoomList},whData:function(){return this.$store.state.currrentFloorPlanWidthHeightData},entranceData:function(){return this.$store.state.entranceData},radarData:function(){return this.$store.state.radarData},currentCompass:function(){var t=void 0,e={up:"",down:""};return t=this.modelSettings.basic.menu&&this.modelSettings.basic.menu.orientation_correct?this.modelSettings.basic.menu.orientation_correct:0,(t%=360)>=337.5||t<22.5?(e.up=this.$t("direction_n_text"),e.down=this.$t("direction_s_text")):t>=22.5&&t<67.5?(e.up=this.$t("direction_w_n_text"),e.down=this.$t("direction_e_s_text")):t>=67.5&&t<112.5?(e.up=this.$t("direction_w_text"),e.down=this.$t("direction_e_text")):t>=112.5&&t<157.5?(e.up=this.$t("direction_w_s_text"),e.down=this.$t("direction_e_n_text")):t>=157.5&&t<202.5?(e.up=this.$t("direction_s_text"),e.down=this.$t("direction_n_text")):t>=202.5&&t<247.5?(e.up=this.$t("direction_e_s_text"),e.down=this.$t("direction_w_n_text")):t>=247.5&&t<292.5?(e.up=this.$t("direction_e_text"),e.down=this.$t("direction_w_text")):t>=292.5&&t<337.5&&(e.up=this.$t("direction_e_n_text"),e.down=this.$t("direction_w_s_text")),e}},created:function(){},mounted:function(){},methods:{}}},pdV6:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"scene-panel-container",class:{active:t.sceneIsActive}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.sceneIsActive,expression:"!sceneIsActive"}],staticClass:"scene-panel-bt",class:{active:t.sceneIsActive},on:{click:t.showScenePanelList}},[i("i",{staticClass:"bt-icon"}),t._v(" "),i("span",{staticClass:"bt-text"},[t._v(t._s(t.$t("sceneText")))])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.sceneIsActive,expression:"sceneIsActive"}],staticClass:"scene-list-container"},[i("div",{staticClass:"scene-pause-btn",on:{click:t.closeScenePanelList}},[i("i",{staticClass:"scene-pause-btn-icon"})]),t._v(" "),t.sceneList&&t.sceneList.length<=4?i("div",{ref:"sceneList",staticClass:"scene-list"},t._l(t.sceneList,function(e,n){return i("div",{key:n,ref:"sceneItem"+e.index,refInFor:!0,staticClass:"scene-item",class:{active:t.currentSceneIndex===e.index},attrs:{"data-index":e.index},on:{click:t.selectSceneItem}},[t._v("\n        "+t._s(e.name)+"\n        ")])}),0):t.sceneList&&t.sceneList.length>4?i("div",{ref:"sceneList",staticClass:"scene-list"},[i("swiper",{attrs:{options:t.swiperOption}},[i("div",{staticClass:"swiper-scrollbar",attrs:{slot:"scrollbar"},slot:"scrollbar"}),t._v(" "),t._l(t.sceneList,function(e,n){return i("swiper-slide",{key:n},[i("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"}),t._v(" "),i("div",{staticClass:"swiper-button-prev",attrs:{slot:"button-prev"},slot:"button-prev"}),t._v(" "),i("div",{staticClass:"swiper-button-next",attrs:{slot:"button-next"},slot:"button-next"}),t._v(" "),i("div",{ref:"sceneItem"+n,refInFor:!0,staticClass:"scene-item",class:{active:t.currentSceneIndex===e.index},attrs:{"data-index":n},on:{click:function(i){return t.selectSceneItem1(e.index)}}},[i("div",{staticClass:"scene-item-text2"},[t._v(t._s(e.name))])])])})],2)],1):t._e()])])},staticRenderFns:[]};e.a=n},pwG3:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"house-img-container"},[t.houseInfoData.communityImages&&t.houseInfoData.communityImages.enable&&t.houseInfoData.communityImages.images&&t.houseInfoData.communityImages.images.length>0&&t.houseInfoData.panoramaLink&&t.houseInfoData.panoramaLink.enable&&t.houseInfoData.panoramaLink.link?i("div",{staticClass:"house-img-box style2"},[i("div",{staticClass:"house-img-item",style:{backgroundImage:"url("+t.houseInfoData.communityImages.images[0]+")"},on:{click:t.toggleHouseInfoImgSwiper}},[i("div",{staticClass:"house-img-status isCommunity"},[i("i",{staticClass:"community-icon"}),t._v(" "),i("span",{staticClass:"community-text"},[t._v(t._s(t.houseInfoData.communityImages.images.length))])])]),t._v(" "),i("div",{staticClass:"house-img-item  isAerial"},[i("div",{staticClass:"house-img-status isAerial",on:{click:t.goHangPai}},[i("span",{staticClass:"aerial-text"},[t._v(t._s(t.$t("goAerialUrl")))]),t._v(" "),i("i",{staticClass:"aerial-icon"})])])]):t.houseInfoData&&t.houseInfoData.communityImages&&t.houseInfoData.communityImages.enable&&t.houseInfoData.communityImages.images&&t.houseInfoData.communityImages.images.length>0||t.houseInfoData&&t.houseInfoData.panoramaLink&&t.houseInfoData.panoramaLink.enable&&t.houseInfoData.panoramaLink.link?i("div",{staticClass:"house-img-box style1"},[t.houseInfoData&&t.houseInfoData.communityImages&&t.houseInfoData.communityImages.enable&&t.houseInfoData.communityImages.images&&t.houseInfoData.communityImages.images.length>0?i("div",{staticClass:"house-img-item",style:{backgroundImage:"url("+t.houseInfoData.communityImages.images[0]+")"},on:{click:t.toggleHouseInfoImgSwiper}},[t._m(0)]):t.houseInfoData&&t.houseInfoData.panoramaLink&&t.houseInfoData.panoramaLink.enable&&t.houseInfoData.panoramaLink.link?i("div",{staticClass:"house-img-item isAerial"},[i("div",{staticClass:"house-img-status isAerial",on:{click:t.goHangPai}},[i("span",{staticClass:"aerial-text"},[t._v(t._s(t.$t("goAerialUrl")))]),t._v(" "),i("i",{staticClass:"aerial-icon"})])]):t._e()]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"house-img-status isCommunity"},[e("i",{staticClass:"community-icon"}),this._v(" "),e("span",{staticClass:"community-text"})])}]};e.a=n},qLlL:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"pano-size-container"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.panoSizeLeftIsShow&&t.panoSizeLeftData,expression:"panoSizeLeftIsShow&&panoSizeLeftData"}],staticClass:"pano-size-line",class:{reverse:t.panoSizeLeftIsShow&&t.panoSizeLeftData},style:{display:t.panoSizeLeftIsShow&&t.panoSizeLeftData?"block":"none",top:t.panoSizeLeftData.point.y+"px",left:t.panoSizeLeftData.point.x+"px",width:t.panoSizeLeftData.dis+"px",transform:"rotate("+t.panoSizeLeftData.angle+"deg)"}},[i("em"),t._v(" "),i("div",{staticClass:"pano-size-label"},[i("div",{staticClass:"pano-size-label-point"}),t._v(" "),i("div",{staticClass:"pano-size-label-name left"},[t._v(t._s(t.$t("approximate_text")+t.panoSizeLeftData.length.toFixed(2)+t.$t("unit_text")))])])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.panoSizeRightIsShow&&t.panoSizeRightData,expression:"panoSizeRightIsShow&&panoSizeRightData"}],staticClass:"pano-size-line",style:{display:t.panoSizeRightIsShow&&t.panoSizeRightData?"block":"none",top:t.panoSizeRightData.point.y+"px",left:t.panoSizeRightData.point.x+"px",width:t.panoSizeRightData.dis+"px",transform:"rotate("+t.panoSizeRightData.angle+"deg)"}},[i("em"),t._v(" "),i("div",{staticClass:"pano-size-label"},[i("div",{staticClass:"pano-size-label-point"}),t._v(" "),i("div",{staticClass:"pano-size-label-name right"},[t._v(t._s(t.$t("approximate_text")+t.panoSizeRightData.length.toFixed(2)+t.$t("unit_text")))])])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.panoSizeHeightIsShow&&t.panoSizeHeightData,expression:"panoSizeHeightIsShow&&panoSizeHeightData"}],staticClass:"pano-size-line ",class:{around:t.panoSizeHeightIsShow&&t.panoSizeHeightData},style:{display:t.panoSizeHeightIsShow&&t.panoSizeHeightData?"block":"none",top:t.panoSizeHeightData.point.y+"px",left:t.panoSizeHeightData.point.x+"px",width:t.panoSizeHeightData.dis+"px",transform:"rotate("+t.panoSizeHeightData.angle+"deg)"}},[i("em"),t._v(" "),i("div",{staticClass:"pano-size-label"},[i("div",{staticClass:"pano-size-label-point"}),t._v(" "),i("div",{staticClass:"pano-size-label-name height"},[t._v(t._s(t.$t("approximate_text")+t.panoSizeHeightData.length.toFixed(2)+t.$t("unit_text")))])])])])},staticRenderFns:[]};e.a=n},qOd3:function(t,e){},"qc+0":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"house-component-mask",on:{click:function(e){return e.target!==e.currentTarget?null:t.closePanel(e)},touchmove:function(t){if(t.target!==t.currentTarget)return null;t.preventDefault()},scroll:function(t){if(t.target!==t.currentTarget)return null;t.preventDefault()},mousewheel:function(t){if(t.target!==t.currentTarget)return null;t.preventDefault()}}},[i("transition",{attrs:{name:"page-turnning"}},[t.isOpen?i("div",{staticClass:"house-component-container"},[i("div",{staticClass:"house-component-content"},[i("div",{staticClass:"house-component-arrow"}),t._v(" "),t.houseInfoData.houseInfo&&t.houseInfoData.houseInfo.enable?i("house-info"):t._e(),t._v(" "),t.houseInfoData.houseInfo&&t.houseInfoData.houseInfo.map&&t.houseInfoData.houseInfo.map.lat&&t.houseInfoData.houseInfo.map.lon&&1!==t.houseInfoData.houseInfo.map_type?i("small-baidu-map"):t.houseInfoData.houseInfo&&t.houseInfoData.houseInfo.map&&t.houseInfoData.houseInfo.map.lat&&t.houseInfoData.houseInfo.map.lon&&1===t.houseInfoData.houseInfo.map_type?i("small-google-map"):t._e(),t._v(" "),t.houseInfoData.communityImages&&t.houseInfoData.communityImages.enable&&t.houseInfoData.communityImages.images&&t.houseInfoData.communityImages.images.length>0||t.houseInfoData.panoramaLink&&t.houseInfoData.panoramaLink.enable&&t.houseInfoData.panoramaLink.link?i("house-img-container"):t._e()],1)]):t._e()])],1)},staticRenderFns:[]};e.a=n},qcWP:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});o(i("EybN"));var n=o(i("Gl8h"));function o(t){return t&&t.__esModule?t:{default:t}}e.default={components:{},props:{modelSettings:Object},name:"mobile-mini-floor-plan",data:function(){return{miniFloorPlanWidth:"",miniFloorPlanHeight:"",locationgPointIcon:n.default,currentTop:0,currentLeft:0}},computed:{floorPlanImageUrl:function(){return this.$store.state.floorPlanImageUrl},currentAngle:function(){return this.$store.state.currentAngle},currentPosition:function(){return this.$store.state.currentPosition},currentArea:function(){return this.$store.state.currentArea},currentCompass:function(){var t=void 0,e={up:"",down:""};return t=this.modelSettings&&this.modelSettings.basic&&this.modelSettings.basic.menu&&this.modelSettings.basic.menu.orientation_correct?this.modelSettings.basic.menu.orientation_correct:0,(t%=360)>=337.5||t<22.5?(e.up=this.$t("direction_n_text"),e.down=this.$t("direction_s_text")):t>=22.5&&t<67.5?(e.up=this.$t("direction_w_n_text"),e.down=this.$t("direction_e_s_text")):t>=67.5&&t<112.5?(e.up=this.$t("direction_w_text"),e.down=this.$t("direction_e_text")):t>=112.5&&t<157.5?(e.up=this.$t("direction_w_s_text"),e.down=this.$t("direction_e_n_text")):t>=157.5&&t<202.5?(e.up=this.$t("direction_s_text"),e.down=this.$t("direction_n_text")):t>=202.5&&t<247.5?(e.up=this.$t("direction_e_s_text"),e.down=this.$t("direction_w_n_text")):t>=247.5&&t<292.5?(e.up=this.$t("direction_e_text"),e.down=this.$t("direction_w_text")):t>=292.5&&t<337.5&&(e.up=this.$t("direction_e_n_text"),e.down=this.$t("direction_w_s_text")),e}},watch:{floorPlanImageUrl:function(t,e){this.updateFloorPlan(t)}},created:function(){this.updateFloorPlan(this.floorPlanImageUrl)},mounted:function(){},methods:{changeMode:function(t){this.statistic_utils.trackEvent(43),this.$store.dispatch("goMode",t)},updateFloorPlan:function(t){if(!t)return!1;var e=t.split("_"),i=9,n=9;if(e&&e.length>0){var o=parseInt(e[e.length-2]),r=parseInt(e[e.length-1]);o>r?(n=r/o*9,i=9):(i=o/r*9,n=9)}this.miniFloorPlanWidth=i+"rem",this.miniFloorPlanHeight=n+"rem"}}}},qcs8:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"switch-container",class:{sceneorlecture:t.sceneList||t.lectureList}},[i("mode-button",{staticClass:"mode-btn-container",attrs:{currentButtonMode:t.baseConst.floorplan},on:{changeMode:t.changeMode}},[i("div",{staticClass:"mode-btn-content",class:{active:"floorplan"===t.currentMode},attrs:{slot:"mode-btn-slot"},slot:"mode-btn-slot"},[i("i",{staticClass:"floorplan-icon mode-btn-icon full-bg"}),t._v(" "),i("span",{staticClass:"flooplan-text mode-btn-text"},[t._v(t._s(t.$t("floorplanText")))])])]),t._v(" "),i("mode-button",{staticClass:"mode-btn-container",attrs:{currentButtonMode:t.baseConst.dollhouse},on:{changeMode:t.changeMode}},[i("div",{staticClass:"mode-btn-content",class:{active:"dollhouse"===t.currentMode},attrs:{slot:"mode-btn-slot"},slot:"mode-btn-slot"},[i("i",{staticClass:"dollhouse-icon  mode-btn-icon full-bg"}),t._v(" "),i("span",{staticClass:"dollhouse-text  mode-btn-text"},[t._v(t._s(t.$t("dollhouseText")))])])])],1)},staticRenderFns:[]};e.a=n},"r/pd":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("pYtu"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("z+Ey");var s=function(t){i("kB+G")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-4dc77875",null);e.default=l.exports},r1dK:function(t,e){},r6fd:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"small-map-container"},[e("div",{staticClass:"small-google-map",attrs:{id:"small-google-map"}}),this._v(" "),e("div",{staticClass:"small-google-map-footer",on:{click:this.showBigMap}},[e("span",{staticClass:"small-google-map-footer-text"},[this._v(this._s(this.$t("lookMapMore")))]),this._v(" "),e("i",{staticClass:"small-google-map-footer-icon"})])])},staticRenderFns:[]};e.a=n},rC5B:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"big-map-container",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeBigMapContent(e)},touchmove:function(t){t.preventDefault()},scroll:function(t){t.preventDefault()},mousewheel:function(t){t.preventDefault()}}},[i("div",{staticClass:"big-map-content"},[i("baidu-map",{staticClass:"map",style:{width:t.map.width,height:t.map.height},attrs:{ak:"UYtXGSLnxZGtjQ0rj58LWvTFivB4aHIF",zoom:15,center:{lng:t.houseInfoData.houseInfo.map.lon,lat:t.houseInfoData.houseInfo.map.lat},"scroll-wheel-zoom":!0}},[i("bm-marker",{attrs:{position:{lng:t.houseInfoData.houseInfo.map.lon,lat:t.houseInfoData.houseInfo.map.lat},animation:"BMAP_ANIMATION_BOUNCE"}})],1)],1),t._v(" "),i("div",{staticClass:"big-map-close",on:{click:t.closeBigMapContent}})])},staticRenderFns:[]};e.a=n},rM3Y:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("f5WC"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("ClAq");var s=function(t){i("BfPX")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-13521d56",null);e.default=l.exports},rOXf:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"loading-component-container",style:{backgroundImage:"url("+t.loadingBgUrl+")"}},[i("img",{staticClass:"loading-logo",style:{visibility:t.companySettingsIsLoaded&&49!==t.companyId?"visible":"hidden"},attrs:{src:t.companyLogoUrl,alt:""}}),t._v(" "),t.companySettingsIsLoaded?i("img",{staticClass:"loading-img",class:{lizihang:49===t.companyId},attrs:{src:t.companyLoadingUrl||t.defaultLoadingUrl,alt:""}}):t._e(),t._v(" "),t.companySettingsIsLoaded?i("div",{staticClass:"loading-wifi-tip-container",class:{lizihang:49===t.companyId}},[i("i",{staticClass:"loading-wifi-tip-icon"}),t._v(" "),i("span",{staticClass:"loading-wifi-tip-text"},[t._v("\n            "+t._s(t.$t("wifiTipText"))+"\n        ")])]):t._e(),t._v(" "),t.companySettingsIsLoaded?i("div",{staticClass:"loading-progress-container"},[i("div",{staticClass:"loading-progress",style:{width:t.loadingProgress+"%"}}),t._v(" "),i("span",{staticClass:"loading-progress-number",style:{left:"50%"}},[t._v("\n            "+t._s(t.loadingProgress+"%")+"\n        ")])]):t._e()])},staticRenderFns:[]};e.a=n},rPfl:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("3pLw"),r=(n=o)&&n.__esModule?n:{default:n};var a=i("xiRS");e.default={props:{},name:"midddle-man",data:function(){return{defaultImg:'this.src="'+i("xiRS")+'"',defaultBg:a}},computed:{houseInfoData:function(){return this.$store.state.houseInfo},brokerImage:function(){var t=this.$store.state.houseInfo;return t&&t.brokerInfo&&t.brokerInfo.brokerImage?t.brokerInfo.brokerImage:a}},created:function(){},mounted:function(){},methods:{openMiddlemanTranspond:function(){this.$store.dispatch("changeMiddlemanTranspondStatus",!0)},showTelDialog:function(){this.statistic_utils.trackEvent(22),this.houseInfoData&&this.houseInfoData.slideVerify&&this.houseInfoData.slideVerify.enable&&this.houseInfoData.slideVerify.uid?this.getVirtualNumber(this.houseInfoData.slideVerify.uid):!(this.houseInfoData&&this.houseInfoData.brokerInfo&&this.houseInfoData.brokerInfo.brokerPhone)||this.houseInfoData.slideVerify&&this.houseInfoData.slideVerify.enable?this.$store.dispatch("changeTelTipStatus",!0):this.$store.dispatch("changeTelDialogStatus",!0)},getVirtualNumber:function(t){var e=this.CommonUtil.getQueryString("city"),i={command:"Global",action:"VirtualCheckType",city_id:e,uid:t},n="https://api.917.com/index.php",o=this;r.default.post({url:n,data:i}).then(function(i){var a;if((a=i.feedback)&&a.msg9006&&1==a.msg9006.type){var s={command:"Global",action:"VirtualCheckType",city_id:e,uid:t,act:"check",ts:a.msg9006.msg.ts,sec:a.msg9006.msg.secret};r.default.post({url:n,data:s}).then(function(t){var e;if((e=t.feedback)&&e.msg9006&&200==e.msg9006.status){var i=e.msg9006.msg._virtual_number,n=e.msg9006.msg.unbind_time;o.$store.dispatch("changeVirtualNumber",{virtualNumber:i,unbindTime:1e3*n}),o.$store.dispatch("changeTelDialogStatus",!0)}else o.$store.dispatch("changeTelTipStatus",!0)})}else a&&a.msg9006&&2==a.msg9006.type&&a.msg9006[0]&&a.msg9006[1]?(o.$store.dispatch("changeSlideVerifyPicArray",[a.msg9006[0],a.msg9006[1]]),o.$store.dispatch("changeSlideVerifyStatus",!0)):a&&a.msg9006})}}}},rcGq:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mobile-top-container",class:{islarge:"zh"!==t.$i18n.locale&&t.houseInfoData.share.enable}},[i("div",{staticClass:"mobile-top-content"},[t._m(0),t._v(" "),i("div",{staticClass:"title-container",on:{click:t.toggleHouseInfoPanel}},[i("span",{staticClass:"title-text only-line1",domProps:{innerHTML:t._s(t.houseInfoData.title)}}),t._v(" "),i("i",{staticClass:"title-icon",class:{active:t.houseInfoIsShow}})]),t._v(" "),i("div",{staticClass:"mobile-share-container",class:{notzh:"zh"!==t.$i18n.locale&&t.houseInfoData.share.enable},on:{click:t.toggleShareComponent}},[i("i",{staticClass:"share-icon"}),t._v(" "),i("share-component",{directives:[{name:"show",rawName:"v-show",value:t.shareComponentIsShow,expression:"shareComponentIsShow"}]})],1)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"back-container"},[e("i",{staticClass:"back-icon"})])}]};e.a=n},rjt4:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("lIcg"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("ASf4");var s=function(t){i("T//p")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-2be5bd3a",null);e.default=l.exports},rnzN:function(t,e,i){"use strict";t.exports={title:"title",share:{enable:!0,share_link:"shareLink",share_context:"shareDesc",share_img:"shareImg",share_title:"shareTitle"},offline:{text:"该房源已下架，您可以联系下方经纪人为您推荐其他优质房源！",houseDetail:""},houseInfo:{enable:!0,version:0,list:"menuInfo",map:{lon:"addressX",lat:"addressY"},houseDetail:"jumpUrl"},communityImages:{enable:!0,images:"images"},brokerInfo:{enable:!0,brokerImage:"middlemanImg",brokerPhone:"middlemanTel",brokerName:"middleman",PcPhoneTip:""},homeLink:{enable:!1,link:""},panoramaLink:{enable:!1,link:""},miniChat:{enable:!1,params:""}}},ruqs:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={components:{},props:{},name:"pc-pano-size",data:function(){return{}},computed:{panoSizeLeftIsShow:function(){return this.$store.state.panoSizeLeftIsShow},panoSizeLeftData:function(){return this.$store.state.panoSizeLeftData},panoSizeHeightIsShow:function(){return this.$store.state.panoSizeHeightIsShow},panoSizeHeightData:function(){return this.$store.state.panoSizeHeightData},panoSizeRightIsShow:function(){return this.$store.state.panoSizeRightIsShow},panoSizeRightData:function(){return this.$store.state.panoSizeRightData}},created:function(){},mounted:function(){},methods:{}}},sANT:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"take-look-tip"},[this._v("\n    "+this._s(this.takeLookTip)+"  \n")])},staticRenderFns:[]};e.a=n},sC8N:function(t,e){},sO78:function(t,e){},sbST:function(t,e,i){"use strict";t.exports={title:"title",share:{enable:!0,share_link:"ShareLink",share_context:"ShareContext",share_img:"ShareImageUrl",share_title:"ShareTitle"},houseInfo:{enable:!0,version:0,list:{rent:[{value:"city",name:"城市",widthStyle:"1"},{value:"propertyType",name:"物业类型",widthStyle:"1"},{value:"hx",name:"户型",widthStyle:"1"},{value:"forward",name:"朝向",widthStyle:1},{value:"buildArea",name:"建筑面积",widthStyle:"1"},{value:"layerNum",name:"楼层",widthStyle:"1"},{value:"rentPrice",name:"租金",widthStyle:"1"},{value:"buildDate",name:"竣工日期",widthStyle:"1"}],sale:[{value:"city",name:"城市",widthStyle:"1"},{value:"propertyType",name:"物业类型",widthStyle:"1"},{value:"hx",name:"户型",widthStyle:"1"},{value:"forward",name:"朝向",widthStyle:"1"},{value:"buildArea",name:"建筑面积",widthStyle:"1"},{value:"layerNum",name:"楼层",widthStyle:"1"},{value:"unitPrice",name:"单价",widthStyle:"1"},{value:"totalPrice",name:"总价",widthStyle:"1"},{value:"buildDate",name:"竣工日期",widthStyle:"1"}]},map:{lon:"b_map_y",lat:"b_map_x"},houseDetail:"detailUrl"},brokerInfo:{enable:!0,brokerImage:"head_pic",brokerName:"contactname",brokerPhone:"contactphone",PcPhoneTip:"请拨打(brokerName)电话咨询"},homeLink:{enable:!1,link:"indexUrl"},panoramaLink:{enable:!0,link:"hangpaiUrl"},commonJsonData:{area_text:"",district_text:"",purpose_text:"propertyType",house_type:"hx",acreage_value:"buildArea",orientation_text:"forward",decoration_type:"",floor_text:"layerNum",complation_date:"buildDate",total_price:"totalPrice",address_details:"",house_status:"",longitude_value:"b_map_y",latitude_value:"b_map_x",more_details_address:"detailUrl",community_name:"",unit_price:"unitPrice",sell_type:"",city_text:"city",developer_name:"",elevator_issupport:"",listing_time:"",rent_price:"rentPrice",hangpaiurl:"hangpaiUrl"}}},sfpZ:function(t,e){},"shi+":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"disclaimer-btn",data:function(){return{}},created:function(){},mounted:function(){},methods:{toggleDisclaimerContent:function(){this.statistic_utils.trackEvent(48),this.$store.dispatch("toggleDisclaimerContent",!this.$store.state.disclaimerContentIsShow)}}}},siXs:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"take-look-container",staticStyle:{display:"none"}},[e("i",{staticClass:"take-look-icon"}),this._v(" "),e("span",{staticClass:"take-look-text"},[this._v("\n       "+this._s(this.$t("takeLookText"))+"\n   ")])])},staticRenderFns:[]};e.a=n},soKl:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("7by9"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("tegL");var s=function(t){i("kNSG")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-763b88e1",null);e.default=l.exports},sskn:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tools-component-container",class:{"tools-icon":t.MiddleManState}},[i("div",{staticClass:"tools-btn-content",on:{click:function(e){return e.preventDefault(),t.toggleToolsList(e)}}},[i("i",{staticClass:"tools-btn-icon"}),t._v(" "),i("span",{staticClass:"tools-btn-text"},[t._v(t._s(t.$t("toolsText")))])]),t._v(" "),t.toolsListIsShow?i("div",{staticClass:"tools-list-container"},[i("div",{staticClass:"tools-list-content"},[t.MultipleMeasureState?i("div",{staticClass:"tools-item",class:{active:t.measureIsActive},on:{click:t.toggleMeasureStatus}},[i("span",{staticClass:"tools-item-icon measure-icon"}),t._v(" "),i("span",{staticClass:"tools-item-text"},[t._v(t._s(t.$t("measureText")))])]):t._e(),t._v(" "),t.MultipleTagState?i("div",{staticClass:"tools-item",class:{active:t.tagIsUsed},on:{click:t.toggleTagStatus}},[i("span",{staticClass:"tools-item-icon tag-icon"}),t._v(" "),i("span",{staticClass:"tools-item-text"},[t._v(t._s(t.$t("tagText")))])]):t._e(),t._v(" "),t.MultipleVrState?i("div",{staticClass:"tools-item active",on:{click:t.showVrTip}},[i("span",{staticClass:"tools-item-icon vr-icon"}),t._v(" "),i("span",{staticClass:"tools-item-text"},[t._v(t._s(t.$t("vrText")))])]):t._e(),t._v(" "),t.MultipleHelpState?i("div",{staticClass:"tools-item active",on:{click:t.showHelpTip}},[i("span",{staticClass:"tools-item-icon help-icon"}),t._v(" "),i("span",{staticClass:"tools-item-text"},[t._v(t._s(t.$t("helpText")))])]):t._e()]),t._v(" "),i("div",{staticClass:"tools-list-arrow"})]):t._e()])},staticRenderFns:[]};e.a=n},syts:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("V5ks"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("5ruX");var s=function(t){i("TAVT")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-6f71aa9e",null);e.default=l.exports},t27W:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i("v2ns");var n=i("7QTg");e.default={props:{},name:"mobile-scene-panel",components:{swiper:n.swiper,swiperSlide:n.swiperSlide},data:function(){return{swiperOption:{slidesPerView:4,spaceBetween:15,slideToClickedSlide:!0,scrollbar:{el:".swiper-scrollbar",draggable:!0,dragSize:100},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},loop:!1,loopAdditionalSlides:0}}},computed:{sceneIsActive:function(){return this.$store.state.sceneIsActive},sceneList:function(){return this.$store.state.sceneList},currentSceneIndex:function(){return this.$store.state.currentSceneIndex}},watch:{currentSceneIndex:function(t,e){var i=this;if(this.sceneIsActive){var n="sceneItem"+t;this.$nextTick(function(){i.sceneIsActive&&(i.$refs[n][0].scrollIntoView&&i.$refs[n][0].scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),i.$refs[n][0].scrollIntoViewIfNeeded&&i.$refs[n][0].scrollIntoViewIfNeeded(!0))})}}},created:function(){},mounted:function(){this.updateSceneItem()},methods:{showScenePanelList:function(){this.statistic_utils.trackEvent(14),this.$store.dispatch("changeSceneStatus",!0)},closeScenePanelList:function(){this.statistic_utils.trackEvent(15),this.$store.dispatch("changeSceneStatus",!1)},selectSceneItem:function(t){if("scene-item"===t.target.className&&t.target.dataset.index&&t.target.dataset.index!==this.currentSceneIndex){var e=parseInt(t.target.dataset.index);this.$store.dispatch("changeCurrentSceneIndex",e)}},selectSceneItem1:function(t){t=parseInt(t),this.$store.dispatch("changeCurrentSceneIndex",t)},updateSceneItem:function(){var t=this,e="sceneItem"+this.currentSceneIndex;this.sceneIsActive&&this.$nextTick(function(){t.$refs[e][0].scrollIntoView&&t.$refs[e][0].scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),t.$refs[e][0].scrollIntoViewIfNeeded&&t.$refs[e][0].scrollIntoViewIfNeeded(!0)})}}}},tDiQ:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tools-component-container"},[i("div",{staticClass:"tools-btn-content",class:{active:t.toolsListIsShow},on:{click:function(e){return e.preventDefault(),t.toggleToolsList(e)}}},[i("i",{staticClass:"tools-btn-icon"}),t._v(" "),i("span",{staticClass:"tools-btn-text"},[t._v(t._s(t.$t("toolsText")))])]),t._v(" "),t.toolsListIsShow?i("div",{staticClass:"tools-list-container"},[i("div",{staticClass:"tools-list-content"},[t.MultipleMeasureState?i("div",{staticClass:"tools-item",class:{active:t.measureIsActive},on:{click:t.toggleMeasureStatus}},[i("span",{staticClass:"tools-item-icon measure-icon"}),t._v(" "),i("span",{staticClass:"tools-item-text"},[t._v(t._s(t.$t("measureText")))])]):t._e(),t._v(" "),t.MultipleTagState?i("div",{staticClass:"tools-item",class:{active:t.tagIsUsed},on:{click:t.toggleTagStatus}},[i("span",{staticClass:"tools-item-icon tag-icon"}),t._v(" "),i("span",{staticClass:"tools-item-text"},[t._v(t._s(t.$t("tagText")))])]):t._e(),t._v(" "),t.MultipleHelpState?i("div",{staticClass:"tools-item active",on:{click:t.showHelpTip}},[i("span",{staticClass:"tools-item-icon help-icon"}),t._v(" "),i("span",{staticClass:"tools-item-text"},[t._v(t._s(t.$t("helpText")))])]):t._e()]),t._v(" "),i("div",{staticClass:"tools-list-arrow"})]):t._e()])},staticRenderFns:[]};e.a=n},tElg:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"house-info",data:function(){return{}},computed:{houseInfoData:function(){return this.$store.state.houseInfo}},created:function(){},mounted:function(){},methods:{toggleHouseInfoImgSwiper:function(){this.statistic_utils.trackEvent(78),this.$store.dispatch("toggleHouseInfoImgSwiper",!0),this.$store.dispatch("toggleHouseInfoPanel",!1)},goHangPai:function(){this.statistic_utils.trackEvent(29),this.houseInfoData.panoramaLink.enable&&this.houseInfoData.panoramaLink.link&&(window.location.href=this.houseInfoData.panoramaLink.link)}}}},tHSw:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"company-logo-container"},[e("img",{staticClass:"company-logo-content",attrs:{src:this.companyLogoUrl,alt:""}})])},staticRenderFns:[]};e.a=n},tegL:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"disclaimer-btn-container",on:{click:this.toggleDisclaimerContent}},[e("span",{staticClass:"disclaimer-btn-text"},[this._v(this._s(this.$t("disclaimerBtnText")))]),this._v(" "),e("i",{staticClass:"disclaimer-btn-icon"})])},staticRenderFns:[]};e.a=n},trOA:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=i("2Uyi"),o=i("322j"),r=i("w1BD");e.default={load:function(e,i){n.getQueryString("m");var a=n.getQueryString("SysCode"),s=n.getQueryString("Mobile"),l=n.getQueryString("Mutil"),c={SysCode:a,Mobile:s,CityID:n.getQueryString("CityID"),PropertyNo:n.getQueryString("PropertyNo")};t.ajax({type:"GET",url:"https://uplus.jjw.com/vrapi/Property/GetPropertyInfo",beforeSend:function(t){t.setRequestHeader("ERPVersion","VR.V1"),t.setRequestHeader("PlatForm","10")},data:c,contentType:"application/x-www-form-urlencoded",dataType:"json",success:function(t){if(2e3==t.Code){var a=t.Data,s=null;if(a.PropertyInfo)if(s=r.replenishData(function(t,e){var i={};for(var n in e)switch(n){case"title":i.title=t.PropertyInfo[e[n]];break;case"houseInfo":i.houseInfo=r.generateHouseInfo(t.PropertyInfo,e.houseInfo);break;case"brokerInfo":i.brokerInfo=r.getbrokerInfo(t.EmpInfo,e.brokerInfo);break;case"homeLink":i.homeLink=r.getLinkData(t,e.homeLink);break;case"panoramaLink":i.panoramaLink=r.getLinkData(t,e.panoramaLink);break;case"commonJsonData":i.commonJsonData=r.getHouseInfoJsonData(t.PropertyInfo,e.commonJsonData)}return i}(a,o),e),"1"===l){var c="";c=n.detectIOS()?"jijiaclient://housedetail?id="+a.PropertyInfo.ID:"jjclient://com.zfw.jijia/androidJJW?houseId="+a.PropertyInfo.ID+'&pageType="houseDetails"',s.houseInfo.houseDetail=c}else s.houseInfo.houseDetail=null;else s=function(t,e){var i={};for(var n in e)switch(n){case"title":i.title="3D看房";break;case"offline":i.offline=e.offline;break;case"brokerInfo":i.brokerInfo=r.getbrokerInfo(t.EmpInfo,e.brokerInfo)}return i}(a,o),"1"===l?(c="",n.detectAndroid()?c='jjclient://com.zfw.jijia/androidJJW?pageType="houseList"':n.detectIOS()&&(c="jijiaclient://esflist"),s.offline.houseDetail=c):s.offline.houseDetail=null;(s=r.replenishData(s,e)).houseInfo.downUrl="http://m.jjw.com/Home/DownLoadApp?MarketingSource=50",i(s)}else s=r.replenishData(null,e),i(s)},error:function(){var t=r.replenishData(null,e);i(t)}})}}}).call(e,i("awxD"))},tzae:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=l(i("cCTi")),o=l(i("Nul3")),r=l(i("PLin")),a=l(i("nK/Z"));i("v2ns");var s=i("7QTg");function l(t){return t&&t.__esModule?t:{default:t}}e.default={props:{},name:"mobile-house-component-container",data:function(){return{swiperOption:{loop:!1,initialSlide:0,loopedSlides:3,effect:"coverflow",grabCursor:!0,centeredSlides:!0,slidesPerView:"auto",slideBetween:10,coverflowEffect:{rotate:0,stretch:180,depth:800,modifier:1,slideShadows:!0}},houseInfo:n.default,smallBaiduMap:o.default,smallGoogleMap:r.default,houseImgContainer:a.default}},components:{houseInfo:n.default,smallBaiduMap:o.default,smallGoogleMap:r.default,houseImgContainer:a.default,swiper:s.swiper,swiperSlide:s.swiperSlide},computed:{isOpen:function(){return this.$store.state.houseInfoIsShow},houseInfoData:function(){return this.$store.state.houseInfo},houseInfoArr:function(){var t=[];return(this.$store.state.houseInfo.communityImages&&this.$store.state.houseInfo.communityImages.enable&&this.$store.state.houseInfo.communityImages.images&&this.$store.state.houseInfo.communityImages.images.length>0||this.$store.state.houseInfo.panoramaLink&&this.$store.state.houseInfo.panoramaLink.enable&&this.$store.state.houseInfo.panoramaLink.link)&&t.push({template:this.houseImgContainer}),this.$store.state.houseInfo.houseInfo&&this.$store.state.houseInfo.houseInfo.enable&&(t.push({template:this.houseInfo}),this.swiperOption.initialSlide=t.length-1),this.$store.state.houseInfo.houseInfo&&this.$store.state.houseInfo.houseInfo.map&&this.$store.state.houseInfo.houseInfo.map.lat&&this.$store.state.houseInfo.houseInfo.map.lon&&1!==this.$store.state.houseInfo.houseInfo.map_type?t.push({template:this.smallBaiduMap}):this.$store.state.houseInfo.houseInfo&&this.$store.state.houseInfo.houseInfo.map&&this.$store.state.houseInfo.houseInfo.map.lat&&this.$store.state.houseInfo.houseInfo.map.lon&&1===this.$store.state.houseInfo.houseInfo.map_type&&t.push({template:this.smallGoogleMap}),t}},created:function(){},mounted:function(){},methods:{closePanel:function(){this.statistic_utils.trackEvent(26),this.$store.dispatch("toggleHouseInfoPanel",!1)},blurEvent:function(){}}}},u62a:function(t,e){},uNpj:function(t,e,i){"use strict";var n=i("2Uyi"),o=i("sbST"),r=i("w1BD"),a=i("hU7x");t.exports.load=function(t,e){var i={},s=n.getQueryString("m")||n.getQueryString("model");a("https://collect.leyoujia.com/vr/vr-house-info?vrId="+s,{},function(n,a){if(n)i=r.replenishData(null,t),e(i,t);else{var s=a.data;s.houseInfo_HouseType=1===s.type?"rent":"sale",i=r.replenishData(function(t,e){var i={};for(var n in e)switch(n){case"title":i.title=t[n];break;case"share":i.share=r.getLinkData(t,e.share);break;case"houseInfo":i.houseInfo=r.generateHouseInfo(t,e.houseInfo);break;case"brokerInfo":i.brokerInfo=r.getbrokerInfo(t,e.brokerInfo);break;case"homeLink":i.homeLink=r.getLinkData(t,e.homeLink);break;case"panoramaLink":i.panoramaLink=r.getLinkData(t,e.panoramaLink)}return i}(s,o),t),e(i,t)}})}},uT31:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("mvHQ"),r=(n=o)&&n.__esModule?n:{default:n};e.default={setCookie:function(t,e,i){var n=new Date;n.setDate(n.getDate()+i),document.cookie=t+"="+e+";expires="+n},delCookie:function(t){setCookie(t,1,-1)},getCookie:function(t){for(var e=document.cookie.split("; "),i=0;i<e.length;i++){var n=e[i].split("=");if(n[0]==t)return n[1]}return""},setCookieJson:function(t,e,i){var n=(0,r.default)(e);this.setCookie(t,n,i)},getCookieJson:function(t){var e,i=this.getCookie(t);return i&&(e=JSON.parse(i)),e},getSessionStorageItem:function(t){return window.sessionStorage.getItem(t)},setSessionStorageItem:function(t,e){window.sessionStorage.setItem(t,e)},removeSessionStorageItem:function(t){return window.sessionStorage.removeItem(t)},getLocalStorageItem:function(t){return window.localStorage.getItem(t)},setLocalStorageItem:function(t,e){window.localStorage.setItem(t,e)},removeLocalStorageItem:function(t){return window.localStorage.removeItem(t)}}},uiEf:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("gimj"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("vead");var s=function(t){i("gqX1")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-e3afdaa4",null);e.default=l.exports},"unS/":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"help-tip-component",data:function(){return{}},created:function(){},mounted:function(){},methods:{closeHelpTip:function(){this.statistic_utils.trackEvent(76),this.$store.dispatch("changeHelpTipStatus",!1)}}}},v2ns:function(t,e){},v4HC:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={components:{},props:{},name:"mobile-floor-bar",data:function(){return{currentFloorIndex:""}},computed:{floorList:function(){return this.$store.state.floorList},currentMode:function(){return this.$store.state.currentMode},sceneList:function(){return this.$store.state.sceneList},lectureList:function(){return this.$store.state.lectureList}},watch:{currentMode:function(t,e){switch(t){case"floorplan":this.currentFloorIndex=this.$store.state.currentFloorIndex;break;case"dollhouse":this.currentFloorIndex="all"}}},created:function(){},mounted:function(){},methods:{selectFloor:function(t){if(this.statistic_utils.trackEvent(75),t.target.dataset.index==this.currentFloorIndex)return!1;this.currentFloorIndex=t.target.dataset.index,this.$store.dispatch("changeCurrentFloorIndex",t.target.dataset.index)}}}},vGXP:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("Y0xb"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("CzbH");var s=function(t){i("sO78")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-65824d1a",null);e.default=l.exports},vLgS:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("gPlk"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("qcs8");var s=function(t){i("al0r")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-23a0faef",null);e.default=l.exports},vWp6:function(t,e){},vead:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mobile-top-container",class:{islarge:"zh"!==t.$i18n.locale&&t.houseInfoData.share.enable}},[i("div",{staticClass:"mobile-top-content"},[t._m(0),t._v(" "),i("div",{staticClass:"title-container",on:{click:t.toggleHouseInfoPanel}},[i("span",{staticClass:"title-text only-line1",domProps:{innerHTML:t._s(t.houseInfoData.title)}}),t._v(" "),i("i",{staticClass:"title-icon",class:{active:t.houseInfoIsShow}})]),t._v(" "),i("div",{staticClass:"mobile-share-container",class:{notzh:"zh"!==t.$i18n.locale&&t.houseInfoData.share.enable},on:{click:t.toggleShareComponent}},[i("i",{staticClass:"share-icon"}),t._v(" "),i("share-component",{directives:[{name:"show",rawName:"v-show",value:t.shareComponentIsShow,expression:"shareComponentIsShow"}]})],1)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"back-container"},[e("i",{staticClass:"back-icon"})])}]};e.a=n},vjUk:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("On2s"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("2sFm");var s=function(t){i("AwAS")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-e87a4d90",null);e.default=l.exports},vxJs:function(t,e){},w1BD:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.replenishData=e.parseString=e.generateList=e.getLinkData=e.getTotalData=e.getbrokerInfo=e.getHouseInfoJsonData=e.generateHouseInfo=void 0;var n,o=i("pFYg"),r=(n=o)&&n.__esModule?n:{default:n};var a=i("1Rfu").mapValues,s=i("v89g").map,l=/\(([a-zA-Z]+)\)/,c=function(t,e){for(var i="",n=l.exec(e);n;)i+=e.substr(0,n.index),i+=t[n[1]],e=e.substr(n.index+n[0].length),n=l.exec(e);return i+=e},u=function(t,e){return s(e,function(e){var i=e.value;return i=i&&l.test(i)?c(t,i):t[i],e.value=i,e})};e.generateHouseInfo=function(t,e){if(!1===e.enable||!t)return{enable:!1};var i={enable:!0};return i.version=e.version,i.map_type=t.map_type,Array.isArray(e.list)?i.list=u(t,e.list):i.list=u(t,e.list[t.houseInfo_HouseType]),i.map=a(e.map,function(e,i){return t[e]}),i.houseDetail=t[e.houseDetail],i},e.getHouseInfoJsonData=function(t,e){if(t)try{return a(e,function(e,i){return(e=e&&l.test(e)?c(t,e):t[e])||""})}catch(t){return!1}},e.getbrokerInfo=function(t,e){if(!1===e.enable||!t)return{enable:!1};var i=a(e,function(e,i){return"enable"===i||"PcPhoneTip"===i?e:t[e]});if("object"===(0,r.default)(i.PcPhoneTip)&&(i.PcPhoneTip=i.PcPhoneTip[t.houseInfo_HouseType]),i.PcPhoneTip){var n=i.PcPhoneTip,o=/\((\S+)\)/.exec(i.PcPhoneTip);o&&(i.PcPhoneTip=n.substr(0,o.index)+i[o[1]],i.PcPhoneTip+=n.substr(o.index+o[0].length))}return i},e.getTotalData=function(t,e){return!1!==e.enable&&t?a(e,function(i,n){return"enable"===n||"version"===n?i:"map"===n?i=a(e.map,function(e,i){return t[e]}):t[i]}):{enable:!1}},e.getLinkData=function(t,e){return!1!==e.enable&&t?a(e,function(e,i){return"enable"===i?e:t[e]}):{enable:!1}},e.generateList=u,e.parseString=c,e.replenishData=function(t,e){return t?(t.brokerInfo||(t.brokerInfo={enable:!0,brokerImage:"",brokerPhone:""}),!t.brokerInfo.brokerPhone&&e.basic.model&&e.basic.menu.phone_enable&&e.basic.menu.phone&&(t.brokerInfo.brokerPhone=e.basic.menu.phone),!t.brokerInfo.brokerImage&&e.basic.model&&e.basic.model.headicon&&(t.brokerInfo.brokerImage=e.basic.model.headicon)):(t={title:"",brokerInfo:{enable:!0,brokerImage:"",brokerPhone:""}},e.basic.model?t.title=e.basic.model.name||"3d看房":t.title="3d看房",!t.brokerInfo.brokerPhone&&e.basic.model&&e.basic.menu.phone_enable&&e.basic.menu.phone&&(t.brokerInfo.brokerPhone=e.basic.menu.phone),!t.brokerInfo.brokerImage&&e.basic.model&&e.basic.model.headicon&&(t.brokerInfo.brokerImage=e.basic.model.headicon)),t.share&&t.share.enable||(t.share={enable:!0}),t.share.share_img||(t.share.share_img=e.nestscenes.backgroundimgurl.replace("http:","https:")),t.share.share_title||(t.share.share_title=t.title||e.languageObj.currentLanguage.defaultTitle),t.share.share_context||(t.share.share_context=t.title||e.languageObj.currentLanguage.defaultTitle),t.share.share_link||(t.share.share_link=window.location.href),t}},wARy:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("5/zl"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("HeY9");var s=function(t){i("ezZF")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-0256c350",null);e.default=l.exports},wAtW:function(t,e){},wJaE:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"title-component",data:function(){return{}},computed:{disclaimerContent:function(){return this.$store.state.disclaimerContent}},created:function(){},mounted:function(){},methods:{closeDisclaimer:function(){this.statistic_utils.trackEvent(49),this.$store.dispatch("toggleDisclaimerContent",!1),!this.$store.state.takeLookInfoStateIsUpdate||"1"!==this.$store.state.takeLookRole&&"2"!==this.$store.state.takeLookRole&&"3"!==this.$store.state.takeLookRole||this.$store.dispatch("changeTakeLookOperation",{type:"UI",target:"disclaimer",action:!1})}}}},wJrY:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("3pLw"),r=(n=o)&&n.__esModule?n:{default:n};var a=i("2Uyi"),s=i("D7O0"),l=i("w1BD");i("ynQN").getStyle();e.default={load:function(t,e){var i=a.getQueryString("hid");if(!i){var n=l.replenishData(null,t);return e(n),!1}var o={house_id:i};r.default.get({url:"https://df.wh66.cn/defang/House/vrHouseInfo",data:o}).then(function(i){var n=null;200===i.status&&i.data&&1==i.data.code?(n=l.replenishData(function(t,e){var i={};for(var n in e)switch(n){case"title":i.title=t.title;break;case"share":i.share=l.getTotalData(t,e.share);break;case"houseInfo":i.houseInfo=l.getTotalData(t,e.houseInfo);break;case"brokerInfo":i.brokerInfo=l.getTotalData(t,e.brokerInfo);break;case"homeLink":i.homeLink=l.getTotalData(t,e.homeLink);break;case"panoramaLink":i.panoramaLink=l.getTotalData(t,e.panoramaLink)}return i}(i.data,s),t),e(n)):(n=l.replenishData(null,t),e(n))})}}},wNIl:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("Rw5l"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("/f0r");var s=function(t){i("9QJq")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-610a146e",null);e.default=l.exports},wPdZ:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(i("2Uyi")),o=a(i("uT31")),r=a(i("WU1G"));function a(t){return t&&t.__esModule?t:{default:t}}var s=function(){return o.default.getCookie("userUuid")},l=function(){return o.default.getSessionStorageItem("pvUuid")},c=function(){var t=(new Date).getTime();return o.default.setSessionStorageItem("statisticTime",t,1)},u=function(){var t=(new Date).getTime(),e=o.default.getSessionStorageItem("statisticTime");return t>=parseInt(e)+3e5},h=function(t){var e="";for(var i in t)""!=e&&(e+="&"),e+=i+"="+encodeURIComponent(t[i]);new Image(1,1).src="https://log.3dnest.cn/a.gif?"+e},d=function(){return(new Date).getTime()/1e3};e.default={setCustomVar:function(t,e){var i=r.default.deviceInfo(),a=s(),l=0;a||(a=function(){var t=n.default.getUuid();return o.default.setCookie("userUuid",t,219e3),t}(),l=1);var u=function(){var t=n.default.getUuid();return o.default.setSessionStorageItem("pvUuid",t),t}();e||(e=-1);var p=function(t){var e=o.default.getCookieJson("companyView"),i=!1;if(e?i=e.some(function(e,i,n){return e.groupId==t&&1==e.isVisited}):e=[],!i){var n={groupId:t,isVisited:1};e.push(n),o.default.setCookieJson("companyView",e,18250)}return i}(e);o.default.setSessionStorageItem("modelId",t),o.default.setSessionStorageItem("groupId",e);var f={tp:1,ud:a,rd:u,md:t,cd:e||"-1",ht:window.location.host,ct:d(),gn:l,cn:p?0:1,dt:i.deviceType,op:i.OS,ov:i.OSVersion,ua:i.userAgent,av:i.appVersion,sh:i.screenHeight,sw:i.screenWidth,lg:i.language,nw:i.netWork,ot:i.orientation,tu:window.location.href,ru:document.referrer||"未知",ver:2};h(f),c()},trackEvent:function(t,e){var i=o.default.getSessionStorageItem("modelId"),n=o.default.getSessionStorageItem("groupId"),r={tp:2,ud:s(),rd:l(),md:i,cd:n||"-1",ct:d(),ed:t||"",pd:e||"",ver:2};h(r),c()},updatePageDuration:function(){if(u())return!1;var t=o.default.getSessionStorageItem("modelId"),e=o.default.getSessionStorageItem("groupId"),i={tp:3,ud:s(),rd:l(),md:t,cd:e||"-1",ct:d(),ver:2};h(i)},sendPerformaceTiming:function(){var t,e=(new Date).getTime(),i=o.default.getSessionStorageItem("modelId"),n=o.default.getSessionStorageItem("groupId");try{var r=window.performance.timing;t={tp:4,ud:s(),rd:l(),md:i,cd:n||"-1",dt:r.domainLookupEnd-r.domainLookupStart,ot:r.domContentLoadedEventEnd-r.navigationStart,lt:r.loadEventEnd-r.navigationStart,et:e-r.navigationStart,ver:2}}catch(t){return!1}t&&h(t)}}},wbWE:function(t,e){},wnCe:function(t,e){},"wuc/":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{},name:"tel-tip",data:function(){return{}},created:function(){},mounted:function(){},computed:{},methods:{goCancel:function(){this.$store.dispatch("changeTelTipStatus",!1)},goConfirm:function(){this.$store.dispatch("changeTelTipStatus",!1)}}}},wwmi:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"audio-tag-container"},["TextAudio"===this.currentTagType?e("audio",{ref:"audioTag",staticClass:"audio-tag",attrs:{src:this.currentTagData.audiourl,autoplay:"autoplay"},on:{onended:this.endPlay}}):this._e()])},staticRenderFns:[]};e.a=n},wz6s:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("HDlG"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("Fhs5");var s=function(t){i("EX0w")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-625ddb60",null);e.default=l.exports},"x/qA":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"middle-man-container"},[i("img",{staticClass:"middle-man-avatar",attrs:{src:t.brokerImage,onerror:t.defaultImg}}),t._v(" "),i("div",{staticClass:"middle-man-info",class:{"no-name":!(t.houseInfoData.brokerInfo&&t.houseInfoData.brokerInfo.brokerName)}},[t.houseInfoData.brokerInfo&&t.houseInfoData.brokerInfo.brokerName?i("span",{staticClass:"middle-man-name only-line1"},[t._v(t._s(t.houseInfoData.brokerInfo.brokerName))]):t._e(),t._v(" "),i("span",{staticClass:"middle-man-title"},[t._v(t._s(t.$t("middleManTitle")))])]),t._v(" "),t.houseInfoData.slideVerify&&t.houseInfoData.slideVerify.enable&&t.houseInfoData.slideVerify.uid?i("span",{staticClass:"middle-man-phone"},[t._v(t._s(t.virtualNumber?t.virtualNumber.substr(0,3)+"-"+t.virtualNumber.substr(3,3)+"-"+t.virtualNumber.substr(6).replace(",","转").replace("#",""):"***"))]):t.houseInfoData.brokerInfo&&t.houseInfoData.brokerInfo.brokerPhone?i("span",{staticClass:"middle-man-phone"},[t._v(t._s(t.houseInfoData.brokerInfo&&t.houseInfoData.brokerInfo.brokerPhone?t.houseInfoData.brokerInfo.brokerPhone.substr(0,3)+"-"+t.houseInfoData.brokerInfo.brokerPhone.substr(3,3)+"-"+t.houseInfoData.brokerInfo.brokerPhone.substr(6).replace(",","转").replace("#",""):"***"))]):t._e()])},staticRenderFns:[]};e.a=n},xD1l:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("mvHQ"),r=(n=o)&&n.__esModule?n:{default:n};var a="725001574522277";window.location.href.indexOf("3dnest.cn")>=0&&(a="1842865549077140"),e.default={props:{},name:"share-component",data:function(){return{shareData:this.$store.state.houseInfo.share}},created:function(){this.FBInit()},mounted:function(){},computed:{},methods:{FBInit:function(){var t,e,i,n,o;"zh"!==this.$i18n.locale&&(window.fbAsyncInit=function(){FB.init({appId:a,status:!0,xfbml:!0,version:"v2.12"}),FB.AppEvents.logPageView()},t=document,e="script",i="facebook-jssdk",o=t.getElementsByTagName(e)[0],t.getElementById(i)||((n=t.createElement(e)).id=i,n.src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.12&appId="+a+"&autoLogAppEvents=1",o.parentNode.insertBefore(n,o)))},fbShare:function(){var t,e,i,n;t=this.shareData.share_link,e=this.shareData.share_title,i=this.shareData.share_context,n=this.shareData.share_img,FB.ui({method:"share_open_graph",display:"popup",action_type:"og.shares",action_properties:(0,r.default)({object:{"og:url":t,"og:title":e,"og:description":i.replace(/&nbsp;/g," ").replace(/<br\/>/g,"\n")||e,"og:image":n,"og:image:width":"200","og:image:height":"200"}})},function(t){})}}}},xJD8:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"App"}},xiRS:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAMAAACahl6sAAACzVBMVEUAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////i4+X////Q1Nf+4blhQC//2axDa4X9/f7j5Obl5ufp6uv4+Pj5+vvr7O3e4OL7+/v8/Pzw8fLn5+nz9PTy8vPu7/Dc3uH+4Lf19vfo6erT1tnv8PHt7e/U2Nr29/f09fba3d/k4uHS1tj09PXZ297W2dzW2Nvw38v5+fnq6+zm5+j64sD/26/X2t3/37VmhZptTj3M0dVmRjXh4uTt4tOpt8FFbYfg4uTl4t/p4tjQ1Nb84byfj4fi4uPn4t3/58v627b82rJNc4uGb2OJaFFpSjr/+vXc29vv4dDT0M+htMDGwL6Qe3GoiG2Cal6Rcll+Zll0VEHPy8rLx8X34sStu8OSprP/3rL017Dsz6mwpJ+uoZvPsI+4mnuKc2iLbFT/9ur+8uPY19jV09O/x87z3cP/4sH33LvBuLaFnay6sKu0qaTewZ5sip2bioG+nn6YhXyVg3mTf3WNd22HZE11Wkx+XUhjQzHr4tjP1NfGzdK7xMu1wcqcrbiLobF7labmyKOypqFzj6GrnZdef5XUtpNVeZBQdY3AoIKxj3Gig2iYeF55WUTl5OPW1NT148joy6byzKHYupfivZWllo+zlHZ6YFPx8vLf5urc5OirnJfIpICjhGmef2Wbe2JtXqLNAAAAUHRSTlMAC7/wAvt4QAjhmGHJKPOQgTj36uS9uLAFAe3nz6loVxgSxbSdUUkh9YgN1cGMclVLPDAPoX5rWkQzJBwWBPnx2KWTLNykdW8a8td8Hl41iXhSwGYAAA7rSURBVHja1NtXT1RBFAfwQUHpihV7AXvvvZfYcyb3bthdWJGmEohoeADLA0EfJFEDEYIEFMsLomIiMRgkikp51RgTW4z9wfYZJAJ7ZhvMmXt3wd8XMCc755z/3BHmL1tWTtu7fNDQzfETRo0cvS183rL5E1csjJnM/h9rVi4fMiqM+7AzctOySYtDWf82ZUF45EwuIyxu+yrWPwVNnzc+hFOMnbA8ivUv62KWzV3PVYTFr+g3bRM8ePMIbkDIyIk7WJ+LXRk+jhs3df4e1pemLB/PTRIdH8P6yurN0dxMcyJiWR+IGd3zjEpIOpKWlW13cmSk5yYm8x6N2D6bBVjMAN8VJKZl223ggzXVkZKTxH0ZOCiIBVBUHPcuP81hAxmZWYcTuFfD5wfsgK3e5vVQHch1WIEiNSvR+26JWMcCYN38Dd6qSM8EBdbsI9yLkQHY+It2eemKXDsos2V76ZiQeX7u+inx3ENyhhWMyczhHsYtZP4zJmIsd3fYDiawpXi2ftwa5idRUz3OVJoNzOJ5wqK3+6fpJ0W7l5FlBTPZEz2a3g9pcskmchl09nz3/Wh6p2wJ467SreAPxw9wV/PMXY8L3C6wR06Av2QluCV8Ey9esUPctp8D/MiW4zaITcv3oXEBOVXInsxFwxaYtAQjuSgxFfwvhbuIYCaYsZWLMiAgUpO4aBkzbNVwLkhKhQCxpnFRfDAzZt9ALkiDADqewAXbjFUyOJqjhGwIKFsSF4w2slAWDhOHbiYQ1Fe++NpcdfFKXVXzucYPoMR62CWvBKnfPcQ68m0g696LqjLdxbVnD0FFOhcMCFWtI1qM6yCpvPaK7k3BuXqgc4iNEhesNq/EOlJAzo1num9V94AsU6xk0xiV/TGW3uYPrug9KlM4YCfEGDlEYZ9vFepwgIzrWIZPVyqAypbM0SBGFBTJkVwdj3QZZY3GKlnBSIJHUn+P6626pCf7yZUIpytkMKOYxZFUfzzU5bVWkvtE6PjhlG8S06nz6qVO0f5ov4HZNV5+nUQNJMarczpR6wOgsQuVLGWSZu8S7rQgoVanqyPGlmyOJjI54UIuAQmV7bqCslunVe9a0TOYjJVCTrTJZJICXc3VG0AhJMipMht+yTgcvFJ594mu7Ckls1iTaXtxAvFaW6kbUPiIUEoqNvz6Law306iB96KOlEqpUGn48cG9RRN8+0+2Sm103bC6SpCUK3+4wrFBUoG4QtRdrT1KbZP1q3u+S3GnLKCfLHWFF3/U09pkLutJpOQGQQW6aa6+vEHZJtOZb5PwYJ0AObqpCsqhF/hlZY7vfo8Nk42KqF03U23v8VEmqQzCL4ogq1A30XfS5Bo+21dYxNCbCbKu6uYpvC4zubDfh/Z6mzoMiDx+1d0CGRn4MLeWebN2mLPTbSCtUjfNM5CT1MtHlSG0TsdFYpLWoyDHjk9Aa72l3pnOH8QKBI26OcrkMxc+Y8/yMbLoP0h5lVkbBBudMILHhjJ3wSNUfpDy72YNrAogSOxhl0wihCz0VDfLS0CELtnlmbJUfpAbumnKDgJBvs/EtRgfn0FeMz6A6Ea9AAIHPmR5m724Q8jRt+mN0axyESicF5OQPUwU6nxDyAGlk3VIq/nVbqzd9wNBho+cEkFIWagWT5bW4eM7nar0tu70ABAhcYUx0Sgh9qrkrLvaPzfvtOkE75o07T0xaXmG4BiGgkLw0zsBPrO91bo1/dHltH2r0TpU693OAUWm18AVgbNXLWbd0VDN45Ze+6H020et02W9WzMgSnQc536ysNXpd5Hbmoua25dLC3xlkeo7TRp6jZ8dgSQLz5aXk+VQLOS55qnm8+vLd537paCttPr35defb2quXqkWYsPk6BlPEoAEHz81ZTfxSQ4Qabtv9PzcmwskdTh91QnNrnq2olin2A14skie4PRV9x7HL43N4/PpYNrMQl9x+qqrFheiWkwZwDoN5V0SgaYRp68ynL8VQJTGu8wMdRu+GUBTgdNX3ePuHA9Ux3m3zrf3Mc7AmApEBTh9FeH8rQMqq1uTLMbhS1WF01fZTex1qnzXS8lEfIqmeojT1/D8rQeyNNeUEo5fT6jKcfoanb9tDWcBUe+Jk11u68eB6sJdnL4G5+8bS8kFILK53NzHOD/MWYHofPFPnL4G5+8ni6UYqA6I3R7FuxwAqvsWSwFOX0Pz952lQx4g2vetCZgYFXr9Qse//Qanr6H5+8XSoUS52zeKez0diPI6/u1PhTh9DczfUss/RaD4P21CghlbirdcogZLh8ctLdWaMaWlLV8s/1wCRPviOIOxAbyLHYhKLJ1OaQYdsnQiN4lNDClhvIut7wu5D0QJwl+YYEDp+0LylJP8biwkGaiKTS/kjPL8DcdCEulrxPRCyCklR1gk+JJLdcbsQhrUY+MoLCQXyEpMLuSM+h+VRWIh6UCWZ24hDUCWIax2fHGjKzazkJJjoB7kB2IhKUB3tti8QorPAp3dWCHo2H2TCinOA6TwTX6Yao9gKUVFZzSDThbhr6GaUdQLQUWGCwGk+iEl9G91d/LTRBTHAXwQV3BBURRX3Pd93/ctbvP7HaYtrUNBGLFYqLWtglZjUHEJmngwxrPIVRNj4sG7u4kxejIe1f9CWgq/6XRmOu+9YfvcevzmrfOm83u9Qc4MxSCyq0EeDIYgAgsiEQ3yW6hrGQd7k8ztvmAQWtG5B3uhwF6LPBMM0u5qkEaZ280BGyI1kFFKQQIyt3axIPSkzr+yz6QgQZnfswHqWbTXKmN+1HV/An4m86szebACrzww89YdN4pcFOmC1Mj83rk01LkfdUt0x0HNsoArAg0iwK87DhrmSqGQB/yruoig7oBug8j2V3ziapVF6I9MS2hFFMK7OxFRoz/EXk0LiZAnbox03tP45fSih+bf/hzvv2QhtfoXPeXj6TheyB2ezYkYf9aL9rFu1Td6wt6xBHmy/sZcxPlEIj5zXZDFtGS/ni6m0S6onW2n8kAWdD77DwM02n2yoAssSe7Koi5m/4WjvJT+d9aPSd7JwqporKeV0UGKC0kE2kPgDWJaCb206ock1B6uDZFJo6W0UYw7efGF8Uq77IJ6418BpxXSqwU33LzPsMES4KEhkjGV3iO64kLnWZuj92uXZFc0Q491UsZs+grGnSBd7xo6OzuvdelJdDal63fnVXoJ7dbkO1nqcZzKVbgUxNYll3vWApMvxfxDJwj1rIUU5DAt7kMmSD1klO6kIDugR/VQCeL10EkQoROI4FAJ0qBf1skJoP2WuF95gvhkcVXmH4sVlLo33H1+ePHaJsfDKk+1i0O9xOpj9hrBvlsNKZZRHj5O9+BKtx5yR2y3+sS1SWwjF4Q0imKMkeH3iZ0D0aOIwVg3VvdzfiAURR+DVHtdmHthjfVn4GdED/nJy2u5MUjQJ/6wvmd47of5Yk3SpsUS4QBYRaEYpCkUj6itMocmuyIvI4H7EFhLhjEt5gHzKBSDeEKYEk1EVNZ50ZNbKoHMXcLTJG1aPIREA0JRnlSBCRVJOKlxNchSycQE1lGiRsJo5IVcgTdgog4NqGUcT1mTKiQTOwpZaoRpySiaqYMcT5VPJulCSHRhHIwZf76quSXgdHnXEmipFgzqHynKXzDS0EJCc/z5S+EOqyJIjnZc7Um0E2rMaRBFuQ4GlWgtGmuz32XR7sTCMch/MKQmMI+4x9ggXZ5Clka0l1Ad1PsuXO+gUFitRYww5hczNEjaP9CLYT4hLW8VusN2pdvsx3sSHfEaG8TYuVrQgZBpq1y2K91G5tnVPFND6FAl9PqiZHRAr4voTNJ2F7RIsnHSpmCxio7RJNykZPx81QgZnjg6FG61LsU8RbJVZFmRtTWKjtHU5X3ek4MmARUdC1vWCNu1jbcEaAJZhAKQEkB8ns7xERFbIK0WGcQM/+nvNZK3KKuGDN737B+9iB+ULt8w5SIt6Y61GZZCKsrKWSY3hIzU7gbBW0qXH7TCaMgkadj0ZqzjLVysIjNvukGwe9r6gCktAKeRUavJAIGRjKWkaUOfQHZ1AezyVkm5hWkXG5GVRpt3XSlp3uLercgjhl26F8QvmBaPIasEncg5K+5NCpbnDHgNeb1S0t4itzbjQIdi/gL4CWR0DzMyW61HyC1iLOW/ge9KggbqWTzeKN1eIa8wbRXpSgLOSyI0RN4mua50eyrSt1qCjJdEkDLo5WmWk8jr/W2l2xvkpvmCQEaJXKQSRV6flIzr1FCskoaLVASutlF52gJTPiuK0Gg3PjuPFLxsSEVOX5UeH5FP+DLfZUNk61EgXuTzXenxmTNHFZBZ5RKPUfoklcjjhtLrK/KIBQUu5KIkk4BURzkm4A4K8h05yKCzYrTEayHo+MPI7DkFuX0DWUVPg868AonfwhFAghFk9U0hn5BRuD6rPSiHcBI4h4x+KOQ5stE8ljnEkzSFkcUHRecr02oYbQa9mZSD15bdoONpQwa3FMI22uN+0Ju6TBI3bgzoNYTQsTeKHsNob4Esp8olN8ydB5yN8lbR60CHYpdBb9dmySXDV0KW+jjmR4+5jKM9VMdwZbPoJdqVUXTgo5LlGzrhhWxTKvr0WvOgirZo60t+YH4xP2SbMLyvL5pvjGA+HbcVveuYT7KW46J58av//Wre6fe2PscNtBdvYLj6X8TiFWBQ5Q3lS+I4R6waDJaskvpIefF0MGoOO0tinyOq+sFo/nap78xdADlqI/ZJ8udInvaA0Zg1Ut8atRxyBGTLZrmXSmKbI+z1Q66lBVJf23l4N+Rq9MWt2ySV457FC88zYGLYOKk/VGwAM1WVkajpc2LHW9P2CEfO+cHM5DlSfxk3H0x5ztREQphfNKFWNnrAVOmq0VI/mjgMrAQafFo8ahkhIjc3VYGVwmMFUj+bOHUE2Llce9qnxuLxMCJGQxFN9dY0/wmArcmHlkkDYFvRJHDT8uJp0gBZv2kmuGT8grXSgFq3rxTErSgukAbc8FH7JoOAEVM2HZEGi7UrDwCf+cVzpcFl/8Z5wGjG3tWDoEeZ2Tp7gcPRP72sZGGFNKiNnnh4w1ibQbN7T9nS1YulIaNi66LZG4umDus15eDKVZvXbuuzvvQfTCyaf/pEySEAAAAASUVORK5CYII="},"y/0k":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"scene-panel-container",class:{active:t.sceneIsActive}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.sceneIsActive,expression:"sceneIsActive"}],staticClass:"scene-list-container"},[t.sceneList&&t.sceneList.length<=4?i("div",{ref:"sceneList",staticClass:"scene-list",on:{click:t.selectSceneItem}},t._l(t.sceneList,function(e,n){return i("div",{key:n,ref:"sceneItem"+e.index,refInFor:!0,staticClass:"scene-item",class:{active:t.currentSceneIndex===e.index},attrs:{"data-index":e.index}},[t._v("\n        "+t._s(e.name)+"\n        ")])}),0):t.sceneList&&t.sceneList.length>4?i("div",{ref:"sceneList",staticClass:"scene-list"},[i("swiper",{ref:"swiper",attrs:{options:t.swiperOption}},[i("div",{staticClass:"swiper-scrollbar",attrs:{slot:"scrollbar"},slot:"scrollbar"}),t._v(" "),t._l(t.sceneList,function(e,n){return i("swiper-slide",{key:n},[i("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"}),t._v(" "),i("div",{staticClass:"swiper-button-prev",attrs:{slot:"button-prev"},slot:"button-prev"}),t._v(" "),i("div",{staticClass:"swiper-button-next",attrs:{slot:"button-next"},slot:"button-next"}),t._v(" "),i("div",{key:n,ref:"sceneItem"+e.index,refInFor:!0,staticClass:"scene-item",class:{active:t.currentSceneIndex===e.index},attrs:{"data-index":e.index},on:{click:function(i){return t.selectSceneItem1(e.index)}}},[i("div",{staticClass:"scene-text"},[t._v(t._s(e.name))])])])})],2)],1):t._e()]),t._v(" "),i("div",{staticClass:"scene-btn-content",class:{active:t.sceneIsActive},on:{click:function(e){return e.preventDefault(),t.showScenePanelList(e)}}},[i("i",{staticClass:"scene-btn-icon"}),t._v(" "),i("span",{staticClass:"scene-btn-text"},[t._v(t._s(t.$t("sceneText")))])])])},staticRenderFns:[]};e.a=n},y8eZ:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("Gl8h"),r=(n=o)&&n.__esModule?n:{default:n};e.default={components:{},props:{modelSettings:Object},name:"pc-floor-plan",data:function(){return{locationgPointIcon:r.default}},computed:{currentFloorPlanData:function(){return this.$store.state.currentFloorPlanData},currentRoomList:function(){return this.$store.state.currentRoomList},whData:function(){return this.$store.state.currrentFloorPlanWidthHeightData},entranceData:function(){return this.$store.state.entranceData},radarData:function(){return this.$store.state.radarData},currentCompass:function(){var t=void 0,e={up:"",down:""};return t=this.modelSettings.basic.menu&&this.modelSettings.basic.menu.orientation_correct?this.modelSettings.basic.menu.orientation_correct:0,(t%=360)>=337.5||t<22.5?(e.up=this.$t("direction_n_text"),e.down=this.$t("direction_s_text")):t>=22.5&&t<67.5?(e.up=this.$t("direction_w_n_text"),e.down=this.$t("direction_e_s_text")):t>=67.5&&t<112.5?(e.up=this.$t("direction_w_text"),e.down=this.$t("direction_e_text")):t>=112.5&&t<157.5?(e.up=this.$t("direction_w_s_text"),e.down=this.$t("direction_e_n_text")):t>=157.5&&t<202.5?(e.up=this.$t("direction_s_text"),e.down=this.$t("direction_n_text")):t>=202.5&&t<247.5?(e.up=this.$t("direction_e_s_text"),e.down=this.$t("direction_w_n_text")):t>=247.5&&t<292.5?(e.up=this.$t("direction_e_text"),e.down=this.$t("direction_w_text")):t>=292.5&&t<337.5&&(e.up=this.$t("direction_e_n_text"),e.down=this.$t("direction_w_s_text")),e}},created:function(){},mounted:function(){},methods:{}}},yJN4:function(t,e,i){"use strict";var n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};e.a=n},yYZK:function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"small-map-container"},[i("baidu-map",{staticClass:"map",style:{width:t.map.width,height:t.map.height},attrs:{ak:"UYtXGSLnxZGtjQ0rj58LWvTFivB4aHIF",zoom:15,center:{lng:t.houseInfoData.houseInfo.map.lon,lat:t.houseInfoData.houseInfo.map.lat},"scroll-wheel-zoom":!1,dragging:!1}},[i("bm-marker",{attrs:{position:{lng:t.houseInfoData.houseInfo.map.lon,lat:t.houseInfoData.houseInfo.map.lat}}})],1),t._v(" "),i("div",{staticClass:"small-baidu-map-footer",on:{click:t.showBigMap}},[i("span",{staticClass:"small-baidu-map-footer-text"},[t._v(t._s(t.$t("lookMapMore")))]),t._v(" "),i("i",{staticClass:"small-baidu-map-footer-icon"})])],1)},staticRenderFns:[]};e.a=n},ynQN:function(t,e,i){"use strict";var n;t.exports.getStyle=(n=null,function(){return n||(e=["beyond.3dnest","vr.917.com","3dnest.n.weimob.com","space.3dnest","cloud.3dnest","house.3dnest","cloudone.3dnest","3d.2500fang.com","cloudone.3dnest.cn","vr.zuobiaowang.com","cloud2.3dnest","cloud3.3dnest","cloud5.3dnest","cloud6.3dnest","cloud7.3dnest","cloud8.3dnest","cloud9.3dnest","cloud10.3dnest","yun.3dnest","vr.sh.centanet.com","vr.jy510.com","3dv.sdnews.com.cn","t.3dnest.cn","pre.3dnest.cn","3dnest.n.weimob.com","testweb.3dnest.cn","vr.517.cn","vr.51fang.com","vr.anyouyou365.com","house3651.3dnest.cn","house3652.3dnest.cn","house3653.3dnest.cn","house3654.3dnest.cn","house3655.3dnest.cn","house3656.3dnest.cn","house3657.3dnest.cn","house3658.3dnest.cn","house3659.3dnest.cn","house36510.3dnest.cn","house36511.3dnest.cn","house36512.3dnest.cn","house36513.3dnest.cn","house36514.3dnest.cn","house36515.3dnest.cn","house36516.3dnest.cn","house36517.3dnest.cn","house36518.3dnest.cn","house36519.3dnest.cn","house36520.3dnest.cn","house36521.3dnest.cn","house36522.3dnest.cn","house36523.3dnest.cn","house36524.3dnest.cn","house36525.3dnest.cn"].some(t=function(t,e,i){return 0===window.location.host.indexOf(t)}),i=["oldbeyond.3dnest","allfun.3dnest"].some(t),n=e?"online":i?"testline":"else");var t,e,i})},yqz8:function(t,e){},ytEo:function(t,e){},"z+Ey":function(t,e,i){"use strict";var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"floor-plan-container not-event"},[i("img",{directives:[{name:"show",rawName:"v-show",value:t.currentFloorPlanData,expression:"currentFloorPlanData"}],staticClass:"floor-plan-img not-event",style:{top:t.currentFloorPlanData.top+"px",left:t.currentFloorPlanData.left+"px",width:t.currentFloorPlanData.width+"px",height:t.currentFloorPlanData.height+"px"},attrs:{src:t.currentFloorPlanData.imageUrl,alt:""}}),t._v(" "),t._l(t.currentRoomList,function(e,n){return i("span",{key:n,staticClass:"floor-plan-room",style:{top:e.top+"px",left:e.left+"px",transform:"translate(-50%,-50%)"}},[t._v("\n         "+t._s(e.roomname)+"\n     ")])}),t._v(" "),t.whData&&t.whData.wData&&t.modelSettings.basic&&t.modelSettings.basic.menu&&t.modelSettings.basic.menu.floorplan_enable?i("div",{staticClass:"floor-plan-width",style:{top:t.whData.wData.wDataTop+"px",left:t.whData.wData.wDataLeft+"px",width:t.whData.wData.width+"px"}},[i("span",{staticClass:"floor-plan-width-text"},[t._v("\n             "+t._s(t.whData.wData.wDataText)+"\n         ")])]):t._e(),t._v(" "),t.whData&&t.whData.hData&&t.modelSettings.basic&&t.modelSettings.basic.menu&&t.modelSettings.basic.menu.floorplan_enable?i("div",{staticClass:"floor-plan-height",style:{top:t.whData.hData.hDataTop+"px",left:t.whData.hData.hDataLeft+"px",height:t.whData.hData.height+"px"}},[i("span",{staticClass:"floor-plan-height-text"},[t._v("\n             "+t._s(t.whData.hData.hDataText)+"\n         ")])]):t._e(),t._v(" "),t.entranceData&&t.entranceData.isShow?i("div",{staticClass:"entry-point",style:{top:t.entranceData.top+"px",left:t.entranceData.left+"px"}},[i("p",{staticClass:"entry-img",class:{class:t.entranceData.state},style:{transform:"rotate("+t.entranceData.angle+"deg)"}})]):t._e(),t._v(" "),i("img",{directives:[{name:"show",rawName:"v-show",value:t.radarData.isShow,expression:"radarData.isShow"}],staticClass:"locating-point",style:{top:t.radarData.top+"px",left:t.radarData.left+"px",transform:"translate(-50%,-50%) rotate("+t.radarData.angle+"deg)"},attrs:{src:t.locationgPointIcon,alt:""}}),t._v(" "),t.whData&&t.whData.hData?i("div",{staticClass:"compass-north-container",style:{top:t.whData.hData.hDataTop-140+"px"}},[i("span",{staticClass:"compass-north-text"},[t._v("\n            "+t._s(this.currentCompass.up)+"\n         ")]),t._v(" "),i("i",{staticClass:"compass-north-icon"})]):t._e()],2)},staticRenderFns:[]};e.a=n},"z+oM":function(t,e){},z30g:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("avSM"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("dg6q");var s=function(t){i("gLWB")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-0030b8c7",null);e.default=l.exports},z4Ha:function(t,e){},z7S7:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("cmTr"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("azXA");var s=function(t){i("locS")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-756a96e1",null);e.default=l.exports},zVGw:function(t,e){},zdtW:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("HMN+"),o=i.n(n);for(var r in n)"default"!==r&&function(t){i.d(e,t,function(){return n[t]})}(r);var a=i("Oe0U");var s=function(t){i("zVGw")},l=i("VU/8")(o.a,a.a,!1,s,"data-v-34b87a02",null);e.default=l.exports},zlT9:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=i("3pLw"),r=(n=o)&&n.__esModule?n:{default:n};var a=i("xiRS");e.default={props:{},name:"midddle-man",data:function(){return{defaultImg:'this.src="'+i("xiRS")+'"',defaultBg:a}},created:function(){},computed:{houseInfoData:function(){return this.$store.state.houseInfo},brokerImage:function(){var t=this.$store.state.houseInfo;return t&&t.brokerInfo&&t.brokerInfo.brokerImage?t.brokerInfo.brokerImage:a}},mounted:function(){},methods:{openMiddlemanTranspond:function(){this.$store.dispatch("changeMiddlemanTranspondStatus",!0)},showTelDialog:function(){this.statistic_utils.trackEvent(22),this.houseInfoData&&this.houseInfoData.slideVerify&&this.houseInfoData.slideVerify.enable&&this.houseInfoData.slideVerify.uid?this.getVirtualNumber(this.houseInfoData.slideVerify.uid):!(this.houseInfoData&&this.houseInfoData.brokerInfo&&this.houseInfoData.brokerInfo.brokerPhone)||this.houseInfoData.slideVerify&&this.houseInfoData.slideVerify.enable?this.$store.dispatch("changeTelTipStatus",!0):this.$store.dispatch("changeTelDialogStatus",!0)},getVirtualNumber:function(t){var e=this.CommonUtil.getQueryString("city"),i={command:"Global",action:"VirtualCheckType",city_id:e,uid:t},n="https://api.917.com/index.php",o=this;r.default.post({url:n,data:i}).then(function(i){var a;if((a=i.feedback)&&a.msg9006&&1==a.msg9006.type){var s={command:"Global",action:"VirtualCheckType",city_id:e,uid:t,act:"check",ts:a.msg9006.msg.ts,sec:a.msg9006.msg.secret};r.default.post({url:n,data:s}).then(function(t){var e;if((e=t.feedback)&&e.msg9006&&200==e.msg9006.status){var i=e.msg9006.msg._virtual_number,n=e.msg9006.msg.unbind_time;o.$store.dispatch("changeVirtualNumber",{virtualNumber:i,unbindTime:1e3*n}),o.$store.dispatch("changeTelDialogStatus",!0)}else o.$store.dispatch("changeTelTipStatus",!0)})}else a&&a.msg9006&&2==a.msg9006.type&&a.msg9006[0]&&a.msg9006[1]?(o.$store.dispatch("changeSlideVerifyPicArray",[a.msg9006[0],a.msg9006[1]]),o.$store.dispatch("changeSlideVerifyStatus",!0)):a&&a.msg9006})}}}},zs9v:function(t,e){}},[0]);